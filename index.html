<!doctype html>
<html class="theme-next   use-motion ">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>




  
    <link href='//fonts.googleapis.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext' rel='stylesheet' type='text/css'>
  



<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=0.4.5.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=0.4.5.2" />






<meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="SmallTalk">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="SmallTalk">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="SmallTalk">
<meta name="twitter:description">



<script type="text/javascript" id="hexo.configuration">
  var CONFIG = {
    scheme: 'Mist',
    sidebar: 'post',
    motion: true
  };
</script>

  <title> SmallTalk </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="">

  <!--[if lte IE 8]>
  <div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;margin:0 auto;'>
    <a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode">
      <img src="http://7u2nvr.com1.z0.glb.clouddn.com/picouterie.jpg" border="0" height="42" width="820"
           alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today or use other browser ,like chrome firefox safari."
           style='margin-left:auto;margin-right:auto;display: block;'/>
    </a>
  </div>
<![endif]-->
  






  <div class="container one-column 
   page-home 
">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">SmallTalk</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu ">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            首頁
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            歸檔
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-tags fa-fw"></i> <br />
            
            標籤
          </a>
        </li>
      

      
      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div id="content" class="content">
          
  <section id="posts" class="posts-expand">

    

    
    

    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2018/11/16/simplefactory/" itemprop="url">
                  简单工厂模式
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            發表於
            <time itemprop="dateCreated" datetime="2018-11-16T08:09:29+08:00" content="2018-11-16">
              2018-11-16
            </time>
          </span>

          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <h3 id="简单工厂模式（C#实现）">简单工厂模式（C#实现）</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">ConsoleApplication1</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="keyword">string</span>[] args</span>)</span><br><span class="line"></span><br><span class="line">        </span>&#123;   <span class="comment">//客户端代码</span></span><br><span class="line">            Operation oper;</span><br><span class="line">            oper = OperationFactory.createOperate(<span class="string">"+"</span>);</span><br><span class="line">            oper.NumberA = <span class="number">1</span>;</span><br><span class="line">            oper.NumberB = <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">double</span> result = oper.GetResult();</span><br><span class="line">            Console.WriteLine(<span class="string">"结果："</span> + result);</span><br><span class="line">            Console.Read();</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//Operation运算类</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Operation</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">double</span> _numberA = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">double</span> _numberB = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">double</span> NumberA</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">get</span> &#123; <span class="keyword">return</span> _numberA; &#125;</span><br><span class="line">            <span class="keyword">set</span> &#123; _numberA = <span class="keyword">value</span>; &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">double</span> NumberB</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">get</span> &#123; <span class="keyword">return</span> _numberB; &#125;</span><br><span class="line">            <span class="keyword">set</span> &#123; _numberB = <span class="keyword">value</span>; &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keyword">double</span> <span class="title">GetResult</span>(<span class="params"></span>)</span><br><span class="line">        </span>&#123;</span><br><span class="line">            <span class="keyword">double</span> result = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//加减乘除类</span></span><br><span class="line">    <span class="keyword">class</span> <span class="title">OperationAdd</span> : <span class="title">Operation</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">double</span> <span class="title">GetResult</span>(<span class="params"></span>)</span><br><span class="line">        </span>&#123;</span><br><span class="line">            <span class="keyword">double</span> result = <span class="number">0</span>;</span><br><span class="line">            result = NumberA + NumberB;</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">class</span> <span class="title">OperationSub</span> : <span class="title">Operation</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">double</span> <span class="title">GetResult</span>(<span class="params"></span>)</span><br><span class="line">        </span>&#123;</span><br><span class="line">            <span class="keyword">double</span> result = <span class="number">0</span>;</span><br><span class="line">            result = NumberA - NumberB;</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">class</span> <span class="title">OperationMul</span> : <span class="title">Operation</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">double</span> <span class="title">GetResult</span>(<span class="params"></span>)</span><br><span class="line">        </span>&#123;</span><br><span class="line">            <span class="keyword">double</span> result = <span class="number">0</span>;</span><br><span class="line">            result = NumberA * NumberB;</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">class</span> <span class="title">OperationDiv</span> : <span class="title">Operation</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">double</span> <span class="title">GetResult</span>(<span class="params"></span>)</span><br><span class="line">        </span>&#123;</span><br><span class="line">            <span class="keyword">double</span> result = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span> (NumberB == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">"除数不能为0"</span>);</span><br><span class="line">            result = NumberA / NumberB;</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">OperationFactory</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Operation <span class="title">createOperate</span>(<span class="params"><span class="keyword">string</span> operate</span>)</span><br><span class="line">        </span>&#123;</span><br><span class="line">            Operation oper = <span class="keyword">null</span>;</span><br><span class="line">            <span class="keyword">switch</span> (operate)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">"+"</span>:</span><br><span class="line">                    oper = <span class="keyword">new</span> OperationAdd();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">"-"</span>:</span><br><span class="line">                    oper = <span class="keyword">new</span> OperationSub();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">"*"</span>:</span><br><span class="line">                    oper = <span class="keyword">new</span> OperationMul();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">"/"</span>:</span><br><span class="line">                    oper = <span class="keyword">new</span> OperationDiv();</span><br><span class="line">                    <span class="keyword">break</span>;  </span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> oper;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/10/28/abap/" itemprop="url">
                  ABAP汇编
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            發表於
            <time itemprop="dateCreated" datetime="2017-10-28T09:13:29+08:00" content="2017-10-28">
              2017-10-28
            </time>
          </span>

          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <h2 id="内表">内表</h2><h3 id="查找内表重复数据">查找内表重复数据</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#34;&#26597;&#25214;&#20869;&#34920;&#37325;&#22797;&#25968;&#25454;&#10;DATA: it_test   TYPE STANDARD TABLE OF ty_test WITH HEADER LINE,&#10;      old_f1(3),&#10;      old_f3(3).&#10;it_test-f1 = &#39;AAA&#39;. it_test-f2 = &#39;AAA&#39;. it_test-f3 = &#39;DDD&#39;. APPEND it_test.&#10;it_test-f1 = &#39;BBB&#39;. it_test-f2 = &#39;AAA&#39;. it_test-f3 = &#39;CCC&#39;. APPEND it_test.&#10;it_test-f1 = &#39;AAA&#39;. it_test-f2 = &#39;AAA&#39;. it_test-f3 = &#39;AAA&#39;. APPEND it_test.&#10;it_test-f1 = &#39;BBB&#39;. it_test-f2 = &#39;AAA&#39;. it_test-f3 = &#39;CCC&#39;. APPEND it_test.&#10;&#10;SORT: it_test BY f1 f3.&#10;LOOP AT it_test.&#10;  IF old_f1 = it_test-f1 AND old_f3 = it_test-f3.&#10;    WRITE: &#39;There is Duplicate Record on Index &#39;, sy-tabix.&#10;  ENDIF.&#10;  old_f1 = it_test-f1.&#10;  old_f3 = it_test-f3.&#10;ENDLOOP.</span><br></pre></td></tr></table></figure>
<h2 id="ALV">ALV</h2><h3 id="输入区间赋值">输入区间赋值</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECTION-SCREEN BEGIN OF BLOCK blc WITH FRAME TITLE text-001.&#10;PARAMETERS:         p_werks  LIKE mseg-werks OBLIGATORY DEFAULT &#39;1000&#39;,&#10;                    p_lgort  LIKE mseg-lgort OBLIGATORY.&#10;SELECT-OPTIONS      p_matnr  FOR mseg-matnr .&#10;SELECT-OPTIONS      p_ekgrp  FOR marc-ekgrp .&#10;SELECT-OPTIONS      p_erdat  FOR mseg-budat_mkpf OBLIGATORY .&#10;SELECTION-SCREEN END OF BLOCK blc.&#10;&#10;INITIALIZATION.&#10;  p_erdat-option = &#39;BT&#39;.&#10;  p_erdat-sign = &#39;I&#39;.&#10;  p_erdat-low = sy-datum.&#10;  p_erdat-low+6(2) = &#39;01&#39;.&#10;  p_erdat-high = sy-datum.&#10;  APPEND p_erdat.</span><br></pre></td></tr></table></figure>
<h3 id="添加选择按钮">添加选择按钮</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AT SELECTION-SCREEN OUTPUT.&#10;  PERFORM frm_setlist.&#10;&#10;FORM frm_setlist .&#10;  TYPE-POOLS: vrm . &#34;&#23384;&#25918;combobox&#20869;&#23481;&#30340;type pool&#10;&#10;  DATA:z_list TYPE         vrm_values,&#10;       value  LIKE LINE OF z_list.&#10;  REFRESH z_list.&#10;&#10;  value-key = &#39;0&#39;.&#10;  value-text = &#39;&#24050;&#25171;&#21360;&#39;.&#10;  APPEND value TO z_list.&#10;&#10;  value-key = &#39;1&#39;.&#10;  value-text = &#39;&#26410;&#25171;&#21360;&#39;.&#10;  APPEND value TO z_list.&#10;&#10;  CALL FUNCTION &#39;VRM_SET_VALUES&#39;&#10;    EXPORTING&#10;      id     = &#39;LS_LIST&#39;&#10;      values = z_list.&#10;ENDFORM.</span><br></pre></td></tr></table></figure>
<h3 id="ALV点击字段跳转VL03N">ALV点击字段跳转VL03N</h3><figure class="highlight scilab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br></pre></td><td class="code"><pre><span class="line">*&amp;---------------------------------------------------------------------*</span><br><span class="line">*&amp; Report  ZSTSD005</span><br><span class="line">*&amp;</span><br><span class="line">*&amp;---------------------------------------------------------------------*</span><br><span class="line">*&amp;</span><br><span class="line">*&amp;</span><br><span class="line">*&amp;---------------------------------------------------------------------*</span><br><span class="line"></span><br><span class="line">REPORT <span class="transposed_variable">zstsd005.</span></span><br><span class="line"></span><br><span class="line">TYPE-POOLS: <span class="transposed_variable">slis.</span></span><br><span class="line">TABLES: likp,lips,vbak,<span class="transposed_variable">adrc.</span></span><br><span class="line">DATA:BEGIN OF item OCCURS <span class="number">0</span>,</span><br><span class="line">       mark(<span class="number">1</span>),</span><br><span class="line">       name1      LIKE adrc-name1,<span class="string">"客户名称</span><br><span class="line">       vkorg      LIKE vbak-vkorg,"</span>销售组织</span><br><span class="line">       vtweg      LIKE vbak-vtweg,<span class="string">"分销渠道</span><br><span class="line">       spart      LIKE vbak-spart,"</span>产品组</span><br><span class="line">       kunnr      LIKE likp-kunnr,<span class="string">"客户编码</span><br><span class="line">       sdabw      LIKE likp-sdabw,"</span>货运方式</span><br><span class="line">       bezei      LIKE tvsakt-bezei,<span class="string">"货运方式描述</span><br><span class="line">       ernam      LIKE likp-ernam,"</span>创建者</span><br><span class="line">       erdat      LIKE likp-erdat,<span class="string">"创建日期</span><br><span class="line">       posnr      LIKE lips-posnr,"</span>行项目号</span><br><span class="line">       werks      LIKE lips-werks,<span class="string">"工厂</span><br><span class="line">       lgort      LIKE lips-lgort,"</span>库存地点</span><br><span class="line">       vbeln      LIKE lips-vbeln,<span class="string">"发货单号</span><br><span class="line">       matnr      LIKE lips-matnr,"</span>物料编码</span><br><span class="line">       arktx      LIKE lips-arktx,<span class="string">"物料描述</span><br><span class="line">       vrkme      LIKE lips-vrkme,"</span>单位</span><br><span class="line">       lfimg      LIKE lips-lfimg,<span class="string">"通知量</span><br><span class="line">       charg      LIKE lips-charg,"</span>批次号</span><br><span class="line">       lfart      LIKE likp-lfart,<span class="string">"交货单类型</span><br><span class="line">       vtext      LIKE tvlkt-vtext,"</span>交货类型编号</span><br><span class="line">       street     LIKE adrc-street,<span class="string">"客户地址</span><br><span class="line">       name2      LIKE adrc-name1,"</span>联系人</span><br><span class="line">       tel_number LIKE adrc-tel_number,<span class="string">"联系人电话</span><br><span class="line">       adrnr      LIKE vbpa-adrnr,</span><br><span class="line">       "</span> parvw      LIKE vbpa-parvw,</span><br><span class="line">       vkgrp      LIKE vbak-vkgrp,<span class="string">"销售组</span><br><span class="line">     END OF item.</span><br><span class="line"></span><br><span class="line">DATA:wa_i LIKE item.</span><br><span class="line">DATA: gd_repid LIKE sy-repid.</span><br><span class="line">DATA: i_grid_settings TYPE lvc_s_glay .</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DATA: afield TYPE slis_fieldcat_alv.</span><br><span class="line">DATA: fieldcat TYPE TABLE OF slis_fieldcat_alv WITH HEADER LINE.</span><br><span class="line">DATA: layout TYPE slis_layout_alv.</span><br><span class="line">DATA: l_pos     TYPE i VALUE 1,</span><br><span class="line">      p_i       TYPE i,</span><br><span class="line">      l_msg(70).</span><br><span class="line">DATA: gt_events TYPE slis_t_event.</span><br><span class="line"></span><br><span class="line">DATA: tem_grid TYPE REF TO cl_gui_alv_grid.</span><br><span class="line">DATA: wa_modi TYPE lvc_s_modi.</span><br><span class="line">DATA: stbl TYPE lvc_s_stbl.</span><br><span class="line">DATA: l_events TYPE LINE OF slis_t_event.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DEFINE fill.</span><br><span class="line">  afield-col_pos = l_pos.</span><br><span class="line">  afield-fieldname = &amp;1.</span><br><span class="line">  afield-seltext_l = &amp;2.</span><br><span class="line">  afield-no_zero   = &amp;3.</span><br><span class="line">  afield-KEY       = &amp;4.</span><br><span class="line">  afield-EDIT      = &amp;5.</span><br><span class="line"></span><br><span class="line">  APPEND afield TO fieldcat.</span><br><span class="line">  CLEAR afield.</span><br><span class="line">  l_pos = l_pos + 1.</span><br><span class="line">END-OF-DEFINITION.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">SELECTION-SCREEN BEGIN OF BLOCK blc WITH FRAME TITLE text-001.</span><br><span class="line"></span><br><span class="line">SELECT-OPTIONS:</span><br><span class="line">  s_vkorg FOR likp-vkorg,</span><br><span class="line">  s_vtweg FOR vbak-vtweg,</span><br><span class="line">  s_spart FOR vbak-spart,</span><br><span class="line">  s_vkgrp FOR vbak-vkgrp,</span><br><span class="line">  s_vbeln FOR vbak-vbeln,</span><br><span class="line">  s_sdabw FOR likp-sdabw,</span><br><span class="line">  s_lgort FOR lips-lgort,</span><br><span class="line">  s_kunag FOR likp-kunag,</span><br><span class="line">  s_bldat FOR likp-bldat.</span><br><span class="line">SELECTION-SCREEN END OF BLOCK blc.</span><br><span class="line">PARAMETERS:</span><br><span class="line">p_upt TYPE c RADIOBUTTON GROUP r1 DEFAULT '</span><span class="transposed_variable">X'</span>,</span><br><span class="line">p_prt TYPE c RADIOBUTTON GROUP r1 .</span><br><span class="line"></span><br><span class="line">START-OF-<span class="transposed_variable">SELECTION.</span></span><br><span class="line">  IF p_upt = <span class="string">'X'</span>.</span><br><span class="line">    <span class="string">"PERFORM frm_get_event.</span><br><span class="line">    PERFORM frm_get_data.</span><br><span class="line">    PERFORM frm_show_data.</span><br><span class="line">  ELSE.</span><br><span class="line">  ENDIF.</span><br><span class="line">*&amp;---------------------------------------------------------------------*</span><br><span class="line">*&amp;      Form  FRM_GET_DATA</span><br><span class="line">*&amp;---------------------------------------------------------------------*</span><br><span class="line">*       text</span><br><span class="line">*----------------------------------------------------------------------*</span><br><span class="line">*  --&gt;  p1        text</span><br><span class="line">*  &lt;--  p2        text</span><br><span class="line">*----------------------------------------------------------------------*</span><br><span class="line">FORM frm_get_data .</span><br><span class="line">  SELECT</span><br><span class="line">    "</span>vbpa~parvw</span><br><span class="line">    vbpa~adrnr</span><br><span class="line">    likp~kunnr</span><br><span class="line">    likp~sdabw</span><br><span class="line">    likp~ernam</span><br><span class="line">    likp~erdat</span><br><span class="line">    likp~lfart</span><br><span class="line">    lips~posnr</span><br><span class="line">    lips~werks</span><br><span class="line">    lips~lgort</span><br><span class="line">    lips~vbeln</span><br><span class="line">    lips~matnr</span><br><span class="line">    lips~arktx</span><br><span class="line">    lips~vrkme</span><br><span class="line">    lips~lfimg</span><br><span class="line">    lips~charg</span><br><span class="line">    vbak~vkorg</span><br><span class="line">    vbak~vtweg</span><br><span class="line">    vbak~spart</span><br><span class="line">    vbak~vkgrp</span><br><span class="line">    INTO CORRESPONDING FIELDS OF TABLE item</span><br><span class="line">    FROM lips</span><br><span class="line">    INNER JOIN likp ON ( lips~vbeln = likp~vbeln )</span><br><span class="line">    INNER JOIN vbpa ON ( vbpa~vbeln = likp~vbeln )</span><br><span class="line">    INNER JOIN vbak ON ( vbak~vbeln = lips~vgbel )</span><br><span class="line">    WHERE likp~kunag IN s_kunag</span><br><span class="line">    AND vbak~vkorg IN s_vkorg</span><br><span class="line">    AND vbak~vtweg IN s_vtweg</span><br><span class="line">    AND vbak~spart IN s_spart</span><br><span class="line">    AND vbak~vkgrp IN s_vkgrp</span><br><span class="line">    AND lips~vbeln IN s_vbeln</span><br><span class="line">    AND likp~sdabw IN s_sdabw</span><br><span class="line">    AND lips~lgort IN <span class="transposed_variable">s_lgort.</span></span><br><span class="line">  SORT item BY <span class="transposed_variable">kunnr.</span></span><br><span class="line">  DELETE ADJACENT DUPLICATES FROM item COMPARING ALL <span class="transposed_variable">FIELDS.</span></span><br><span class="line">  LOOP AT <span class="transposed_variable">item.</span></span><br><span class="line">    SELECT SINGLE adrnr INTO item-adrnr</span><br><span class="line">       FROM vbpa</span><br><span class="line">      WHERE vbeln = item-vbeln AND parvw = <span class="string">'AG'</span>.</span><br><span class="line">    SELECT SINGLE name1 INTO item-name1</span><br><span class="line">      FROM adrc</span><br><span class="line">      WHERE addrnumber = item-<span class="transposed_variable">adrnr.</span></span><br><span class="line">    SELECT SINGLE adrnr INTO item-adrnr</span><br><span class="line">      FROM vbpa</span><br><span class="line">      WHERE vbeln = item-vbeln AND parvw = <span class="string">'AP'</span>.</span><br><span class="line">    SELECT SINGLE street name1 tel_number</span><br><span class="line">      INTO (item-street,item-name2,item-tel_number)</span><br><span class="line">    FROM adrc</span><br><span class="line">    WHERE addrnumber = item-<span class="transposed_variable">adrnr.</span></span><br><span class="line">    SELECT SINGLE bezei INTO item-bezei</span><br><span class="line">      FROM tvsakt</span><br><span class="line">      WHERE sdabw = item-<span class="transposed_variable">sdabw.</span></span><br><span class="line">    SELECT SINGLE vtext INTO item-vtext</span><br><span class="line">      FROM tvlkt WHERE lfart = item-<span class="transposed_variable">lfart.</span></span><br><span class="line">    MODIFY <span class="transposed_variable">item.</span></span><br><span class="line">  <span class="transposed_variable">ENDLOOP.</span></span><br><span class="line">  <span class="string">"BREAK-POINT.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ENDFORM.                    "</span> FRM_GET_DATA</span><br><span class="line">*&amp;---------------------------------------------------------------------*</span><br><span class="line">*&amp;      Form  FRM_SHOW_DATA</span><br><span class="line">*&amp;---------------------------------------------------------------------*</span><br><span class="line">*       text</span><br><span class="line">*----------------------------------------------------------------------*</span><br><span class="line">*  --&gt;  p1        text</span><br><span class="line">*  &lt;--  p2        text</span><br><span class="line">*----------------------------------------------------------------------*</span><br><span class="line">FORM frm_show_data .</span><br><span class="line">  i_grid_settings-edt_cll_cb  = <span class="string">'X'</span> .            <span class="string">"显示界面可编辑字段上修改了数据，回车后就会立即将内表的数据也修改</span><br><span class="line">  layout-colwidth_optimize    = '</span><span class="transposed_variable">X'.</span>                <span class="string">"设置字段列宽自适应</span><br><span class="line">  layout-zebra             = '</span><span class="transposed_variable">X'.</span></span><br><span class="line"></span><br><span class="line">  CLEAR <span class="transposed_variable">afield.</span></span><br><span class="line">  REFRESH <span class="transposed_variable">fieldcat.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  fill  <span class="string">'MARK'</span>       <span class="string">'选择'</span>     <span class="string">''</span> <span class="string">'X'</span> <span class="string">'X'</span>     .</span><br><span class="line">  fieldcat-checkbox = <span class="string">'X'</span>.</span><br><span class="line">  fieldcat-hotspot = <span class="string">''</span>.</span><br><span class="line">  MODIFY fieldcat INDEX <span class="number">1</span> TRANSPORTING checkbox <span class="transposed_variable">hotspot.</span></span><br><span class="line">  fill  <span class="string">'NAME1'</span> <span class="string">'客户名称'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>.</span><br><span class="line">  fill  <span class="string">'VKORG'</span> <span class="string">'销售组织'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>.</span><br><span class="line">  fill  <span class="string">'VTWEG'</span> <span class="string">'分销渠道'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>.</span><br><span class="line">  fill  <span class="string">'SPART'</span> <span class="string">'产品组'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>.</span><br><span class="line">  fill  <span class="string">'KUNNR'</span> <span class="string">'客户编码'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>.</span><br><span class="line">  fill  <span class="string">'SDABW'</span> <span class="string">'货运方式'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>.</span><br><span class="line">  fill  <span class="string">'BEZEI'</span> <span class="string">'货运方式描述'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>.</span><br><span class="line">  fill  <span class="string">'ERNAM'</span> <span class="string">'创建者'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>.</span><br><span class="line">  fill  <span class="string">'ERDAT'</span> <span class="string">'创建日期'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>.</span><br><span class="line">  fill  <span class="string">'POSNR'</span> <span class="string">'行项目号'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>.</span><br><span class="line">  fill  <span class="string">'WERKS'</span> <span class="string">'工厂'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>.</span><br><span class="line">  fill  <span class="string">'LGORT'</span> <span class="string">'库存地点'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>.</span><br><span class="line">  fill  <span class="string">'VBELN'</span> <span class="string">'发货单号'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>.</span><br><span class="line">  fill  <span class="string">'MATNR'</span> <span class="string">'物料编码'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>.</span><br><span class="line">  fill  <span class="string">'ARKTX'</span> <span class="string">'物料描述'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>.</span><br><span class="line">  fill  <span class="string">'VRKME'</span> <span class="string">'单位'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>.</span><br><span class="line">  fill  <span class="string">'LFIMG'</span> <span class="string">'通知量'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>.</span><br><span class="line">  fill  <span class="string">'CHARG'</span> <span class="string">'批次号'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>.</span><br><span class="line">  fill  <span class="string">'LFART'</span> <span class="string">'交货单类型'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>.</span><br><span class="line">  fill  <span class="string">'VTEXT'</span> <span class="string">'交货类型编号'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>.</span><br><span class="line">  fill  <span class="string">'STREET'</span>  <span class="string">'客户地址'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>.</span><br><span class="line">  fill  <span class="string">'NAME2'</span> <span class="string">'联系人'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>.</span><br><span class="line">  fill  <span class="string">'TEL_NUMBER'</span>  <span class="string">'联系人电话'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>.</span><br><span class="line">  fill  <span class="string">'VKGRP'</span> <span class="string">'销售组'</span>  <span class="string">''</span> <span class="string">''</span> <span class="string">''</span>.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  CALL FUNCTION <span class="string">'REUSE_ALV_GRID_DISPLAY'</span></span><br><span class="line">    EXPORTING</span><br><span class="line">      i_grid_settings    = i_grid_settings                 <span class="string">"显示界面可编辑字段上修改了数据，回车后就会立即将内表的数据也修改</span><br><span class="line">      i_callback_program = sy-cprog "</span>sy-repid                        <span class="string">"标记当前程序</span><br><span class="line">      it_fieldcat        = fieldcat[]</span><br><span class="line">      is_layout          = layout</span><br><span class="line">      i_callback_user_command  = '</span><span class="transposed_variable">USER_COMMAND'</span></span><br><span class="line">      i_callback_pf_status_set = <span class="string">'SET_STATUS'</span></span><br><span class="line">    <span class="string">" it_events          = gt_events</span><br><span class="line">    TABLES</span><br><span class="line">      t_outtab           = item.</span><br><span class="line">ENDFORM.                    "</span> FRM_SHOW_DATA</span><br><span class="line">FORM set_status USING rt_extab TYPE <span class="transposed_variable">slis_t_extab.</span></span><br><span class="line">  SET PF-STATUS <span class="string">'ZCMD1'</span>.</span><br><span class="line"><span class="transposed_variable">ENDFORM.</span></span><br><span class="line">FORM user_command USING rf_ucomm  LIKE sy-ucomm</span><br><span class="line">      rs        TYPE slis_selfield .</span><br><span class="line">  rs-REFRESH = <span class="string">'X'</span>.</span><br><span class="line"></span><br><span class="line">  CASE <span class="transposed_variable">rf_ucomm.</span></span><br><span class="line"></span><br><span class="line">  WHEN <span class="string">'&amp;IC1'</span>.</span><br><span class="line">    CLEAR <span class="transposed_variable">wa_i.</span></span><br><span class="line">    READ TABLE item INTO wa_i INDEX rs-<span class="transposed_variable">tabindex.</span></span><br><span class="line">    IF rs-fieldname = <span class="string">'VBELN'</span>.</span><br><span class="line">        <span class="string">"PERFORM frm_show_dymx.                                    "</span>显示打印明细</span><br><span class="line">        SET PARAMETER ID <span class="string">'VL'</span> FIELD wa_i-vbeln .</span><br><span class="line">        CALL TRANSACTION <span class="string">'VL03N'</span> AND SKIP FIRST <span class="transposed_variable">SCREEN.</span></span><br><span class="line">    <span class="transposed_variable">ENDIF.</span></span><br><span class="line">  WHEN <span class="string">'&amp;ZZPT'</span>.</span><br><span class="line">*    READ TABLE item WITH KEY mark = <span class="string">'X'</span>.</span><br><span class="line">*    IF sy-subrc &lt;&gt; <span class="number">0.</span></span><br><span class="line">*      MESSAGE s001(<span class="number">00</span>) WITH <span class="string">'请选择记录'</span> DISPLAY LIKE <span class="string">'E'</span>.</span><br><span class="line">*      <span class="transposed_variable">EXIT.</span></span><br><span class="line">*    <span class="transposed_variable">ENDIF.</span></span><br><span class="line">*    IF p_bukrs = <span class="string">'6000'</span> .</span><br><span class="line">*      PERFORM frm_print USING <span class="string">'ZRFI009'</span>.               <span class="string">"调用sf</span><br><span class="line">*  ELSEIF p_bukrs = '</span><span class="number">7000</span><span class="string">' .</span><br><span class="line">*      PERFORM frm_print USING '</span><span class="transposed_variable">ZRFI009N'.</span>               <span class="string">"调用sf</span><br><span class="line">*    ENDIF.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  WHEN '</span>&amp;<span class="transposed_variable">ZALL'.</span></span><br><span class="line">    LOOP AT item WHERE mark IS <span class="transposed_variable">INITIAL.</span></span><br><span class="line">      item-mark = <span class="string">'X'</span>.</span><br><span class="line">      MODIFY item TRANSPORTING <span class="transposed_variable">mark.</span></span><br><span class="line">    <span class="transposed_variable">ENDLOOP.</span></span><br><span class="line">  WHEN <span class="string">'&amp;ZSAL'</span>.</span><br><span class="line">    LOOP AT item WHERE mark IS NOT INITIAL .</span><br><span class="line">      item-mark = <span class="string">''</span>.</span><br><span class="line">      MODIFY item TRANSPORTING <span class="transposed_variable">mark.</span></span><br><span class="line">    <span class="transposed_variable">ENDLOOP.</span></span><br><span class="line">  <span class="transposed_variable">ENDCASE.</span></span><br><span class="line"></span><br><span class="line"><span class="transposed_variable">ENDFORM.</span></span><br></pre></td></tr></table></figure>
<h3 id="Excel批量上传">Excel批量上传</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">REPORT zrmm056.&#10;&#10;TABLES: zrmm054.&#10;&#10;types: BEGIN OF ty_zt,&#10;werks TYPE zrmm054-werks,&#10;MATNR type zrmm054-matnr,&#10;MAKTX type zrmm054-maktx,&#10;LIFNR type zrmm054-lifnr,&#10;NAME1 type zrmm054-name1,&#10;ZMJJE TYPE zrmm054-zmjje,&#10;ZMJMG TYPE zrmm054-zmjmg,&#10;ZFTJE TYPE zrmm054-zftje,&#10;ZMJNSUM TYPE zrmm054-zmjnsum,&#10;ZMJMSUM TYPE zrmm054-zmjmsum,&#10;END OF TY_ZT.&#10;&#10;&#34;&#23450;&#20041;&#21442;&#29031;TY_ZT&#31867;&#22411;&#30340;&#20869;&#34920;&#21644;&#24037;&#20316;&#21306;&#65292;&#29992;&#20110;&#26242;&#23384;&#21462;&#21040;&#30340;Excel&#20869;&#23481;&#34;&#10;DATA:I_TABLE TYPE TABLE OF TY_ZT,&#10;     W_TABLE TYPE TY_ZT.&#10;DATA:GT_TABLE TYPE TABLE OF Zrmm054,&#34;&#30452;&#25509;&#21442;&#29031;&#36879;&#26126;&#34920;&#34;&#10;     GW_TABLE TYPE Zrmm054.&#10;SELECTION-SCREEN BEGIN OF BLOCK B1 WITH FRAME TITLE TEXT-001.&#10;PARAMETERS P_FILE(80).&#34;&#22320;&#22336;&#26639;&#34;&#10;SELECTION-SCREEN END OF BLOCK B1.&#10;&#10;AT SELECTION-SCREEN ON VALUE-REQUEST FOR P_FILE.&#10;  PERFORM OPEN_DIALOG.&#34;&#35843;&#29992;&#36873;&#25321;&#25991;&#20214;&#20989;&#25968;&#34;&#10;AT SELECTION-SCREEN.&#34;&#29992;&#20110;&#23631;&#24149;&#36755;&#20837;&#26816;&#39564;&#34;&#10;  IF P_FILE IS INITIAL.&#10;    MESSAGE &#39;&#25991;&#20214;&#22320;&#22336;&#19981;&#21487;&#20026;&#31354;&#65281;&#39; TYPE &#39;S&#39; DISPLAY LIKE &#39;E&#39;.&#10;    STOP.&#10;  ENDIF.&#10;&#10;START-OF-SELECTION.&#10;PERFORM upload.&#10;&#10;&#10;&#10;FORM OPEN_DIALOG.&#34;&#36873;&#25321;&#25991;&#20214;&#20250;&#35805;&#12290;&#34;&#10;DATA:LT_FILE_TABLE TYPE FILETABLE.&#10;DATA:LW_FILE_TABLE TYPE FILE_TABLE.&#10;DATA:L_RC TYPE I.&#10;  CALL METHOD CL_GUI_FRONTEND_SERVICES=&#62;FILE_OPEN_DIALOG&#10;    EXPORTING&#10;      WINDOW_TITLE            = &#39;&#36873;&#25321;&#25991;&#20214;&#39;&#10;      DEFAULT_FILENAME        =  &#39;*.XLSX&#39;  &#34;&#40664;&#35748;excel&#25991;&#20214;&#34;&#10;      INITIAL_DIRECTORY       =  &#39;D:\ &#39;  &#34;&#40664;&#35748;&#25171;&#24320;D&#30424;&#65292;&#20063;&#21487;&#20197;&#40664;&#35748;&#31354;&#34;&#10;      MULTISELECTION          =  &#39;&#39;   &#34;&#25991;&#20214;&#21333;&#36873;&#34;&#10;    CHANGING&#10;      FILE_TABLE              = LT_FILE_TABLE&#10;      RC                      = L_RC&#10;    EXCEPTIONS&#10;      FILE_OPEN_DIALOG_FAILED = 1&#10;      CNTL_ERROR              = 2&#10;      ERROR_NO_GUI            = 3&#10;      NOT_SUPPORTED_BY_GUI    = 4&#10;      others                  = 5&#10;          .&#10;CHECK L_RC EQ 1.&#34;&#22240;&#20026;&#25991;&#20214;&#21333;&#36873;&#65292;&#25152;&#20197;&#36825;&#37324;&#21028;&#26029;&#19968;&#19979;&#36873;&#25321;&#30340;&#25968;&#37327;&#20026;1&#34;&#10;READ TABLE LT_FILE_TABLE INDEX 1 INTO P_FILE.&#10;&#34;&#23558;&#36873;&#25321;&#30340;&#25991;&#20214;&#22320;&#22336;&#20889;&#20837;&#21040;&#22320;&#22336;&#26639;&#34;&#10;ENDFORM.&#10;&#10;FORM upload.&#34;&#26368;&#21518;&#20063;&#26159;&#26368;&#20851;&#38190;&#30340;&#19968;&#27493;&#34;&#10;  &#34;&#23450;&#20041;&#34920;&#26684;&#32467;&#26500;&#20869;&#34920;&#12290;&#34;&#10;  DATA: i_excel TYPE TABLE OF alsmex_tabline,&#34;&#34920;&#26684;&#32467;&#26500;&#12290;&#34;&#10;        w_excel TYPE alsmex_tabline.&#10;  &#34;ALSMEX_TABLINE&#26159;&#20855;&#26377;Excel&#25968;&#25454;&#30340;&#34920;&#34892;&#65292;&#26377;&#19977;&#20010;&#32452;&#20214;&#65292;row col value &#12290;&#34;&#10;&#10;  DATA:get_file TYPE rlgrap-filename.&#34;&#36825;&#37324;&#21442;&#29031;&#31995;&#32479;&#20013;&#30340;&#32467;&#26500;&#23383;&#27573;&#12290;&#34;&#10;  MOVE p_file TO get_file.&#34;&#23558;&#22320;&#22336;&#26639;&#30340;&#20540;&#36171;&#20540;&#32473;GET_FILE&#34;&#10;&#10;  &#34;&#35843;&#29992;&#27492;&#20989;&#25968;&#65292;&#23558;Excel&#20013;&#30340;&#20869;&#23481;&#20197;&#31867;&#20284;&#22352;&#26631;&#30340;&#24418;&#24335;&#23384;&#20648;&#21040;I_excel&#20869;&#34920;&#20013;&#12290;&#34;&#10;  CALL FUNCTION &#39;ALSM_EXCEL_TO_INTERNAL_TABLE&#39;&#10;    EXPORTING&#10;      filename                = get_file&#10;      i_begin_col             = 1&#10;      i_begin_row             = 1&#10;      i_end_col               = 10&#10;      i_end_row               = 65535&#10;    TABLES&#10;      intern                  = i_excel&#10;    EXCEPTIONS&#10;      inconsistent_parameters = 1&#10;      upload_ole              = 2&#10;      OTHERS                  = 3.&#10;  DELETE i_excel WHERE row = 1.&#34;&#21024;&#38500;&#31532;&#19968;&#34892;&#25260;&#22836;&#12290;&#22914;&#26524;excel&#25991;&#20214;&#20013;&#19981;&#23384;&#22312;&#25260;&#22836;&#30340;&#35805;&#65292;&#21487;&#19981;&#20889;&#27492;&#21477;&#12290;&#34;&#10;&#10;  IF i_excel IS INITIAL.&#10;    CALL FUNCTION &#39;POPUP_TO_CONFIRM_WITH_MESSAGE&#39;&#10;      EXPORTING&#10;*       DEFAULTOPTION = &#39;Y&#39;&#10;        diagnosetext1 = &#39;&#25968;&#25454;&#38169;&#35823;&#39;&#10;*       DIAGNOSETEXT2 = &#39; &#39;&#10;*       DIAGNOSETEXT3 = &#39; &#39;&#10;        textline1     = &#39;Excel&#34920;&#26684;&#20013;&#27809;&#26377;&#20869;&#23481;&#65281;&#39;&#10;        titel         = &#39;&#25552;&#31034;&#39;.&#10;    RETURN.&#10;  ENDIF.&#10;&#10;  CLEAR:i_table.&#10;  FIELD-SYMBOLS:&#60;fs&#62;.&#34;&#36825;&#37324;&#28041;&#21450;&#21040;SAP&#20869;&#37096;&#23383;&#27573;&#30340;&#20351;&#29992;&#65292;&#35814;&#24773;&#35831;&#21442;&#35265;&#24494;&#21338;&#30456;&#20851;&#20171;&#32461;&#12290;&#34;&#10;  SORT i_excel BY row col.&#10;  DATA:num_col TYPE i.&#10;&#10;  LOOP AT i_excel INTO w_excel.&#10;    num_col = w_excel-col.&#10;    ASSIGN COMPONENT  num_col  OF STRUCTURE w_table TO &#60;fs&#62;.&#10;    &#60;fs&#62; = w_excel-value.&#10;    AT END OF row.&#10;      APPEND w_table TO i_table.&#10;      CLEAR:w_table.&#10;    ENDAT.&#10;    CLEAR:w_excel.&#10;  ENDLOOP.&#10;&#10;  LOOP AT i_table INTO w_table.&#10;    MOVE-CORRESPONDING w_table TO gw_table.&#10;    CALL FUNCTION &#39;CONVERSION_EXIT_ALPHA_INPUT&#39;&#10;      EXPORTING&#10;        input  = gw_table-werks&#10;      IMPORTING&#10;        output = gw_table-werks.&#10;    CALL FUNCTION &#39;CONVERSION_EXIT_ALPHA_INPUT&#39;&#10;      EXPORTING&#10;        input  = gw_table-lifnr&#10;      IMPORTING&#10;        output = gw_table-lifnr.&#10;    CALL FUNCTION &#39;CONVERSION_EXIT_ALPHA_INPUT&#39;&#10;      EXPORTING&#10;        input  = gw_table-matnr&#10;      IMPORTING&#10;        output = gw_table-matnr.&#10;    gw_table-mandt = sy-mandt.&#34;&#23458;&#25143;&#31471;&#21495;&#65292;&#21019;&#24314;&#36879;&#26126;&#34920;&#24517;&#39035;&#21253;&#21547;&#30340;&#23383;&#27573;&#12290;&#34;&#10;    gw_table-usnam = sy-uname.&#10;    gw_table-aedat = sy-datum.&#10;    gw_table-cputm = sy-uzeit.&#10;    APPEND gw_table TO gt_table.&#10;    CLEAR:gw_table.&#10;    CLEAR:w_table.&#10;  ENDLOOP.&#10;&#10;  &#34;&#23558;&#25968;&#25454;&#24211;&#20013;&#20869;&#23481;&#26356;&#26032;&#34;&#10;  MODIFY zrmm054 FROM TABLE gt_table.&#34;&#36825;&#37324;&#20351;&#29992;modify&#65292;&#20860;&#39038;&#22686;&#21152;&#21644;&#20462;&#25913;&#65292;&#33509;&#20027;&#38190;&#23384;&#22312;&#21017;&#20026;&#20462;&#25913;&#65292;&#21542;&#21017;&#22686;&#21152;&#34;&#10;  IF sy-subrc = 0.&#10;    COMMIT WORK AND WAIT.&#34;&#25104;&#21151;&#25552;&#20132;&#65292;&#25110;&#32773;&#26368;&#21518;&#31243;&#24207;&#32467;&#26463;&#31995;&#32479;&#20063;&#20250;&#33258;&#21160;&#25552;&#20132;&#34;&#10;    DATA:num_tab(6) TYPE c.&#10;    DESCRIBE TABLE gt_table  LINES num_tab.&#10;    CONDENSE num_tab NO-GAPS.&#10;    DATA:str_line1 TYPE string .&#10;    CONCATENATE &#39;&#25104;&#21151;&#23548;&#20837;&#25968;&#25454;&#39;  num_tab &#39;&#34892;&#39; INTO str_line1 .&#10;    &#34;&#35835;&#20986;excel&#20013;&#30340;&#25968;&#25454;&#26465;&#25968;&#65292;&#29992;&#20110;&#28040;&#24687;&#25552;&#31034;&#34;&#10;    CALL FUNCTION &#39;POPUP_TO_CONFIRM_WITH_MESSAGE&#39;&#10;      EXPORTING&#10;        diagnosetext1 = &#39;&#25104;&#21151;&#39;&#10;        textline1     = str_line1&#10;        titel         = &#39;&#25552;&#31034;&#39;.&#10;  ELSE.&#10;    ROLLBACK WORK.&#34;&#21542;&#21017;&#22833;&#36133;&#34;&#10;  ENDIF.&#10;&#10;ENDFORM.</span><br></pre></td></tr></table></figure>
<h2 id="增强">增强</h2><h2 id="常用函数">常用函数</h2><h3 id="检查日期有效性">检查日期有效性</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#10;CALL FUNCTION &#39;DATE_CHECK_PLAUSIBILITY&#39;&#10;      EXPORTING&#10;        date = gt_data_w-datum&#10;     EXCEPTIONS&#10;       PLAUSIBILITY_CHECK_FAILED       = 1&#10;       OTHERS                          = 2&#10;      .&#10;IF sy-subrc &#60;&#62; 0.&#10;      gt_data_w-ms_type = &#39;E&#39;.&#10;      l_msg =  l_msg &#38;&#38; &#39;&#26085;&#26399;&#26684;&#24335;&#19981;&#23545;&#65292;&#39;.&#10;ENDIF.</span><br></pre></td></tr></table></figure>
<h3 id="读取销售订单行项目文本">读取销售订单行项目文本</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">DATA: t_read  LIKE TABLE OF tline WITH HEADER LINE,</span><br><span class="line">      l_stxl  LIKE TABLE OF stxl WITH HEADER LINE,</span><br><span class="line">      l_vbeln LIKE          thead-tdname.</span><br><span class="line"></span><br><span class="line">CLEAR: l_vbeln.</span><br><span class="line">vbeln = item-vbeln &amp;&amp; item-posnr.</span><br><span class="line"><span class="operator"><span class="keyword">SELECT</span> SINGLE  * <span class="keyword">INTO</span> <span class="keyword">CORRESPONDING</span> <span class="keyword">FIELDS</span> <span class="keyword">OF</span> l_stxl <span class="keyword">FROM</span> stxl</span><br><span class="line"><span class="keyword">WHERE</span> tdname = l_vbeln <span class="keyword">AND</span> tdspras = <span class="string">'1'</span>.</span><br><span class="line"><span class="keyword">IF</span> sy-subrc = <span class="number">0.</span></span><br><span class="line">      <span class="keyword">READ</span> <span class="keyword">TABLE</span> l_stxl <span class="keyword">INDEX</span> <span class="number">1.</span></span><br><span class="line">      <span class="keyword">CALL</span> <span class="keyword">FUNCTION</span> <span class="string">'READ_TEXT'</span></span><br><span class="line">      EXPORTING</span><br><span class="line">        <span class="keyword">ID</span>       = l_stxl-tdid</span><br><span class="line">        <span class="keyword">LANGUAGE</span> = sy-langu</span><br><span class="line">        <span class="keyword">name</span>     = l_vbeln</span><br><span class="line">        <span class="keyword">object</span>   = l_stxl-tdobject</span><br><span class="line">      <span class="keyword">TABLES</span></span><br><span class="line">        <span class="keyword">LINES</span>    = t_read.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">LOOP</span> <span class="keyword">AT</span> t_read.</span><br><span class="line">        item-ztext = item-ztext &amp;&amp; t_read-tdline.</span><br><span class="line">      ENDLOOP.</span><br><span class="line">ENDIF.  </span><br><span class="line"><span class="keyword">IF</span> item-ztext <span class="keyword">IS</span> <span class="keyword">INITIAL</span>.</span><br><span class="line">      <span class="keyword">SELECT</span> SINGLE vgbel vgpos <span class="keyword">INTO</span> (l_vgbel,l_vgpos)</span><br><span class="line">        <span class="keyword">FROM</span> lips <span class="keyword">WHERE</span> vbeln = item-vbeln <span class="keyword">AND</span> posnr = item-posnr.</span><br><span class="line">      <span class="keyword">CLEAR</span> l_vbeln.</span><br><span class="line">      l_vbeln = l_vgbel &amp;&amp; l_vgpos.</span><br><span class="line">      <span class="keyword">SELECT</span> SINGLE  * <span class="keyword">INTO</span> <span class="keyword">CORRESPONDING</span> <span class="keyword">FIELDS</span> <span class="keyword">OF</span> l_stxl <span class="keyword">FROM</span> stxl</span><br><span class="line">      <span class="keyword">WHERE</span> tdname = l_vbeln <span class="keyword">AND</span> tdspras = <span class="string">'1'</span>.</span><br><span class="line">      <span class="keyword">IF</span> sy-subrc = <span class="number">0.</span></span><br><span class="line">        <span class="keyword">READ</span> <span class="keyword">TABLE</span> l_stxl <span class="keyword">INDEX</span> <span class="number">1.</span></span><br><span class="line">        <span class="keyword">CALL</span> <span class="keyword">FUNCTION</span> <span class="string">'READ_TEXT'</span></span><br><span class="line">          EXPORTING</span><br><span class="line">            <span class="keyword">id</span>       = l_stxl-tdid</span><br><span class="line">            <span class="keyword">language</span> = sy-langu</span><br><span class="line">            <span class="keyword">name</span>     = l_vbeln</span><br><span class="line">            <span class="keyword">object</span>   = l_stxl-tdobject</span><br><span class="line">          IMPORTING</span><br><span class="line">            header   = t_header</span><br><span class="line">          <span class="keyword">TABLES</span></span><br><span class="line">            <span class="keyword">lines</span>    = t_read.</span><br><span class="line"></span><br><span class="line">        <span class="keyword">LOOP</span> <span class="keyword">AT</span> t_read.</span><br><span class="line">          item-ztext = item-ztext &amp;&amp; t_read-tdline.</span><br><span class="line">        ENDLOOP.</span><br><span class="line">      ENDIF.</span><br><span class="line">ENDIF.</span></span><br></pre></td></tr></table></figure>
<h3 id="外部单位转到内部单位">外部单位转到内部单位</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CONVERSION_EXIT_CUNIT_INPUT</span><br></pre></td></tr></table></figure>
<h3 id="内部单位转到外部单位">内部单位转到外部单位</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CONVERSION_EXIT_CUNIT_OUTPUT</span><br></pre></td></tr></table></figure>
<h3 id="大小写转换函数,数字转中文">大小写转换函数,数字转中文</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">CALL</span> <span class="keyword">FUNCTION</span> <span class="string">'ZF_CN_NUM'</span></span><br><span class="line">      EXPORTING</span><br><span class="line">        iv_money = lft_i-zprzk</span><br><span class="line">      IMPORTING</span><br><span class="line">        ev_money = lft_i-zzdx. </span><br><span class="line"><span class="string">``</span><span class="string">`        </span><br><span class="line">`</span><span class="string">``</span>   </span><br><span class="line"><span class="keyword">FUNCTION</span> zf_cn_num.</span><br><span class="line">*<span class="string">"----------------------------------------------------------------------</span><br><span class="line">*"</span>*<span class="string">"本地接口：</span><br><span class="line">*"</span>  IMPORTING</span><br><span class="line">*<span class="string">"     REFERENCE(IV_MONEY) TYPE  BSEG-DMBTR</span><br><span class="line">*"</span>  EXPORTING</span><br><span class="line">*<span class="string">"     REFERENCE(EV_MONEY) TYPE  CHAR100</span><br><span class="line">*"</span><span class="comment">----------------------------------------------------------------------</span></span><br><span class="line">  <span class="keyword">IF</span> iv_money = <span class="number">0.</span></span><br><span class="line">    ev_money = <span class="string">'零'</span>.</span><br><span class="line">    <span class="keyword">EXIT</span>.</span><br><span class="line">  ENDIF.</span><br><span class="line">  <span class="keyword">DATA</span>:money_str(<span class="number">33</span>).</span><br><span class="line">  money_str = iv_money.</span><br><span class="line">  CONDENSE money_str <span class="keyword">NO</span>-GAPS.</span><br><span class="line">  <span class="keyword">IF</span> money_str CN <span class="string">'0123456789. '</span>.</span><br><span class="line">    <span class="keyword">RAISE</span> wrong_money.</span><br><span class="line">  ENDIF.</span><br><span class="line">  <span class="keyword">DATA</span>:<span class="keyword">i</span> <span class="keyword">TYPE</span> <span class="keyword">i</span>.</span><br><span class="line">  <span class="keyword">IF</span> money_str CS <span class="string">'.'</span>.</span><br><span class="line">    <span class="keyword">i</span> = sy-fdpos + <span class="number">1.</span></span><br><span class="line">    money_str+sy-fdpos = money_str+<span class="keyword">i</span>.</span><br><span class="line">  ENDIF.</span><br><span class="line">  CONDENSE money_str <span class="keyword">NO</span>-GAPS.</span><br><span class="line">  <span class="keyword">DATA</span>:units_off <span class="keyword">TYPE</span> <span class="keyword">i</span>,</span><br><span class="line">       curnt_off <span class="keyword">TYPE</span> <span class="keyword">i</span>.</span><br><span class="line">  <span class="keyword">DATA</span>:lastd  <span class="keyword">TYPE</span> <span class="keyword">n</span>,curntd <span class="keyword">TYPE</span> <span class="keyword">n</span>.</span><br><span class="line">  <span class="keyword">DATA</span>:cword(<span class="number">2</span>),weight(<span class="number">2</span>).</span><br><span class="line">  <span class="keyword">DATA</span>:units(<span class="number">30</span>)      <span class="keyword">VALUE</span> <span class="string">'分角元拾佰仟万拾佰仟亿拾佰仟万'</span>,</span><br><span class="line">       digts(<span class="number">20</span>)      <span class="keyword">VALUE</span> <span class="string">'零壹贰叁肆伍陆柒捌玖'</span>.</span><br><span class="line">* <span class="keyword">clear</span>:ev_money,units_off.</span><br><span class="line">  lastd = <span class="number">0.</span></span><br><span class="line">  curnt_off = strlen( money_str ) - <span class="number">1.</span></span><br><span class="line">  <span class="keyword">WHILE</span> curnt_off &gt;= <span class="number">0.</span></span><br><span class="line">    curntd = money_str+curnt_off(<span class="number">1</span>).</span><br><span class="line">    <span class="keyword">i</span> = curntd.</span><br><span class="line">    cword = digts+<span class="keyword">i</span>(<span class="number">1</span>).</span><br><span class="line">    weight = units+units_off(<span class="number">1</span>).</span><br><span class="line">    <span class="keyword">i</span> = units_off / <span class="number">1.</span></span><br><span class="line">    <span class="keyword">IF</span> curntd = <span class="number">0.</span>             <span class="string">"Current digit is 0</span><br><span class="line">      IF i = 2 OR i = 6 OR i = 10.</span><br><span class="line">        CLEAR:cword.</span><br><span class="line">        IF curnt_off = 0.</span><br><span class="line">          CLEAR:weight.</span><br><span class="line">        ENDIF.</span><br><span class="line">      ELSEIF lastd = 0.</span><br><span class="line">        CLEAR:cword,weight.</span><br><span class="line">      ELSE.</span><br><span class="line">        CLEAR:weight.</span><br><span class="line">      ENDIF.</span><br><span class="line">    ENDIF.</span><br><span class="line">    CONCATENATE cword weight ev_money INTO ev_money.</span><br><span class="line">    lastd = curntd.</span><br><span class="line">    SUBTRACT 1 FROM curnt_off.</span><br><span class="line">    ADD 1 TO units_off.</span><br><span class="line">  ENDWHILE.</span><br><span class="line">  IF ev_money NS '分'.</span><br><span class="line">    CONCATENATE ev_money '整' INTO ev_money.</span><br><span class="line">  ELSE.</span><br><span class="line">    cword = ev_money.</span><br><span class="line">    IF cword = '零'.</span><br><span class="line">      SHIFT ev_money BY 1 PLACES.</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFUNCTION.</span></span></span><br></pre></td></tr></table></figure>
<h3 id="内外部单位转换">内外部单位转换</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">CALL</span> <span class="keyword">FUNCTION</span> <span class="string">'CONVERSION_EXIT_CUNIT_INPUT'</span></span><br><span class="line">    EXPORTING</span><br><span class="line">            <span class="keyword">input</span>          = pr_unit</span><br><span class="line">            <span class="keyword">language</span>       = sy-langu</span><br><span class="line">    IMPORTING</span><br><span class="line">            <span class="keyword">output</span>         = pr_unit</span><br><span class="line">    <span class="keyword">EXCEPTIONS</span></span><br><span class="line">            unit_not_found = <span class="number">1</span></span><br><span class="line">            OTHERS         = <span class="number">2.</span></span></span><br></pre></td></tr></table></figure>
<h3 id="日期函数">日期函数</h3><h4 id="获取周一的日期和周日的日期">获取周一的日期和周日的日期</h4><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">REPORT ZWEEKFIRSTDAY.&#10;DATA mweek LIKE scal-week VALUE &#39;201743&#39;.&#10;DATA mdate LIKE scal-DATE.&#34;&#21608;&#19968;&#26085;&#26399;&#10;DATA ldate LIKE scal-DATE.&#34;&#21608;&#26085;&#26085;&#26399;&#10;CALL FUNCTION &#39;WEEK_GET_FIRST_DAY&#39;&#10;EXPORTING&#10;  week               =  mweek&#10;IMPORTING&#10;  DATE               =   mdate &#34;&#36820;&#22238;&#30340;DATE&#20540;&#20026;20110328,2011&#24180;&#31532;13&#21608;&#30340;&#31532;&#19968;&#22825;&#26159;3&#26376;28&#26085;&#12290;&#10;* EXCEPTIONS&#10;*   WEEK_INVALID       = 1&#10;*   OTHERS             = 2&#10;  .&#10;IF sy-subrc &#60;&#62; 0.&#10;* Implement suitable error handling here&#10;ENDIF.&#10;ldate = mdate + 6.&#10;WRITE ldate .</span><br></pre></td></tr></table></figure>
<h3 id="前导零">前导零</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*&#21152;&#19978;p_in&#30340;&#21069;&#23548;&#38646;&#10;&#10;      CALL FUNCTION &#39;CONVERSION_EXIT_ALPHA_INPUT&#39;&#10;        EXPORTING&#10;          input  = p_in&#10;        IMPORTING&#10;          output = p_in.&#10;&#10;*&#21435;&#38500;p_out&#30340;&#21069;&#23548;&#38646;&#10;&#10;      CALL FUNCTION &#39;CONVERSION_EXIT_ALPHA_OUTPUT&#39;&#10;        EXPORTING&#10;          input  = p_out&#10;        IMPORTING&#10;          output = p_out.</span><br></pre></td></tr></table></figure>
<h2 id="接口">接口</h2><h2 id="屏幕">屏幕</h2><h2 id="BAPI">BAPI</h2><h3 id="批量发票校验">批量发票校验</h3><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;  包含                ZHLT_FICMIROFORM</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">FORM</span> frm_miro_getfile .</span><br><span class="line"></span><br><span class="line">  DATA: lv_subrc     <span class="keyword">TYPE</span> i,</span><br><span class="line">        ls_filename  <span class="keyword">TYPE</span> file_table,</span><br><span class="line">        it_filetable <span class="keyword">TYPE</span> filetable.</span><br><span class="line"></span><br><span class="line">  CALL METHOD cl_gui_frontend_services=&gt;file_open_dialog</span><br><span class="line">    EXPORTING</span><br><span class="line">      window_title            = '文件导入'</span><br><span class="line"><span class="comment">*     default_extension       =</span></span><br><span class="line"><span class="comment">*     default_filename        =</span></span><br><span class="line"><span class="comment">*     file_filter             =</span></span><br><span class="line"><span class="comment">*     with_encoding           =</span></span><br><span class="line"><span class="comment">*     initial_directory       =</span></span><br><span class="line"><span class="comment">*     multiselection          =</span></span><br><span class="line">    CHANGING</span><br><span class="line">      file_table              = it_filetable[]</span><br><span class="line">      rc                      = lv_subrc</span><br><span class="line"><span class="comment">*     user_action             =</span></span><br><span class="line"><span class="comment">*     file_encoding           =</span></span><br><span class="line">    EXCEPTIONS</span><br><span class="line">      file_open_dialog_failed = 1</span><br><span class="line">      cntl_error              = 2</span><br><span class="line">      error_no_gui            = 3</span><br><span class="line">      not_supported_by_gui    = 4</span><br><span class="line">      OTHERS                  = 5.</span><br><span class="line">  <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line"><span class="comment">*         Implement suitable error handling here</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line">    LOOP AT it_filetable INTO ls_filename..</span><br><span class="line">      p_file = ls_filename-filename.</span><br><span class="line">    ENDLOOP.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.</span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  FRM_MIRO_CHECK</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       text 权限检查</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*  --&gt;  p1        text</span></span><br><span class="line"><span class="comment">*  &lt;--  p2        text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="keyword">FORM</span> frm_miro_check .</span><br><span class="line"></span><br><span class="line">ENDFORM.</span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  FRM_GETDATA_FROMEXCEL</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       text 从EXCEL中获取数据</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*  --&gt;  p1        text</span></span><br><span class="line"><span class="comment">*  &lt;--  p2        text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="keyword">FORM</span> frm_getdata_fromexcel .</span><br><span class="line">  DATA: it_alsmex <span class="keyword">TYPE</span> <span class="keyword">TABLE</span> OF zalsmex_tabline1.</span><br><span class="line">  DATA: wa_alsmex LIKE <span class="keyword">LINE</span> OF it_alsmex.</span><br><span class="line"></span><br><span class="line">  CALL FUNCTION 'ZALSM_EXCEL_TO_INTERNAL_TABLE1'</span><br><span class="line">    EXPORTING</span><br><span class="line">      filename                = p_file</span><br><span class="line">      i_begin_col             = 1</span><br><span class="line">      i_begin_row             = 3</span><br><span class="line">      i_end_col               = 21</span><br><span class="line">      i_end_row               = 999</span><br><span class="line">      "sheet_name              = 'Sheet1'</span><br><span class="line">    TABLES</span><br><span class="line">      intern                  = it_alsmex</span><br><span class="line">    EXCEPTIONS</span><br><span class="line">      inconsistent_parameters = 1</span><br><span class="line">      upload_ole              = 2</span><br><span class="line">      OTHERS                  = 3.</span><br><span class="line">  <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line">    MESSAGE '数据传输出错！' <span class="keyword">TYPE</span> '<span class="keyword">E</span>'.</span><br><span class="line">  ENDIF.</span><br><span class="line">  <span class="keyword">SORT</span> it_alsmex <span class="keyword">BY</span> row col.</span><br><span class="line">  <span class="keyword">IF</span> it_alsmex IS NOT INITIAL.</span><br><span class="line">    LOOP AT it_alsmex INTO wa_alsmex .</span><br><span class="line">      AT NEW row.</span><br><span class="line">      ENDAT.</span><br><span class="line">      CASE wa_alsmex-col.</span><br><span class="line">        WHEN 1.</span><br><span class="line">          wa_data-head_comp_code = wa_alsmex-value.</span><br><span class="line">        WHEN 2.</span><br><span class="line">          wa_data-head_doc_date = wa_alsmex-value.</span><br><span class="line">        WHEN 3.</span><br><span class="line">          wa_data-head_pstng_date = wa_alsmex-value.</span><br><span class="line">        WHEN 4.</span><br><span class="line">          wa_data-head_invoice_ind = wa_alsmex-value.</span><br><span class="line">        WHEN 5.</span><br><span class="line">          wa_data-head_currency = wa_alsmex-value.</span><br><span class="line">        WHEN 6.</span><br><span class="line">          wa_data-head_bline_date = wa_alsmex-value.</span><br><span class="line">        WHEN 7.</span><br><span class="line">          wa_data-head_calc_tax_ind = wa_alsmex-value.</span><br><span class="line">        WHEN 8.</span><br><span class="line">          wa_data-head_gross_amount = wa_alsmex-value.</span><br><span class="line">        WHEN 9.</span><br><span class="line">          CALL FUNCTION 'CONVERSION_EXIT_ALPHA_INPUT'</span><br><span class="line">            EXPORTING</span><br><span class="line">              <span class="keyword">input</span>  = wa_alsmex-value</span><br><span class="line">            IMPORTING</span><br><span class="line">              output = wa_data-item_invoice_doc_item.</span><br><span class="line">        WHEN 10.</span><br><span class="line">          CALL FUNCTION 'CONVERSION_EXIT_ALPHA_INPUT'</span><br><span class="line">            EXPORTING</span><br><span class="line">              <span class="keyword">input</span>  = wa_alsmex-value</span><br><span class="line">            IMPORTING</span><br><span class="line">              output = wa_data-item_freight_ven.</span><br><span class="line">        WHEN 11.</span><br><span class="line">          wa_data-item_po_number = wa_alsmex-value.</span><br><span class="line">        WHEN 12.</span><br><span class="line">          CALL FUNCTION 'CONVERSION_EXIT_ALPHA_INPUT'</span><br><span class="line">            EXPORTING</span><br><span class="line">              <span class="keyword">input</span>  = wa_alsmex-value</span><br><span class="line">            IMPORTING</span><br><span class="line">              output = wa_data-item_po_item.</span><br><span class="line">        WHEN 13.</span><br><span class="line">          wa_data-item_quantity = wa_alsmex-value.</span><br><span class="line">        WHEN 14.</span><br><span class="line">          wa_data-item_amount = wa_alsmex-value.</span><br><span class="line">        WHEN 15.</span><br><span class="line">          wa_data-item_tax_code = wa_alsmex-value.</span><br><span class="line">        WHEN 16.</span><br><span class="line">          wa_data-item_po_unit = wa_alsmex-value.</span><br><span class="line">          <span class="keyword">TRANSLATE</span> wa_data-item_po_unit TO UPPER CASE.</span><br><span class="line">        WHEN 17.</span><br><span class="line">          wa_data-item_po_unit_iso = wa_alsmex-value.</span><br><span class="line">          <span class="keyword">TRANSLATE</span> wa_data-item_po_unit_iso TO UPPER CASE.</span><br><span class="line">        WHEN 18.</span><br><span class="line">          wa_data-item_text = wa_alsmex-value.</span><br><span class="line">        WHEN 19.</span><br><span class="line">          wa_data-item_ref_doc = wa_alsmex-value.</span><br><span class="line">        WHEN 20.</span><br><span class="line">          CALL FUNCTION 'CONVERSION_EXIT_ALPHA_INPUT'</span><br><span class="line">            EXPORTING</span><br><span class="line">              <span class="keyword">input</span>  = wa_alsmex-value</span><br><span class="line">            IMPORTING</span><br><span class="line">              output = wa_data-item_ref_doc_it.</span><br><span class="line">        WHEN 21.</span><br><span class="line">          wa_data-item_ref_doc_year = wa_alsmex-value.</span><br><span class="line">      ENDCASE.</span><br><span class="line">      AT END OF row.</span><br><span class="line">        <span class="keyword">APPEND</span> wa_data TO gt_data.</span><br><span class="line">        <span class="keyword">CLEAR</span>: wa_data.</span><br><span class="line">      ENDAT.</span><br><span class="line"></span><br><span class="line">    ENDLOOP.</span><br><span class="line"></span><br><span class="line">  ENDIF.</span><br><span class="line">  DELETE gt_data WHERE item_quantity = 0.</span><br><span class="line">  <span class="keyword">SORT</span> gt_data <span class="keyword">BY</span> item_invoice_doc_item.</span><br><span class="line"></span><br><span class="line">  PERFORM frm_getalvdata.</span><br><span class="line"></span><br><span class="line">ENDFORM.</span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  FRM_DISPLAY_ALV</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       text 提取数据在ALV中显示一次</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*  --&gt;  p1        text</span></span><br><span class="line"><span class="comment">*  &lt;--  p2        text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="keyword">FORM</span> frm_display_alv .</span><br><span class="line">  CALL SCREEN 999.</span><br><span class="line">ENDFORM.</span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Module  STATUS_0999  OUTPUT</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line">MODULE status_0999 OUTPUT.</span><br><span class="line">  <span class="keyword">SET</span> PF-STATUS 'ZMIRO'.</span><br><span class="line">  <span class="keyword">SET</span> TITLEBAR 'ZMIRO'.</span><br><span class="line">ENDMODULE.</span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Module  USER_COMMAND_0999  INPUT</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line">MODULE user_command_0999 <span class="keyword">INPUT</span>.</span><br><span class="line">  DATA: ok_code <span class="keyword">TYPE</span> sy-ucomm.</span><br><span class="line"></span><br><span class="line">  CASE ok_code.</span><br><span class="line">    WHEN 'BACK' OR '&amp;F03' .</span><br><span class="line">      LEAVE TO SCREEN 0.</span><br><span class="line">    WHEN  '&amp;F15' OR '&amp;F12'.</span><br><span class="line">      LEAVE <span class="keyword">PROGRAM</span>.</span><br><span class="line">    WHEN '&amp;PD'.</span><br><span class="line">      PERFORM frm_filldata_tobapi.</span><br><span class="line">  ENDCASE.</span><br><span class="line"></span><br><span class="line">ENDMODULE.</span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Module  DISPALY_ALV  OUTPUT</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line">MODULE dispaly_alv OUTPUT.</span><br><span class="line">  DATA: grid <span class="keyword">TYPE</span> REF TO cl_gui_alv_grid.</span><br><span class="line">  DATA: container <span class="keyword">TYPE</span> REF TO cl_gui_custom_container.</span><br><span class="line">  DATA: ls_layo <span class="keyword">TYPE</span> lvc_s_layo.</span><br><span class="line">  DATA: it_fcat <span class="keyword">TYPE</span> lvc_t_fcat,</span><br><span class="line">        wa_fcat <span class="keyword">TYPE</span> lvc_s_fcat.</span><br><span class="line">  <span class="keyword">IF</span> grid IS INITIAL.</span><br><span class="line">    CREATE OBJECT container</span><br><span class="line">      EXPORTING</span><br><span class="line">        container_name              = 'CUSTOM_999'</span><br><span class="line">      EXCEPTIONS</span><br><span class="line">        cntl_error                  = 1</span><br><span class="line">        cntl_system_error           = 2</span><br><span class="line">        create_error                = 3</span><br><span class="line">        lifetime_error              = 4</span><br><span class="line">        lifetime_dynpro_dynpro_link = 5</span><br><span class="line">        OTHERS                      = 6.</span><br><span class="line">    <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line">      MESSAGE ID sy-msgid <span class="keyword">TYPE</span> sy-msgty NUMBER sy-msgno</span><br><span class="line">      WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    CREATE OBJECT grid</span><br><span class="line">      EXPORTING</span><br><span class="line">        i_parent          = container</span><br><span class="line">      EXCEPTIONS</span><br><span class="line">        error_cntl_create = 1</span><br><span class="line">        error_cntl_init   = 2</span><br><span class="line">        error_cntl_link   = 3</span><br><span class="line">        error_dp_create   = 4</span><br><span class="line">        OTHERS            = 5.</span><br><span class="line">    <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line">      MESSAGE ID sy-msgid <span class="keyword">TYPE</span> sy-msgty NUMBER sy-msgno</span><br><span class="line">      WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.</span><br><span class="line">    ENDIF.</span><br><span class="line">    PERFORM frm_setalv.</span><br><span class="line"></span><br><span class="line">    CALL METHOD grid-&gt;set_table_for_first_display</span><br><span class="line">      EXPORTING</span><br><span class="line"><span class="comment">*       i_buffer_active               =</span></span><br><span class="line"><span class="comment">*       i_bypassing_buffer            =</span></span><br><span class="line"><span class="comment">*       i_consistency_check           =</span></span><br><span class="line"><span class="comment">*       i_structure_name              =</span></span><br><span class="line"><span class="comment">*       is_variant                    =</span></span><br><span class="line"><span class="comment">*       i_save                        =</span></span><br><span class="line"><span class="comment">*       i_default                     = 'X'</span></span><br><span class="line">        is_layout                     = ls_layo</span><br><span class="line"><span class="comment">*       is_print                      =</span></span><br><span class="line"><span class="comment">*       it_special_groups             =</span></span><br><span class="line"><span class="comment">*       it_toolbar_excluding          =</span></span><br><span class="line"><span class="comment">*       it_hyperlink                  =</span></span><br><span class="line"><span class="comment">*       it_alv_graphics               =</span></span><br><span class="line"><span class="comment">*       it_except_qinfo               =</span></span><br><span class="line"><span class="comment">*       ir_salv_adapter               =</span></span><br><span class="line">      CHANGING</span><br><span class="line">        it_outtab                     = it_alv[]</span><br><span class="line">        it_fieldcatalog               = it_fcat[]</span><br><span class="line"><span class="comment">*       it_sort                       =</span></span><br><span class="line"><span class="comment">*       it_filter                     =</span></span><br><span class="line">      EXCEPTIONS</span><br><span class="line">        invalid_parameter_combination = 1</span><br><span class="line">        program_error                 = 2</span><br><span class="line">        too_many_lines                = 3</span><br><span class="line">        OTHERS                        = 4.</span><br><span class="line">    <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line"><span class="comment">*     Implement suitable error handling here</span></span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">ENDMODULE.</span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  FRM_SETALV</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*  --&gt;  p1        text</span></span><br><span class="line"><span class="comment">*  &lt;--  p2        text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="keyword">FORM</span> frm_setalv .</span><br><span class="line">  DATA: <span class="keyword">lv</span> <span class="keyword">TYPE</span> i VALUE 0.</span><br><span class="line">  ls_layo-zebra = 'X'.</span><br><span class="line">  ls_layo-cwidth_opt = 'A'.</span><br><span class="line"></span><br><span class="line">  DEFINE marc.</span><br><span class="line">    <span class="keyword">lv</span> = <span class="keyword">lv</span> + 1.</span><br><span class="line">    wa_fcat-col_pos = <span class="keyword">lv</span>.</span><br><span class="line">    wa_fcat-fieldname = &amp;1.</span><br><span class="line">    wa_fcat-scrtext_l = &amp;2.</span><br><span class="line">    <span class="keyword">APPEND</span> wa_fcat TO it_fcat.</span><br><span class="line">    <span class="keyword">CLEAR</span>: wa_fcat.</span><br><span class="line">  END-OF-DEFINITION.</span><br><span class="line">  marc 'HEAD_COMP_CODE' '公司代码'.</span><br><span class="line">  marc 'ITEM_FREIGHT_VEN' '供应商'.</span><br><span class="line">  marc 'ITEM_REF_DOC_YEAR' '会计年度'.</span><br><span class="line">  marc 'HEAD_DOC_DATE' '发票日期'.</span><br><span class="line">  marc 'HEAD_PSTNG_DATE' '过账日期'.</span><br><span class="line">  marc 'HEAD_INVOICE_IND' '发票类型'.</span><br><span class="line">  marc 'HEAD_CURRENCY' '货币码'.</span><br><span class="line">  marc 'HEAD_BLINE_DATE' '基准日期'.</span><br><span class="line">  marc 'HEAD_CALC_TAX_IND' '自动计算税额'.</span><br><span class="line">  marc 'HEAD_GROSS_AMOUNT' '发票金额'.</span><br><span class="line">  marc 'ITEM_INVOICE_DOC_ITEM' '发票凭证中的凭证项目'.</span><br><span class="line"><span class="comment">*  marc 'LFSNR' '交货单号'.</span></span><br><span class="line">  marc 'ITEM_PO_NUMBER' '采购订单'.</span><br><span class="line">  marc 'ITEM_PO_ITEM' '行项目'.</span><br><span class="line">  marc 'ITEM_QUANTITY' '数量'.</span><br><span class="line">  marc 'ITEM_AMOUNT' '金额'.</span><br><span class="line">  marc 'ITEM_TAX_CODE' '税务代码'.</span><br><span class="line">  marc 'ITEM_PO_UNIT' '订单单位'.</span><br><span class="line">  marc 'ITEM_PO_UNIT_ISO'  '订单基本计量单位'.</span><br><span class="line">  marc 'ITEM_REF_DOC' '参考凭证'.</span><br><span class="line">  marc 'ITEM_REF_DOC_IT' '行项目'.</span><br><span class="line">  marc 'PLANT' '工厂'.</span><br><span class="line">  marc 'ERNAM' '创建者'.</span><br><span class="line">  marc 'ITEM_TEXT' '项目文本'.</span><br><span class="line"><span class="comment">*  marc 'MESSAGE' '消息'.</span></span><br><span class="line">ENDFORM.</span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  FRM_GETALVDATA</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*  --&gt;  p1        text</span></span><br><span class="line"><span class="comment">*  &lt;--  p2        text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="keyword">FORM</span> frm_getalvdata .</span><br><span class="line">  FIELD-SYMBOLS &lt;fs&gt; LIKE <span class="keyword">LINE</span> OF it_alv.</span><br><span class="line">  <span class="keyword">MOVE</span>-CORRESPONDING gt_data[] TO it_alv.</span><br><span class="line">  LOOP AT it_alv ASSIGNING &lt;fs&gt;.</span><br><span class="line">    r_po-sign = 'I'.</span><br><span class="line">    r_po-option = '<span class="keyword">EQ</span>'.</span><br><span class="line">    r_po-low = &lt;fs&gt;-item_po_number.</span><br><span class="line">    <span class="keyword">APPEND</span> r_po.</span><br><span class="line">  ENDLOOP.</span><br><span class="line"></span><br><span class="line">  SELECT</span><br><span class="line">  ekko~ebeln</span><br><span class="line">  ekko~ernam</span><br><span class="line">  ekko~lifnr</span><br><span class="line">  ekpo~werks <span class="keyword">AS</span> plant</span><br><span class="line">  INTO CORRESPONDING FIELDS OF <span class="keyword">TABLE</span> it_tab1</span><br><span class="line">  FROM ekko</span><br><span class="line">  LEFT JOIN ekpo <span class="keyword">ON</span> ekpo~ebeln = ekko~ebeln</span><br><span class="line">  WHERE ekko~ebeln <span class="keyword">IN</span> r_po.</span><br><span class="line">  LOOP AT it_alv ASSIGNING &lt;fs&gt;.</span><br><span class="line">    LOOP AT it_tab1.</span><br><span class="line">      <span class="keyword">IF</span> it_tab1-ebeln = &lt;fs&gt;-item_po_number AND it_tab1-lifnr = &lt;fs&gt;-item_freight_ven.</span><br><span class="line">        wa_alv-plant = it_tab1-plant.</span><br><span class="line">        wa_alv-ernam = it_tab1-ernam.</span><br><span class="line"><span class="comment">*      elseif it_tab1-EBELN = &lt;fs&gt;-item_po_number and IT_TAB1-lifnr ne &lt;fs&gt;-item_freight_ven.</span></span><br><span class="line"><span class="comment">*       wa_alv-message = '供应商或采购订单号错误'.</span></span><br><span class="line">        MODIFY it_alv FROM wa_alv TRANSPORTING plant ernam.</span><br><span class="line">        <span class="keyword">CLEAR</span>: it_tab1.</span><br><span class="line">      ENDIF.</span><br><span class="line">    ENDLOOP.</span><br><span class="line">  ENDLOOP.</span><br><span class="line">ENDFORM.</span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  FRM_FILLDATA_TOBAPI</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*  --&gt;  p1        text</span></span><br><span class="line"><span class="comment">*  &lt;--  p2        text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="keyword">FORM</span> frm_filldata_tobapi .</span><br><span class="line">  DATA: <span class="keyword">total</span> <span class="keyword">TYPE</span> bapi_rmwwr.</span><br><span class="line">  <span class="keyword">MOVE</span>-CORRESPONDING gt_data[] TO it_invoice[].</span><br><span class="line"></span><br><span class="line">  <span class="keyword">CLEAR</span>: it_bapi[].</span><br><span class="line">  LOOP AT it_invoice INTO wa_invoice.</span><br><span class="line">    CONCATENATE wa_invoice-item_freight_ven wa_invoice-item_tax_code INTO it_bapi-sign.</span><br><span class="line">    <span class="keyword">MOVE</span>-CORRESPONDING wa_invoice TO it_bapi.</span><br><span class="line">    <span class="keyword">APPEND</span> it_bapi.</span><br><span class="line">    <span class="keyword">CLEAR</span>: it_bapi,wa_invoice.</span><br><span class="line">  ENDLOOP.</span><br><span class="line"></span><br><span class="line">  LOOP AT it_bapi.</span><br><span class="line">    AT NEW sign.</span><br><span class="line">      <span class="keyword">CLEAR</span>: ls_head,it_item[],it_return[],invoicedocnumber.</span><br><span class="line">    ENDAT.</span><br><span class="line"><span class="comment">*    ls_head-SIMULATION = 'X'.</span></span><br><span class="line">    ls_head-comp_code = it_bapi-head_comp_code.</span><br><span class="line">    ls_head-invoice_ind = it_bapi-head_invoice_ind.</span><br><span class="line">    ls_head-doc_type  = 'RE'.</span><br><span class="line">    ls_head-doc_date = it_bapi-head_doc_date.</span><br><span class="line">    ls_head-pstng_date = it_bapi-head_pstng_date.</span><br><span class="line">    ls_head-currency = it_bapi-head_currency.</span><br><span class="line">    ls_head-gross_amount = ls_head-gross_amount + it_bapi-head_gross_amount .</span><br><span class="line">    ls_head-calc_tax_ind = it_bapi-head_calc_tax_ind.</span><br><span class="line">    ls_head-bline_date = it_bapi-head_bline_date.</span><br><span class="line"></span><br><span class="line">    wa_item-invoice_doc_item = it_bapi-item_invoice_doc_item.</span><br><span class="line">    wa_item-po_number = it_bapi-item_po_number.</span><br><span class="line">    wa_item-po_item = it_bapi-item_po_item.</span><br><span class="line">    wa_item-ref_doc = it_bapi-item_ref_doc.</span><br><span class="line">    wa_item-ref_doc_it = it_bapi-item_ref_doc_it.</span><br><span class="line">    wa_item-ref_doc_year = it_bapi-item_ref_doc_year.</span><br><span class="line">    wa_item-tax_code = it_bapi-item_tax_code.</span><br><span class="line">    wa_item-item_amount = it_bapi-item_amount.</span><br><span class="line">    wa_item-quantity = it_bapi-item_quantity.</span><br><span class="line">    wa_item-po_unit = it_bapi-item_po_unit.</span><br><span class="line">    wa_item-po_unit_iso = it_bapi-item_po_unit.</span><br><span class="line">    wa_item-po_pr_uom = it_bapi-item_po_unit_iso.</span><br><span class="line">    wa_item-po_pr_uom_iso = it_bapi-item_po_unit_iso.</span><br><span class="line">    wa_item-item_text = it_bapi-item_text.</span><br><span class="line">    <span class="keyword">APPEND</span> wa_item TO it_item.</span><br><span class="line">    <span class="keyword">CLEAR</span>: wa_item.</span><br><span class="line"></span><br><span class="line">    AT END OF sign.</span><br><span class="line">      PERFORM frm_transfer_bapi.</span><br><span class="line">    ENDAT.</span><br><span class="line">  ENDLOOP.</span><br><span class="line"></span><br><span class="line">ENDFORM.</span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  FRM_TRANSFER_BAPI</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*  --&gt;  p1        text</span></span><br><span class="line"><span class="comment">*  &lt;--  p2        text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="keyword">FORM</span> frm_transfer_bapi .</span><br><span class="line">  DATA str <span class="keyword">TYPE</span> string.</span><br><span class="line">  CALL FUNCTION 'BAPI_INCOMINGINVOICE_PARK'</span><br><span class="line">    EXPORTING</span><br><span class="line">      headerdata       = ls_head</span><br><span class="line"><span class="comment">*     ADDRESSDATA      =</span></span><br><span class="line">    IMPORTING</span><br><span class="line">      invoicedocnumber = invoicedocnumber</span><br><span class="line"><span class="comment">*     FISCALYEAR       =</span></span><br><span class="line">    TABLES</span><br><span class="line">      itemdata         = it_item[]</span><br><span class="line"><span class="comment">*     ACCOUNTINGDATA   =</span></span><br><span class="line"><span class="comment">*     GLACCOUNTDATA    =</span></span><br><span class="line"><span class="comment">*     MATERIALDATA     =</span></span><br><span class="line"><span class="comment">*     TAXDATA          =</span></span><br><span class="line"><span class="comment">*     WITHTAXDATA      =</span></span><br><span class="line"><span class="comment">*     VENDORITEMSPLITDATA       =</span></span><br><span class="line">      <span class="keyword">return</span>           = it_return[]</span><br><span class="line"><span class="comment">*     EXTENSIONIN      =</span></span><br><span class="line"><span class="comment">*     TM_ITEMDATA      =</span></span><br><span class="line">    .</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> invoicedocnumber NE space.</span><br><span class="line">    CALL FUNCTION 'BAPI_TRANSACTION_COMMIT'</span><br><span class="line">      EXPORTING</span><br><span class="line">        wait = 'X'.</span><br><span class="line">    it_result-invoicedocnumber = invoicedocnumber.</span><br><span class="line">    <span class="keyword">APPEND</span> it_result.</span><br><span class="line">    <span class="keyword">CLEAR</span>: it_result.</span><br><span class="line">    CONCATENATE '发票号' invoicedocnumber INTO str.</span><br><span class="line">    MESSAGE str <span class="keyword">TYPE</span> 'S'.</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line">    LOOP AT it_return INTO wa_return.</span><br><span class="line">      CONCATENATE '错误：' wa_return-message INTO str.</span><br><span class="line">      MESSAGE str <span class="keyword">TYPE</span> '<span class="keyword">E</span>'.</span><br><span class="line">    ENDLOOP.</span><br><span class="line">    CALL FUNCTION 'BAPI_TRANSACTION_ROLLBACK'.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ENDFORM.</span><br></pre></td></tr></table></figure>
<h3 id="BOM批量导入">BOM批量导入</h3><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br><span class="line">1073</span><br><span class="line">1074</span><br><span class="line">1075</span><br><span class="line">1076</span><br><span class="line">1077</span><br><span class="line">1078</span><br><span class="line">1079</span><br><span class="line">1080</span><br><span class="line">1081</span><br><span class="line">1082</span><br><span class="line">1083</span><br><span class="line">1084</span><br><span class="line">1085</span><br><span class="line">1086</span><br><span class="line">1087</span><br><span class="line">1088</span><br><span class="line">1089</span><br><span class="line">1090</span><br><span class="line">1091</span><br><span class="line">1092</span><br><span class="line">1093</span><br><span class="line">1094</span><br><span class="line">1095</span><br><span class="line">1096</span><br><span class="line">1097</span><br><span class="line">1098</span><br><span class="line">1099</span><br><span class="line">1100</span><br><span class="line">1101</span><br><span class="line">1102</span><br><span class="line">1103</span><br><span class="line">1104</span><br><span class="line">1105</span><br><span class="line">1106</span><br><span class="line">1107</span><br><span class="line">1108</span><br><span class="line">1109</span><br><span class="line">1110</span><br><span class="line">1111</span><br><span class="line">1112</span><br><span class="line">1113</span><br><span class="line">1114</span><br><span class="line">1115</span><br><span class="line">1116</span><br><span class="line">1117</span><br><span class="line">1118</span><br><span class="line">1119</span><br><span class="line">1120</span><br><span class="line">1121</span><br><span class="line">1122</span><br><span class="line">1123</span><br><span class="line">1124</span><br><span class="line">1125</span><br><span class="line">1126</span><br><span class="line">1127</span><br><span class="line">1128</span><br><span class="line">1129</span><br><span class="line">1130</span><br><span class="line">1131</span><br><span class="line">1132</span><br><span class="line">1133</span><br><span class="line">1134</span><br><span class="line">1135</span><br><span class="line">1136</span><br><span class="line">1137</span><br><span class="line">1138</span><br><span class="line">1139</span><br><span class="line">1140</span><br><span class="line">1141</span><br><span class="line">1142</span><br><span class="line">1143</span><br><span class="line">1144</span><br><span class="line">1145</span><br><span class="line">1146</span><br><span class="line">1147</span><br><span class="line">1148</span><br><span class="line">1149</span><br><span class="line">1150</span><br><span class="line">1151</span><br><span class="line">1152</span><br><span class="line">1153</span><br><span class="line">1154</span><br><span class="line">1155</span><br><span class="line">1156</span><br><span class="line">1157</span><br><span class="line">1158</span><br><span class="line">1159</span><br><span class="line">1160</span><br><span class="line">1161</span><br><span class="line">1162</span><br><span class="line">1163</span><br><span class="line">1164</span><br><span class="line">1165</span><br><span class="line">1166</span><br><span class="line">1167</span><br><span class="line">1168</span><br><span class="line">1169</span><br><span class="line">1170</span><br><span class="line">1171</span><br><span class="line">1172</span><br><span class="line">1173</span><br><span class="line">1174</span><br><span class="line">1175</span><br><span class="line">1176</span><br><span class="line">1177</span><br><span class="line">1178</span><br><span class="line">1179</span><br><span class="line">1180</span><br><span class="line">1181</span><br><span class="line">1182</span><br><span class="line">1183</span><br><span class="line">1184</span><br><span class="line">1185</span><br><span class="line">1186</span><br><span class="line">1187</span><br><span class="line">1188</span><br><span class="line">1189</span><br><span class="line">1190</span><br><span class="line">1191</span><br><span class="line">1192</span><br><span class="line">1193</span><br><span class="line">1194</span><br><span class="line">1195</span><br><span class="line">1196</span><br><span class="line">1197</span><br><span class="line">1198</span><br><span class="line">1199</span><br><span class="line">1200</span><br><span class="line">1201</span><br><span class="line">1202</span><br><span class="line">1203</span><br><span class="line">1204</span><br><span class="line">1205</span><br><span class="line">1206</span><br><span class="line">1207</span><br><span class="line">1208</span><br><span class="line">1209</span><br><span class="line">1210</span><br><span class="line">1211</span><br><span class="line">1212</span><br><span class="line">1213</span><br><span class="line">1214</span><br><span class="line">1215</span><br><span class="line">1216</span><br><span class="line">1217</span><br><span class="line">1218</span><br><span class="line">1219</span><br><span class="line">1220</span><br><span class="line">1221</span><br><span class="line">1222</span><br><span class="line">1223</span><br><span class="line">1224</span><br><span class="line">1225</span><br><span class="line">1226</span><br><span class="line">1227</span><br><span class="line">1228</span><br><span class="line">1229</span><br><span class="line">1230</span><br><span class="line">1231</span><br><span class="line">1232</span><br><span class="line">1233</span><br><span class="line">1234</span><br><span class="line">1235</span><br><span class="line">1236</span><br><span class="line">1237</span><br><span class="line">1238</span><br><span class="line">1239</span><br><span class="line">1240</span><br><span class="line">1241</span><br><span class="line">1242</span><br><span class="line">1243</span><br><span class="line">1244</span><br><span class="line">1245</span><br><span class="line">1246</span><br><span class="line">1247</span><br><span class="line">1248</span><br><span class="line">1249</span><br><span class="line">1250</span><br><span class="line">1251</span><br><span class="line">1252</span><br><span class="line">1253</span><br><span class="line">1254</span><br><span class="line">1255</span><br><span class="line">1256</span><br><span class="line">1257</span><br><span class="line">1258</span><br><span class="line">1259</span><br><span class="line">1260</span><br><span class="line">1261</span><br><span class="line">1262</span><br><span class="line">1263</span><br><span class="line">1264</span><br><span class="line">1265</span><br><span class="line">1266</span><br><span class="line">1267</span><br><span class="line">1268</span><br><span class="line">1269</span><br><span class="line">1270</span><br><span class="line">1271</span><br><span class="line">1272</span><br><span class="line">1273</span><br><span class="line">1274</span><br><span class="line">1275</span><br><span class="line">1276</span><br><span class="line">1277</span><br><span class="line">1278</span><br><span class="line">1279</span><br><span class="line">1280</span><br><span class="line">1281</span><br><span class="line">1282</span><br><span class="line">1283</span><br><span class="line">1284</span><br><span class="line">1285</span><br><span class="line">1286</span><br><span class="line">1287</span><br><span class="line">1288</span><br><span class="line">1289</span><br><span class="line">1290</span><br><span class="line">1291</span><br><span class="line">1292</span><br><span class="line">1293</span><br><span class="line">1294</span><br><span class="line">1295</span><br><span class="line">1296</span><br><span class="line">1297</span><br><span class="line">1298</span><br><span class="line">1299</span><br><span class="line">1300</span><br><span class="line">1301</span><br><span class="line">1302</span><br><span class="line">1303</span><br><span class="line">1304</span><br><span class="line">1305</span><br><span class="line">1306</span><br><span class="line">1307</span><br><span class="line">1308</span><br><span class="line">1309</span><br><span class="line">1310</span><br><span class="line">1311</span><br><span class="line">1312</span><br><span class="line">1313</span><br><span class="line">1314</span><br><span class="line">1315</span><br><span class="line">1316</span><br><span class="line">1317</span><br><span class="line">1318</span><br><span class="line">1319</span><br><span class="line">1320</span><br><span class="line">1321</span><br><span class="line">1322</span><br><span class="line">1323</span><br><span class="line">1324</span><br><span class="line">1325</span><br><span class="line">1326</span><br><span class="line">1327</span><br><span class="line">1328</span><br><span class="line">1329</span><br><span class="line">1330</span><br><span class="line">1331</span><br><span class="line">1332</span><br><span class="line">1333</span><br><span class="line">1334</span><br><span class="line">1335</span><br><span class="line">1336</span><br><span class="line">1337</span><br><span class="line">1338</span><br><span class="line">1339</span><br><span class="line">1340</span><br><span class="line">1341</span><br><span class="line">1342</span><br><span class="line">1343</span><br><span class="line">1344</span><br><span class="line">1345</span><br><span class="line">1346</span><br><span class="line">1347</span><br><span class="line">1348</span><br><span class="line">1349</span><br><span class="line">1350</span><br><span class="line">1351</span><br><span class="line">1352</span><br><span class="line">1353</span><br><span class="line">1354</span><br><span class="line">1355</span><br><span class="line">1356</span><br><span class="line">1357</span><br><span class="line">1358</span><br><span class="line">1359</span><br><span class="line">1360</span><br><span class="line">1361</span><br><span class="line">1362</span><br><span class="line">1363</span><br><span class="line">1364</span><br><span class="line">1365</span><br><span class="line">1366</span><br><span class="line">1367</span><br><span class="line">1368</span><br><span class="line">1369</span><br><span class="line">1370</span><br><span class="line">1371</span><br><span class="line">1372</span><br><span class="line">1373</span><br><span class="line">1374</span><br><span class="line">1375</span><br><span class="line">1376</span><br><span class="line">1377</span><br><span class="line">1378</span><br><span class="line">1379</span><br><span class="line">1380</span><br><span class="line">1381</span><br><span class="line">1382</span><br><span class="line">1383</span><br><span class="line">1384</span><br><span class="line">1385</span><br><span class="line">1386</span><br><span class="line">1387</span><br><span class="line">1388</span><br><span class="line">1389</span><br><span class="line">1390</span><br><span class="line">1391</span><br><span class="line">1392</span><br><span class="line">1393</span><br><span class="line">1394</span><br><span class="line">1395</span><br><span class="line">1396</span><br><span class="line">1397</span><br><span class="line">1398</span><br><span class="line">1399</span><br><span class="line">1400</span><br><span class="line">1401</span><br><span class="line">1402</span><br><span class="line">1403</span><br><span class="line">1404</span><br><span class="line">1405</span><br><span class="line">1406</span><br><span class="line">1407</span><br><span class="line">1408</span><br><span class="line">1409</span><br><span class="line">1410</span><br><span class="line">1411</span><br><span class="line">1412</span><br><span class="line">1413</span><br><span class="line">1414</span><br><span class="line">1415</span><br><span class="line">1416</span><br><span class="line">1417</span><br><span class="line">1418</span><br><span class="line">1419</span><br><span class="line">1420</span><br><span class="line">1421</span><br><span class="line">1422</span><br><span class="line">1423</span><br><span class="line">1424</span><br><span class="line">1425</span><br><span class="line">1426</span><br><span class="line">1427</span><br><span class="line">1428</span><br><span class="line">1429</span><br><span class="line">1430</span><br><span class="line">1431</span><br><span class="line">1432</span><br><span class="line">1433</span><br><span class="line">1434</span><br><span class="line">1435</span><br><span class="line">1436</span><br><span class="line">1437</span><br><span class="line">1438</span><br><span class="line">1439</span><br><span class="line">1440</span><br><span class="line">1441</span><br><span class="line">1442</span><br><span class="line">1443</span><br><span class="line">1444</span><br><span class="line">1445</span><br><span class="line">1446</span><br><span class="line">1447</span><br><span class="line">1448</span><br><span class="line">1449</span><br><span class="line">1450</span><br><span class="line">1451</span><br><span class="line">1452</span><br><span class="line">1453</span><br><span class="line">1454</span><br><span class="line">1455</span><br><span class="line">1456</span><br><span class="line">1457</span><br><span class="line">1458</span><br><span class="line">1459</span><br><span class="line">1460</span><br><span class="line">1461</span><br><span class="line">1462</span><br><span class="line">1463</span><br><span class="line">1464</span><br><span class="line">1465</span><br><span class="line">1466</span><br><span class="line">1467</span><br><span class="line">1468</span><br><span class="line">1469</span><br><span class="line">1470</span><br><span class="line">1471</span><br><span class="line">1472</span><br><span class="line">1473</span><br><span class="line">1474</span><br><span class="line">1475</span><br><span class="line">1476</span><br><span class="line">1477</span><br><span class="line">1478</span><br><span class="line">1479</span><br><span class="line">1480</span><br><span class="line">1481</span><br><span class="line">1482</span><br><span class="line">1483</span><br><span class="line">1484</span><br><span class="line">1485</span><br><span class="line">1486</span><br><span class="line">1487</span><br><span class="line">1488</span><br><span class="line">1489</span><br><span class="line">1490</span><br><span class="line">1491</span><br><span class="line">1492</span><br><span class="line">1493</span><br><span class="line">1494</span><br><span class="line">1495</span><br><span class="line">1496</span><br><span class="line">1497</span><br><span class="line">1498</span><br><span class="line">1499</span><br><span class="line">1500</span><br><span class="line">1501</span><br><span class="line">1502</span><br><span class="line">1503</span><br><span class="line">1504</span><br><span class="line">1505</span><br><span class="line">1506</span><br><span class="line">1507</span><br><span class="line">1508</span><br><span class="line">1509</span><br><span class="line">1510</span><br><span class="line">1511</span><br><span class="line">1512</span><br><span class="line">1513</span><br><span class="line">1514</span><br><span class="line">1515</span><br><span class="line">1516</span><br><span class="line">1517</span><br><span class="line">1518</span><br><span class="line">1519</span><br><span class="line">1520</span><br><span class="line">1521</span><br><span class="line">1522</span><br><span class="line">1523</span><br><span class="line">1524</span><br><span class="line">1525</span><br><span class="line">1526</span><br><span class="line">1527</span><br><span class="line">1528</span><br><span class="line">1529</span><br><span class="line">1530</span><br><span class="line">1531</span><br><span class="line">1532</span><br><span class="line">1533</span><br><span class="line">1534</span><br><span class="line">1535</span><br><span class="line">1536</span><br><span class="line">1537</span><br><span class="line">1538</span><br><span class="line">1539</span><br><span class="line">1540</span><br><span class="line">1541</span><br><span class="line">1542</span><br><span class="line">1543</span><br><span class="line">1544</span><br><span class="line">1545</span><br><span class="line">1546</span><br><span class="line">1547</span><br><span class="line">1548</span><br><span class="line">1549</span><br><span class="line">1550</span><br><span class="line">1551</span><br><span class="line">1552</span><br><span class="line">1553</span><br><span class="line">1554</span><br><span class="line">1555</span><br><span class="line">1556</span><br><span class="line">1557</span><br><span class="line">1558</span><br><span class="line">1559</span><br><span class="line">1560</span><br><span class="line">1561</span><br><span class="line">1562</span><br><span class="line">1563</span><br><span class="line">1564</span><br><span class="line">1565</span><br><span class="line">1566</span><br><span class="line">1567</span><br><span class="line">1568</span><br><span class="line">1569</span><br><span class="line">1570</span><br><span class="line">1571</span><br><span class="line">1572</span><br><span class="line">1573</span><br><span class="line">1574</span><br><span class="line">1575</span><br><span class="line">1576</span><br><span class="line">1577</span><br><span class="line">1578</span><br><span class="line">1579</span><br><span class="line">1580</span><br><span class="line">1581</span><br><span class="line">1582</span><br><span class="line">1583</span><br><span class="line">1584</span><br><span class="line">1585</span><br><span class="line">1586</span><br><span class="line">1587</span><br><span class="line">1588</span><br><span class="line">1589</span><br><span class="line">1590</span><br><span class="line">1591</span><br><span class="line">1592</span><br><span class="line">1593</span><br><span class="line">1594</span><br><span class="line">1595</span><br><span class="line">1596</span><br><span class="line">1597</span><br><span class="line">1598</span><br><span class="line">1599</span><br><span class="line">1600</span><br><span class="line">1601</span><br><span class="line">1602</span><br><span class="line">1603</span><br><span class="line">1604</span><br><span class="line">1605</span><br><span class="line">1606</span><br><span class="line">1607</span><br><span class="line">1608</span><br><span class="line">1609</span><br><span class="line">1610</span><br><span class="line">1611</span><br><span class="line">1612</span><br><span class="line">1613</span><br><span class="line">1614</span><br><span class="line">1615</span><br><span class="line">1616</span><br><span class="line">1617</span><br><span class="line">1618</span><br><span class="line">1619</span><br><span class="line">1620</span><br><span class="line">1621</span><br><span class="line">1622</span><br><span class="line">1623</span><br><span class="line">1624</span><br><span class="line">1625</span><br><span class="line">1626</span><br><span class="line">1627</span><br><span class="line">1628</span><br><span class="line">1629</span><br><span class="line">1630</span><br><span class="line">1631</span><br><span class="line">1632</span><br><span class="line">1633</span><br><span class="line">1634</span><br><span class="line">1635</span><br><span class="line">1636</span><br><span class="line">1637</span><br><span class="line">1638</span><br><span class="line">1639</span><br><span class="line">1640</span><br><span class="line">1641</span><br><span class="line">1642</span><br><span class="line">1643</span><br><span class="line">1644</span><br><span class="line">1645</span><br><span class="line">1646</span><br><span class="line">1647</span><br><span class="line">1648</span><br><span class="line">1649</span><br><span class="line">1650</span><br><span class="line">1651</span><br><span class="line">1652</span><br><span class="line">1653</span><br><span class="line">1654</span><br><span class="line">1655</span><br><span class="line">1656</span><br><span class="line">1657</span><br><span class="line">1658</span><br><span class="line">1659</span><br><span class="line">1660</span><br><span class="line">1661</span><br><span class="line">1662</span><br><span class="line">1663</span><br><span class="line">1664</span><br><span class="line">1665</span><br><span class="line">1666</span><br><span class="line">1667</span><br><span class="line">1668</span><br><span class="line">1669</span><br><span class="line">1670</span><br><span class="line">1671</span><br><span class="line">1672</span><br><span class="line">1673</span><br><span class="line">1674</span><br><span class="line">1675</span><br><span class="line">1676</span><br><span class="line">1677</span><br><span class="line">1678</span><br><span class="line">1679</span><br><span class="line">1680</span><br><span class="line">1681</span><br><span class="line">1682</span><br><span class="line">1683</span><br><span class="line">1684</span><br><span class="line">1685</span><br><span class="line">1686</span><br><span class="line">1687</span><br><span class="line">1688</span><br><span class="line">1689</span><br><span class="line">1690</span><br><span class="line">1691</span><br><span class="line">1692</span><br><span class="line">1693</span><br><span class="line">1694</span><br><span class="line">1695</span><br><span class="line">1696</span><br><span class="line">1697</span><br><span class="line">1698</span><br><span class="line">1699</span><br><span class="line">1700</span><br><span class="line">1701</span><br><span class="line">1702</span><br><span class="line">1703</span><br><span class="line">1704</span><br><span class="line">1705</span><br><span class="line">1706</span><br><span class="line">1707</span><br><span class="line">1708</span><br><span class="line">1709</span><br><span class="line">1710</span><br><span class="line">1711</span><br><span class="line">1712</span><br><span class="line">1713</span><br><span class="line">1714</span><br><span class="line">1715</span><br><span class="line">1716</span><br><span class="line">1717</span><br><span class="line">1718</span><br><span class="line">1719</span><br><span class="line">1720</span><br><span class="line">1721</span><br><span class="line">1722</span><br><span class="line">1723</span><br><span class="line">1724</span><br><span class="line">1725</span><br><span class="line">1726</span><br><span class="line">1727</span><br><span class="line">1728</span><br><span class="line">1729</span><br><span class="line">1730</span><br><span class="line">1731</span><br><span class="line">1732</span><br><span class="line">1733</span><br><span class="line">1734</span><br><span class="line">1735</span><br><span class="line">1736</span><br><span class="line">1737</span><br><span class="line">1738</span><br><span class="line">1739</span><br><span class="line">1740</span><br><span class="line">1741</span><br><span class="line">1742</span><br><span class="line">1743</span><br><span class="line">1744</span><br><span class="line">1745</span><br><span class="line">1746</span><br><span class="line">1747</span><br><span class="line">1748</span><br><span class="line">1749</span><br><span class="line">1750</span><br><span class="line">1751</span><br><span class="line">1752</span><br><span class="line">1753</span><br><span class="line">1754</span><br><span class="line">1755</span><br><span class="line">1756</span><br><span class="line">1757</span><br><span class="line">1758</span><br><span class="line">1759</span><br><span class="line">1760</span><br><span class="line">1761</span><br><span class="line">1762</span><br><span class="line">1763</span><br><span class="line">1764</span><br><span class="line">1765</span><br><span class="line">1766</span><br><span class="line">1767</span><br><span class="line">1768</span><br><span class="line">1769</span><br><span class="line">1770</span><br><span class="line">1771</span><br><span class="line">1772</span><br><span class="line">1773</span><br><span class="line">1774</span><br><span class="line">1775</span><br><span class="line">1776</span><br><span class="line">1777</span><br><span class="line">1778</span><br><span class="line">1779</span><br><span class="line">1780</span><br><span class="line">1781</span><br><span class="line">1782</span><br><span class="line">1783</span><br><span class="line">1784</span><br><span class="line">1785</span><br><span class="line">1786</span><br><span class="line">1787</span><br><span class="line">1788</span><br><span class="line">1789</span><br><span class="line">1790</span><br><span class="line">1791</span><br><span class="line">1792</span><br><span class="line">1793</span><br><span class="line">1794</span><br><span class="line">1795</span><br><span class="line">1796</span><br><span class="line">1797</span><br><span class="line">1798</span><br><span class="line">1799</span><br><span class="line">1800</span><br><span class="line">1801</span><br><span class="line">1802</span><br><span class="line">1803</span><br><span class="line">1804</span><br><span class="line">1805</span><br><span class="line">1806</span><br><span class="line">1807</span><br><span class="line">1808</span><br><span class="line">1809</span><br><span class="line">1810</span><br><span class="line">1811</span><br><span class="line">1812</span><br><span class="line">1813</span><br><span class="line">1814</span><br><span class="line">1815</span><br><span class="line">1816</span><br><span class="line">1817</span><br><span class="line">1818</span><br><span class="line">1819</span><br><span class="line">1820</span><br><span class="line">1821</span><br><span class="line">1822</span><br><span class="line">1823</span><br><span class="line">1824</span><br><span class="line">1825</span><br><span class="line">1826</span><br><span class="line">1827</span><br><span class="line">1828</span><br><span class="line">1829</span><br><span class="line">1830</span><br><span class="line">1831</span><br><span class="line">1832</span><br><span class="line">1833</span><br><span class="line">1834</span><br><span class="line">1835</span><br><span class="line">1836</span><br><span class="line">1837</span><br><span class="line">1838</span><br><span class="line">1839</span><br><span class="line">1840</span><br><span class="line">1841</span><br><span class="line">1842</span><br><span class="line">1843</span><br><span class="line">1844</span><br><span class="line">1845</span><br><span class="line">1846</span><br><span class="line">1847</span><br><span class="line">1848</span><br><span class="line">1849</span><br><span class="line">1850</span><br><span class="line">1851</span><br><span class="line">1852</span><br><span class="line">1853</span><br><span class="line">1854</span><br><span class="line">1855</span><br><span class="line">1856</span><br><span class="line">1857</span><br><span class="line">1858</span><br><span class="line">1859</span><br><span class="line">1860</span><br><span class="line">1861</span><br><span class="line">1862</span><br><span class="line">1863</span><br><span class="line">1864</span><br><span class="line">1865</span><br><span class="line">1866</span><br><span class="line">1867</span><br><span class="line">1868</span><br><span class="line">1869</span><br><span class="line">1870</span><br><span class="line">1871</span><br><span class="line">1872</span><br><span class="line">1873</span><br><span class="line">1874</span><br><span class="line">1875</span><br><span class="line">1876</span><br><span class="line">1877</span><br><span class="line">1878</span><br><span class="line">1879</span><br><span class="line">1880</span><br><span class="line">1881</span><br><span class="line">1882</span><br><span class="line">1883</span><br><span class="line">1884</span><br><span class="line">1885</span><br><span class="line">1886</span><br><span class="line">1887</span><br><span class="line">1888</span><br><span class="line">1889</span><br><span class="line">1890</span><br><span class="line">1891</span><br><span class="line">1892</span><br><span class="line">1893</span><br><span class="line">1894</span><br><span class="line">1895</span><br><span class="line">1896</span><br><span class="line">1897</span><br><span class="line">1898</span><br><span class="line">1899</span><br><span class="line">1900</span><br><span class="line">1901</span><br><span class="line">1902</span><br><span class="line">1903</span><br><span class="line">1904</span><br><span class="line">1905</span><br><span class="line">1906</span><br><span class="line">1907</span><br><span class="line">1908</span><br><span class="line">1909</span><br><span class="line">1910</span><br><span class="line">1911</span><br><span class="line">1912</span><br><span class="line">1913</span><br><span class="line">1914</span><br><span class="line">1915</span><br><span class="line">1916</span><br><span class="line">1917</span><br><span class="line">1918</span><br><span class="line">1919</span><br><span class="line">1920</span><br><span class="line">1921</span><br><span class="line">1922</span><br><span class="line">1923</span><br><span class="line">1924</span><br><span class="line">1925</span><br><span class="line">1926</span><br><span class="line">1927</span><br><span class="line">1928</span><br><span class="line">1929</span><br><span class="line">1930</span><br><span class="line">1931</span><br><span class="line">1932</span><br><span class="line">1933</span><br><span class="line">1934</span><br><span class="line">1935</span><br><span class="line">1936</span><br><span class="line">1937</span><br><span class="line">1938</span><br><span class="line">1939</span><br><span class="line">1940</span><br><span class="line">1941</span><br><span class="line">1942</span><br><span class="line">1943</span><br><span class="line">1944</span><br><span class="line">1945</span><br><span class="line">1946</span><br><span class="line">1947</span><br><span class="line">1948</span><br><span class="line">1949</span><br><span class="line">1950</span><br><span class="line">1951</span><br><span class="line">1952</span><br><span class="line">1953</span><br><span class="line">1954</span><br><span class="line">1955</span><br><span class="line">1956</span><br><span class="line">1957</span><br><span class="line">1958</span><br><span class="line">1959</span><br><span class="line">1960</span><br><span class="line">1961</span><br><span class="line">1962</span><br><span class="line">1963</span><br><span class="line">1964</span><br><span class="line">1965</span><br><span class="line">1966</span><br><span class="line">1967</span><br><span class="line">1968</span><br><span class="line">1969</span><br><span class="line">1970</span><br><span class="line">1971</span><br><span class="line">1972</span><br><span class="line">1973</span><br><span class="line">1974</span><br><span class="line">1975</span><br><span class="line">1976</span><br><span class="line">1977</span><br><span class="line">1978</span><br><span class="line">1979</span><br><span class="line">1980</span><br><span class="line">1981</span><br><span class="line">1982</span><br><span class="line">1983</span><br><span class="line">1984</span><br><span class="line">1985</span><br><span class="line">1986</span><br><span class="line">1987</span><br><span class="line">1988</span><br><span class="line">1989</span><br><span class="line">1990</span><br><span class="line">1991</span><br><span class="line">1992</span><br><span class="line">1993</span><br><span class="line">1994</span><br><span class="line">1995</span><br><span class="line">1996</span><br><span class="line">1997</span><br><span class="line">1998</span><br><span class="line">1999</span><br><span class="line">2000</span><br><span class="line">2001</span><br><span class="line">2002</span><br><span class="line">2003</span><br><span class="line">2004</span><br><span class="line">2005</span><br><span class="line">2006</span><br><span class="line">2007</span><br><span class="line">2008</span><br><span class="line">2009</span><br><span class="line">2010</span><br><span class="line">2011</span><br><span class="line">2012</span><br><span class="line">2013</span><br><span class="line">2014</span><br><span class="line">2015</span><br><span class="line">2016</span><br><span class="line">2017</span><br><span class="line">2018</span><br><span class="line">2019</span><br><span class="line">2020</span><br><span class="line">2021</span><br><span class="line">2022</span><br><span class="line">2023</span><br><span class="line">2024</span><br><span class="line">2025</span><br><span class="line">2026</span><br><span class="line">2027</span><br><span class="line">2028</span><br><span class="line">2029</span><br><span class="line">2030</span><br><span class="line">2031</span><br><span class="line">2032</span><br><span class="line">2033</span><br><span class="line">2034</span><br><span class="line">2035</span><br><span class="line">2036</span><br><span class="line">2037</span><br><span class="line">2038</span><br><span class="line">2039</span><br><span class="line">2040</span><br><span class="line">2041</span><br><span class="line">2042</span><br><span class="line">2043</span><br><span class="line">2044</span><br><span class="line">2045</span><br><span class="line">2046</span><br><span class="line">2047</span><br><span class="line">2048</span><br><span class="line">2049</span><br><span class="line">2050</span><br><span class="line">2051</span><br><span class="line">2052</span><br><span class="line">2053</span><br><span class="line">2054</span><br><span class="line">2055</span><br><span class="line">2056</span><br><span class="line">2057</span><br><span class="line">2058</span><br><span class="line">2059</span><br><span class="line">2060</span><br><span class="line">2061</span><br><span class="line">2062</span><br><span class="line">2063</span><br><span class="line">2064</span><br><span class="line">2065</span><br><span class="line">2066</span><br><span class="line">2067</span><br><span class="line">2068</span><br><span class="line">2069</span><br><span class="line">2070</span><br><span class="line">2071</span><br><span class="line">2072</span><br><span class="line">2073</span><br><span class="line">2074</span><br><span class="line">2075</span><br><span class="line">2076</span><br><span class="line">2077</span><br><span class="line">2078</span><br><span class="line">2079</span><br><span class="line">2080</span><br><span class="line">2081</span><br><span class="line">2082</span><br><span class="line">2083</span><br><span class="line">2084</span><br><span class="line">2085</span><br><span class="line">2086</span><br><span class="line">2087</span><br><span class="line">2088</span><br><span class="line">2089</span><br><span class="line">2090</span><br><span class="line">2091</span><br><span class="line">2092</span><br><span class="line">2093</span><br><span class="line">2094</span><br><span class="line">2095</span><br><span class="line">2096</span><br><span class="line">2097</span><br><span class="line">2098</span><br><span class="line">2099</span><br><span class="line">2100</span><br><span class="line">2101</span><br><span class="line">2102</span><br><span class="line">2103</span><br><span class="line">2104</span><br><span class="line">2105</span><br><span class="line">2106</span><br><span class="line">2107</span><br><span class="line">2108</span><br><span class="line">2109</span><br><span class="line">2110</span><br><span class="line">2111</span><br><span class="line">2112</span><br><span class="line">2113</span><br><span class="line">2114</span><br><span class="line">2115</span><br><span class="line">2116</span><br><span class="line">2117</span><br><span class="line">2118</span><br><span class="line">2119</span><br><span class="line">2120</span><br><span class="line">2121</span><br><span class="line">2122</span><br><span class="line">2123</span><br><span class="line">2124</span><br><span class="line">2125</span><br><span class="line">2126</span><br><span class="line">2127</span><br><span class="line">2128</span><br><span class="line">2129</span><br><span class="line">2130</span><br><span class="line">2131</span><br><span class="line">2132</span><br><span class="line">2133</span><br><span class="line">2134</span><br><span class="line">2135</span><br><span class="line">2136</span><br><span class="line">2137</span><br><span class="line">2138</span><br><span class="line">2139</span><br><span class="line">2140</span><br><span class="line">2141</span><br><span class="line">2142</span><br><span class="line">2143</span><br><span class="line">2144</span><br><span class="line">2145</span><br><span class="line">2146</span><br><span class="line">2147</span><br><span class="line">2148</span><br><span class="line">2149</span><br><span class="line">2150</span><br><span class="line">2151</span><br><span class="line">2152</span><br><span class="line">2153</span><br><span class="line">2154</span><br><span class="line">2155</span><br><span class="line">2156</span><br><span class="line">2157</span><br><span class="line">2158</span><br><span class="line">2159</span><br><span class="line">2160</span><br><span class="line">2161</span><br><span class="line">2162</span><br><span class="line">2163</span><br><span class="line">2164</span><br><span class="line">2165</span><br><span class="line">2166</span><br><span class="line">2167</span><br><span class="line">2168</span><br><span class="line">2169</span><br><span class="line">2170</span><br><span class="line">2171</span><br><span class="line">2172</span><br><span class="line">2173</span><br><span class="line">2174</span><br><span class="line">2175</span><br><span class="line">2176</span><br><span class="line">2177</span><br><span class="line">2178</span><br><span class="line">2179</span><br><span class="line">2180</span><br><span class="line">2181</span><br><span class="line">2182</span><br><span class="line">2183</span><br><span class="line">2184</span><br><span class="line">2185</span><br><span class="line">2186</span><br><span class="line">2187</span><br><span class="line">2188</span><br><span class="line">2189</span><br><span class="line">2190</span><br><span class="line">2191</span><br><span class="line">2192</span><br><span class="line">2193</span><br><span class="line">2194</span><br><span class="line">2195</span><br><span class="line">2196</span><br><span class="line">2197</span><br><span class="line">2198</span><br><span class="line">2199</span><br><span class="line">2200</span><br><span class="line">2201</span><br><span class="line">2202</span><br><span class="line">2203</span><br><span class="line">2204</span><br><span class="line">2205</span><br><span class="line">2206</span><br><span class="line">2207</span><br><span class="line">2208</span><br><span class="line">2209</span><br><span class="line">2210</span><br><span class="line">2211</span><br><span class="line">2212</span><br><span class="line">2213</span><br><span class="line">2214</span><br><span class="line">2215</span><br><span class="line">2216</span><br><span class="line">2217</span><br><span class="line">2218</span><br><span class="line">2219</span><br><span class="line">2220</span><br><span class="line">2221</span><br><span class="line">2222</span><br><span class="line">2223</span><br><span class="line">2224</span><br><span class="line">2225</span><br><span class="line">2226</span><br><span class="line">2227</span><br><span class="line">2228</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="stata"></span><br><span class="line"><span class="keyword">REPORT</span> zppe008.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">TABLES:</span><br><span class="line">  sscrfields,"选择屏幕-新增按钮</span><br><span class="line"> csap_mbom.</span><br><span class="line"><span class="keyword">TYPE</span>-POOLS: slis.</span><br><span class="line"></span><br><span class="line">TYPES:</span><br><span class="line">  BEGIN OF typ_file,</span><br><span class="line">    col01 <span class="keyword">TYPE</span> char200,                   "删除标记  +</span><br><span class="line">    col02 <span class="keyword">TYPE</span> char200,                   "工厂  +</span><br><span class="line">    col03 <span class="keyword">TYPE</span> char200,                   "主件物料(母件）+</span><br><span class="line">    col04 <span class="keyword">TYPE</span> char200,                   "主物料描述 +</span><br><span class="line">    col05 <span class="keyword">TYPE</span> char200,                   "BOM用途 +</span><br><span class="line">    col06 <span class="keyword">TYPE</span> char200,                   "可选的 BOM  ?</span><br><span class="line">    col07 <span class="keyword">TYPE</span> char200,                   "基准数量</span><br><span class="line">    col08 <span class="keyword">TYPE</span> char200,                   "BOM状态</span><br><span class="line">    col09 <span class="keyword">TYPE</span> char200,                   "项目类别（物料单）</span><br><span class="line">    col10 <span class="keyword">TYPE</span> char200,                   "BOM 项目号</span><br><span class="line">    col11 <span class="keyword">TYPE</span> char200,                   "子物料号</span><br><span class="line">    col12 <span class="keyword">TYPE</span> char200,                   "子物料描述</span><br><span class="line">    col13 <span class="keyword">TYPE</span> char200,                   "数量</span><br><span class="line">    col14 <span class="keyword">TYPE</span> char200,                   "组件计量单位</span><br><span class="line">    col15 <span class="keyword">TYPE</span> char200,                   "BOM行项目文本描述1</span><br><span class="line">    col16 <span class="keyword">TYPE</span> char200,                   "排序字符串</span><br><span class="line">    col17 <span class="keyword">TYPE</span> char200,                   "损耗率</span><br><span class="line"><span class="comment">*    col18 TYPE char200,                   "相关性1</span></span><br><span class="line"><span class="comment">*    col19 TYPE char200,                   "相关性2</span></span><br><span class="line"><span class="comment">*    col20 TYPE char200,                   "相关性3</span></span><br><span class="line"><span class="comment">*    col21 TYPE char200,                   "相关性4</span></span><br><span class="line">    col18 <span class="keyword">TYPE</span> char200,                   "替代项目：组</span><br><span class="line">    col19 <span class="keyword">TYPE</span> char200,                   "优先级</span><br><span class="line">    col20 <span class="keyword">TYPE</span> char200,                   "替代项目：策略</span><br><span class="line">    col21 <span class="keyword">TYPE</span> char200,                   "使用可能性按 % (BTCI)</span><br><span class="line"><span class="comment">*    col22 TYPE char200,                   "替代项目：组</span></span><br><span class="line"><span class="comment">*    col23 TYPE char200,                   "优先级</span></span><br><span class="line"><span class="comment">*    col24 TYPE char200,                   "替代项目：策略</span></span><br><span class="line"><span class="comment">*    col25 TYPE char200,                   "使用可能性按 % (BTCI)</span></span><br><span class="line">    col22 <span class="keyword">TYPE</span> char200,                   "成本标志: 与成本核算相关项目(选填)</span><br><span class="line">    col23 <span class="keyword">TYPE</span> char200,                   "散装物料(选填)</span><br><span class="line"><span class="comment">*    col24 type char200,                   "提前期偏置(非必须，可空着)(选填)</span></span><br><span class="line"><span class="comment">*    col25 type char200,                   "工序提前期偏置(非必须，可空着)(选填)</span></span><br><span class="line">    col24 <span class="keyword">TYPE</span> char200,                   "生产仓库地点(选填)</span><br><span class="line">  END OF typ_file,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* 导入数据</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  BEGIN OF typ_data_in,</span><br><span class="line">    werks       <span class="keyword">TYPE</span> csap_mbom-werks,           "工厂</span><br><span class="line">    matnr       <span class="keyword">TYPE</span> csap_mbom-matnr,           "主件物料(母件）</span><br><span class="line">    stlan       <span class="keyword">TYPE</span> csap_mbom-stlan,           "BOM用途</span><br><span class="line">    stlal       <span class="keyword">TYPE</span> csap_mbom-stlal,           "可选的 BOM</span><br><span class="line">    base_quan   <span class="keyword">TYPE</span> stko_api01-base_quan,      "基准数量</span><br><span class="line">    bom_status  <span class="keyword">TYPE</span> stko_api01-bom_status,     "BOM状态</span><br><span class="line">    item_categ  <span class="keyword">TYPE</span> stpo_api01-item_categ,     "项目类别（物料单）</span><br><span class="line">    item_no     <span class="keyword">TYPE</span> stpo_api01-item_no,        "BOM 项目号</span><br><span class="line">    component   <span class="keyword">TYPE</span> stpo_api01-component,      "子物料号</span><br><span class="line">    comp_qty    <span class="keyword">TYPE</span> stpo_api01-comp_qty,       "数量</span><br><span class="line">    comp_unit   <span class="keyword">TYPE</span> stpo_api01-comp_unit,      "组件计量单位</span><br><span class="line">    item_text1  <span class="keyword">TYPE</span> stpo_api01-item_text1,     "BOM行项目文本描述1</span><br><span class="line">    sortstring  <span class="keyword">TYPE</span> stpo_api01-sortstring,     "排序字符串</span><br><span class="line">    comp_scrap  <span class="keyword">TYPE</span> stpo_api01-comp_scrap,     "损耗率</span><br><span class="line">    dep_intern1 <span class="keyword">TYPE</span> csdep_dat-dep_intern,      "相关性1</span><br><span class="line">    dep_intern2 <span class="keyword">TYPE</span> csdep_dat-dep_intern,      "相关性2</span><br><span class="line">    dep_intern3 <span class="keyword">TYPE</span> csdep_dat-dep_intern,      "相关性3</span><br><span class="line">    dep_intern4 <span class="keyword">TYPE</span> csdep_dat-dep_intern,      "相关性4</span><br><span class="line">    ai_group    <span class="keyword">TYPE</span> stpo_api01-ai_group,       "替代项目：组</span><br><span class="line">    ai_prio     <span class="keyword">TYPE</span> stpo_api01-ai_prio,        "优先级</span><br><span class="line">    ai_strateg  <span class="keyword">TYPE</span> stpo_api01-ai_strateg,     "替代项目：策略</span><br><span class="line">    usage_prob  <span class="keyword">TYPE</span> stpo_api01-usage_prob,     "使用可能性按 % (BTCI)</span><br><span class="line">    rel_cost    <span class="keyword">TYPE</span> stpo_api01-rel_cost,       "成本标志: 与成本核算相关项目</span><br><span class="line">    bulk_mat    <span class="keyword">TYPE</span> stpo_api01-bulk_mat,       "散装物料</span><br><span class="line">    lead_time   <span class="keyword">TYPE</span> stpo_api01-lead_time,      "提前期偏置(非必须，可空着)</span><br><span class="line">    op_lead_tm  <span class="keyword">TYPE</span> stpo_api01-op_lead_tm,     "工序提前期偏置(非必须，可空着)</span><br><span class="line">    issue_loc   <span class="keyword">TYPE</span> stpo_api01-issue_loc,      "生产仓库地点</span><br><span class="line">    maktx1      <span class="keyword">TYPE</span> makt-maktx,                "主物料描述</span><br><span class="line">    maktx2      <span class="keyword">TYPE</span> makt-maktx,                "子物料描述</span><br><span class="line">    flg_del     <span class="keyword">TYPE</span> char1,                     "删除标记 +</span><br><span class="line">  END OF typ_data_in,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* 导出数据</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  BEGIN OF typ_data_out,</span><br><span class="line">    flg_del    <span class="keyword">TYPE</span> char1,                     "删除标记</span><br><span class="line">    werks      <span class="keyword">TYPE</span> csap_mbom-werks,           "工厂</span><br><span class="line">    matnr      <span class="keyword">TYPE</span> csap_mbom-matnr,           "主件物料(母件）</span><br><span class="line">    maktx1     <span class="keyword">TYPE</span> c LENGTH 60,               "主物料描述</span><br><span class="line">    stlan      <span class="keyword">TYPE</span> csap_mbom-stlan,           "BOM用途</span><br><span class="line">    stlal      <span class="keyword">TYPE</span> csap_mbom-stlal,           "可选的 BOM</span><br><span class="line">    base_quan  <span class="keyword">TYPE</span> stko_api01-base_quan,      "基准数量</span><br><span class="line">    bom_status <span class="keyword">TYPE</span> stko_api01-bom_status,     "BOM状态</span><br><span class="line">    item_categ <span class="keyword">TYPE</span> stpo_api01-item_categ,     "项目类别（物料单）</span><br><span class="line">    item_no    <span class="keyword">TYPE</span> stpo_api01-item_no,        "BOM 项目号</span><br><span class="line">    component  <span class="keyword">TYPE</span> stpo_api01-component,      "子物料号</span><br><span class="line">    maktx2     <span class="keyword">TYPE</span> c LENGTH 60,               "子物料描述</span><br><span class="line">    comp_qty   <span class="keyword">TYPE</span> stpo_api01-comp_qty,       "数量</span><br><span class="line">    comp_unit  <span class="keyword">TYPE</span> stpo_api01-comp_unit,      "组件计量单位</span><br><span class="line">    item_text1 <span class="keyword">TYPE</span> stpo_api01-item_text1,     "BOM行项目文本描述1</span><br><span class="line">    sortstring <span class="keyword">TYPE</span> stpo_api01-sortstring,     "排序字符串</span><br><span class="line">    comp_scrap <span class="keyword">TYPE</span> stpo_api01-comp_scrap,     "损耗率</span><br><span class="line"><span class="comment">*    dep_intern1 TYPE csdep_dat-dep_intern,      "相关性1</span></span><br><span class="line"><span class="comment">*    dep_intern2 TYPE csdep_dat-dep_intern,      "相关性2</span></span><br><span class="line"><span class="comment">*    dep_intern3 TYPE csdep_dat-dep_intern,      "相关性3</span></span><br><span class="line"><span class="comment">*    dep_intern4 TYPE csdep_dat-dep_intern,      "相关性4</span></span><br><span class="line">    ai_group   <span class="keyword">TYPE</span> stpo_api01-ai_group,       "替代项目：组</span><br><span class="line">    ai_prio    <span class="keyword">TYPE</span> stpo_api01-ai_prio,        "优先级</span><br><span class="line">    ai_strateg <span class="keyword">TYPE</span> stpo_api01-ai_strateg,     "替代项目：策略</span><br><span class="line">    usage_prob <span class="keyword">TYPE</span> stpo_api01-usage_prob,     "使用可能性按 % (BTCI)</span><br><span class="line">    rel_cost   <span class="keyword">TYPE</span> stpo_api01-rel_cost,       "成本标志: 与成本核算相关项目</span><br><span class="line">    bulk_mat   <span class="keyword">TYPE</span> stpo_api01-bulk_mat,       "散装物料</span><br><span class="line"><span class="comment">*    lead_time   TYPE stpo_api01-lead_time,      "提前期偏置(非必须，可空着)</span></span><br><span class="line"><span class="comment">*    op_lead_tm  TYPE stpo_api01-op_lead_tm,     "工序提前期偏置(非必须，可空着)</span></span><br><span class="line">    issue_loc  <span class="keyword">TYPE</span> stpo_api01-issue_loc,      "生产仓库地点</span><br><span class="line">  END OF typ_data_out,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* alv显示</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  BEGIN OF typ_alv,</span><br><span class="line">    werks   <span class="keyword">TYPE</span> csap_mbom-werks,           "工厂</span><br><span class="line">    matnr   <span class="keyword">TYPE</span> csap_mbom-matnr,           "主件物料(母件）</span><br><span class="line">    stlan   <span class="keyword">TYPE</span> csap_mbom-stlan,           "BOM用途</span><br><span class="line">    stlal   <span class="keyword">TYPE</span> csap_mbom-stlal,           "可选的 BOM</span><br><span class="line">    message <span class="keyword">TYPE</span> char255,                   "信息</span><br><span class="line">    icon_id <span class="keyword">TYPE</span> icon-id,                   "图标</span><br><span class="line">  END OF typ_alv,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* excel表头</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  BEGIN OF typ_fieldnames,</span><br><span class="line">    name <span class="keyword">TYPE</span> char10,                    "标题名称</span><br><span class="line">  END OF typ_fieldnames,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* BOM 链接物料</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  BEGIN OF typ_mast,</span><br><span class="line">    matnr <span class="keyword">TYPE</span> mast-matnr,                "物料编号</span><br><span class="line">    werks <span class="keyword">TYPE</span> mast-werks,                "工厂</span><br><span class="line">    stlan <span class="keyword">TYPE</span> mast-stlan,                "BOM 用途</span><br><span class="line">    stlal <span class="keyword">TYPE</span> mast-stlal,                "可选的 BOM</span><br><span class="line">  END OF typ_mast.</span><br><span class="line"></span><br><span class="line">DATA:</span><br><span class="line">  gt_file     <span class="keyword">TYPE</span> <span class="keyword">TABLE</span> OF typ_file,         "excle文件</span><br><span class="line">  gt_data_in  <span class="keyword">TYPE</span> <span class="keyword">TABLE</span> OF typ_data_in,      "导入数据</span><br><span class="line">  gt_data_out <span class="keyword">TYPE</span> <span class="keyword">TABLE</span> OF typ_data_out,     "导出数据</span><br><span class="line">  gt_alv      <span class="keyword">TYPE</span> <span class="keyword">TABLE</span> OF typ_alv.          "alv信息</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">SELECTION-SCREEN: FUNCTION KEY 1. "激活下载模板按钮</span><br><span class="line"></span><br><span class="line">SELECTION-SCREEN BEGIN OF BLOCK bk3 WITH FRAME TITLE text-003.</span><br><span class="line">PARAMETERS:</span><br><span class="line">  rb_in  <span class="keyword">TYPE</span> c RADIOBUTTON GROUP r2 DEFAULT 'X' USER-COMMAND io,</span><br><span class="line">  rb_out <span class="keyword">TYPE</span> c RADIOBUTTON GROUP r2.</span><br><span class="line">SELECTION-SCREEN END OF BLOCK bk3.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">SELECTION-SCREEN BEGIN OF BLOCK bk1 WITH FRAME TITLE text-001.</span><br><span class="line"></span><br><span class="line">PARAMETERS: p_ufile <span class="keyword">TYPE</span> rlgrap-filename MODIF ID g1</span><br><span class="line">                         DEFAULT 'C:\Users\Administrator\Desktop\BOM创建修改删除模板.XLSX'.</span><br><span class="line"></span><br><span class="line">SELECTION-SCREEN SKIP 1.</span><br><span class="line">PARAMETERS:</span><br><span class="line">  rb_ins <span class="keyword">TYPE</span> c RADIOBUTTON GROUP r1 DEFAULT 'X' USER-COMMAND rb MODIF ID g1,</span><br><span class="line">  rb_upd <span class="keyword">TYPE</span> c RADIOBUTTON GROUP r1 MODIF ID g1,</span><br><span class="line">  rb_del <span class="keyword">TYPE</span> c RADIOBUTTON GROUP r1 MODIF ID g1.</span><br><span class="line"></span><br><span class="line">SELECTION-SCREEN SKIP 1.</span><br><span class="line"><span class="comment">*parameters:</span></span><br><span class="line"><span class="comment">*  cb_stlal type c as checkbox modif id g1.</span></span><br><span class="line">DATA:  cb_stlal <span class="keyword">TYPE</span> c.  "隐藏可选bom按钮</span><br><span class="line"></span><br><span class="line">SELECTION-SCREEN END OF BLOCK bk1.</span><br><span class="line"></span><br><span class="line">SELECTION-SCREEN BEGIN OF BLOCK bk2 WITH FRAME TITLE text-002.</span><br><span class="line"></span><br><span class="line">PARAMETERS: p_dfile <span class="keyword">TYPE</span> rlgrap-filename MODIF ID g2</span><br><span class="line">                         DEFAULT 'C:\Users\Administrator\Desktop\BOM创建修改删除模板.XLS'.</span><br><span class="line">SELECTION-SCREEN SKIP 1.</span><br><span class="line">SELECT-OPTIONS:</span><br><span class="line"> s_werks  <span class="keyword">FOR</span> csap_mbom-werks MODIF ID g2,           "工厂</span><br><span class="line"> s_matnr  <span class="keyword">FOR</span> csap_mbom-matnr MODIF ID g2,           "主件物料(母件）</span><br><span class="line"> s_stlan  <span class="keyword">FOR</span> csap_mbom-stlan MODIF ID g2,           "BOM用途</span><br><span class="line"> s_stlal  <span class="keyword">FOR</span> csap_mbom-stlal MODIF ID g2.           "可选的 BOM</span><br><span class="line"></span><br><span class="line">SELECTION-SCREEN END OF BLOCK bk2.</span><br><span class="line"></span><br><span class="line">INITIALIZATION.</span><br><span class="line"></span><br><span class="line">  sscrfields-functxt_01 = '下载模板'.</span><br><span class="line"></span><br><span class="line">AT SELECTION-SCREEN.</span><br><span class="line"></span><br><span class="line">  CASE sscrfields-ucomm.</span><br><span class="line">    WHEN 'FC01'."下载模板</span><br><span class="line">      PERFORM frm_download_template.</span><br><span class="line">    WHEN OTHERS.</span><br><span class="line">  ENDCASE.</span><br><span class="line"></span><br><span class="line">AT SELECTION-SCREEN OUTPUT.</span><br><span class="line"></span><br><span class="line">  PERFORM frm_modify_screen.</span><br><span class="line"></span><br><span class="line">AT SELECTION-SCREEN <span class="keyword">ON</span> VALUE-REQUEST <span class="keyword">FOR</span> p_ufile.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* 文件路径的help</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  PERFORM get_filepath USING p_ufile.</span><br><span class="line"></span><br><span class="line">AT SELECTION-SCREEN <span class="keyword">ON</span> VALUE-REQUEST <span class="keyword">FOR</span> p_dfile.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* 文件路径的help</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  PERFORM get_filepath USING p_dfile.</span><br><span class="line"></span><br><span class="line">START-OF-SELECTION.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* 导入数据</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> rb_in = 'X'.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*   导入数据的取得</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    PERFORM frm_get_data_in.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*   BAPI执行</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    PERFORM frm_bapi_bom.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*   展示alv信息</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    PERFORM frm_alv_output.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* 导出数据</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*   导出数据的取得</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    PERFORM frm_get_data_out.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*   展示EXCEL</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    PERFORM frm_excel_output.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  FRM_DOWNLOAD_TEMPLATE</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       下载模板</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*  --&gt;  p1        text</span></span><br><span class="line"><span class="comment">*  &lt;--  p2        text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">FORM</span> frm_download_template .</span><br><span class="line"></span><br><span class="line">  DATA:</span><br><span class="line">    ls_object     <span class="keyword">TYPE</span> wwwdatatab,</span><br><span class="line">    l_filename    <span class="keyword">TYPE</span> string,</span><br><span class="line">    l_path        <span class="keyword">TYPE</span> string,</span><br><span class="line">    l_fullpath    <span class="keyword">TYPE</span> string,</span><br><span class="line">    l_title       <span class="keyword">TYPE</span> string,</span><br><span class="line">    l_destination <span class="keyword">TYPE</span> rlgrap-filename.</span><br><span class="line"></span><br><span class="line">  SELECT SINGLE *</span><br><span class="line">    FROM wwwdata</span><br><span class="line">    INTO CORRESPONDING FIELDS OF ls_object</span><br><span class="line">   WHERE objid = 'ZPPE008'.    "smw0里对象名称</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line"></span><br><span class="line">    MESSAGE 'smw0里对象名称没有找到' <span class="keyword">TYPE</span> '<span class="keyword">E</span>'.</span><br><span class="line"></span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">  l_title = ls_object-text.            "WWWDATA 对象的短文本</span><br><span class="line"></span><br><span class="line">  CALL METHOD cl_gui_frontend_services=&gt;file_save_dialog</span><br><span class="line">    EXPORTING</span><br><span class="line">      window_title      = '模板下载'</span><br><span class="line">      default_extension = 'xls'</span><br><span class="line">      default_file_name = l_title</span><br><span class="line">      file_filter       = 'EXCEL(*.xls)|*.xls*'</span><br><span class="line">    CHANGING</span><br><span class="line">      filename          = l_filename</span><br><span class="line">      path              = l_path</span><br><span class="line">      fullpath          = l_fullpath</span><br><span class="line">    EXCEPTIONS</span><br><span class="line">      cntl_error        = 1</span><br><span class="line">      error_no_gui      = 2</span><br><span class="line">      OTHERS            = 3.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> l_fullpath IS NOT INITIAL.</span><br><span class="line"></span><br><span class="line">    l_destination = l_fullpath.</span><br><span class="line"></span><br><span class="line">    CALL FUNCTION 'DOWNLOAD_WEB_OBJECT'</span><br><span class="line">      EXPORTING</span><br><span class="line">        key         = ls_object</span><br><span class="line">        destination = l_destination.</span><br><span class="line"></span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  GET_FILEPATH</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       文件路径的help</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*      --&gt;P_P_UFILE  text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">FORM</span> get_filepath USING i_file.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* Data for open dialog</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  DATA: l_filetab <span class="keyword">TYPE</span> filetable,</span><br><span class="line">        l_rc      <span class="keyword">TYPE</span> i.</span><br><span class="line">  <span class="keyword">CLEAR</span> l_filetab.</span><br><span class="line">  REFRESH l_filetab.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* Open dialog</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  CALL METHOD cl_gui_frontend_services=&gt;file_open_dialog</span><br><span class="line">    EXPORTING</span><br><span class="line"><span class="comment">*     WINDOW_TITLE         = 'SAP Custom - Open File'</span></span><br><span class="line"><span class="comment">*     DEFAULT_EXTENSION    =</span></span><br><span class="line">      default_filename     = '*.xls'</span><br><span class="line"><span class="comment">*     FILE_FILTER          = '*.xls'</span></span><br><span class="line">      initial_directory    = 'c:\'</span><br><span class="line">      multiselection       = ''</span><br><span class="line">    CHANGING</span><br><span class="line">      file_table           = l_filetab</span><br><span class="line">      rc                   = l_rc</span><br><span class="line">    EXCEPTIONS</span><br><span class="line">      cntl_error           = 1</span><br><span class="line">      error_no_gui         = 2</span><br><span class="line">      not_supported_by_gui = 3</span><br><span class="line">      OTHERS               = 4.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* Get file path</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  CHECK l_rc <span class="keyword">EQ</span> 1.</span><br><span class="line">  <span class="keyword">READ</span> <span class="keyword">TABLE</span> l_filetab INDEX 1 INTO i_file.</span><br><span class="line"></span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  FRM_GET_DATA_IN</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       导入数据的取得</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*  --&gt;  p1        text</span></span><br><span class="line"><span class="comment">*  &lt;--  p2        text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">FORM</span> frm_get_data_in .</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* 从excel中得到数据</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  PERFORM frm_xls_to_sap.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* 导入数据的编辑检查</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  PERFORM frm_edit_file.</span><br><span class="line"></span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  FRM_BAPI_BOM</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       BAPI执行</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*  --&gt;  p1        text</span></span><br><span class="line"><span class="comment">*  &lt;--  p2        text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">FORM</span> frm_bapi_bom .</span><br><span class="line"></span><br><span class="line">  CASE 'X'.</span><br><span class="line">    WHEN rb_ins.   "创建BOM</span><br><span class="line">      PERFORM frm_bapi_bom_ins.</span><br><span class="line">    WHEN rb_upd.   "修改删除BOM行项目</span><br><span class="line">      PERFORM frm_bapi_bom_upd.</span><br><span class="line">    WHEN rb_del.   "删除BOM</span><br><span class="line">      PERFORM frm_bapi_bom_del.</span><br><span class="line">    WHEN OTHERS.</span><br><span class="line">  ENDCASE.</span><br><span class="line"></span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  FRM_XLS_TO_SAP</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       从excel中得到数据</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*  --&gt;  p1        text</span></span><br><span class="line"><span class="comment">*  &lt;--  p2        text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">FORM</span> frm_xls_to_sap .</span><br><span class="line"></span><br><span class="line">  DATA:</span><br><span class="line">    lt_raw_data <span class="keyword">TYPE</span> truxs_t_text_data.</span><br><span class="line"></span><br><span class="line">  CALL FUNCTION 'TEXT_CONVERT_XLS_TO_SAP'</span><br><span class="line">    EXPORTING</span><br><span class="line">      i_tab_raw_data       = lt_raw_data</span><br><span class="line">      i_filename           = p_ufile</span><br><span class="line">    TABLES</span><br><span class="line">      i_tab_converted_data = gt_file</span><br><span class="line">    EXCEPTIONS</span><br><span class="line">      conversion_failed    = 1</span><br><span class="line">      OTHERS               = 2.</span><br><span class="line">  <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line">    MESSAGE ID sy-msgid <span class="keyword">TYPE</span> 'S' NUMBER sy-msgno</span><br><span class="line">    WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4 <span class="keyword">DISPLAY</span> LIKE '<span class="keyword">E</span>'.</span><br><span class="line"></span><br><span class="line">    LEAVE <span class="keyword">LIST</span>-PROCESSING.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  FRM_EDIT_FILE</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       导入数据的编辑检查</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*  --&gt;  p1        text</span></span><br><span class="line"><span class="comment">*  &lt;--  p2        text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">FORM</span> frm_edit_file .</span><br><span class="line"></span><br><span class="line">  DATA:</span><br><span class="line">    ls_file     LIKE <span class="keyword">LINE</span> OF gt_file,</span><br><span class="line">    ls_data     LIKE <span class="keyword">LINE</span> OF gt_data_in,</span><br><span class="line">    ls_data_bak LIKE <span class="keyword">LINE</span> OF gt_data_in,</span><br><span class="line">    l_line      <span class="keyword">TYPE</span>         i,</span><br><span class="line">    l_message   <span class="keyword">TYPE</span>         char255.                  "ALV信息</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* 创建时从第三行</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> rb_ins = 'X'.</span><br><span class="line">    l_line = 3.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* 修改删除时从第二行</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line">    l_line = 3.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* 得到数据</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  LOOP AT gt_file INTO ls_file FROM l_line.</span><br><span class="line">    <span class="keyword">CLEAR</span>:</span><br><span class="line">      ls_data.</span><br><span class="line"></span><br><span class="line">    ls_data-flg_del          = ls_file-col01.    "删除标记</span><br><span class="line">    ls_data-werks            = ls_file-col02.    "工厂</span><br><span class="line">    ls_data-matnr            = ls_file-col03.    "主件物料(母件）</span><br><span class="line">    ls_data-maktx1           = ls_file-col04.    "主物料描述</span><br><span class="line">    ls_data-stlan            = ls_file-col05.    "BOM用途</span><br><span class="line">    ls_data-stlal            = ls_file-col06.    "可选的 BOM</span><br><span class="line">    ls_data-base_quan        = ls_file-col07.    "基准数量</span><br><span class="line">    ls_data-bom_status       = ls_file-col08.    "BOM状态</span><br><span class="line">    ls_data-item_categ       = ls_file-col09.    "项目类别（物料单）</span><br><span class="line">    ls_data-item_no          = ls_file-col10.    "BOM 项目号</span><br><span class="line">    ls_data-component        = ls_file-col11.    "子物料号</span><br><span class="line">    ls_data-maktx2           = ls_file-col12.    "子物料描述</span><br><span class="line">    ls_data-comp_qty         = ls_file-col13.    "数量</span><br><span class="line">    ls_data-comp_unit        = ls_file-col14.    "组件计量单位</span><br><span class="line">    ls_data-item_text1       = ls_file-col15.    "BOM行项目文本描述1</span><br><span class="line">    ls_data-sortstring       = ls_file-col16.    "排序字符串</span><br><span class="line">    ls_data-comp_scrap       = ls_file-col17.    "损耗率</span><br><span class="line"><span class="comment">*    ls_data-dep_intern1      = ls_file-col18.    "相关性1</span></span><br><span class="line"><span class="comment">*    ls_data-dep_intern2      = ls_file-col19.    "相关性2</span></span><br><span class="line"><span class="comment">*    ls_data-dep_intern3      = ls_file-col20.    "相关性3</span></span><br><span class="line"><span class="comment">*    ls_data-dep_intern4      = ls_file-col21.    "相关性4</span></span><br><span class="line">    ls_data-ai_group         = ls_file-col18.    "替代项目：组</span><br><span class="line">    ls_data-ai_prio          = ls_file-col19.    "优先级</span><br><span class="line">    ls_data-ai_strateg       = ls_file-col20.    "替代项目：策略</span><br><span class="line">    ls_data-usage_prob       = ls_file-col21.    "使用可能性按 % (BTCI)</span><br><span class="line">    <span class="keyword">IF</span> ls_file-col22 <span class="keyword">EQ</span> '<span class="keyword">N</span>'.</span><br><span class="line">      ls_data-rel_cost         = ''.    "成本标志: 与成本核算相关项目</span><br><span class="line">    <span class="keyword">ELSE</span>.</span><br><span class="line">      ls_data-rel_cost         = 'X'.    "成本标志: 与成本核算相关项目</span><br><span class="line">    ENDIF.</span><br><span class="line">    "ls_data-rel_cost         = ls_file-col22.</span><br><span class="line">    ls_data-bulk_mat         = ls_file-col23.    "散装物料</span><br><span class="line"><span class="comment">*    ls_data-lead_time        = ls_file-col24.    "提前期偏置(非必须，可空着)</span></span><br><span class="line"><span class="comment">*    ls_data-op_lead_tm       = ls_file-col25.    "工序提前期偏置(非必须，可空着)</span></span><br><span class="line">    ls_data-issue_loc        = ls_file-col24.    "生产仓库地点</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*   主件物料(母件）</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    CALL FUNCTION 'CONVERSION_EXIT_MATN2_INPUT'</span><br><span class="line">      EXPORTING</span><br><span class="line">        <span class="keyword">input</span>            = ls_data-matnr</span><br><span class="line">      IMPORTING</span><br><span class="line">        output           = ls_data-matnr</span><br><span class="line">      EXCEPTIONS</span><br><span class="line">        number_not_found = 0</span><br><span class="line">        length_error     = 0</span><br><span class="line">        OTHERS           = 0.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*   子物料号</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    CALL FUNCTION 'CONVERSION_EXIT_MATN2_INPUT'</span><br><span class="line">      EXPORTING</span><br><span class="line">        <span class="keyword">input</span>            = ls_data-component</span><br><span class="line">      IMPORTING</span><br><span class="line">        output           = ls_data-component</span><br><span class="line">      EXCEPTIONS</span><br><span class="line">        number_not_found = 0</span><br><span class="line">        length_error     = 0</span><br><span class="line">        OTHERS           = 0.</span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*     SELECT SINGLE COUNT(*)</span></span><br><span class="line"><span class="comment">*       FROM ZEPP008_1</span></span><br><span class="line"><span class="comment">*       WHERE BNAME   = SY-UNAME</span></span><br><span class="line"><span class="comment">*        AND  WERKS   = LS_DATA-WERKS</span></span><br><span class="line"><span class="comment">*        AND  ZCHANGE = 'X'.</span></span><br><span class="line">    sy-subrc = 0."新增此行，跳过上一行程序的执行</span><br><span class="line">    <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line">      <span class="keyword">APPEND</span> ls_data TO gt_data_in.</span><br><span class="line">    <span class="keyword">ELSE</span>.</span><br><span class="line">      l_message = '没有该工厂的权限'.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*     alv数据的编辑</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      PERFORM frm_edit_alv USING ls_data-werks</span><br><span class="line">                                  ' '</span><br><span class="line">                                  ' '</span><br><span class="line">                                  ' '</span><br><span class="line">                                  l_message</span><br><span class="line">                                  icon_cancel.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line">  ENDLOOP.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">SORT</span> gt_data_in <span class="keyword">BY</span> werks matnr stlan stlal item_no.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">SORT</span> gt_alv <span class="keyword">BY</span> werks ASCENDING.</span><br><span class="line">  DELETE ADJACENT <span class="keyword">DUPLICATES</span> FROM gt_alv COMPARING werks.</span><br><span class="line"></span><br><span class="line">  LOOP AT gt_data_in INTO ls_data.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">IF</span> sy-tabix &lt;&gt; 1.</span><br><span class="line">      <span class="keyword">IF</span> cb_stlal = 'X'.</span><br><span class="line">        <span class="keyword">IF</span> ls_data-werks   = ls_data_bak-werks AND</span><br><span class="line">           ls_data-matnr   = ls_data_bak-matnr AND</span><br><span class="line">           ls_data-stlan   = ls_data_bak-stlan AND</span><br><span class="line">           ls_data-stlal   = ls_data_bak-stlal AND</span><br><span class="line">           ls_data-item_no = ls_data_bak-item_no.</span><br><span class="line"></span><br><span class="line">          l_message = 'BOM项目号重复'.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*         alv数据的编辑</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">          PERFORM frm_edit_alv USING ls_data-werks</span><br><span class="line">                                      ls_data-matnr</span><br><span class="line">                                      ls_data-stlan</span><br><span class="line">                                      ls_data-stlal</span><br><span class="line">                                      l_message</span><br><span class="line">                                      icon_cancel.</span><br><span class="line"></span><br><span class="line">          DELETE gt_data_in WHERE werks = ls_data-werks</span><br><span class="line">                             AND  matnr = ls_data-matnr</span><br><span class="line">                             AND  stlan = ls_data-stlan</span><br><span class="line">                             AND  stlal = ls_data-stlal.</span><br><span class="line">        ENDIF.</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line">        <span class="keyword">IF</span> ls_data-werks   = ls_data_bak-werks AND</span><br><span class="line">           ls_data-matnr   = ls_data_bak-matnr AND</span><br><span class="line">           ls_data-stlan   = ls_data_bak-stlan AND</span><br><span class="line">           ls_data-item_no = ls_data_bak-item_no.</span><br><span class="line"></span><br><span class="line">          l_message = 'BOM项目号重复'.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*         alv数据的编辑</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">          PERFORM frm_edit_alv USING ls_data-werks</span><br><span class="line">                                      ls_data-matnr</span><br><span class="line">                                      ls_data-stlan</span><br><span class="line">                                      ls_data-stlal</span><br><span class="line">                                      l_message</span><br><span class="line">                                      icon_cancel.</span><br><span class="line"></span><br><span class="line">          DELETE gt_data_in WHERE werks = ls_data-werks</span><br><span class="line">                             AND  matnr = ls_data-matnr</span><br><span class="line">                             AND  stlan = ls_data-stlan</span><br><span class="line">                             AND  stlal = ls_data-stlal.</span><br><span class="line">        ENDIF.</span><br><span class="line">      ENDIF.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line">    ls_data_bak = ls_data.</span><br><span class="line"></span><br><span class="line">  ENDLOOP.</span><br><span class="line"></span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  FRM_ALV_OUTPUT</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       展示alv信息</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*  --&gt;  p1        text</span></span><br><span class="line"><span class="comment">*  &lt;--  p2        text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">FORM</span> frm_alv_output .</span><br><span class="line"></span><br><span class="line">  DATA:</span><br><span class="line">    lt_fieldcat <span class="keyword">TYPE</span> slis_t_fieldcat_alv,</span><br><span class="line">    ls_filedcat <span class="keyword">TYPE</span> slis_fieldcat_alv,</span><br><span class="line">    ls_layout   <span class="keyword">TYPE</span> slis_layout_alv.</span><br><span class="line"></span><br><span class="line">  ls_layout-colwidth_optimize = 'X'.</span><br><span class="line">  ls_layout-zebra             = 'X'.</span><br><span class="line"></span><br><span class="line">  DEFINE d_filedcat.</span><br><span class="line">    ls_filedcat-fieldname = &amp;1.</span><br><span class="line">    ls_filedcat-seltext_l = &amp;2.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">IF</span> &amp;1 = 'ICON_ID'.</span><br><span class="line">      ls_filedcat-icon = 'X'.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">APPEND</span> ls_filedcat TO lt_fieldcat.</span><br><span class="line">    <span class="keyword">CLEAR</span> ls_filedcat.</span><br><span class="line">  END-OF-DEFINITION.</span><br><span class="line"></span><br><span class="line">  d_filedcat: 'WERKS'     '工厂' ,</span><br><span class="line">              'MATNR'     '主件物料(母件）' ,</span><br><span class="line">              'STLAN'     'BOM 用途'  ,</span><br><span class="line">              'STLAL'     '可选的 BOM'  ,</span><br><span class="line">              'MESSAGE'   '信息'      ,</span><br><span class="line">              'ICON_ID'   '提示'  .</span><br><span class="line"></span><br><span class="line">  CALL FUNCTION 'REUSE_ALV_GRID_DISPLAY'</span><br><span class="line">    EXPORTING</span><br><span class="line">      i_callback_program = sy-repid</span><br><span class="line"><span class="comment">*     I_CALLBACK_PF_STATUS_SET          = 'FRM_PF_STATUS_SET'</span></span><br><span class="line"><span class="comment">*     I_CALLBACK_USER_COMMAND           = 'FRM_USER_COMMAND'</span></span><br><span class="line">      is_layout          = ls_layout</span><br><span class="line">      it_fieldcat        = lt_fieldcat</span><br><span class="line">      i_save             = 'A'</span><br><span class="line">    TABLES</span><br><span class="line">      t_outtab           = gt_alv</span><br><span class="line">    EXCEPTIONS</span><br><span class="line">      program_error      = 1</span><br><span class="line">      OTHERS             = 2.</span><br><span class="line">  <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* Implement suitable error handling here</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  FRM_EDIT_ALV</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       alv数据的编辑</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*      --&gt;P_LS_DATA_WERKS  text</span></span><br><span class="line"><span class="comment">*      --&gt;P_LS_DATA_MATNR  text</span></span><br><span class="line"><span class="comment">*      --&gt;P_LS_DATA_STLAN  text</span></span><br><span class="line"><span class="comment">*      --&gt;P_LS_DATA_STLAL  text</span></span><br><span class="line"><span class="comment">*      --&gt;P_L_MESSAGE  text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">FORM</span> frm_edit_alv USING i_werks <span class="keyword">TYPE</span> csap_mbom-werks</span><br><span class="line">                             i_matnr   <span class="keyword">TYPE</span> csap_mbom-matnr</span><br><span class="line">                             i_stlan   <span class="keyword">TYPE</span> csap_mbom-stlan</span><br><span class="line">                             i_stlal   <span class="keyword">TYPE</span> csap_mbom-stlal</span><br><span class="line">                             i_message <span class="keyword">TYPE</span> char255</span><br><span class="line">                             i_icon_id <span class="keyword">TYPE</span> icon-id.</span><br><span class="line"></span><br><span class="line">  DATA:</span><br><span class="line">    ls_alv <span class="keyword">TYPE</span> typ_alv.</span><br><span class="line"></span><br><span class="line">  CALL FUNCTION 'CONVERSION_EXIT_MATN2_OUTPUT'</span><br><span class="line">    EXPORTING</span><br><span class="line">      <span class="keyword">input</span>  = i_matnr</span><br><span class="line">    IMPORTING</span><br><span class="line">      output = ls_alv-matnr.</span><br><span class="line"></span><br><span class="line">  ls_alv-werks    = i_werks.</span><br><span class="line">  ls_alv-stlan    = i_stlan.</span><br><span class="line">  ls_alv-stlal    = i_stlal.</span><br><span class="line">  ls_alv-message  = i_message.</span><br><span class="line">  ls_alv-icon_id  = i_icon_id.</span><br><span class="line">  <span class="keyword">APPEND</span> ls_alv TO gt_alv.</span><br><span class="line"></span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  FRM_BAPI_BOM_INS</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       创建BOM</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*  --&gt;  p1        text</span></span><br><span class="line"><span class="comment">*  &lt;--  p2        text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">FORM</span> frm_bapi_bom_ins .</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> cb_stlal &lt;&gt; 'X'.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*   可选BOM单一</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    PERFORM frm_bapi_bom_ins_bapi.</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*   可选BOM多个（创建可选的bom 抬头）</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    PERFORM frm_bapi_bom_ins_bdc.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*   修改BOM(明细行项目的追加)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    PERFORM frm_bapi_bom_upd_item.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  FRM_BAPI_BOM_UPD</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       修改BOM</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">FORM</span> frm_bapi_bom_upd .</span><br><span class="line"></span><br><span class="line">  DATA:</span><br><span class="line">    ls_tmp      LIKE <span class="keyword">LINE</span> OF  gt_data_in,</span><br><span class="line">    ls_data     LIKE <span class="keyword">LINE</span> OF  gt_data_in,</span><br><span class="line">    lt_stpo     <span class="keyword">TYPE</span> <span class="keyword">TABLE</span> OF stpo_api03,      "BOM 项目的 API 结构：ALL ＋标识的字段</span><br><span class="line">    ls_stpo     LIKE <span class="keyword">LINE</span> OF  lt_stpo,</span><br><span class="line">    lt_dep_data <span class="keyword">TYPE</span> <span class="keyword">TABLE</span> OF csdep_dat,       "BOMs：相关性的基本数据</span><br><span class="line">    ls_dep_data LIKE <span class="keyword">LINE</span> OF  lt_dep_data,</span><br><span class="line">    l_message   <span class="keyword">TYPE</span>          char255,                  "ALV信息</span><br><span class="line">    l_originno  <span class="keyword">TYPE</span>          i,</span><br><span class="line">    ls_stko     <span class="keyword">TYPE</span>          stko_api01.               "API BOM 表头结构：可以被更改的字段</span><br><span class="line"></span><br><span class="line">  DATA:</span><br><span class="line">    l_valid_from    <span class="keyword">TYPE</span> csap_mbom-datuv,</span><br><span class="line">    lt_stpo_sel     LIKE stpo_api02 OCCURS 0 WITH HEADER <span class="keyword">LINE</span>, "BOM 项目的 API 结构：能被修改的字段</span><br><span class="line">    lt_dep_data_sel LIKE csdep_dat  OCCURS 0 WITH HEADER <span class="keyword">LINE</span>. "BOMs：相关性的基本数据</span><br><span class="line"></span><br><span class="line">  LOOP AT gt_data_in INTO ls_tmp.</span><br><span class="line"><span class="comment">*        ls_stpo-rel_cost   = ls_data-rel_cost.       "标识：与成本核算相关的项目</span></span><br><span class="line"><span class="comment">*        ls_stpo-bulk_mat   = ls_data-bulk_mat.       "标识：散装物料</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">CLEAR</span>:</span><br><span class="line">      ls_data,</span><br><span class="line">      ls_stpo,</span><br><span class="line">      ls_dep_data.</span><br><span class="line"></span><br><span class="line">    ls_data = ls_tmp.</span><br><span class="line">    <span class="keyword">IF</span>  ls_data-rel_cost = 'X' AND ls_data-bulk_mat = 'X'.</span><br><span class="line">      MESSAGE s001(00) WITH ls_data-component '成本核算相关的项目为空，散装物料为X属于非法情况' <span class="keyword">DISPLAY</span> LIKE '<span class="keyword">E</span>'.</span><br><span class="line">      <span class="keyword">RETURN</span>.</span><br><span class="line">    ENDIF.</span><br><span class="line">    <span class="keyword">IF</span>  ls_data-rel_cost = space  AND ls_data-bulk_mat = space.</span><br><span class="line">      MESSAGE s001(00) WITH ls_data-component '成本核算相关的项目为<span class="keyword">N</span>，散装物料为空属于非法情况' <span class="keyword">DISPLAY</span> LIKE '<span class="keyword">E</span>'.</span><br><span class="line">      <span class="keyword">RETURN</span>.</span><br><span class="line">    ENDIF.</span><br><span class="line">    AT NEW stlal.</span><br><span class="line">      REFRESH:</span><br><span class="line">        lt_stpo,</span><br><span class="line">        lt_dep_data,</span><br><span class="line">        lt_stpo_sel.</span><br><span class="line">      <span class="keyword">CLEAR</span>:</span><br><span class="line">        l_message,</span><br><span class="line">        l_valid_from,</span><br><span class="line">        l_originno,</span><br><span class="line">        ls_stko.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*     日期:转换</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      CALL FUNCTION 'CONVERT_DATE_TO_EXTERNAL'</span><br><span class="line">        EXPORTING</span><br><span class="line">          date_internal            = sy-datum</span><br><span class="line">        IMPORTING</span><br><span class="line">          date_external            = l_valid_from</span><br><span class="line">        EXCEPTIONS</span><br><span class="line">          date_internal_is_invalid = 1</span><br><span class="line">          OTHERS                   = 2.</span><br><span class="line">      <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* Implement suitable error handling here</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*     得到最新的BOM 行项目</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      CALL FUNCTION 'CSAP_MAT_BOM_OPEN'</span><br><span class="line">        EXPORTING</span><br><span class="line">          material    = ls_data-matnr     "主件物料(母件）</span><br><span class="line">          plant       = ls_data-werks     "工厂</span><br><span class="line">          bom_usage   = ls_data-stlan     "BOM用途</span><br><span class="line">          alternative = ls_data-stlal     "可选的 BOM</span><br><span class="line">          valid_from  = l_valid_from</span><br><span class="line"><span class="comment">*         CHANGE_NO   =</span></span><br><span class="line"><span class="comment">*         REVISION_LEVEL         =</span></span><br><span class="line"><span class="comment">*         FL_NO_CHANGE_DOC       = ' '</span></span><br><span class="line"><span class="comment">*        IMPORTING</span></span><br><span class="line"><span class="comment">*         O_STKO      =</span></span><br><span class="line"><span class="comment">*         FL_WARNING  =</span></span><br><span class="line">        TABLES</span><br><span class="line">          t_stpo      = lt_stpo_sel</span><br><span class="line">          t_dep_data  = lt_dep_data_sel</span><br><span class="line"><span class="comment">*         T_DEP_DESCR =</span></span><br><span class="line"><span class="comment">*         T_DEP_ORDER =</span></span><br><span class="line"><span class="comment">*         T_DEP_SOURCE           =</span></span><br><span class="line"><span class="comment">*         T_DEP_DOC   =</span></span><br><span class="line">        EXCEPTIONS</span><br><span class="line">          <span class="keyword">error</span>       = 1</span><br><span class="line">          OTHERS      = 2.</span><br><span class="line">      <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* Implement suitable error handling here</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line">      LOOP AT lt_stpo_sel.</span><br><span class="line">        CALL FUNCTION 'CONVERSION_EXIT_MATN2_INPUT'</span><br><span class="line">          EXPORTING</span><br><span class="line">            <span class="keyword">input</span>  = lt_stpo_sel-component</span><br><span class="line">          IMPORTING</span><br><span class="line">            output = lt_stpo_sel-component.</span><br><span class="line">        MODIFY lt_stpo_sel TRANSPORTING component.</span><br><span class="line">      ENDLOOP.</span><br><span class="line">    ENDAT.</span><br><span class="line"></span><br><span class="line">    l_originno = l_originno + 1.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">READ</span> <span class="keyword">TABLE</span> lt_stpo_sel WITH KEY item_no   = ls_data-item_no</span><br><span class="line">                                    component = ls_data-component.</span><br><span class="line">    <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*     删除标记是X</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      <span class="keyword">IF</span> ls_data-flg_del = 'X'.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*       BOM 项目的 API 结构：能被修改的字段</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        ls_stpo-fldelete   = 'X'.                    "删除标识</span><br><span class="line">        ls_stpo-bom_no     = lt_stpo_sel-bom_no.     "物料单</span><br><span class="line">        ls_stpo-item_node  = lt_stpo_sel-item_node.  "BOM 项目节点号</span><br><span class="line">        ls_stpo-item_count = lt_stpo_sel-item_count. "内部计数器</span><br><span class="line">        ls_stpo-item_categ = ls_data-item_categ  .   "项目类别（物料单）</span><br><span class="line">        ls_stpo-item_no    = ls_data-item_no  .      "BOM 项目号</span><br><span class="line">        ls_stpo-component  = ls_data-component.      "BOM 组件</span><br><span class="line">        <span class="keyword">APPEND</span> ls_stpo TO lt_stpo.</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*       BOM 项目的 API 结构：能被修改的字段</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        ls_stpo-fldelete   = ' '.                    "删除标识</span><br><span class="line">        ls_stpo-bom_no     = lt_stpo_sel-bom_no.     "物料单</span><br><span class="line">        ls_stpo-item_node  = lt_stpo_sel-item_node.  "BOM 项目节点号</span><br><span class="line">        ls_stpo-item_count = lt_stpo_sel-item_count. "内部计数器</span><br><span class="line"></span><br><span class="line">        ls_stpo-item_categ = ls_data-item_categ  .   "项目类别（物料单）</span><br><span class="line">        ls_stpo-item_no    = ls_data-item_no  .      "BOM 项目号</span><br><span class="line">        ls_stpo-component  = ls_data-component.      "BOM 组件</span><br><span class="line">        ls_stpo-comp_qty   = ls_data-comp_qty.       "组件数量 (BTCI)</span><br><span class="line">        ls_stpo-comp_unit  = ls_data-comp_unit.      "组件计量单位</span><br><span class="line">        ls_stpo-item_text1 = ls_data-item_text1.     "BOM 项目文本（行1）</span><br><span class="line">        ls_stpo-sortstring = ls_data-sortstring.     "排序字符串</span><br><span class="line">        ls_stpo-comp_scrap = ls_data-comp_scrap.     "部件废品用百分比表示(BTCI)</span><br><span class="line">        ls_stpo-ai_group   = ls_data-ai_group.       "替代项目：组</span><br><span class="line">        ls_stpo-ai_prio    = ls_data-ai_prio.        "备选项目：优先级</span><br><span class="line">        ls_stpo-ai_strateg = ls_data-ai_strateg.     "替代项目：策略</span><br><span class="line">        ls_stpo-usage_prob = ls_data-usage_prob.     "使用可能性按 % (BTCI)</span><br><span class="line">        ls_stpo-rel_cost   = ls_data-rel_cost.       "标识：与成本核算相关的项目</span><br><span class="line">        ls_stpo-bulk_mat   = ls_data-bulk_mat.       "标识：散装物料</span><br><span class="line">        ls_stpo-lead_time  = ls_data-lead_time.      "跟踪时间（批输入）</span><br><span class="line">        ls_stpo-op_lead_tm = ls_data-op_lead_tm.     "工序(BTCI)引导时间偏移</span><br><span class="line">        ls_stpo-issue_loc  = ls_data-issue_loc.      "生产订单的发货地点</span><br><span class="line">        ls_stpo-identifier = l_originno.             "特定客户的 APIs 对象标识符</span><br><span class="line">        <span class="keyword">IF</span> ls_stpo-bulk_mat IS NOT INITIAL.</span><br><span class="line">          ls_stpo-rel_prod = 'X'.             "特定客户的 APIs 对象标识符</span><br><span class="line">        ENDIF.</span><br><span class="line">        <span class="keyword">APPEND</span> ls_stpo TO lt_stpo.</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">ELSE</span>.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*     BOM 项目的 API 结构：能被修改的字段</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      ls_stpo-fldelete   = ' '.                    "删除标识</span><br><span class="line"></span><br><span class="line">      ls_stpo-item_categ = ls_data-item_categ  .   "项目类别（物料单）</span><br><span class="line">      ls_stpo-item_no    = ls_data-item_no  .      "BOM 项目号</span><br><span class="line">      ls_stpo-component  = ls_data-component.      "BOM 组件</span><br><span class="line">      ls_stpo-comp_qty   = ls_data-comp_qty.       "组件数量 (BTCI)</span><br><span class="line">      ls_stpo-comp_unit  = ls_data-comp_unit.      "组件计量单位</span><br><span class="line">      ls_stpo-item_text1 = ls_data-item_text1.     "BOM 项目文本（行1）</span><br><span class="line">      ls_stpo-sortstring = ls_data-sortstring.     "排序字符串</span><br><span class="line">      ls_stpo-comp_scrap = ls_data-comp_scrap.     "部件废品用百分比表示(BTCI)</span><br><span class="line">      ls_stpo-ai_group   = ls_data-ai_group.       "替代项目：组</span><br><span class="line">      ls_stpo-ai_prio    = ls_data-ai_prio.        "备选项目：优先级</span><br><span class="line">      ls_stpo-ai_strateg = ls_data-ai_strateg.     "替代项目：策略</span><br><span class="line">      ls_stpo-usage_prob = ls_data-usage_prob.     "使用可能性按 % (BTCI)</span><br><span class="line">      ls_stpo-rel_cost   = ls_data-rel_cost.       "标识：与成本核算相关的项目</span><br><span class="line">      ls_stpo-bulk_mat   = ls_data-bulk_mat.       "标识：散装物料</span><br><span class="line">      ls_stpo-lead_time  = ls_data-lead_time.      "跟踪时间（批输入）</span><br><span class="line">      ls_stpo-op_lead_tm = ls_data-op_lead_tm.     "工序(BTCI)引导时间偏移</span><br><span class="line">      ls_stpo-issue_loc  = ls_data-issue_loc.      "生产订单的发货地点</span><br><span class="line">      ls_stpo-identifier = l_originno.             "特定客户的 APIs 对象标识符</span><br><span class="line">      <span class="keyword">APPEND</span> ls_stpo TO lt_stpo.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*   BOMs：相关性的基本数据</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    LOOP AT lt_dep_data_sel WHERE bom_no     = lt_stpo_sel-bom_no</span><br><span class="line">                               AND item_node  = lt_stpo_sel-item_node</span><br><span class="line">                               AND item_count = lt_stpo_sel-item_count.</span><br><span class="line">      <span class="keyword">IF</span> lt_dep_data_sel-dep_intern &lt;&gt; ls_data-dep_intern1 AND</span><br><span class="line">         lt_dep_data_sel-dep_intern &lt;&gt; ls_data-dep_intern2 AND</span><br><span class="line">         lt_dep_data_sel-dep_intern &lt;&gt; ls_data-dep_intern3 AND</span><br><span class="line">         lt_dep_data_sel-dep_intern &lt;&gt; ls_data-dep_intern4.</span><br><span class="line"></span><br><span class="line">        <span class="keyword">CLEAR</span> ls_dep_data.</span><br><span class="line">        ls_dep_data-fldelete    = 'X'.                       "删除标识</span><br><span class="line">        ls_dep_data-object_id   = '2'.                       "APIs 的 BOM 对象标识符</span><br><span class="line">        ls_dep_data-identifier  = l_originno.                "特定客户的 APIs 对象标识符</span><br><span class="line">        ls_dep_data-bom_no      = lt_dep_data_sel-bom_no.    "物料单</span><br><span class="line">        ls_dep_data-item_node   = lt_dep_data_sel-item_node. "BOM 项目节点号</span><br><span class="line">        ls_dep_data-item_count  = lt_dep_data_sel-item_count."内部计数器</span><br><span class="line">        ls_dep_data-dep_intern  = lt_dep_data_sel-dep_intern."相关性的内部名称</span><br><span class="line">        <span class="keyword">APPEND</span> ls_dep_data TO lt_dep_data.</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line">    ENDLOOP.</span><br><span class="line">    <span class="keyword">IF</span> ls_data-dep_intern1 IS NOT INITIAL .</span><br><span class="line">      <span class="keyword">CLEAR</span> ls_dep_data.</span><br><span class="line">      ls_dep_data-object_id   = '2'.                "APIs 的 BOM 对象标识符</span><br><span class="line">      ls_dep_data-identifier  = l_originno.         "特定客户的 APIs 对象标识符</span><br><span class="line">      ls_dep_data-dep_intern  = ls_data-dep_intern1."相关性的内部名称</span><br><span class="line">      <span class="keyword">APPEND</span> ls_dep_data TO lt_dep_data.</span><br><span class="line">    ENDIF.</span><br><span class="line">    <span class="keyword">IF</span> ls_data-dep_intern2 IS NOT INITIAL .</span><br><span class="line">      <span class="keyword">CLEAR</span> ls_dep_data.</span><br><span class="line">      ls_dep_data-object_id   = '2'.                "APIs 的 BOM 对象标识符</span><br><span class="line">      ls_dep_data-identifier  = l_originno.         "特定客户的 APIs 对象标识符</span><br><span class="line">      ls_dep_data-dep_intern  = ls_data-dep_intern2."相关性的内部名称</span><br><span class="line">      <span class="keyword">APPEND</span> ls_dep_data TO lt_dep_data.</span><br><span class="line">    ENDIF.</span><br><span class="line">    <span class="keyword">IF</span> ls_data-dep_intern3 IS NOT INITIAL .</span><br><span class="line">      <span class="keyword">CLEAR</span> ls_dep_data.</span><br><span class="line">      ls_dep_data-object_id   = '2'.                "APIs 的 BOM 对象标识符</span><br><span class="line">      ls_dep_data-identifier  = l_originno.         "特定客户的 APIs 对象标识符</span><br><span class="line">      ls_dep_data-dep_intern  = ls_data-dep_intern3."相关性的内部名称</span><br><span class="line">      <span class="keyword">APPEND</span> ls_dep_data TO lt_dep_data.</span><br><span class="line">    ENDIF.</span><br><span class="line">    <span class="keyword">IF</span> ls_data-dep_intern4 IS NOT INITIAL .</span><br><span class="line">      <span class="keyword">CLEAR</span> ls_dep_data.</span><br><span class="line">      ls_dep_data-object_id   = '2'.                "APIs 的 BOM 对象标识符</span><br><span class="line">      ls_dep_data-identifier  = l_originno.         "特定客户的 APIs 对象标识符</span><br><span class="line">      ls_dep_data-dep_intern  = ls_data-dep_intern4."相关性的内部名称</span><br><span class="line">      <span class="keyword">APPEND</span> ls_dep_data TO lt_dep_data.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line">    AT END OF stlal.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*     API BOM 表头结构：可以被更改的字段</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      ls_stko-bom_status = ls_data-bom_status.   "BOM 状态</span><br><span class="line">      ls_stko-base_quan  = ls_data-base_quan.    "基准数量(BTCI)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*     修改BOM</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      CALL FUNCTION 'CSAP_MAT_BOM_MAINTAIN'</span><br><span class="line">        EXPORTING</span><br><span class="line">          material           = ls_data-matnr     "主件物料(母件）</span><br><span class="line">          plant              = ls_data-werks     "工厂</span><br><span class="line">          bom_usage          = ls_data-stlan     "BOM用途</span><br><span class="line">          alternative        = ls_data-stlal     "可选的 BOM</span><br><span class="line"><span class="comment">*         VALID_FROM         =</span></span><br><span class="line"><span class="comment">*         CHANGE_NO          =</span></span><br><span class="line"><span class="comment">*         REVISION_LEVEL     =</span></span><br><span class="line">          i_stko             = ls_stko</span><br><span class="line">          fl_commit_and_wait = 'X'</span><br><span class="line">          fl_bom_create      = 'X'</span><br><span class="line">          fl_new_item        = 'X'</span><br><span class="line">          fl_default_values  = ' '</span><br><span class="line"><span class="comment">*         FL_COMPLETE        = 'X'</span></span><br><span class="line">        TABLES</span><br><span class="line">          t_stpo             = lt_stpo</span><br><span class="line">          t_dep_data         = lt_dep_data</span><br><span class="line">        EXCEPTIONS</span><br><span class="line">          <span class="keyword">error</span>              = 1</span><br><span class="line">          OTHERS             = 2.</span><br><span class="line">      <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line">        CALL FUNCTION 'BAPI_TRANSACTION_COMMIT'</span><br><span class="line">          EXPORTING</span><br><span class="line">            wait = 'X'.</span><br><span class="line"></span><br><span class="line">        l_message = '修改BOM成功'.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*       alv数据的编辑</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        PERFORM frm_edit_alv USING ls_data-werks</span><br><span class="line">                                    ls_data-matnr</span><br><span class="line">                                    ls_data-stlan</span><br><span class="line">                                    ls_data-stlal</span><br><span class="line">                                    l_message</span><br><span class="line">                                    icon_okay.</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line">        CALL FUNCTION 'BAPI_TRANSACTION_ROLLBACK'.</span><br><span class="line"></span><br><span class="line">        MESSAGE ID sy-msgid <span class="keyword">TYPE</span> sy-msgty NUMBER sy-msgno</span><br><span class="line">          WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4</span><br><span class="line">          INTO l_message.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*       alv数据的编辑</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        PERFORM frm_edit_alv USING ls_data-werks</span><br><span class="line">                                    ls_data-matnr</span><br><span class="line">                                    ls_data-stlan</span><br><span class="line">                                    ls_data-stlal</span><br><span class="line">                                    l_message</span><br><span class="line">                                    icon_cancel.</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line">      CALL FUNCTION 'CSAP_MAT_BOM_CLOSE'</span><br><span class="line"><span class="comment">*        EXPORTING</span></span><br><span class="line"><span class="comment">*          FL_COMMIT_AND_WAIT       = 'X'</span></span><br><span class="line"><span class="comment">*        IMPORTING</span></span><br><span class="line"><span class="comment">*          FL_WARNING               =</span></span><br><span class="line">        EXCEPTIONS</span><br><span class="line">          <span class="keyword">error</span>  = 1</span><br><span class="line">          OTHERS = 2.</span><br><span class="line">      <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* Implement suitable error handling here</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line">    ENDAT.</span><br><span class="line">    <span class="keyword">CLEAR</span>: ls_data,ls_tmp.</span><br><span class="line">  ENDLOOP.</span><br><span class="line"></span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  FRM_BAPI_BOM_DEL</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       删除BOM</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">FORM</span> frm_bapi_bom_del .</span><br><span class="line"></span><br><span class="line">  DATA:</span><br><span class="line">    ls_data   LIKE <span class="keyword">LINE</span> OF gt_data_in,</span><br><span class="line">    l_message <span class="keyword">TYPE</span>         char255.                  "ALV信息</span><br><span class="line"></span><br><span class="line">  LOOP AT gt_data_in INTO ls_data.</span><br><span class="line"></span><br><span class="line">    AT END OF stlal.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*     删除BOM</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      CALL FUNCTION 'CSAP_MAT_BOM_DELETE'</span><br><span class="line">        EXPORTING</span><br><span class="line">          material           = ls_data-matnr     "主件物料(母件）</span><br><span class="line">          plant              = ls_data-werks     "工厂</span><br><span class="line">          bom_usage          = ls_data-stlan     "BOM用途</span><br><span class="line">          alternative        = ls_data-stlal     "可选的 BOM</span><br><span class="line"><span class="comment">*         VALID_FROM         =</span></span><br><span class="line"><span class="comment">*         CHANGE_NO          =</span></span><br><span class="line"><span class="comment">*         REVISION_LEVEL     =</span></span><br><span class="line"><span class="comment">*         FL_NO_CHANGE_DOC   = ' '</span></span><br><span class="line">          fl_commit_and_wait = 'X'</span><br><span class="line"><span class="comment">*       IMPORTING</span></span><br><span class="line"><span class="comment">*         FL_WARNING         =</span></span><br><span class="line">        EXCEPTIONS</span><br><span class="line">          <span class="keyword">error</span>              = 1</span><br><span class="line">          OTHERS             = 2.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line">        CALL FUNCTION 'BAPI_TRANSACTION_COMMIT'</span><br><span class="line">          EXPORTING</span><br><span class="line">            wait = 'X'.</span><br><span class="line"></span><br><span class="line">        l_message = '删除BOM成功'.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*       alv数据的编辑</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        PERFORM frm_edit_alv USING ls_data-werks</span><br><span class="line">                                    ls_data-matnr</span><br><span class="line">                                    ls_data-stlan</span><br><span class="line">                                    ls_data-stlal</span><br><span class="line">                                    l_message</span><br><span class="line">                                    icon_okay.</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line">        CALL FUNCTION 'BAPI_TRANSACTION_ROLLBACK'.</span><br><span class="line"></span><br><span class="line">        MESSAGE ID sy-msgid <span class="keyword">TYPE</span> sy-msgty NUMBER sy-msgno</span><br><span class="line">          WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4</span><br><span class="line">          INTO l_message.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*       alv数据的编辑</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        PERFORM frm_edit_alv USING ls_data-werks</span><br><span class="line">                                    ls_data-matnr</span><br><span class="line">                                    ls_data-stlan</span><br><span class="line">                                    ls_data-stlal</span><br><span class="line">                                    l_message</span><br><span class="line">                                    icon_cancel.</span><br><span class="line">      ENDIF.</span><br><span class="line">    ENDAT.</span><br><span class="line"></span><br><span class="line">  ENDLOOP.</span><br><span class="line"></span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  FRM_BAPI_BOM_INS_BAPI</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       可选BOM单一</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">FORM</span> frm_bapi_bom_ins_bapi .</span><br><span class="line"></span><br><span class="line">  DATA:</span><br><span class="line">    ls_tmp       LIKE <span class="keyword">LINE</span> OF  gt_data_in,</span><br><span class="line">    ls_data      LIKE <span class="keyword">LINE</span> OF  gt_data_in,</span><br><span class="line">    lt_stpo      <span class="keyword">TYPE</span> <span class="keyword">TABLE</span> OF stpo_api01,      "BOM 项目的 API 结构：能被修改的字段</span><br><span class="line">    ls_stpo      LIKE <span class="keyword">LINE</span> OF  lt_stpo,</span><br><span class="line">    lt_dep_data  <span class="keyword">TYPE</span> <span class="keyword">TABLE</span> OF csdep_dat,       "BOMs：相关性的基本数据</span><br><span class="line">    ls_dep_data  LIKE <span class="keyword">LINE</span> OF  lt_dep_data,</span><br><span class="line">    l_valid_from <span class="keyword">TYPE</span>          csap_mbom-datuv,          "有效日期自 (BTCI)</span><br><span class="line">    l_message    <span class="keyword">TYPE</span>          char255,                  "ALV信息</span><br><span class="line">    l_originno   <span class="keyword">TYPE</span>          i,</span><br><span class="line">    ls_stko      <span class="keyword">TYPE</span>          stko_api01.               "API BOM 表头结构：可以被更改的字段</span><br><span class="line"></span><br><span class="line">  LOOP AT gt_data_in INTO ls_tmp.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">CLEAR</span>:</span><br><span class="line">      ls_data,</span><br><span class="line">      ls_stpo,</span><br><span class="line">      ls_dep_data.</span><br><span class="line"></span><br><span class="line">    ls_data = ls_tmp.</span><br><span class="line"></span><br><span class="line">    AT NEW stlan.</span><br><span class="line">      REFRESH:</span><br><span class="line">        lt_stpo,</span><br><span class="line">        lt_dep_data.</span><br><span class="line">      <span class="keyword">CLEAR</span>:</span><br><span class="line">        l_valid_from,</span><br><span class="line">        l_message,</span><br><span class="line">        l_originno,</span><br><span class="line">        ls_stko.</span><br><span class="line">    ENDAT.</span><br><span class="line"></span><br><span class="line">    l_originno = l_originno + 1.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*   BOM 项目的 API 结构：能被修改的字段</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    ls_stpo-item_categ = ls_data-item_categ  .   "项目类别（物料单）</span><br><span class="line">    ls_stpo-item_no    = ls_data-item_no  .      "BOM 项目号</span><br><span class="line">    ls_stpo-component  = ls_data-component.      "BOM 组件</span><br><span class="line">    ls_stpo-comp_qty   = ls_data-comp_qty.       "组件数量 (BTCI)</span><br><span class="line">    ls_stpo-comp_unit  = ls_data-comp_unit.      "组件计量单位</span><br><span class="line">    ls_stpo-item_text1 = ls_data-item_text1.     "BOM 项目文本（行1）</span><br><span class="line">    ls_stpo-sortstring = ls_data-sortstring.     "排序字符串</span><br><span class="line">    ls_stpo-comp_scrap = ls_data-comp_scrap.     "部件废品用百分比表示(BTCI)</span><br><span class="line">    ls_stpo-ai_group   = ls_data-ai_group.       "替代项目：组</span><br><span class="line">    ls_stpo-ai_prio    = ls_data-ai_prio.        "备选项目：优先级</span><br><span class="line">    ls_stpo-ai_strateg = ls_data-ai_strateg.     "替代项目：策略</span><br><span class="line">    ls_stpo-usage_prob = ls_data-usage_prob.     "使用可能性按 % (BTCI)</span><br><span class="line">    ls_stpo-rel_cost   = ls_data-rel_cost.       "标识：与成本核算相关的项目</span><br><span class="line">    ls_stpo-bulk_mat   = ls_data-bulk_mat.       "标识：散装物料</span><br><span class="line">    ls_stpo-lead_time  = ls_data-lead_time.      "跟踪时间（批输入）</span><br><span class="line">    ls_stpo-op_lead_tm = ls_data-op_lead_tm.     "工序(BTCI)引导时间偏移</span><br><span class="line">    ls_stpo-issue_loc  = ls_data-issue_loc.      "生产订单的发货地点</span><br><span class="line">    ls_stpo-identifier = l_originno.             "特定客户的 APIs 对象标识符</span><br><span class="line"></span><br><span class="line">    <span class="keyword">IF</span> ls_stpo-bulk_mat IS NOT INITIAL.</span><br><span class="line">      ls_stpo-rel_prod = 'X'.             "特定客户的 APIs 对象标识符</span><br><span class="line">    ENDIF.</span><br><span class="line">    <span class="keyword">APPEND</span> ls_stpo TO lt_stpo.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*   BOMs：相关性的基本数据</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">IF</span> ls_data-dep_intern1 IS NOT INITIAL .</span><br><span class="line">      <span class="keyword">CLEAR</span> ls_dep_data.</span><br><span class="line">      ls_dep_data-object_id   = '2'.                "APIs 的 BOM 对象标识符</span><br><span class="line">      ls_dep_data-identifier  = l_originno.         "特定客户的 APIs 对象标识符</span><br><span class="line">      ls_dep_data-dep_intern  = ls_data-dep_intern1."相关性的内部名称</span><br><span class="line">      <span class="keyword">APPEND</span> ls_dep_data TO lt_dep_data.</span><br><span class="line">    ENDIF.</span><br><span class="line">    <span class="keyword">IF</span> ls_data-dep_intern2 IS NOT INITIAL .</span><br><span class="line">      <span class="keyword">CLEAR</span> ls_dep_data.</span><br><span class="line">      ls_dep_data-object_id   = '2'.                "APIs 的 BOM 对象标识符</span><br><span class="line">      ls_dep_data-identifier  = l_originno.         "特定客户的 APIs 对象标识符</span><br><span class="line">      ls_dep_data-dep_intern  = ls_data-dep_intern2."相关性的内部名称</span><br><span class="line">      <span class="keyword">APPEND</span> ls_dep_data TO lt_dep_data.</span><br><span class="line">    ENDIF.</span><br><span class="line">    <span class="keyword">IF</span> ls_data-dep_intern3 IS NOT INITIAL .</span><br><span class="line">      <span class="keyword">CLEAR</span> ls_dep_data.</span><br><span class="line">      ls_dep_data-object_id   = '2'.                "APIs 的 BOM 对象标识符</span><br><span class="line">      ls_dep_data-identifier  = l_originno.         "特定客户的 APIs 对象标识符</span><br><span class="line">      ls_dep_data-dep_intern  = ls_data-dep_intern3."相关性的内部名称</span><br><span class="line">      <span class="keyword">APPEND</span> ls_dep_data TO lt_dep_data.</span><br><span class="line">    ENDIF.</span><br><span class="line">    <span class="keyword">IF</span> ls_data-dep_intern4 IS NOT INITIAL .</span><br><span class="line">      <span class="keyword">CLEAR</span> ls_dep_data.</span><br><span class="line">      ls_dep_data-object_id   = '2'.                "APIs 的 BOM 对象标识符</span><br><span class="line">      ls_dep_data-identifier  = l_originno.         "特定客户的 APIs 对象标识符</span><br><span class="line">      ls_dep_data-dep_intern  = ls_data-dep_intern4."相关性的内部名称</span><br><span class="line">      <span class="keyword">APPEND</span> ls_dep_data TO lt_dep_data.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line">    AT END OF stlan.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*     API BOM 表头结构：可以被更改的字段</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      ls_stko-bom_status = ls_data-bom_status.   "BOM 状态</span><br><span class="line">      ls_stko-base_quan  = ls_data-base_quan.    "基准数量(BTCI)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*     日期:转换</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      CALL FUNCTION 'CONVERT_DATE_TO_EXTERNAL'</span><br><span class="line">        EXPORTING</span><br><span class="line">          date_internal            = sy-datum</span><br><span class="line">        IMPORTING</span><br><span class="line">          date_external            = l_valid_from</span><br><span class="line">        EXCEPTIONS</span><br><span class="line">          date_internal_is_invalid = 1</span><br><span class="line">          OTHERS                   = 2.</span><br><span class="line">      <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* Implement suitable error handling here</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*     创建BOM</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      CALL FUNCTION 'CSAP_MAT_BOM_CREATE'</span><br><span class="line">        EXPORTING</span><br><span class="line">          material           = ls_data-matnr     "主件物料(母件）</span><br><span class="line">          plant              = ls_data-werks     "工厂</span><br><span class="line">          bom_usage          = ls_data-stlan     "BOM用途</span><br><span class="line">          valid_from         = l_valid_from      "有效起</span><br><span class="line"><span class="comment">*         VALID_FROM         = LS_DATA-DATUV     "有效起</span></span><br><span class="line"><span class="comment">*         CHANGE_NO          = LS_DATA-AENNR     "更改号</span></span><br><span class="line"><span class="comment">*         REVISION_LEVEL     = LS_DATA-REVLV     "版次</span></span><br><span class="line">          i_stko             = ls_stko</span><br><span class="line">          fl_commit_and_wait = 'X'</span><br><span class="line"><span class="comment">*         FL_DEFAULT_VALUES  = ' '</span></span><br><span class="line">        TABLES</span><br><span class="line">          t_stpo             = lt_stpo</span><br><span class="line">          t_dep_data         = lt_dep_data</span><br><span class="line">        EXCEPTIONS</span><br><span class="line">          <span class="keyword">error</span>              = 1</span><br><span class="line">          OTHERS             = 2.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line">        CALL FUNCTION 'BAPI_TRANSACTION_COMMIT'</span><br><span class="line">          EXPORTING</span><br><span class="line">            wait = 'X'.</span><br><span class="line"></span><br><span class="line">        l_message = '创建BOM成功'.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*       alv数据的编辑</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        PERFORM frm_edit_alv USING ls_data-werks</span><br><span class="line">                                    ls_data-matnr</span><br><span class="line">                                    ls_data-stlan</span><br><span class="line">                                    ls_data-stlal</span><br><span class="line">                                    l_message</span><br><span class="line">                                    icon_okay.</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line">        CALL FUNCTION 'BAPI_TRANSACTION_ROLLBACK'.</span><br><span class="line"></span><br><span class="line">        MESSAGE ID sy-msgid <span class="keyword">TYPE</span> sy-msgty NUMBER sy-msgno</span><br><span class="line">          WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4</span><br><span class="line">          INTO l_message.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*       alv数据的编辑</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        PERFORM frm_edit_alv USING ls_data-werks</span><br><span class="line">                                    ls_data-matnr</span><br><span class="line">                                    ls_data-stlan</span><br><span class="line">                                    ls_data-stlal</span><br><span class="line">                                    l_message</span><br><span class="line">                                    icon_cancel.</span><br><span class="line">      ENDIF.</span><br><span class="line">    ENDAT.</span><br><span class="line"></span><br><span class="line">  ENDLOOP.</span><br><span class="line"></span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  FRM_BAPI_BOM_INS_BDC</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       可选BOM多个（创建可选的bom 抬头）</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">FORM</span> frm_bapi_bom_ins_bdc .</span><br><span class="line"></span><br><span class="line">  DATA:</span><br><span class="line">    ls_tmp    LIKE <span class="keyword">LINE</span> OF gt_data_in,</span><br><span class="line">    ls_data   LIKE <span class="keyword">LINE</span> OF gt_data_in,</span><br><span class="line">    l_message <span class="keyword">TYPE</span>         char255.                  "ALV信息</span><br><span class="line"></span><br><span class="line">  DATA:</span><br><span class="line">    ls_bom_header <span class="keyword">TYPE</span> bicsk,          "BOM 表头数据的批输入结构</span><br><span class="line">    ls_group_data <span class="keyword">TYPE</span> bgr00,</span><br><span class="line">    l_msgid       <span class="keyword">TYPE</span> t100-arbgb,</span><br><span class="line">    l_msgno       <span class="keyword">TYPE</span> t100-msgnr,</span><br><span class="line">    l_msgty       <span class="keyword">TYPE</span> sy-msgty,</span><br><span class="line">    l_msgv1       <span class="keyword">TYPE</span> sy-msgv1,</span><br><span class="line">    l_msgv2       <span class="keyword">TYPE</span> sy-msgv2,</span><br><span class="line">    l_msgv3       <span class="keyword">TYPE</span> sy-msgv3,</span><br><span class="line">    l_msgv4       <span class="keyword">TYPE</span> sy-msgv4,</span><br><span class="line">    lt_bom_item   LIKE bicsp OCCURS 0 WITH HEADER <span class="keyword">LINE</span>, "BOM项数据的批输入结构</span><br><span class="line">    lt_sub_item   LIKE bicsu OCCURS 0 WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line"></span><br><span class="line">  LOOP AT gt_data_in INTO ls_tmp.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">CLEAR</span>:</span><br><span class="line">      ls_data.</span><br><span class="line"></span><br><span class="line">    ls_data = ls_tmp.</span><br><span class="line"></span><br><span class="line">    AT NEW stlan.</span><br><span class="line">      <span class="keyword">CLEAR</span>:</span><br><span class="line">        ls_bom_header,</span><br><span class="line">        ls_group_data,</span><br><span class="line">        l_msgid      ,</span><br><span class="line">        l_msgno      ,</span><br><span class="line">        l_msgty      ,</span><br><span class="line">        l_msgv1      ,</span><br><span class="line">        l_msgv2      ,</span><br><span class="line">        l_msgv3      ,</span><br><span class="line">        l_msgv4      ,</span><br><span class="line">        lt_bom_item  ,</span><br><span class="line">        lt_sub_item  .</span><br><span class="line">    ENDAT.</span><br><span class="line"></span><br><span class="line">    AT END OF stlan.</span><br><span class="line">      ls_bom_header-tcode = 'CS01'.</span><br><span class="line">      ls_bom_header-werks = ls_data-werks.</span><br><span class="line">      ls_bom_header-matnr = ls_data-matnr.</span><br><span class="line">      ls_bom_header-bmeng = ls_data-base_quan.</span><br><span class="line">      ls_bom_header-stlal = ls_data-stlal.</span><br><span class="line">      ls_bom_header-stlan = ls_data-stlan.</span><br><span class="line">      ls_bom_header-stlst = ls_data-bom_status.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*     日期:转换</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      CALL FUNCTION 'CONVERT_DATE_TO_EXTERNAL'</span><br><span class="line">        EXPORTING</span><br><span class="line">          date_internal            = sy-datum</span><br><span class="line">        IMPORTING</span><br><span class="line">          date_external            = ls_bom_header-datuv</span><br><span class="line">        EXCEPTIONS</span><br><span class="line">          date_internal_is_invalid = 1</span><br><span class="line">          OTHERS                   = 2.</span><br><span class="line">      <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* Implement suitable error handling here</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line">      CALL FUNCTION 'CS_BI_BOM_CREATE_BATCH_INPUT1'</span><br><span class="line">        EXPORTING</span><br><span class="line"><span class="comment">*         BDC_FLAG     = ' '</span></span><br><span class="line">          bom_header   = ls_bom_header</span><br><span class="line"><span class="comment">*         CLOSE_GROUP  = ' '</span></span><br><span class="line">          commit_work  = 'X'</span><br><span class="line">          group_data   = ls_group_data</span><br><span class="line"><span class="comment">*         NEW_GROUP    = ' '</span></span><br><span class="line">          tcode_mode   = '<span class="keyword">N</span>'</span><br><span class="line">          tcode_update = 'S'</span><br><span class="line">        IMPORTING</span><br><span class="line">          msgid        = l_msgid</span><br><span class="line">          msgno        = l_msgno</span><br><span class="line">          msgty        = l_msgty</span><br><span class="line">          msgv1        = l_msgv1</span><br><span class="line">          msgv2        = l_msgv2</span><br><span class="line">          msgv3        = l_msgv3</span><br><span class="line">          msgv4        = l_msgv4</span><br><span class="line">        TABLES</span><br><span class="line">          bom_item     = lt_bom_item</span><br><span class="line">          bom_sub_item = lt_sub_item.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">IF</span> l_msgty = '<span class="keyword">E</span>' OR l_msgty = 'A'.</span><br><span class="line">        CALL FUNCTION 'BAPI_TRANSACTION_ROLLBACK'.</span><br><span class="line">        MESSAGE ID l_msgid <span class="keyword">TYPE</span> l_msgty NUMBER l_msgno</span><br><span class="line">          WITH l_msgv1 l_msgv2 l_msgv3 l_msgv4</span><br><span class="line">          INTO l_message.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*       alv数据的编辑</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        PERFORM frm_edit_alv USING ls_data-werks</span><br><span class="line">                                    ls_data-matnr</span><br><span class="line">                                    ls_data-stlan</span><br><span class="line">                                    ls_data-stlal</span><br><span class="line">                                    l_message</span><br><span class="line">                                    icon_cancel.</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line">        CALL FUNCTION 'BAPI_TRANSACTION_COMMIT'</span><br><span class="line">          EXPORTING</span><br><span class="line">            wait = 'X'.</span><br><span class="line"></span><br><span class="line">        l_message = '创建BOM成功'.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*       alv数据的编辑</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        PERFORM frm_edit_alv USING ls_data-werks</span><br><span class="line">                                    ls_data-matnr</span><br><span class="line">                                    ls_data-stlan</span><br><span class="line">                                    ls_data-stlal</span><br><span class="line">                                    l_message</span><br><span class="line">                                    icon_okay.</span><br><span class="line">      ENDIF.</span><br><span class="line">    ENDAT.</span><br><span class="line"></span><br><span class="line">  ENDLOOP.</span><br><span class="line"></span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  FRM_BAPI_BOM_UPD_ITEM</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       修改BOM(明细行项目的追加)</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*  --&gt;  p1        text</span></span><br><span class="line"><span class="comment">*  &lt;--  p2        text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">FORM</span> frm_bapi_bom_upd_item .</span><br><span class="line"></span><br><span class="line">  DATA:</span><br><span class="line">    ls_tmp      LIKE <span class="keyword">LINE</span> OF  gt_data_in,</span><br><span class="line">    ls_data     LIKE <span class="keyword">LINE</span> OF  gt_data_in,</span><br><span class="line">    lt_stpo     <span class="keyword">TYPE</span> <span class="keyword">TABLE</span> OF stpo_api03,      "BOM 项目的 API 结构：ALL ＋标识的字段</span><br><span class="line">    ls_stpo     LIKE <span class="keyword">LINE</span> OF  lt_stpo,</span><br><span class="line">    lt_dep_data <span class="keyword">TYPE</span> <span class="keyword">TABLE</span> OF csdep_dat,       "BOMs：相关性的基本数据</span><br><span class="line">    ls_dep_data LIKE <span class="keyword">LINE</span> OF  lt_dep_data,</span><br><span class="line">    l_message   <span class="keyword">TYPE</span>          char255,                  "ALV信息</span><br><span class="line">    l_originno  <span class="keyword">TYPE</span>          i,</span><br><span class="line">    ls_stko     <span class="keyword">TYPE</span>          stko_api01.               "API BOM 表头结构：可以被更改的字段</span><br><span class="line"></span><br><span class="line">  FIELD-SYMBOLS:</span><br><span class="line">    &lt;ls_fs_alv&gt; LIKE <span class="keyword">LINE</span> OF gt_alv.</span><br><span class="line"></span><br><span class="line">  LOOP AT gt_data_in INTO ls_tmp.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">CLEAR</span>:</span><br><span class="line">      ls_data,</span><br><span class="line">      ls_stpo,</span><br><span class="line">      ls_dep_data.</span><br><span class="line"></span><br><span class="line">    ls_data = ls_tmp.</span><br><span class="line"></span><br><span class="line">    AT NEW stlal.</span><br><span class="line">      REFRESH:</span><br><span class="line">        lt_stpo,</span><br><span class="line">        lt_dep_data.</span><br><span class="line">      <span class="keyword">CLEAR</span>:</span><br><span class="line">        l_message,</span><br><span class="line">        l_originno,</span><br><span class="line">        ls_stko.</span><br><span class="line">    ENDAT.</span><br><span class="line"></span><br><span class="line">    l_originno = l_originno + 1.</span><br><span class="line"></span><br><span class="line">    ls_stpo-item_categ = ls_data-item_categ  .   "项目类别（物料单）</span><br><span class="line">    ls_stpo-item_no    = ls_data-item_no  .      "BOM 项目号</span><br><span class="line">    ls_stpo-component  = ls_data-component.      "BOM 组件</span><br><span class="line">    ls_stpo-comp_qty   = ls_data-comp_qty.       "组件数量 (BTCI)</span><br><span class="line">    ls_stpo-comp_unit  = ls_data-comp_unit.      "组件计量单位</span><br><span class="line">    ls_stpo-item_text1 = ls_data-item_text1.     "BOM 项目文本（行1）</span><br><span class="line">    ls_stpo-sortstring = ls_data-sortstring.     "排序字符串</span><br><span class="line">    ls_stpo-comp_scrap = ls_data-comp_scrap.     "部件废品用百分比表示(BTCI)</span><br><span class="line">    ls_stpo-ai_group   = ls_data-ai_group.       "替代项目：组</span><br><span class="line">    ls_stpo-ai_prio    = ls_data-ai_prio.        "备选项目：优先级</span><br><span class="line">    ls_stpo-ai_strateg = ls_data-ai_strateg.     "替代项目：策略</span><br><span class="line">    ls_stpo-usage_prob = ls_data-usage_prob.     "使用可能性按 % (BTCI)</span><br><span class="line">    ls_stpo-rel_cost   = ls_data-rel_cost.       "标识：与成本核算相关的项目</span><br><span class="line">    ls_stpo-bulk_mat   = ls_data-bulk_mat.       "标识：散装物料</span><br><span class="line">    ls_stpo-lead_time  = ls_data-lead_time.      "跟踪时间（批输入）</span><br><span class="line">    ls_stpo-op_lead_tm = ls_data-op_lead_tm.     "工序(BTCI)引导时间偏移</span><br><span class="line">    ls_stpo-issue_loc  = ls_data-issue_loc.      "生产订单的发货地点</span><br><span class="line">    ls_stpo-identifier = l_originno.             "特定客户的 APIs 对象标识符</span><br><span class="line">    <span class="keyword">APPEND</span> ls_stpo TO lt_stpo.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*   BOMs：相关性的基本数据</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">IF</span> ls_data-dep_intern1 IS NOT INITIAL .</span><br><span class="line">      <span class="keyword">CLEAR</span> ls_dep_data.</span><br><span class="line">      ls_dep_data-object_id   = '2'.                "APIs 的 BOM 对象标识符</span><br><span class="line">      ls_dep_data-identifier  = l_originno.         "特定客户的 APIs 对象标识符</span><br><span class="line">      ls_dep_data-dep_intern  = ls_data-dep_intern1."相关性的内部名称</span><br><span class="line">      <span class="keyword">APPEND</span> ls_dep_data TO lt_dep_data.</span><br><span class="line">    ENDIF.</span><br><span class="line">    <span class="keyword">IF</span> ls_data-dep_intern2 IS NOT INITIAL .</span><br><span class="line">      <span class="keyword">CLEAR</span> ls_dep_data.</span><br><span class="line">      ls_dep_data-object_id   = '2'.                "APIs 的 BOM 对象标识符</span><br><span class="line">      ls_dep_data-identifier  = l_originno.         "特定客户的 APIs 对象标识符</span><br><span class="line">      ls_dep_data-dep_intern  = ls_data-dep_intern2."相关性的内部名称</span><br><span class="line">      <span class="keyword">APPEND</span> ls_dep_data TO lt_dep_data.</span><br><span class="line">    ENDIF.</span><br><span class="line">    <span class="keyword">IF</span> ls_data-dep_intern3 IS NOT INITIAL .</span><br><span class="line">      <span class="keyword">CLEAR</span> ls_dep_data.</span><br><span class="line">      ls_dep_data-object_id   = '2'.                "APIs 的 BOM 对象标识符</span><br><span class="line">      ls_dep_data-identifier  = l_originno.         "特定客户的 APIs 对象标识符</span><br><span class="line">      ls_dep_data-dep_intern  = ls_data-dep_intern3."相关性的内部名称</span><br><span class="line">      <span class="keyword">APPEND</span> ls_dep_data TO lt_dep_data.</span><br><span class="line">    ENDIF.</span><br><span class="line">    <span class="keyword">IF</span> ls_data-dep_intern4 IS NOT INITIAL .</span><br><span class="line">      <span class="keyword">CLEAR</span> ls_dep_data.</span><br><span class="line">      ls_dep_data-object_id   = '2'.                "APIs 的 BOM 对象标识符</span><br><span class="line">      ls_dep_data-identifier  = l_originno.         "特定客户的 APIs 对象标识符</span><br><span class="line">      ls_dep_data-dep_intern  = ls_data-dep_intern4."相关性的内部名称</span><br><span class="line">      <span class="keyword">APPEND</span> ls_dep_data TO lt_dep_data.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line">    AT END OF stlal.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*     API BOM 表头结构：可以被更改的字段</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      ls_stko-bom_status = ls_data-bom_status.   "BOM 状态</span><br><span class="line">      ls_stko-base_quan  = ls_data-base_quan.    "基准数量(BTCI)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*     修改BOM</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      CALL FUNCTION 'CSAP_MAT_BOM_MAINTAIN'</span><br><span class="line">        EXPORTING</span><br><span class="line">          material           = ls_data-matnr     "主件物料(母件）</span><br><span class="line">          plant              = ls_data-werks     "工厂</span><br><span class="line">          bom_usage          = ls_data-stlan     "BOM用途</span><br><span class="line">          alternative        = ls_data-stlal     "可选的 BOM</span><br><span class="line"><span class="comment">*         VALID_FROM         =</span></span><br><span class="line"><span class="comment">*         CHANGE_NO          =</span></span><br><span class="line"><span class="comment">*         REVISION_LEVEL     =</span></span><br><span class="line">          i_stko             = ls_stko</span><br><span class="line">          fl_commit_and_wait = 'X'</span><br><span class="line">          fl_bom_create      = 'X'</span><br><span class="line">          fl_new_item        = 'X'</span><br><span class="line">          fl_default_values  = ' '</span><br><span class="line"><span class="comment">*         FL_COMPLETE        = 'X'</span></span><br><span class="line">        TABLES</span><br><span class="line">          t_stpo             = lt_stpo</span><br><span class="line">          t_dep_data         = lt_dep_data</span><br><span class="line">        EXCEPTIONS</span><br><span class="line">          <span class="keyword">error</span>              = 1</span><br><span class="line">          OTHERS             = 2.</span><br><span class="line">      <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line">        CALL FUNCTION 'BAPI_TRANSACTION_COMMIT'</span><br><span class="line">          EXPORTING</span><br><span class="line">            wait = 'X'.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line">        CALL FUNCTION 'BAPI_TRANSACTION_ROLLBACK'.</span><br><span class="line"></span><br><span class="line">        MESSAGE ID sy-msgid <span class="keyword">TYPE</span> sy-msgty NUMBER sy-msgno</span><br><span class="line">          WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4</span><br><span class="line">          INTO l_message.</span><br><span class="line"></span><br><span class="line">        LOOP AT gt_alv ASSIGNING &lt;ls_fs_alv&gt;.</span><br><span class="line"></span><br><span class="line">          CALL FUNCTION 'CONVERSION_EXIT_MATN2_OUTPUT'</span><br><span class="line">            EXPORTING</span><br><span class="line">              <span class="keyword">input</span>  = ls_data-matnr</span><br><span class="line">            IMPORTING</span><br><span class="line">              output = ls_data-matnr.</span><br><span class="line"></span><br><span class="line">          <span class="keyword">IF</span> ls_data-matnr = &lt;ls_fs_alv&gt;-matnr.</span><br><span class="line">            &lt;ls_fs_alv&gt;-message = l_message.</span><br><span class="line">            &lt;ls_fs_alv&gt;-icon_id = icon_cancel.</span><br><span class="line">          ENDIF.</span><br><span class="line"></span><br><span class="line">        ENDLOOP.</span><br><span class="line">      ENDIF.</span><br><span class="line">    ENDAT.</span><br><span class="line"></span><br><span class="line">  ENDLOOP.</span><br><span class="line"></span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  FRM_MODIFY_SCREEN</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*  --&gt;  p1        text</span></span><br><span class="line"><span class="comment">*  &lt;--  p2        text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">FORM</span> frm_modify_screen .</span><br><span class="line"></span><br><span class="line">  LOOP AT SCREEN.</span><br><span class="line">    CASE 'X'.</span><br><span class="line">      WHEN rb_ins.</span><br><span class="line">        <span class="keyword">IF</span> screen-name = 'CB_STLAL'.</span><br><span class="line">          screen-active = 1.</span><br><span class="line">        ENDIF.</span><br><span class="line">      WHEN rb_upd.</span><br><span class="line">        <span class="keyword">IF</span> screen-name = 'CB_STLAL'.</span><br><span class="line">          screen-active = 0.</span><br><span class="line">        ENDIF.</span><br><span class="line">      WHEN rb_del.</span><br><span class="line">        <span class="keyword">IF</span> screen-name = 'CB_STLAL'.</span><br><span class="line">          screen-active = 0.</span><br><span class="line">        ENDIF.</span><br><span class="line">      WHEN OTHERS.</span><br><span class="line">    ENDCASE.</span><br><span class="line">    MODIFY SCREEN.</span><br><span class="line">  ENDLOOP.</span><br><span class="line"></span><br><span class="line">  LOOP AT SCREEN.</span><br><span class="line">    <span class="keyword">IF</span> rb_in = 'X'.</span><br><span class="line">      <span class="keyword">IF</span> screen-group1 = 'G1'.</span><br><span class="line">        screen-active = 1.</span><br><span class="line">      ENDIF.</span><br><span class="line">      <span class="keyword">IF</span> screen-group1 = 'G2'.</span><br><span class="line">        screen-active = 0.</span><br><span class="line">      ENDIF.</span><br><span class="line">    <span class="keyword">ELSE</span>.</span><br><span class="line">      <span class="keyword">IF</span> screen-group1 = 'G1'.</span><br><span class="line">        screen-active = 0.</span><br><span class="line">      ENDIF.</span><br><span class="line">      <span class="keyword">IF</span> screen-group1 = 'G2'.</span><br><span class="line">        screen-active = 1.</span><br><span class="line">      ENDIF.</span><br><span class="line">    ENDIF.</span><br><span class="line">    MODIFY SCREEN.</span><br><span class="line">  ENDLOOP.</span><br><span class="line"></span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  FRM_GET_DATA_OUT</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       导出数据的取得</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*  --&gt;  p1        text</span></span><br><span class="line"><span class="comment">*  &lt;--  p2        text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">FORM</span> frm_get_data_out .</span><br><span class="line"></span><br><span class="line">  DATA:</span><br><span class="line">    ls_data      LIKE <span class="keyword">LINE</span> OF  gt_data_out,</span><br><span class="line">    lt_mast      <span class="keyword">TYPE</span> <span class="keyword">TABLE</span> OF typ_mast,</span><br><span class="line">    ls_mast      LIKE <span class="keyword">LINE</span> OF  lt_mast,</span><br><span class="line">    l_valid_from <span class="keyword">TYPE</span>          csap_mbom-datuv,</span><br><span class="line">    l_line       <span class="keyword">TYPE</span>          i,</span><br><span class="line">    l_maktx      <span class="keyword">TYPE</span>          makt-maktx,</span><br><span class="line">    ls_stko      <span class="keyword">TYPE</span>          stko_api02,                          "BOM 表头的 API 结构： 所有字段</span><br><span class="line">    lt_stpo      LIKE          stpo_api02 OCCURS 0 WITH HEADER <span class="keyword">LINE</span>, "BOM 项目的 API 结构：能被修改的字段</span><br><span class="line">    lt_dep_data  LIKE          csdep_dat  OCCURS 0 WITH HEADER <span class="keyword">LINE</span>. "BOMs：相关性的基本数据</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* 日期:转换</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  CALL FUNCTION 'CONVERT_DATE_TO_EXTERNAL'</span><br><span class="line">    EXPORTING</span><br><span class="line">      date_internal            = sy-datum</span><br><span class="line">    IMPORTING</span><br><span class="line">      date_external            = l_valid_from</span><br><span class="line">    EXCEPTIONS</span><br><span class="line">      date_internal_is_invalid = 1</span><br><span class="line">      OTHERS                   = 2.</span><br><span class="line">  <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*Implement suitable error handling here</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">  SELECT matnr     "物料编号</span><br><span class="line">        werks     "工厂</span><br><span class="line">        stlan     "BOM 用途</span><br><span class="line">        stlal     "可选的 BOM</span><br><span class="line">    FROM mast</span><br><span class="line">    INTO <span class="keyword">TABLE</span> lt_mast</span><br><span class="line">   WHERE matnr <span class="keyword">IN</span> s_matnr</span><br><span class="line">    AND  werks <span class="keyword">IN</span> s_werks</span><br><span class="line">    AND  stlan <span class="keyword">IN</span> s_stlan</span><br><span class="line">    AND  stlal <span class="keyword">IN</span> s_stlal.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">SORT</span> lt_mast <span class="keyword">BY</span> werks matnr stlan stlal.</span><br><span class="line"></span><br><span class="line">  LOOP AT lt_mast INTO ls_mast.</span><br><span class="line">    <span class="keyword">CLEAR</span>:</span><br><span class="line">      ls_stko,</span><br><span class="line">      lt_stpo,</span><br><span class="line">      lt_dep_data.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*   得到最新的BOM 行项目</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    CALL FUNCTION 'CSAP_MAT_BOM_OPEN'</span><br><span class="line">      EXPORTING</span><br><span class="line">        material    = ls_mast-matnr     "主件物料(母件）</span><br><span class="line">        plant       = ls_mast-werks     "工厂</span><br><span class="line">        bom_usage   = ls_mast-stlan     "BOM用途</span><br><span class="line">        alternative = ls_mast-stlal     "可选的 BOM</span><br><span class="line">        valid_from  = l_valid_from      "有效日期自 (BTCI)</span><br><span class="line"><span class="comment">*       CHANGE_NO   =</span></span><br><span class="line"><span class="comment">*       REVISION_LEVEL         =</span></span><br><span class="line"><span class="comment">*       FL_NO_CHANGE_DOC       = ' '</span></span><br><span class="line">      IMPORTING</span><br><span class="line">        o_stko      = ls_stko</span><br><span class="line"><span class="comment">*       FL_WARNING  =</span></span><br><span class="line">      TABLES</span><br><span class="line">        t_stpo      = lt_stpo</span><br><span class="line">        t_dep_data  = lt_dep_data</span><br><span class="line"><span class="comment">*       T_DEP_DESCR =</span></span><br><span class="line"><span class="comment">*       T_DEP_ORDER =</span></span><br><span class="line"><span class="comment">*       T_DEP_SOURCE           =</span></span><br><span class="line"><span class="comment">*       T_DEP_DOC   =</span></span><br><span class="line">      EXCEPTIONS</span><br><span class="line">        <span class="keyword">error</span>       = 1</span><br><span class="line">        OTHERS      = 2.</span><br><span class="line">    <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*Implement suitable error handling here</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line">    CALL FUNCTION 'CSAP_MAT_BOM_CLOSE'</span><br><span class="line"><span class="comment">*      EXPORTING</span></span><br><span class="line"><span class="comment">*        FL_COMMIT_AND_WAIT       = 'X'</span></span><br><span class="line"><span class="comment">*      IMPORTING</span></span><br><span class="line"><span class="comment">*        FL_WARNING               =</span></span><br><span class="line">      EXCEPTIONS</span><br><span class="line">        <span class="keyword">error</span>  = 1</span><br><span class="line">        OTHERS = 2.</span><br><span class="line">    <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*Implement suitable error handling here</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line">    LOOP AT lt_stpo.</span><br><span class="line">      ls_data-werks        = ls_mast-werks.         "工厂</span><br><span class="line">      ls_data-matnr        = ls_mast-matnr.         "主件物料(母件）</span><br><span class="line">      ls_data-stlan        = ls_mast-stlan.         "BOM用途</span><br><span class="line">      ls_data-stlal        = ls_mast-stlal.         "可选的 BOM</span><br><span class="line">      ls_data-base_quan    = ls_stko-base_quan.     "基准数量</span><br><span class="line">      ls_data-bom_status   = ls_stko-bom_status.    "BOM状态</span><br><span class="line">      ls_data-item_categ   = lt_stpo-item_categ.    "项目类别（物料单）</span><br><span class="line">      ls_data-item_no      = lt_stpo-item_no   .    "BOM 项目号</span><br><span class="line">      ls_data-component    = lt_stpo-component .    "子物料号</span><br><span class="line">      ls_data-comp_qty     = lt_stpo-comp_qty  .    "数量</span><br><span class="line">      ls_data-comp_unit    = lt_stpo-comp_unit .    "组件计量单位</span><br><span class="line">      ls_data-item_text1   = lt_stpo-item_text1.    "BOM行项目文本描述1</span><br><span class="line">      ls_data-sortstring   = lt_stpo-sortstring.    "排序字符串</span><br><span class="line">      ls_data-comp_scrap   = lt_stpo-comp_scrap.    "损耗率</span><br><span class="line">      ls_data-ai_group     = lt_stpo-ai_group  .    "替代项目：组</span><br><span class="line">      ls_data-ai_prio      = lt_stpo-ai_prio   .    "优先级</span><br><span class="line">      ls_data-ai_strateg   = lt_stpo-ai_strateg.    "替代项目：策略</span><br><span class="line">      ls_data-usage_prob   = lt_stpo-usage_prob.    "使用可能性按 % (BTCI)</span><br><span class="line">      ls_data-rel_cost     = lt_stpo-rel_cost  .    "成本标志: 与成本核算相关项目</span><br><span class="line">      ls_data-bulk_mat     = lt_stpo-bulk_mat  .    "散装物料</span><br><span class="line"><span class="comment">*      ls_data-lead_time    = lt_stpo-lead_time .    "提前期偏置(非必须，可空着)</span></span><br><span class="line"><span class="comment">*      ls_data-op_lead_tm   = lt_stpo-op_lead_tm.    "工序提前期偏置(非必须，可空着)</span></span><br><span class="line">      ls_data-issue_loc    = lt_stpo-issue_loc .    "生产仓库地点</span><br><span class="line"></span><br><span class="line">      <span class="keyword">CLEAR</span> l_line.</span><br><span class="line">      LOOP AT lt_dep_data WHERE bom_no     = lt_stpo-bom_no</span><br><span class="line">                           AND  item_node  = lt_stpo-item_node</span><br><span class="line">                           AND  item_count = lt_stpo-item_count.</span><br><span class="line"></span><br><span class="line">        l_line = l_line + 1.</span><br><span class="line"></span><br><span class="line">        CASE l_line.</span><br><span class="line"><span class="comment">*          WHEN 1.</span></span><br><span class="line"><span class="comment">*            ls_data-dep_intern1      = lt_dep_data-dep_intern.    "相关性1</span></span><br><span class="line"><span class="comment">*          WHEN 2.</span></span><br><span class="line"><span class="comment">*            ls_data-dep_intern2      = lt_dep_data-dep_intern.    "相关性2</span></span><br><span class="line"><span class="comment">*          WHEN 3.</span></span><br><span class="line"><span class="comment">*            ls_data-dep_intern3      = lt_dep_data-dep_intern.    "相关性3</span></span><br><span class="line"><span class="comment">*          WHEN 4.</span></span><br><span class="line"><span class="comment">*            ls_data-dep_intern4      = lt_dep_data-dep_intern.    "相关性4</span></span><br><span class="line">          WHEN OTHERS.</span><br><span class="line">        ENDCASE.</span><br><span class="line">      ENDLOOP.</span><br><span class="line"></span><br><span class="line">      CALL FUNCTION 'CONVERSION_EXIT_MATN1_OUTPUT'</span><br><span class="line">        EXPORTING</span><br><span class="line">          <span class="keyword">input</span>  = ls_data-matnr</span><br><span class="line">        IMPORTING</span><br><span class="line">          output = ls_data-matnr.</span><br><span class="line">      CALL FUNCTION 'CONVERSION_EXIT_MATN2_INPUT'</span><br><span class="line">        EXPORTING</span><br><span class="line">          <span class="keyword">input</span>            = lt_stpo-component</span><br><span class="line">        IMPORTING</span><br><span class="line">          output           = lt_stpo-component</span><br><span class="line">        EXCEPTIONS</span><br><span class="line">          number_not_found = 0</span><br><span class="line">          length_error     = 0</span><br><span class="line">          OTHERS           = 0.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*     主物料描述</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      <span class="keyword">CLEAR</span> l_maktx.</span><br><span class="line">      SELECT SINGLE maktx</span><br><span class="line">        FROM makt</span><br><span class="line">        INTO l_maktx</span><br><span class="line">       WHERE matnr = ls_mast-matnr</span><br><span class="line">        AND  spras = sy-langu.</span><br><span class="line">      ls_data-maktx1 = l_maktx.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*     子物料描述</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      <span class="keyword">CLEAR</span> l_maktx.</span><br><span class="line">      SELECT SINGLE maktx</span><br><span class="line">        FROM makt</span><br><span class="line">        INTO l_maktx</span><br><span class="line">       WHERE matnr = lt_stpo-component</span><br><span class="line">        AND  spras = sy-langu.</span><br><span class="line">      ls_data-maktx2 = l_maktx.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">APPEND</span> ls_data TO gt_data_out.</span><br><span class="line">      <span class="keyword">CLEAR</span> ls_data.</span><br><span class="line">    ENDLOOP.</span><br><span class="line"></span><br><span class="line">  ENDLOOP.</span><br><span class="line"></span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  FRM_EXCEL_OUTPUT</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       展示EXCEL</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*  --&gt;  p1        text</span></span><br><span class="line"><span class="comment">*  &lt;--  p2        text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">FORM</span> frm_excel_output .</span><br><span class="line"></span><br><span class="line">  DATA:</span><br><span class="line">    l_filename    <span class="keyword">TYPE</span>          string,</span><br><span class="line">    lt_fieldnames <span class="keyword">TYPE</span> <span class="keyword">TABLE</span> OF typ_fieldnames,</span><br><span class="line">    ls_fieldnames <span class="keyword">TYPE</span>          typ_fieldnames.</span><br><span class="line"></span><br><span class="line">  l_filename = p_dfile.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">CLEAR</span> ls_fieldnames.</span><br><span class="line">  ls_fieldnames-name = '删除标记'.</span><br><span class="line">  <span class="keyword">APPEND</span> ls_fieldnames-name TO lt_fieldnames.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">CLEAR</span> ls_fieldnames.</span><br><span class="line">  ls_fieldnames-name = '工厂'.</span><br><span class="line">  <span class="keyword">APPEND</span> ls_fieldnames-name TO lt_fieldnames.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">CLEAR</span> ls_fieldnames.</span><br><span class="line">  ls_fieldnames-name = '主件物料'.</span><br><span class="line">  <span class="keyword">APPEND</span> ls_fieldnames-name TO lt_fieldnames.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">CLEAR</span> ls_fieldnames.</span><br><span class="line">  ls_fieldnames-name = '主物料描述'.</span><br><span class="line">  <span class="keyword">APPEND</span> ls_fieldnames-name TO lt_fieldnames.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">CLEAR</span> ls_fieldnames.</span><br><span class="line">  ls_fieldnames-name = 'BOM用途'.</span><br><span class="line">  <span class="keyword">APPEND</span> ls_fieldnames-name TO lt_fieldnames.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">CLEAR</span> ls_fieldnames.</span><br><span class="line">  ls_fieldnames-name = '可选的 BOM'.</span><br><span class="line">  <span class="keyword">APPEND</span> ls_fieldnames-name TO lt_fieldnames.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">CLEAR</span> ls_fieldnames.</span><br><span class="line">  ls_fieldnames-name = '基准数量'.</span><br><span class="line">  <span class="keyword">APPEND</span> ls_fieldnames-name TO lt_fieldnames.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">CLEAR</span> ls_fieldnames.</span><br><span class="line">  ls_fieldnames-name = 'BOM状态'.</span><br><span class="line">  <span class="keyword">APPEND</span> ls_fieldnames-name TO lt_fieldnames.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">CLEAR</span> ls_fieldnames.</span><br><span class="line">  ls_fieldnames-name = '项目类别'.</span><br><span class="line">  <span class="keyword">APPEND</span> ls_fieldnames-name TO lt_fieldnames.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">CLEAR</span> ls_fieldnames.</span><br><span class="line">  ls_fieldnames-name = 'BOM 项目号'.</span><br><span class="line">  <span class="keyword">APPEND</span> ls_fieldnames-name TO lt_fieldnames.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">CLEAR</span> ls_fieldnames.</span><br><span class="line">  ls_fieldnames-name = '子物料号'.</span><br><span class="line">  <span class="keyword">APPEND</span> ls_fieldnames-name TO lt_fieldnames.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">CLEAR</span> ls_fieldnames.</span><br><span class="line">  ls_fieldnames-name = '子物料描述'.</span><br><span class="line">  <span class="keyword">APPEND</span> ls_fieldnames-name TO lt_fieldnames.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">CLEAR</span> ls_fieldnames.</span><br><span class="line">  ls_fieldnames-name = '数量'.</span><br><span class="line">  <span class="keyword">APPEND</span> ls_fieldnames-name TO lt_fieldnames.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">CLEAR</span> ls_fieldnames.</span><br><span class="line">  ls_fieldnames-name = '计量单位'.</span><br><span class="line">  <span class="keyword">APPEND</span> ls_fieldnames-name TO lt_fieldnames.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">CLEAR</span> ls_fieldnames.</span><br><span class="line">  ls_fieldnames-name = '行项目文本'.</span><br><span class="line">  <span class="keyword">APPEND</span> ls_fieldnames-name TO lt_fieldnames.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">CLEAR</span> ls_fieldnames.</span><br><span class="line">  ls_fieldnames-name = '排序字符串'.</span><br><span class="line">  <span class="keyword">APPEND</span> ls_fieldnames-name TO lt_fieldnames.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">CLEAR</span> ls_fieldnames.</span><br><span class="line">  ls_fieldnames-name = '损耗率'.</span><br><span class="line">  <span class="keyword">APPEND</span> ls_fieldnames-name TO lt_fieldnames.</span><br><span class="line"></span><br><span class="line"><span class="comment">*  CLEAR ls_fieldnames.</span></span><br><span class="line"><span class="comment">*  ls_fieldnames-name = '相关性1'.</span></span><br><span class="line"><span class="comment">*  APPEND ls_fieldnames-name TO lt_fieldnames.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  CLEAR ls_fieldnames.</span></span><br><span class="line"><span class="comment">*  ls_fieldnames-name = '相关性2'.</span></span><br><span class="line"><span class="comment">*  APPEND ls_fieldnames-name TO lt_fieldnames.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  CLEAR ls_fieldnames.</span></span><br><span class="line"><span class="comment">*  ls_fieldnames-name = '相关性3'.</span></span><br><span class="line"><span class="comment">*  APPEND ls_fieldnames-name TO lt_fieldnames.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  CLEAR ls_fieldnames.</span></span><br><span class="line"><span class="comment">*  ls_fieldnames-name = '相关性4'.</span></span><br><span class="line"><span class="comment">*  APPEND ls_fieldnames-name TO lt_fieldnames.</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">CLEAR</span> ls_fieldnames.</span><br><span class="line">  ls_fieldnames-name = '替代：组'.</span><br><span class="line">  <span class="keyword">APPEND</span> ls_fieldnames-name TO lt_fieldnames.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">CLEAR</span> ls_fieldnames.</span><br><span class="line">  ls_fieldnames-name = '优先级'.</span><br><span class="line">  <span class="keyword">APPEND</span> ls_fieldnames-name TO lt_fieldnames.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">CLEAR</span> ls_fieldnames.</span><br><span class="line">  ls_fieldnames-name = '替代:策略'.</span><br><span class="line">  <span class="keyword">APPEND</span> ls_fieldnames-name TO lt_fieldnames.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">CLEAR</span> ls_fieldnames.</span><br><span class="line">  ls_fieldnames-name = '使用可能性'.</span><br><span class="line">  <span class="keyword">APPEND</span> ls_fieldnames-name TO lt_fieldnames.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">CLEAR</span> ls_fieldnames.</span><br><span class="line">  ls_fieldnames-name = '成本标志'.</span><br><span class="line">  <span class="keyword">APPEND</span> ls_fieldnames-name TO lt_fieldnames.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">CLEAR</span> ls_fieldnames.</span><br><span class="line">  ls_fieldnames-name = '散装物料'.</span><br><span class="line">  <span class="keyword">APPEND</span> ls_fieldnames-name TO lt_fieldnames.</span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  CLEAR ls_fieldnames.</span></span><br><span class="line"><span class="comment">*  ls_fieldnames-name = '提前期偏置'.</span></span><br><span class="line"><span class="comment">*  APPEND ls_fieldnames-name TO lt_fieldnames.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  CLEAR ls_fieldnames.</span></span><br><span class="line"><span class="comment">*  ls_fieldnames-name = '工序偏置'.</span></span><br><span class="line"><span class="comment">*  APPEND ls_fieldnames-name TO lt_fieldnames.</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">CLEAR</span> ls_fieldnames.</span><br><span class="line">  ls_fieldnames-name = '仓库地点'.</span><br><span class="line">  <span class="keyword">APPEND</span> ls_fieldnames-name TO lt_fieldnames.</span><br><span class="line"></span><br><span class="line">  CALL FUNCTION 'GUI_DOWNLOAD'</span><br><span class="line">    EXPORTING</span><br><span class="line">      filename                = l_filename</span><br><span class="line">      filetype                = 'DBF'</span><br><span class="line">      write_field_separator   = 'X'</span><br><span class="line">      codepage                = '8400'</span><br><span class="line">    TABLES</span><br><span class="line">      data_tab                = gt_data_out</span><br><span class="line">      fieldnames              = lt_fieldnames</span><br><span class="line">    EXCEPTIONS</span><br><span class="line">      file_write_error        = 1</span><br><span class="line">      no_batch                = 2</span><br><span class="line">      gui_refuse_filetransfer = 3</span><br><span class="line">      invalid_type            = 4</span><br><span class="line">      no_authority            = 5</span><br><span class="line">      unknown_error           = 6</span><br><span class="line">      header_not_allowed      = 7</span><br><span class="line">      separator_not_allowed   = 8</span><br><span class="line">      filesize_not_allowed    = 9</span><br><span class="line">      header_too_long         = 10</span><br><span class="line">      dp_error_create         = 11</span><br><span class="line">      dp_error_send           = 12</span><br><span class="line">      dp_error_write          = 13</span><br><span class="line">      unknown_dp_error        = 14</span><br><span class="line">      access_denied           = 15</span><br><span class="line">      dp_out_of_memory        = 16</span><br><span class="line">      disk_full               = 17</span><br><span class="line">      dp_timeout              = 18</span><br><span class="line">      file_not_found          = 19</span><br><span class="line">      dataprovider_exception  = 20</span><br><span class="line">      control_flush_error     = 21</span><br><span class="line">      OTHERS                  = 22.</span><br><span class="line">  <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line">    MESSAGE ID sy-msgid <span class="keyword">TYPE</span> 'S' NUMBER sy-msgno</span><br><span class="line">    WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4 <span class="keyword">DISPLAY</span> LIKE '<span class="keyword">E</span>'.</span><br><span class="line"></span><br><span class="line">    LEAVE <span class="keyword">LIST</span>-PROCESSING.</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line">    MESSAGE '数据导出成功' <span class="keyword">TYPE</span> 'S'.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">ENDFORM.</span></span><br></pre></td></tr></table></figure>
<h3 id="BOM导出">BOM导出</h3><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br><span class="line">1073</span><br><span class="line">1074</span><br><span class="line">1075</span><br><span class="line">1076</span><br><span class="line">1077</span><br><span class="line">1078</span><br><span class="line">1079</span><br><span class="line">1080</span><br><span class="line">1081</span><br><span class="line">1082</span><br><span class="line">1083</span><br><span class="line">1084</span><br><span class="line">1085</span><br><span class="line">1086</span><br><span class="line">1087</span><br><span class="line">1088</span><br><span class="line">1089</span><br><span class="line">1090</span><br><span class="line">1091</span><br><span class="line">1092</span><br><span class="line">1093</span><br><span class="line">1094</span><br><span class="line">1095</span><br><span class="line">1096</span><br><span class="line">1097</span><br><span class="line">1098</span><br><span class="line">1099</span><br><span class="line">1100</span><br><span class="line">1101</span><br><span class="line">1102</span><br><span class="line">1103</span><br><span class="line">1104</span><br><span class="line">1105</span><br><span class="line">1106</span><br><span class="line">1107</span><br><span class="line">1108</span><br><span class="line">1109</span><br><span class="line">1110</span><br><span class="line">1111</span><br><span class="line">1112</span><br><span class="line">1113</span><br><span class="line">1114</span><br><span class="line">1115</span><br><span class="line">1116</span><br><span class="line">1117</span><br><span class="line">1118</span><br><span class="line">1119</span><br><span class="line">1120</span><br><span class="line">1121</span><br><span class="line">1122</span><br><span class="line">1123</span><br><span class="line">1124</span><br><span class="line">1125</span><br><span class="line">1126</span><br><span class="line">1127</span><br><span class="line">1128</span><br><span class="line">1129</span><br><span class="line">1130</span><br><span class="line">1131</span><br><span class="line">1132</span><br><span class="line">1133</span><br><span class="line">1134</span><br><span class="line">1135</span><br><span class="line">1136</span><br><span class="line">1137</span><br><span class="line">1138</span><br><span class="line">1139</span><br><span class="line">1140</span><br><span class="line">1141</span><br><span class="line">1142</span><br><span class="line">1143</span><br><span class="line">1144</span><br><span class="line">1145</span><br><span class="line">1146</span><br><span class="line">1147</span><br><span class="line">1148</span><br><span class="line">1149</span><br><span class="line">1150</span><br><span class="line">1151</span><br><span class="line">1152</span><br><span class="line">1153</span><br><span class="line">1154</span><br><span class="line">1155</span><br><span class="line">1156</span><br><span class="line">1157</span><br><span class="line">1158</span><br><span class="line">1159</span><br><span class="line">1160</span><br><span class="line">1161</span><br><span class="line">1162</span><br><span class="line">1163</span><br><span class="line">1164</span><br><span class="line">1165</span><br><span class="line">1166</span><br><span class="line">1167</span><br><span class="line">1168</span><br><span class="line">1169</span><br><span class="line">1170</span><br><span class="line">1171</span><br><span class="line">1172</span><br><span class="line">1173</span><br><span class="line">1174</span><br><span class="line">1175</span><br><span class="line">1176</span><br><span class="line">1177</span><br><span class="line">1178</span><br><span class="line">1179</span><br><span class="line">1180</span><br><span class="line">1181</span><br><span class="line">1182</span><br><span class="line">1183</span><br><span class="line">1184</span><br><span class="line">1185</span><br><span class="line">1186</span><br><span class="line">1187</span><br><span class="line">1188</span><br><span class="line">1189</span><br><span class="line">1190</span><br><span class="line">1191</span><br><span class="line">1192</span><br><span class="line">1193</span><br><span class="line">1194</span><br><span class="line">1195</span><br><span class="line">1196</span><br><span class="line">1197</span><br><span class="line">1198</span><br><span class="line">1199</span><br><span class="line">1200</span><br><span class="line">1201</span><br><span class="line">1202</span><br><span class="line">1203</span><br><span class="line">1204</span><br><span class="line">1205</span><br><span class="line">1206</span><br><span class="line">1207</span><br><span class="line">1208</span><br><span class="line">1209</span><br><span class="line">1210</span><br><span class="line">1211</span><br><span class="line">1212</span><br><span class="line">1213</span><br><span class="line">1214</span><br><span class="line">1215</span><br><span class="line">1216</span><br><span class="line">1217</span><br><span class="line">1218</span><br><span class="line">1219</span><br><span class="line">1220</span><br><span class="line">1221</span><br><span class="line">1222</span><br><span class="line">1223</span><br><span class="line">1224</span><br><span class="line">1225</span><br><span class="line">1226</span><br><span class="line">1227</span><br><span class="line">1228</span><br><span class="line">1229</span><br><span class="line">1230</span><br><span class="line">1231</span><br><span class="line">1232</span><br><span class="line">1233</span><br><span class="line">1234</span><br><span class="line">1235</span><br><span class="line">1236</span><br><span class="line">1237</span><br><span class="line">1238</span><br><span class="line">1239</span><br><span class="line">1240</span><br><span class="line">1241</span><br><span class="line">1242</span><br><span class="line">1243</span><br><span class="line">1244</span><br><span class="line">1245</span><br><span class="line">1246</span><br><span class="line">1247</span><br><span class="line">1248</span><br><span class="line">1249</span><br><span class="line">1250</span><br><span class="line">1251</span><br><span class="line">1252</span><br><span class="line">1253</span><br><span class="line">1254</span><br><span class="line">1255</span><br><span class="line">1256</span><br><span class="line">1257</span><br><span class="line">1258</span><br><span class="line">1259</span><br><span class="line">1260</span><br><span class="line">1261</span><br><span class="line">1262</span><br><span class="line">1263</span><br><span class="line">1264</span><br><span class="line">1265</span><br><span class="line">1266</span><br><span class="line">1267</span><br><span class="line">1268</span><br><span class="line">1269</span><br><span class="line">1270</span><br><span class="line">1271</span><br><span class="line">1272</span><br><span class="line">1273</span><br><span class="line">1274</span><br><span class="line">1275</span><br><span class="line">1276</span><br><span class="line">1277</span><br><span class="line">1278</span><br><span class="line">1279</span><br><span class="line">1280</span><br><span class="line">1281</span><br><span class="line">1282</span><br><span class="line">1283</span><br><span class="line">1284</span><br><span class="line">1285</span><br><span class="line">1286</span><br><span class="line">1287</span><br><span class="line">1288</span><br><span class="line">1289</span><br><span class="line">1290</span><br><span class="line">1291</span><br><span class="line">1292</span><br><span class="line">1293</span><br><span class="line">1294</span><br><span class="line">1295</span><br><span class="line">1296</span><br><span class="line">1297</span><br><span class="line">1298</span><br><span class="line">1299</span><br><span class="line">1300</span><br><span class="line">1301</span><br><span class="line">1302</span><br><span class="line">1303</span><br><span class="line">1304</span><br><span class="line">1305</span><br><span class="line">1306</span><br><span class="line">1307</span><br><span class="line">1308</span><br><span class="line">1309</span><br><span class="line">1310</span><br><span class="line">1311</span><br><span class="line">1312</span><br><span class="line">1313</span><br><span class="line">1314</span><br><span class="line">1315</span><br><span class="line">1316</span><br><span class="line">1317</span><br><span class="line">1318</span><br><span class="line">1319</span><br><span class="line">1320</span><br><span class="line">1321</span><br><span class="line">1322</span><br><span class="line">1323</span><br><span class="line">1324</span><br><span class="line">1325</span><br><span class="line">1326</span><br><span class="line">1327</span><br><span class="line">1328</span><br><span class="line">1329</span><br><span class="line">1330</span><br><span class="line">1331</span><br><span class="line">1332</span><br><span class="line">1333</span><br><span class="line">1334</span><br><span class="line">1335</span><br><span class="line">1336</span><br><span class="line">1337</span><br><span class="line">1338</span><br><span class="line">1339</span><br><span class="line">1340</span><br><span class="line">1341</span><br><span class="line">1342</span><br><span class="line">1343</span><br><span class="line">1344</span><br><span class="line">1345</span><br><span class="line">1346</span><br><span class="line">1347</span><br><span class="line">1348</span><br><span class="line">1349</span><br><span class="line">1350</span><br><span class="line">1351</span><br><span class="line">1352</span><br><span class="line">1353</span><br><span class="line">1354</span><br><span class="line">1355</span><br><span class="line">1356</span><br><span class="line">1357</span><br><span class="line">1358</span><br><span class="line">1359</span><br><span class="line">1360</span><br><span class="line">1361</span><br><span class="line">1362</span><br><span class="line">1363</span><br><span class="line">1364</span><br><span class="line">1365</span><br><span class="line">1366</span><br><span class="line">1367</span><br><span class="line">1368</span><br><span class="line">1369</span><br><span class="line">1370</span><br><span class="line">1371</span><br><span class="line">1372</span><br><span class="line">1373</span><br><span class="line">1374</span><br><span class="line">1375</span><br><span class="line">1376</span><br><span class="line">1377</span><br><span class="line">1378</span><br><span class="line">1379</span><br><span class="line">1380</span><br><span class="line">1381</span><br><span class="line">1382</span><br><span class="line">1383</span><br><span class="line">1384</span><br><span class="line">1385</span><br><span class="line">1386</span><br><span class="line">1387</span><br><span class="line">1388</span><br><span class="line">1389</span><br><span class="line">1390</span><br><span class="line">1391</span><br><span class="line">1392</span><br><span class="line">1393</span><br><span class="line">1394</span><br><span class="line">1395</span><br><span class="line">1396</span><br><span class="line">1397</span><br><span class="line">1398</span><br><span class="line">1399</span><br><span class="line">1400</span><br><span class="line">1401</span><br><span class="line">1402</span><br><span class="line">1403</span><br><span class="line">1404</span><br><span class="line">1405</span><br><span class="line">1406</span><br><span class="line">1407</span><br><span class="line">1408</span><br><span class="line">1409</span><br><span class="line">1410</span><br><span class="line">1411</span><br><span class="line">1412</span><br><span class="line">1413</span><br><span class="line">1414</span><br><span class="line">1415</span><br><span class="line">1416</span><br><span class="line">1417</span><br><span class="line">1418</span><br><span class="line">1419</span><br><span class="line">1420</span><br><span class="line">1421</span><br><span class="line">1422</span><br><span class="line">1423</span><br><span class="line">1424</span><br><span class="line">1425</span><br><span class="line">1426</span><br><span class="line">1427</span><br><span class="line">1428</span><br><span class="line">1429</span><br><span class="line">1430</span><br><span class="line">1431</span><br><span class="line">1432</span><br><span class="line">1433</span><br><span class="line">1434</span><br><span class="line">1435</span><br><span class="line">1436</span><br><span class="line">1437</span><br><span class="line">1438</span><br><span class="line">1439</span><br><span class="line">1440</span><br><span class="line">1441</span><br><span class="line">1442</span><br><span class="line">1443</span><br><span class="line">1444</span><br><span class="line">1445</span><br><span class="line">1446</span><br><span class="line">1447</span><br><span class="line">1448</span><br><span class="line">1449</span><br><span class="line">1450</span><br><span class="line">1451</span><br><span class="line">1452</span><br><span class="line">1453</span><br><span class="line">1454</span><br><span class="line">1455</span><br><span class="line">1456</span><br><span class="line">1457</span><br><span class="line">1458</span><br><span class="line">1459</span><br><span class="line">1460</span><br><span class="line">1461</span><br><span class="line">1462</span><br><span class="line">1463</span><br><span class="line">1464</span><br><span class="line">1465</span><br><span class="line">1466</span><br><span class="line">1467</span><br><span class="line">1468</span><br><span class="line">1469</span><br><span class="line">1470</span><br><span class="line">1471</span><br><span class="line">1472</span><br><span class="line">1473</span><br><span class="line">1474</span><br><span class="line">1475</span><br><span class="line">1476</span><br><span class="line">1477</span><br><span class="line">1478</span><br><span class="line">1479</span><br><span class="line">1480</span><br><span class="line">1481</span><br><span class="line">1482</span><br><span class="line">1483</span><br><span class="line">1484</span><br><span class="line">1485</span><br><span class="line">1486</span><br><span class="line">1487</span><br><span class="line">1488</span><br><span class="line">1489</span><br><span class="line">1490</span><br><span class="line">1491</span><br><span class="line">1492</span><br><span class="line">1493</span><br><span class="line">1494</span><br><span class="line">1495</span><br><span class="line">1496</span><br><span class="line">1497</span><br><span class="line">1498</span><br><span class="line">1499</span><br><span class="line">1500</span><br><span class="line">1501</span><br><span class="line">1502</span><br><span class="line">1503</span><br><span class="line">1504</span><br><span class="line">1505</span><br><span class="line">1506</span><br><span class="line">1507</span><br><span class="line">1508</span><br><span class="line">1509</span><br><span class="line">1510</span><br><span class="line">1511</span><br><span class="line">1512</span><br><span class="line">1513</span><br><span class="line">1514</span><br><span class="line">1515</span><br><span class="line">1516</span><br><span class="line">1517</span><br><span class="line">1518</span><br><span class="line">1519</span><br><span class="line">1520</span><br><span class="line">1521</span><br><span class="line">1522</span><br><span class="line">1523</span><br><span class="line">1524</span><br><span class="line">1525</span><br><span class="line">1526</span><br><span class="line">1527</span><br><span class="line">1528</span><br><span class="line">1529</span><br><span class="line">1530</span><br><span class="line">1531</span><br><span class="line">1532</span><br><span class="line">1533</span><br><span class="line">1534</span><br><span class="line">1535</span><br><span class="line">1536</span><br><span class="line">1537</span><br><span class="line">1538</span><br><span class="line">1539</span><br><span class="line">1540</span><br><span class="line">1541</span><br><span class="line">1542</span><br><span class="line">1543</span><br><span class="line">1544</span><br><span class="line">1545</span><br><span class="line">1546</span><br><span class="line">1547</span><br><span class="line">1548</span><br><span class="line">1549</span><br><span class="line">1550</span><br><span class="line">1551</span><br><span class="line">1552</span><br><span class="line">1553</span><br><span class="line">1554</span><br><span class="line">1555</span><br><span class="line">1556</span><br><span class="line">1557</span><br><span class="line">1558</span><br><span class="line">1559</span><br><span class="line">1560</span><br><span class="line">1561</span><br><span class="line">1562</span><br><span class="line">1563</span><br><span class="line">1564</span><br><span class="line">1565</span><br><span class="line">1566</span><br><span class="line">1567</span><br><span class="line">1568</span><br><span class="line">1569</span><br><span class="line">1570</span><br><span class="line">1571</span><br><span class="line">1572</span><br><span class="line">1573</span><br><span class="line">1574</span><br><span class="line">1575</span><br><span class="line">1576</span><br><span class="line">1577</span><br><span class="line">1578</span><br><span class="line">1579</span><br><span class="line">1580</span><br><span class="line">1581</span><br><span class="line">1582</span><br><span class="line">1583</span><br><span class="line">1584</span><br><span class="line">1585</span><br><span class="line">1586</span><br><span class="line">1587</span><br><span class="line">1588</span><br><span class="line">1589</span><br><span class="line">1590</span><br><span class="line">1591</span><br><span class="line">1592</span><br><span class="line">1593</span><br><span class="line">1594</span><br><span class="line">1595</span><br><span class="line">1596</span><br><span class="line">1597</span><br><span class="line">1598</span><br><span class="line">1599</span><br><span class="line">1600</span><br><span class="line">1601</span><br><span class="line">1602</span><br><span class="line">1603</span><br><span class="line">1604</span><br><span class="line">1605</span><br><span class="line">1606</span><br><span class="line">1607</span><br><span class="line">1608</span><br><span class="line">1609</span><br><span class="line">1610</span><br><span class="line">1611</span><br><span class="line">1612</span><br><span class="line">1613</span><br><span class="line">1614</span><br><span class="line">1615</span><br><span class="line">1616</span><br><span class="line">1617</span><br><span class="line">1618</span><br><span class="line">1619</span><br><span class="line">1620</span><br><span class="line">1621</span><br><span class="line">1622</span><br><span class="line">1623</span><br><span class="line">1624</span><br><span class="line">1625</span><br><span class="line">1626</span><br><span class="line">1627</span><br><span class="line">1628</span><br><span class="line">1629</span><br><span class="line">1630</span><br><span class="line">1631</span><br><span class="line">1632</span><br><span class="line">1633</span><br><span class="line">1634</span><br><span class="line">1635</span><br><span class="line">1636</span><br><span class="line">1637</span><br><span class="line">1638</span><br><span class="line">1639</span><br><span class="line">1640</span><br><span class="line">1641</span><br><span class="line">1642</span><br><span class="line">1643</span><br><span class="line">1644</span><br><span class="line">1645</span><br><span class="line">1646</span><br><span class="line">1647</span><br><span class="line">1648</span><br><span class="line">1649</span><br><span class="line">1650</span><br><span class="line">1651</span><br><span class="line">1652</span><br><span class="line">1653</span><br><span class="line">1654</span><br><span class="line">1655</span><br><span class="line">1656</span><br><span class="line">1657</span><br><span class="line">1658</span><br><span class="line">1659</span><br><span class="line">1660</span><br><span class="line">1661</span><br><span class="line">1662</span><br><span class="line">1663</span><br><span class="line">1664</span><br><span class="line">1665</span><br><span class="line">1666</span><br><span class="line">1667</span><br><span class="line">1668</span><br><span class="line">1669</span><br><span class="line">1670</span><br><span class="line">1671</span><br><span class="line">1672</span><br><span class="line">1673</span><br><span class="line">1674</span><br><span class="line">1675</span><br><span class="line">1676</span><br><span class="line">1677</span><br><span class="line">1678</span><br><span class="line">1679</span><br><span class="line">1680</span><br><span class="line">1681</span><br><span class="line">1682</span><br><span class="line">1683</span><br><span class="line">1684</span><br><span class="line">1685</span><br><span class="line">1686</span><br><span class="line">1687</span><br><span class="line">1688</span><br><span class="line">1689</span><br><span class="line">1690</span><br><span class="line">1691</span><br><span class="line">1692</span><br><span class="line">1693</span><br><span class="line">1694</span><br><span class="line">1695</span><br><span class="line">1696</span><br><span class="line">1697</span><br><span class="line">1698</span><br><span class="line">1699</span><br><span class="line">1700</span><br><span class="line">1701</span><br><span class="line">1702</span><br><span class="line">1703</span><br><span class="line">1704</span><br><span class="line">1705</span><br><span class="line">1706</span><br><span class="line">1707</span><br><span class="line">1708</span><br><span class="line">1709</span><br><span class="line">1710</span><br><span class="line">1711</span><br><span class="line">1712</span><br><span class="line">1713</span><br><span class="line">1714</span><br><span class="line">1715</span><br><span class="line">1716</span><br><span class="line">1717</span><br><span class="line">1718</span><br><span class="line">1719</span><br><span class="line">1720</span><br><span class="line">1721</span><br><span class="line">1722</span><br><span class="line">1723</span><br><span class="line">1724</span><br><span class="line">1725</span><br><span class="line">1726</span><br><span class="line">1727</span><br><span class="line">1728</span><br><span class="line">1729</span><br><span class="line">1730</span><br><span class="line">1731</span><br><span class="line">1732</span><br><span class="line">1733</span><br><span class="line">1734</span><br><span class="line">1735</span><br><span class="line">1736</span><br><span class="line">1737</span><br><span class="line">1738</span><br><span class="line">1739</span><br><span class="line">1740</span><br><span class="line">1741</span><br><span class="line">1742</span><br><span class="line">1743</span><br><span class="line">1744</span><br><span class="line">1745</span><br><span class="line">1746</span><br><span class="line">1747</span><br><span class="line">1748</span><br><span class="line">1749</span><br><span class="line">1750</span><br><span class="line">1751</span><br><span class="line">1752</span><br><span class="line">1753</span><br><span class="line">1754</span><br><span class="line">1755</span><br><span class="line">1756</span><br><span class="line">1757</span><br><span class="line">1758</span><br><span class="line">1759</span><br><span class="line">1760</span><br><span class="line">1761</span><br><span class="line">1762</span><br><span class="line">1763</span><br><span class="line">1764</span><br><span class="line">1765</span><br><span class="line">1766</span><br><span class="line">1767</span><br><span class="line">1768</span><br><span class="line">1769</span><br><span class="line">1770</span><br><span class="line">1771</span><br><span class="line">1772</span><br><span class="line">1773</span><br><span class="line">1774</span><br><span class="line">1775</span><br><span class="line">1776</span><br><span class="line">1777</span><br><span class="line">1778</span><br><span class="line">1779</span><br><span class="line">1780</span><br><span class="line">1781</span><br><span class="line">1782</span><br><span class="line">1783</span><br><span class="line">1784</span><br><span class="line">1785</span><br><span class="line">1786</span><br><span class="line">1787</span><br><span class="line">1788</span><br><span class="line">1789</span><br><span class="line">1790</span><br><span class="line">1791</span><br><span class="line">1792</span><br><span class="line">1793</span><br><span class="line">1794</span><br><span class="line">1795</span><br><span class="line">1796</span><br><span class="line">1797</span><br><span class="line">1798</span><br><span class="line">1799</span><br><span class="line">1800</span><br><span class="line">1801</span><br><span class="line">1802</span><br><span class="line">1803</span><br><span class="line">1804</span><br><span class="line">1805</span><br><span class="line">1806</span><br><span class="line">1807</span><br><span class="line">1808</span><br><span class="line">1809</span><br><span class="line">1810</span><br><span class="line">1811</span><br><span class="line">1812</span><br><span class="line">1813</span><br><span class="line">1814</span><br><span class="line">1815</span><br><span class="line">1816</span><br><span class="line">1817</span><br><span class="line">1818</span><br><span class="line">1819</span><br><span class="line">1820</span><br><span class="line">1821</span><br><span class="line">1822</span><br><span class="line">1823</span><br><span class="line">1824</span><br><span class="line">1825</span><br><span class="line">1826</span><br><span class="line">1827</span><br><span class="line">1828</span><br><span class="line">1829</span><br><span class="line">1830</span><br><span class="line">1831</span><br><span class="line">1832</span><br><span class="line">1833</span><br><span class="line">1834</span><br><span class="line">1835</span><br><span class="line">1836</span><br><span class="line">1837</span><br><span class="line">1838</span><br><span class="line">1839</span><br><span class="line">1840</span><br><span class="line">1841</span><br><span class="line">1842</span><br><span class="line">1843</span><br><span class="line">1844</span><br><span class="line">1845</span><br><span class="line">1846</span><br><span class="line">1847</span><br><span class="line">1848</span><br><span class="line">1849</span><br><span class="line">1850</span><br><span class="line">1851</span><br><span class="line">1852</span><br><span class="line">1853</span><br><span class="line">1854</span><br><span class="line">1855</span><br><span class="line">1856</span><br><span class="line">1857</span><br><span class="line">1858</span><br><span class="line">1859</span><br><span class="line">1860</span><br><span class="line">1861</span><br><span class="line">1862</span><br><span class="line">1863</span><br><span class="line">1864</span><br><span class="line">1865</span><br><span class="line">1866</span><br><span class="line">1867</span><br><span class="line">1868</span><br><span class="line">1869</span><br><span class="line">1870</span><br><span class="line">1871</span><br><span class="line">1872</span><br><span class="line">1873</span><br><span class="line">1874</span><br><span class="line">1875</span><br><span class="line">1876</span><br><span class="line">1877</span><br><span class="line">1878</span><br><span class="line">1879</span><br><span class="line">1880</span><br><span class="line">1881</span><br><span class="line">1882</span><br><span class="line">1883</span><br><span class="line">1884</span><br><span class="line">1885</span><br><span class="line">1886</span><br><span class="line">1887</span><br><span class="line">1888</span><br><span class="line">1889</span><br><span class="line">1890</span><br><span class="line">1891</span><br><span class="line">1892</span><br><span class="line">1893</span><br><span class="line">1894</span><br><span class="line">1895</span><br><span class="line">1896</span><br><span class="line">1897</span><br><span class="line">1898</span><br><span class="line">1899</span><br><span class="line">1900</span><br><span class="line">1901</span><br><span class="line">1902</span><br><span class="line">1903</span><br><span class="line">1904</span><br><span class="line">1905</span><br><span class="line">1906</span><br><span class="line">1907</span><br><span class="line">1908</span><br><span class="line">1909</span><br><span class="line">1910</span><br><span class="line">1911</span><br><span class="line">1912</span><br><span class="line">1913</span><br><span class="line">1914</span><br><span class="line">1915</span><br><span class="line">1916</span><br><span class="line">1917</span><br><span class="line">1918</span><br><span class="line">1919</span><br><span class="line">1920</span><br><span class="line">1921</span><br><span class="line">1922</span><br><span class="line">1923</span><br><span class="line">1924</span><br><span class="line">1925</span><br><span class="line">1926</span><br><span class="line">1927</span><br><span class="line">1928</span><br><span class="line">1929</span><br><span class="line">1930</span><br><span class="line">1931</span><br><span class="line">1932</span><br><span class="line">1933</span><br><span class="line">1934</span><br><span class="line">1935</span><br><span class="line">1936</span><br><span class="line">1937</span><br><span class="line">1938</span><br><span class="line">1939</span><br><span class="line">1940</span><br><span class="line">1941</span><br><span class="line">1942</span><br><span class="line">1943</span><br><span class="line">1944</span><br><span class="line">1945</span><br><span class="line">1946</span><br><span class="line">1947</span><br><span class="line">1948</span><br><span class="line">1949</span><br><span class="line">1950</span><br><span class="line">1951</span><br><span class="line">1952</span><br><span class="line">1953</span><br><span class="line">1954</span><br><span class="line">1955</span><br><span class="line">1956</span><br><span class="line">1957</span><br><span class="line">1958</span><br><span class="line">1959</span><br><span class="line">1960</span><br><span class="line">1961</span><br><span class="line">1962</span><br><span class="line">1963</span><br><span class="line">1964</span><br><span class="line">1965</span><br><span class="line">1966</span><br><span class="line">1967</span><br><span class="line">1968</span><br><span class="line">1969</span><br><span class="line">1970</span><br><span class="line">1971</span><br><span class="line">1972</span><br><span class="line">1973</span><br><span class="line">1974</span><br><span class="line">1975</span><br><span class="line">1976</span><br><span class="line">1977</span><br><span class="line">1978</span><br><span class="line">1979</span><br><span class="line">1980</span><br><span class="line">1981</span><br><span class="line">1982</span><br><span class="line">1983</span><br><span class="line">1984</span><br><span class="line">1985</span><br><span class="line">1986</span><br><span class="line">1987</span><br><span class="line">1988</span><br><span class="line">1989</span><br><span class="line">1990</span><br><span class="line">1991</span><br><span class="line">1992</span><br><span class="line">1993</span><br><span class="line">1994</span><br><span class="line">1995</span><br><span class="line">1996</span><br><span class="line">1997</span><br><span class="line">1998</span><br><span class="line">1999</span><br><span class="line">2000</span><br><span class="line">2001</span><br><span class="line">2002</span><br><span class="line">2003</span><br><span class="line">2004</span><br><span class="line">2005</span><br><span class="line">2006</span><br><span class="line">2007</span><br><span class="line">2008</span><br><span class="line">2009</span><br><span class="line">2010</span><br><span class="line">2011</span><br><span class="line">2012</span><br><span class="line">2013</span><br><span class="line">2014</span><br><span class="line">2015</span><br><span class="line">2016</span><br><span class="line">2017</span><br><span class="line">2018</span><br><span class="line">2019</span><br><span class="line">2020</span><br><span class="line">2021</span><br><span class="line">2022</span><br><span class="line">2023</span><br><span class="line">2024</span><br><span class="line">2025</span><br><span class="line">2026</span><br><span class="line">2027</span><br><span class="line">2028</span><br><span class="line">2029</span><br><span class="line">2030</span><br><span class="line">2031</span><br><span class="line">2032</span><br><span class="line">2033</span><br><span class="line">2034</span><br><span class="line">2035</span><br><span class="line">2036</span><br><span class="line">2037</span><br><span class="line">2038</span><br><span class="line">2039</span><br><span class="line">2040</span><br><span class="line">2041</span><br><span class="line">2042</span><br><span class="line">2043</span><br><span class="line">2044</span><br><span class="line">2045</span><br><span class="line">2046</span><br><span class="line">2047</span><br><span class="line">2048</span><br><span class="line">2049</span><br><span class="line">2050</span><br><span class="line">2051</span><br><span class="line">2052</span><br><span class="line">2053</span><br><span class="line">2054</span><br><span class="line">2055</span><br><span class="line">2056</span><br><span class="line">2057</span><br><span class="line">2058</span><br><span class="line">2059</span><br><span class="line">2060</span><br><span class="line">2061</span><br><span class="line">2062</span><br><span class="line">2063</span><br><span class="line">2064</span><br><span class="line">2065</span><br><span class="line">2066</span><br><span class="line">2067</span><br><span class="line">2068</span><br><span class="line">2069</span><br><span class="line">2070</span><br><span class="line">2071</span><br><span class="line">2072</span><br><span class="line">2073</span><br><span class="line">2074</span><br><span class="line">2075</span><br><span class="line">2076</span><br><span class="line">2077</span><br><span class="line">2078</span><br><span class="line">2079</span><br><span class="line">2080</span><br><span class="line">2081</span><br><span class="line">2082</span><br><span class="line">2083</span><br><span class="line">2084</span><br><span class="line">2085</span><br><span class="line">2086</span><br><span class="line">2087</span><br><span class="line">2088</span><br><span class="line">2089</span><br><span class="line">2090</span><br><span class="line">2091</span><br><span class="line">2092</span><br><span class="line">2093</span><br><span class="line">2094</span><br><span class="line">2095</span><br><span class="line">2096</span><br><span class="line">2097</span><br><span class="line">2098</span><br><span class="line">2099</span><br><span class="line">2100</span><br><span class="line">2101</span><br><span class="line">2102</span><br><span class="line">2103</span><br><span class="line">2104</span><br><span class="line">2105</span><br><span class="line">2106</span><br><span class="line">2107</span><br><span class="line">2108</span><br><span class="line">2109</span><br><span class="line">2110</span><br><span class="line">2111</span><br><span class="line">2112</span><br><span class="line">2113</span><br><span class="line">2114</span><br><span class="line">2115</span><br><span class="line">2116</span><br><span class="line">2117</span><br><span class="line">2118</span><br><span class="line">2119</span><br><span class="line">2120</span><br><span class="line">2121</span><br><span class="line">2122</span><br><span class="line">2123</span><br><span class="line">2124</span><br><span class="line">2125</span><br><span class="line">2126</span><br><span class="line">2127</span><br><span class="line">2128</span><br><span class="line">2129</span><br><span class="line">2130</span><br><span class="line">2131</span><br><span class="line">2132</span><br><span class="line">2133</span><br><span class="line">2134</span><br><span class="line">2135</span><br><span class="line">2136</span><br><span class="line">2137</span><br><span class="line">2138</span><br><span class="line">2139</span><br><span class="line">2140</span><br><span class="line">2141</span><br><span class="line">2142</span><br><span class="line">2143</span><br><span class="line">2144</span><br><span class="line">2145</span><br><span class="line">2146</span><br><span class="line">2147</span><br><span class="line">2148</span><br><span class="line">2149</span><br><span class="line">2150</span><br><span class="line">2151</span><br><span class="line">2152</span><br><span class="line">2153</span><br><span class="line">2154</span><br><span class="line">2155</span><br><span class="line">2156</span><br><span class="line">2157</span><br><span class="line">2158</span><br><span class="line">2159</span><br><span class="line">2160</span><br><span class="line">2161</span><br><span class="line">2162</span><br><span class="line">2163</span><br><span class="line">2164</span><br><span class="line">2165</span><br><span class="line">2166</span><br><span class="line">2167</span><br><span class="line">2168</span><br><span class="line">2169</span><br><span class="line">2170</span><br><span class="line">2171</span><br><span class="line">2172</span><br><span class="line">2173</span><br><span class="line">2174</span><br><span class="line">2175</span><br><span class="line">2176</span><br><span class="line">2177</span><br><span class="line">2178</span><br><span class="line">2179</span><br><span class="line">2180</span><br><span class="line">2181</span><br><span class="line">2182</span><br><span class="line">2183</span><br><span class="line">2184</span><br><span class="line">2185</span><br><span class="line">2186</span><br><span class="line">2187</span><br><span class="line">2188</span><br><span class="line">2189</span><br><span class="line">2190</span><br><span class="line">2191</span><br><span class="line">2192</span><br><span class="line">2193</span><br><span class="line">2194</span><br><span class="line">2195</span><br><span class="line">2196</span><br><span class="line">2197</span><br><span class="line">2198</span><br><span class="line">2199</span><br><span class="line">2200</span><br><span class="line">2201</span><br><span class="line">2202</span><br><span class="line">2203</span><br><span class="line">2204</span><br><span class="line">2205</span><br><span class="line">2206</span><br><span class="line">2207</span><br><span class="line">2208</span><br><span class="line">2209</span><br><span class="line">2210</span><br><span class="line">2211</span><br><span class="line">2212</span><br><span class="line">2213</span><br><span class="line">2214</span><br><span class="line">2215</span><br><span class="line">2216</span><br><span class="line">2217</span><br><span class="line">2218</span><br><span class="line">2219</span><br><span class="line">2220</span><br><span class="line">2221</span><br><span class="line">2222</span><br><span class="line">2223</span><br><span class="line">2224</span><br><span class="line">2225</span><br><span class="line">2226</span><br><span class="line">2227</span><br><span class="line">2228</span><br><span class="line">2229</span><br><span class="line">2230</span><br><span class="line">2231</span><br><span class="line">2232</span><br><span class="line">2233</span><br><span class="line">2234</span><br><span class="line">2235</span><br><span class="line">2236</span><br><span class="line">2237</span><br><span class="line">2238</span><br><span class="line">2239</span><br><span class="line">2240</span><br><span class="line">2241</span><br><span class="line">2242</span><br><span class="line">2243</span><br><span class="line">2244</span><br><span class="line">2245</span><br><span class="line">2246</span><br><span class="line">2247</span><br><span class="line">2248</span><br><span class="line">2249</span><br><span class="line">2250</span><br><span class="line">2251</span><br><span class="line">2252</span><br><span class="line">2253</span><br><span class="line">2254</span><br><span class="line">2255</span><br><span class="line">2256</span><br><span class="line">2257</span><br><span class="line">2258</span><br><span class="line">2259</span><br><span class="line">2260</span><br><span class="line">2261</span><br><span class="line">2262</span><br><span class="line">2263</span><br><span class="line">2264</span><br><span class="line">2265</span><br><span class="line">2266</span><br><span class="line">2267</span><br><span class="line">2268</span><br><span class="line">2269</span><br><span class="line">2270</span><br><span class="line">2271</span><br><span class="line">2272</span><br><span class="line">2273</span><br><span class="line">2274</span><br><span class="line">2275</span><br><span class="line">2276</span><br><span class="line">2277</span><br><span class="line">2278</span><br><span class="line">2279</span><br><span class="line">2280</span><br><span class="line">2281</span><br><span class="line">2282</span><br><span class="line">2283</span><br><span class="line">2284</span><br><span class="line">2285</span><br><span class="line">2286</span><br><span class="line">2287</span><br><span class="line">2288</span><br><span class="line">2289</span><br><span class="line">2290</span><br><span class="line">2291</span><br><span class="line">2292</span><br><span class="line">2293</span><br><span class="line">2294</span><br><span class="line">2295</span><br><span class="line">2296</span><br><span class="line">2297</span><br><span class="line">2298</span><br><span class="line">2299</span><br><span class="line">2300</span><br><span class="line">2301</span><br><span class="line">2302</span><br><span class="line">2303</span><br><span class="line">2304</span><br><span class="line">2305</span><br><span class="line">2306</span><br><span class="line">2307</span><br><span class="line">2308</span><br><span class="line">2309</span><br><span class="line">2310</span><br><span class="line">2311</span><br><span class="line">2312</span><br><span class="line">2313</span><br><span class="line">2314</span><br><span class="line">2315</span><br><span class="line">2316</span><br><span class="line">2317</span><br><span class="line">2318</span><br><span class="line">2319</span><br><span class="line">2320</span><br><span class="line">2321</span><br><span class="line">2322</span><br><span class="line">2323</span><br><span class="line">2324</span><br><span class="line">2325</span><br><span class="line">2326</span><br><span class="line">2327</span><br><span class="line">2328</span><br><span class="line">2329</span><br><span class="line">2330</span><br><span class="line">2331</span><br><span class="line">2332</span><br><span class="line">2333</span><br><span class="line">2334</span><br><span class="line">2335</span><br><span class="line">2336</span><br><span class="line">2337</span><br><span class="line">2338</span><br><span class="line">2339</span><br><span class="line">2340</span><br><span class="line">2341</span><br><span class="line">2342</span><br><span class="line">2343</span><br><span class="line">2344</span><br><span class="line">2345</span><br><span class="line">2346</span><br><span class="line">2347</span><br><span class="line">2348</span><br><span class="line">2349</span><br><span class="line">2350</span><br><span class="line">2351</span><br><span class="line">2352</span><br><span class="line">2353</span><br><span class="line">2354</span><br><span class="line">2355</span><br><span class="line">2356</span><br><span class="line">2357</span><br><span class="line">2358</span><br><span class="line">2359</span><br><span class="line">2360</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="stata"></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp; Report  ZPPE008</span></span><br><span class="line"><span class="comment">*&amp;</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">* 程序名称  ZPPE008</span></span><br><span class="line"><span class="comment">* 程序说明  BOM创建修改删除</span></span><br><span class="line"><span class="comment">* 所属模块  PP</span></span><br><span class="line"><span class="comment">* 程序开发  郑常伟</span></span><br><span class="line"><span class="comment">* 程序描述  BOM创建修改删除</span></span><br><span class="line"><span class="comment">* 开发日期  2016-06-17</span></span><br><span class="line"><span class="comment">*&amp;--------------------------------------------------------------------&amp;*</span></span><br><span class="line"><span class="comment">*&amp;更改记录</span></span><br><span class="line"><span class="comment">*&amp;</span></span><br><span class="line"><span class="comment">*&amp;--------------------------------------------------------------------&amp;*</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">REPORT</span> zppe008.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">TABLES:</span><br><span class="line">  sscrfields,"选择屏幕-新增按钮</span><br><span class="line"> csap_mbom.</span><br><span class="line"><span class="keyword">TYPE</span>-POOLS: slis.</span><br><span class="line"></span><br><span class="line">TYPES:</span><br><span class="line">  BEGIN OF typ_file,</span><br><span class="line">    col01 <span class="keyword">TYPE</span> char200,                   "删除标记  +</span><br><span class="line">    col02 <span class="keyword">TYPE</span> char200,                   "工厂  +</span><br><span class="line">    col03 <span class="keyword">TYPE</span> char200,                   "主件物料(母件）+</span><br><span class="line">    col04 <span class="keyword">TYPE</span> char200,                   "主物料描述 +</span><br><span class="line">    col05 <span class="keyword">TYPE</span> char200,                   "BOM用途 +</span><br><span class="line">    col06 <span class="keyword">TYPE</span> char200,                   "可选的 BOM  ?</span><br><span class="line">    col07 <span class="keyword">TYPE</span> char200,                   "基准数量</span><br><span class="line">    col08 <span class="keyword">TYPE</span> char200,                   "BOM状态</span><br><span class="line">    col09 <span class="keyword">TYPE</span> char200,                   "项目类别（物料单）</span><br><span class="line">    col10 <span class="keyword">TYPE</span> char200,                   "BOM 项目号</span><br><span class="line">    col11 <span class="keyword">TYPE</span> char200,                   "子物料号</span><br><span class="line">    col12 <span class="keyword">TYPE</span> char200,                   "子物料描述</span><br><span class="line">    col13 <span class="keyword">TYPE</span> char200,                   "数量</span><br><span class="line">    col14 <span class="keyword">TYPE</span> char200,                   "组件计量单位</span><br><span class="line">    col15 <span class="keyword">TYPE</span> char200,                   "BOM行项目文本描述1</span><br><span class="line">    col16 <span class="keyword">TYPE</span> char200,                   "排序字符串</span><br><span class="line">    col17 <span class="keyword">TYPE</span> char200,                   "损耗率</span><br><span class="line"><span class="comment">*    col18 TYPE char200,                   "相关性1</span></span><br><span class="line"><span class="comment">*    col19 TYPE char200,                   "相关性2</span></span><br><span class="line"><span class="comment">*    col20 TYPE char200,                   "相关性3</span></span><br><span class="line"><span class="comment">*    col21 TYPE char200,                   "相关性4</span></span><br><span class="line">    col18 <span class="keyword">TYPE</span> char200,                   "替代项目：组</span><br><span class="line">    col19 <span class="keyword">TYPE</span> char200,                   "优先级</span><br><span class="line">    col20 <span class="keyword">TYPE</span> char200,                   "替代项目：策略</span><br><span class="line">    col21 <span class="keyword">TYPE</span> char200,                   "使用可能性按 % (BTCI)</span><br><span class="line"><span class="comment">*    col22 TYPE char200,                   "替代项目：组</span></span><br><span class="line"><span class="comment">*    col23 TYPE char200,                   "优先级</span></span><br><span class="line"><span class="comment">*    col24 TYPE char200,                   "替代项目：策略</span></span><br><span class="line"><span class="comment">*    col25 TYPE char200,                   "使用可能性按 % (BTCI)</span></span><br><span class="line">    col22 <span class="keyword">TYPE</span> char200,                   "成本标志: 与成本核算相关项目(选填)</span><br><span class="line">    col23 <span class="keyword">TYPE</span> char200,                   "散装物料(选填)</span><br><span class="line"><span class="comment">*    col24 type char200,                   "提前期偏置(非必须，可空着)(选填)</span></span><br><span class="line"><span class="comment">*    col25 type char200,                   "工序提前期偏置(非必须，可空着)(选填)</span></span><br><span class="line">    col24 <span class="keyword">TYPE</span> char200,                   "生产仓库地点(选填)</span><br><span class="line">  END OF typ_file,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* 导入数据</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  BEGIN OF typ_data_in,</span><br><span class="line">    werks       <span class="keyword">TYPE</span> csap_mbom-werks,           "工厂</span><br><span class="line">    matnr       <span class="keyword">TYPE</span> csap_mbom-matnr,           "主件物料(母件）</span><br><span class="line">    stlan       <span class="keyword">TYPE</span> csap_mbom-stlan,           "BOM用途</span><br><span class="line">    stlal       <span class="keyword">TYPE</span> csap_mbom-stlal,           "可选的 BOM</span><br><span class="line">    base_quan   <span class="keyword">TYPE</span> stko_api01-base_quan,      "基准数量</span><br><span class="line">    bom_status  <span class="keyword">TYPE</span> stko_api01-bom_status,     "BOM状态</span><br><span class="line">    item_categ  <span class="keyword">TYPE</span> stpo_api01-item_categ,     "项目类别（物料单）</span><br><span class="line">    item_no     <span class="keyword">TYPE</span> stpo_api01-item_no,        "BOM 项目号</span><br><span class="line">    component   <span class="keyword">TYPE</span> stpo_api01-component,      "子物料号</span><br><span class="line">    comp_qty    <span class="keyword">TYPE</span> stpo_api01-comp_qty,       "数量</span><br><span class="line">    comp_unit   <span class="keyword">TYPE</span> stpo_api01-comp_unit,      "组件计量单位</span><br><span class="line">    item_text1  <span class="keyword">TYPE</span> stpo_api01-item_text1,     "BOM行项目文本描述1</span><br><span class="line">    sortstring  <span class="keyword">TYPE</span> stpo_api01-sortstring,     "排序字符串</span><br><span class="line">    comp_scrap  <span class="keyword">TYPE</span> stpo_api01-comp_scrap,     "损耗率</span><br><span class="line">    dep_intern1 <span class="keyword">TYPE</span> csdep_dat-dep_intern,      "相关性1</span><br><span class="line">    dep_intern2 <span class="keyword">TYPE</span> csdep_dat-dep_intern,      "相关性2</span><br><span class="line">    dep_intern3 <span class="keyword">TYPE</span> csdep_dat-dep_intern,      "相关性3</span><br><span class="line">    dep_intern4 <span class="keyword">TYPE</span> csdep_dat-dep_intern,      "相关性4</span><br><span class="line">    ai_group    <span class="keyword">TYPE</span> stpo_api01-ai_group,       "替代项目：组</span><br><span class="line">    ai_prio     <span class="keyword">TYPE</span> stpo_api01-ai_prio,        "优先级</span><br><span class="line">    ai_strateg  <span class="keyword">TYPE</span> stpo_api01-ai_strateg,     "替代项目：策略</span><br><span class="line">    usage_prob  <span class="keyword">TYPE</span> stpo_api01-usage_prob,     "使用可能性按 % (BTCI)</span><br><span class="line">    rel_cost    <span class="keyword">TYPE</span> stpo_api01-rel_cost,       "成本标志: 与成本核算相关项目</span><br><span class="line">    bulk_mat    <span class="keyword">TYPE</span> stpo_api01-bulk_mat,       "散装物料</span><br><span class="line">    lead_time   <span class="keyword">TYPE</span> stpo_api01-lead_time,      "提前期偏置(非必须，可空着)</span><br><span class="line">    op_lead_tm  <span class="keyword">TYPE</span> stpo_api01-op_lead_tm,     "工序提前期偏置(非必须，可空着)</span><br><span class="line">    issue_loc   <span class="keyword">TYPE</span> stpo_api01-issue_loc,      "生产仓库地点</span><br><span class="line">    maktx1      <span class="keyword">TYPE</span> makt-maktx,                "主物料描述</span><br><span class="line">    maktx2      <span class="keyword">TYPE</span> makt-maktx,                "子物料描述</span><br><span class="line">    flg_del     <span class="keyword">TYPE</span> char1,                     "删除标记 +</span><br><span class="line">  END OF typ_data_in,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* 导出数据</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  BEGIN OF typ_data_out,</span><br><span class="line"><span class="comment">*    flg_del    TYPE char1,                     "删除标记</span></span><br><span class="line"><span class="comment">*    werks      TYPE csap_mbom-werks,           "工厂</span></span><br><span class="line"><span class="comment">*    matnr      TYPE csap_mbom-matnr,           "主件物料(母件）</span></span><br><span class="line"><span class="comment">*    maktx1     TYPE c LENGTH 60,               "主物料描述</span></span><br><span class="line"><span class="comment">*    stlan      TYPE csap_mbom-stlan,           "BOM用途</span></span><br><span class="line"><span class="comment">*    stlal      TYPE csap_mbom-stlal,           "可选的 BOM</span></span><br><span class="line"><span class="comment">*    base_quan  TYPE stko_api01-base_quan,      "基准数量</span></span><br><span class="line"><span class="comment">*    bom_status TYPE stko_api01-bom_status,     "BOM状态</span></span><br><span class="line"><span class="comment">*    item_categ TYPE stpo_api01-item_categ,     "项目类别（物料单）</span></span><br><span class="line"><span class="comment">*    item_no    TYPE stpo_api01-item_no,        "BOM 项目号</span></span><br><span class="line"><span class="comment">*    component  TYPE stpo_api01-component,      "子物料号</span></span><br><span class="line"><span class="comment">*    maktx2     TYPE c LENGTH 60,               "子物料描述</span></span><br><span class="line"><span class="comment">*    comp_qty   TYPE stpo_api01-comp_qty,       "数量</span></span><br><span class="line"><span class="comment">*    comp_unit  TYPE stpo_api01-comp_unit,      "组件计量单位</span></span><br><span class="line"><span class="comment">*    item_text1 TYPE stpo_api01-item_text1,     "BOM行项目文本描述1</span></span><br><span class="line"><span class="comment">*    sortstring TYPE stpo_api01-sortstring,     "排序字符串</span></span><br><span class="line"><span class="comment">*    comp_scrap TYPE stpo_api01-comp_scrap,     "损耗率</span></span><br><span class="line"><span class="comment">**    dep_intern1 TYPE csdep_dat-dep_intern,      "相关性1</span></span><br><span class="line"><span class="comment">**    dep_intern2 TYPE csdep_dat-dep_intern,      "相关性2</span></span><br><span class="line"><span class="comment">**    dep_intern3 TYPE csdep_dat-dep_intern,      "相关性3</span></span><br><span class="line"><span class="comment">**    dep_intern4 TYPE csdep_dat-dep_intern,      "相关性4</span></span><br><span class="line"><span class="comment">*    ai_group   TYPE stpo_api01-ai_group,       "替代项目：组</span></span><br><span class="line"><span class="comment">*    ai_prio    TYPE stpo_api01-ai_prio,        "优先级</span></span><br><span class="line"><span class="comment">*    ai_strateg TYPE stpo_api01-ai_strateg,     "替代项目：策略</span></span><br><span class="line"><span class="comment">*    usage_prob TYPE stpo_api01-usage_prob,     "使用可能性按 % (BTCI)</span></span><br><span class="line"><span class="comment">*    rel_cost   TYPE stpo_api01-rel_cost,       "成本标志: 与成本核算相关项目</span></span><br><span class="line"><span class="comment">*    bulk_mat   TYPE stpo_api01-bulk_mat,       "散装物料</span></span><br><span class="line"><span class="comment">**    lead_time   TYPE stpo_api01-lead_time,      "提前期偏置(非必须，可空着)</span></span><br><span class="line"><span class="comment">**    op_lead_tm  TYPE stpo_api01-op_lead_tm,     "工序提前期偏置(非必须，可空着)</span></span><br><span class="line"><span class="comment">*    issue_loc  TYPE stpo_api01-issue_loc,      "生产仓库地点</span></span><br><span class="line">    werks <span class="keyword">TYPE</span> werks_d,"工厂 CSTMAT</span><br><span class="line">    matnr <span class="keyword">TYPE</span> matnr,"主件物料(母件） CSTMAT</span><br><span class="line">    maktx <span class="keyword">TYPE</span> maktx,"主物料描述</span><br><span class="line">    stlan <span class="keyword">TYPE</span> stlan,"BOM用途 CSTMAT</span><br><span class="line">    stlal <span class="keyword">TYPE</span> stlal,"可选的 BOM CSTMAT</span><br><span class="line">    bmeng <span class="keyword">TYPE</span> bmeng,"基准数量 CSTMAT</span><br><span class="line">    stlst <span class="keyword">TYPE</span> stlst,"BOM状态 CSTMAT</span><br><span class="line">    postp <span class="keyword">TYPE</span> postp,"项目类别 STPOX</span><br><span class="line">    posnr <span class="keyword">TYPE</span> posnr,"BOM 项目号 STPOX</span><br><span class="line">    idnrk <span class="keyword">TYPE</span> idnrk,"子物料号 STPOX</span><br><span class="line">    ojtxp <span class="keyword">TYPE</span> ojtxp,"子件物料描述</span><br><span class="line">    mnglg <span class="keyword">TYPE</span> menge_d,"数量 STPOX</span><br><span class="line">    meins <span class="keyword">TYPE</span> meins,"组件计量单位 STPOX</span><br><span class="line">    ojtxb <span class="keyword">TYPE</span> ojtxb,"BOM行项目文本描述1 STPOX</span><br><span class="line">    sortf <span class="keyword">TYPE</span> sortf,"排序字符串 STPOX</span><br><span class="line">    kausf <span class="keyword">TYPE</span> kausf,"损耗率 CSTMAT</span><br><span class="line">    alpgr <span class="keyword">TYPE</span> cs_alpgr,"替代项目：组 STPOX</span><br><span class="line">    alprf <span class="keyword">TYPE</span> cs_alprf,"优先级 STPOX</span><br><span class="line">    alpst <span class="keyword">TYPE</span> cs_alpst,"替代项目：策略 STPOX</span><br><span class="line">    ewahr <span class="keyword">TYPE</span> ewahr,"使用可能性按 % (BTCI) STPOX</span><br><span class="line">    sanka <span class="keyword">TYPE</span> sanka,"成本标志: 与成本核算相关项目 STPOX</span><br><span class="line">    mschg <span class="keyword">TYPE</span> cs_e_mschg,"散装物料 STPOX</span><br><span class="line">    lgpro <span class="keyword">TYPE</span> lgpro,"生产仓库地点 STPOX</span><br><span class="line">  END OF typ_data_out,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* alv显示</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  BEGIN OF typ_alv,</span><br><span class="line">    werks   <span class="keyword">TYPE</span> csap_mbom-werks,           "工厂</span><br><span class="line">    matnr   <span class="keyword">TYPE</span> csap_mbom-matnr,           "主件物料(母件）</span><br><span class="line">    stlan   <span class="keyword">TYPE</span> csap_mbom-stlan,           "BOM用途</span><br><span class="line">    stlal   <span class="keyword">TYPE</span> csap_mbom-stlal,           "可选的 BOM</span><br><span class="line">    message <span class="keyword">TYPE</span> char255,                   "信息</span><br><span class="line">    icon_id <span class="keyword">TYPE</span> icon-id,                   "图标</span><br><span class="line">  END OF typ_alv,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* excel表头</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  BEGIN OF typ_fieldnames,</span><br><span class="line">    name <span class="keyword">TYPE</span> char10,                    "标题名称</span><br><span class="line">  END OF typ_fieldnames,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* BOM 链接物料</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  BEGIN OF typ_mast,</span><br><span class="line">    matnr <span class="keyword">TYPE</span> mast-matnr,                "物料编号</span><br><span class="line">    werks <span class="keyword">TYPE</span> mast-werks,                "工厂</span><br><span class="line">    stlan <span class="keyword">TYPE</span> mast-stlan,                "BOM 用途</span><br><span class="line">    stlal <span class="keyword">TYPE</span> mast-stlal,                "可选的 BOM</span><br><span class="line">  END OF typ_mast.</span><br><span class="line"></span><br><span class="line">DATA:</span><br><span class="line">  gt_file     <span class="keyword">TYPE</span> <span class="keyword">TABLE</span> OF typ_file,         "excle文件</span><br><span class="line">  gt_data_in  <span class="keyword">TYPE</span> <span class="keyword">TABLE</span> OF typ_data_in,      "导入数据</span><br><span class="line">  gt_data_out <span class="keyword">TYPE</span> <span class="keyword">TABLE</span> OF typ_data_out,     "导出数据</span><br><span class="line">  gt_alv      <span class="keyword">TYPE</span> <span class="keyword">TABLE</span> OF typ_alv.          "alv信息</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">"SELECTION-SCREEN: FUNCTION KEY 1. "</span>激活下载模板按钮</span><br><span class="line"></span><br><span class="line"><span class="comment">*SELECTION-SCREEN BEGIN OF BLOCK bk3 WITH FRAME TITLE text-003.</span></span><br><span class="line"><span class="comment">*PARAMETERS:</span></span><br><span class="line"><span class="comment">*  rb_in  TYPE c RADIOBUTTON GROUP r2 DEFAULT 'X' USER-COMMAND io,</span></span><br><span class="line"><span class="comment">*  rb_out TYPE c RADIOBUTTON GROUP r2.</span></span><br><span class="line"><span class="comment">*SELECTION-SCREEN END OF BLOCK bk3.</span></span><br><span class="line"></span><br><span class="line">DATA: rb_out <span class="keyword">TYPE</span> c VALUE 'X' ."隐藏上面代码</span><br><span class="line">DATA: rb_in <span class="keyword">TYPE</span> c .</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*SELECTION-SCREEN BEGIN OF BLOCK bk1 WITH FRAME TITLE text-001.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*PARAMETERS: p_ufile TYPE rlgrap-filename MODIF ID g1</span></span><br><span class="line"><span class="comment">*                         DEFAULT 'C:\Users\Administrator\Desktop\BOM创建修改删除模板.XLSX'.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*SELECTION-SCREEN SKIP 1.</span></span><br><span class="line"><span class="comment">*PARAMETERS:</span></span><br><span class="line"><span class="comment">*  rb_ins TYPE c RADIOBUTTON GROUP r1 DEFAULT 'X' USER-COMMAND rb MODIF ID g1,</span></span><br><span class="line"><span class="comment">*  rb_upd TYPE c RADIOBUTTON GROUP r1 MODIF ID g1,</span></span><br><span class="line"><span class="comment">*  rb_del TYPE c RADIOBUTTON GROUP r1 MODIF ID g1.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*SELECTION-SCREEN SKIP 1.</span></span><br><span class="line"><span class="comment">*parameters:</span></span><br><span class="line"><span class="comment">*  cb_stlal type c as checkbox modif id g1.</span></span><br><span class="line">DATA:  cb_stlal <span class="keyword">TYPE</span> c.  "隐藏可选bom按钮</span><br><span class="line"></span><br><span class="line">"SELECTION-SCREEN END OF BLOCK bk1.</span><br><span class="line"></span><br><span class="line">SELECTION-SCREEN BEGIN OF BLOCK bk2 WITH FRAME TITLE text-002.</span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*PARAMETERS: p_dfile TYPE rlgrap-filename MODIF ID g2</span></span><br><span class="line"><span class="comment">*                         DEFAULT 'C:\Users\Administrator\Desktop\BOM创建修改删除模板.XLS'.</span></span><br><span class="line"><span class="comment">*SELECTION-SCREEN SKIP 1.</span></span><br><span class="line">SELECT-OPTIONS:</span><br><span class="line"> s_werks  <span class="keyword">FOR</span> csap_mbom-werks MODIF ID g2,           "工厂</span><br><span class="line"> s_matnr  <span class="keyword">FOR</span> csap_mbom-matnr MODIF ID g2,           "主件物料(母件）</span><br><span class="line"> s_stlan  <span class="keyword">FOR</span> csap_mbom-stlan MODIF ID g2,           "BOM用途</span><br><span class="line"> s_stlal  <span class="keyword">FOR</span> csap_mbom-stlal MODIF ID g2.           "可选的 BOM</span><br><span class="line"></span><br><span class="line">SELECTION-SCREEN END OF BLOCK bk2.</span><br><span class="line"></span><br><span class="line">INITIALIZATION.</span><br><span class="line"></span><br><span class="line">  sscrfields-functxt_01 = '下载模板'.</span><br><span class="line"></span><br><span class="line">AT SELECTION-SCREEN.</span><br><span class="line"></span><br><span class="line">  CASE sscrfields-ucomm.</span><br><span class="line">    WHEN 'FC01'."下载模板</span><br><span class="line">      PERFORM frm_download_template.</span><br><span class="line">    WHEN OTHERS.</span><br><span class="line">  ENDCASE.</span><br><span class="line"></span><br><span class="line">AT SELECTION-SCREEN OUTPUT.</span><br><span class="line"></span><br><span class="line">  " PERFORM frm_modify_screen.</span><br><span class="line"></span><br><span class="line"><span class="comment">*AT SELECTION-SCREEN ON VALUE-REQUEST FOR p_ufile.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">** 文件路径的help</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  PERFORM get_filepath USING p_ufile.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*AT SELECTION-SCREEN ON VALUE-REQUEST FOR p_dfile.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">** 文件路径的help</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  PERFORM get_filepath USING p_dfile.</span></span><br><span class="line"></span><br><span class="line">START-OF-SELECTION.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* 导入数据</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> rb_in = 'X'.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*   导入数据的取得</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    PERFORM frm_get_data_in.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*   BAPI执行</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    PERFORM frm_bapi_bom.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*   展示alv信息</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    PERFORM frm_alv_output.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* 导出数据</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*   导出数据的取得</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    PERFORM frm_get_data_out.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*   展示EXCEL</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    PERFORM frm_excel_output.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  FRM_DOWNLOAD_TEMPLATE</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       下载模板</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*  --&gt;  p1        text</span></span><br><span class="line"><span class="comment">*  &lt;--  p2        text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">FORM</span> frm_download_template .</span><br><span class="line"></span><br><span class="line">  DATA:</span><br><span class="line">    ls_object     <span class="keyword">TYPE</span> wwwdatatab,</span><br><span class="line">    l_filename    <span class="keyword">TYPE</span> string,</span><br><span class="line">    l_path        <span class="keyword">TYPE</span> string,</span><br><span class="line">    l_fullpath    <span class="keyword">TYPE</span> string,</span><br><span class="line">    l_title       <span class="keyword">TYPE</span> string,</span><br><span class="line">    l_destination <span class="keyword">TYPE</span> rlgrap-filename.</span><br><span class="line"></span><br><span class="line">  SELECT SINGLE *</span><br><span class="line">    FROM wwwdata</span><br><span class="line">    INTO CORRESPONDING FIELDS OF ls_object</span><br><span class="line">   WHERE objid = 'ZPPE008'.    "smw0里对象名称</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line"></span><br><span class="line">    MESSAGE 'smw0里对象名称没有找到' <span class="keyword">TYPE</span> '<span class="keyword">E</span>'.</span><br><span class="line"></span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">  l_title = ls_object-text.            "WWWDATA 对象的短文本</span><br><span class="line"></span><br><span class="line">  CALL METHOD cl_gui_frontend_services=&gt;file_save_dialog</span><br><span class="line">    EXPORTING</span><br><span class="line">      window_title      = '模板下载'</span><br><span class="line">      default_extension = 'xls'</span><br><span class="line">      default_file_name = l_title</span><br><span class="line">      file_filter       = 'EXCEL(*.xls)|*.xls*'</span><br><span class="line">    CHANGING</span><br><span class="line">      filename          = l_filename</span><br><span class="line">      path              = l_path</span><br><span class="line">      fullpath          = l_fullpath</span><br><span class="line">    EXCEPTIONS</span><br><span class="line">      cntl_error        = 1</span><br><span class="line">      error_no_gui      = 2</span><br><span class="line">      OTHERS            = 3.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> l_fullpath IS NOT INITIAL.</span><br><span class="line"></span><br><span class="line">    l_destination = l_fullpath.</span><br><span class="line"></span><br><span class="line">    CALL FUNCTION 'DOWNLOAD_WEB_OBJECT'</span><br><span class="line">      EXPORTING</span><br><span class="line">        key         = ls_object</span><br><span class="line">        destination = l_destination.</span><br><span class="line"></span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  GET_FILEPATH</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       文件路径的help</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*      --&gt;P_P_UFILE  text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">FORM</span> get_filepath USING i_file.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* Data for open dialog</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  DATA: l_filetab <span class="keyword">TYPE</span> filetable,</span><br><span class="line">        l_rc      <span class="keyword">TYPE</span> i.</span><br><span class="line">  <span class="keyword">CLEAR</span> l_filetab.</span><br><span class="line">  REFRESH l_filetab.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* Open dialog</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  CALL METHOD cl_gui_frontend_services=&gt;file_open_dialog</span><br><span class="line">    EXPORTING</span><br><span class="line"><span class="comment">*     WINDOW_TITLE         = 'SAP Custom - Open File'</span></span><br><span class="line"><span class="comment">*     DEFAULT_EXTENSION    =</span></span><br><span class="line">      default_filename     = '*.xls'</span><br><span class="line"><span class="comment">*     FILE_FILTER          = '*.xls'</span></span><br><span class="line">      initial_directory    = 'c:\'</span><br><span class="line">      multiselection       = ''</span><br><span class="line">    CHANGING</span><br><span class="line">      file_table           = l_filetab</span><br><span class="line">      rc                   = l_rc</span><br><span class="line">    EXCEPTIONS</span><br><span class="line">      cntl_error           = 1</span><br><span class="line">      error_no_gui         = 2</span><br><span class="line">      not_supported_by_gui = 3</span><br><span class="line">      OTHERS               = 4.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* Get file path</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  CHECK l_rc <span class="keyword">EQ</span> 1.</span><br><span class="line">  <span class="keyword">READ</span> <span class="keyword">TABLE</span> l_filetab INDEX 1 INTO i_file.</span><br><span class="line"></span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  FRM_GET_DATA_IN</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       导入数据的取得</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*  --&gt;  p1        text</span></span><br><span class="line"><span class="comment">*  &lt;--  p2        text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">FORM</span> frm_get_data_in .</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* 从excel中得到数据</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  PERFORM frm_xls_to_sap.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* 导入数据的编辑检查</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  " PERFORM frm_edit_file.</span><br><span class="line"></span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  FRM_BAPI_BOM</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       BAPI执行</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*  --&gt;  p1        text</span></span><br><span class="line"><span class="comment">*  &lt;--  p2        text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">FORM</span> frm_bapi_bom .</span><br><span class="line"></span><br><span class="line"><span class="comment">*  CASE 'X'.</span></span><br><span class="line"><span class="comment">*    WHEN rb_ins.   "创建BOM</span></span><br><span class="line"><span class="comment">*      PERFORM frm_bapi_bom_ins.</span></span><br><span class="line"><span class="comment">*    WHEN rb_upd.   "修改删除BOM行项目</span></span><br><span class="line"><span class="comment">*      PERFORM frm_bapi_bom_upd.</span></span><br><span class="line"><span class="comment">*    WHEN rb_del.   "删除BOM</span></span><br><span class="line"><span class="comment">*      PERFORM frm_bapi_bom_del.</span></span><br><span class="line"><span class="comment">*    WHEN OTHERS.</span></span><br><span class="line"><span class="comment">*  ENDCASE.</span></span><br><span class="line"></span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  FRM_XLS_TO_SAP</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       从excel中得到数据</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*  --&gt;  p1        text</span></span><br><span class="line"><span class="comment">*  &lt;--  p2        text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">FORM</span> frm_xls_to_sap .</span><br><span class="line"></span><br><span class="line"><span class="comment">*  DATA:</span></span><br><span class="line"><span class="comment">*    lt_raw_data TYPE truxs_t_text_data.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  CALL FUNCTION 'TEXT_CONVERT_XLS_TO_SAP'</span></span><br><span class="line"><span class="comment">*    EXPORTING</span></span><br><span class="line"><span class="comment">*      i_tab_raw_data       = lt_raw_data</span></span><br><span class="line"><span class="comment">*      i_filename           = p_ufile</span></span><br><span class="line"><span class="comment">*    TABLES</span></span><br><span class="line"><span class="comment">*      i_tab_converted_data = gt_file</span></span><br><span class="line"><span class="comment">*    EXCEPTIONS</span></span><br><span class="line"><span class="comment">*      conversion_failed    = 1</span></span><br><span class="line"><span class="comment">*      OTHERS               = 2.</span></span><br><span class="line"><span class="comment">*  IF sy-subrc &lt;&gt; 0.</span></span><br><span class="line"><span class="comment">*    MESSAGE ID sy-msgid TYPE 'S' NUMBER sy-msgno</span></span><br><span class="line"><span class="comment">*    WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4 DISPLAY LIKE 'E'.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*    LEAVE LIST-PROCESSING.</span></span><br><span class="line"><span class="comment">*  ENDIF.</span></span><br><span class="line"></span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  FRM_EDIT_FILE</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       导入数据的编辑检查</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*  --&gt;  p1        text</span></span><br><span class="line"><span class="comment">*  &lt;--  p2        text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*FORM frm_edit_file .</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  DATA:</span></span><br><span class="line"><span class="comment">*    ls_file     LIKE LINE OF gt_file,</span></span><br><span class="line"><span class="comment">*    ls_data     LIKE LINE OF gt_data_in,</span></span><br><span class="line"><span class="comment">*    ls_data_bak LIKE LINE OF gt_data_in,</span></span><br><span class="line"><span class="comment">*    l_line      TYPE         i,</span></span><br><span class="line"><span class="comment">*    l_message   TYPE         char255.                  "ALV信息</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">** 创建时从第三行</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  IF rb_ins = 'X'.</span></span><br><span class="line"><span class="comment">*    l_line = 3.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">** 修改删除时从第二行</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  ELSE.</span></span><br><span class="line"><span class="comment">*    l_line = 3.</span></span><br><span class="line"><span class="comment">*  ENDIF.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">** 得到数据</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  LOOP AT gt_file INTO ls_file FROM l_line.</span></span><br><span class="line"><span class="comment">*    CLEAR:</span></span><br><span class="line"><span class="comment">*      ls_data.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*    ls_data-flg_del          = ls_file-col01.    "删除标记</span></span><br><span class="line"><span class="comment">*    ls_data-werks            = ls_file-col02.    "工厂</span></span><br><span class="line"><span class="comment">*    ls_data-matnr            = ls_file-col03.    "主件物料(母件）</span></span><br><span class="line"><span class="comment">*    ls_data-maktx1           = ls_file-col04.    "主物料描述</span></span><br><span class="line"><span class="comment">*    ls_data-stlan            = ls_file-col05.    "BOM用途</span></span><br><span class="line"><span class="comment">*    ls_data-stlal            = ls_file-col06.    "可选的 BOM</span></span><br><span class="line"><span class="comment">*    ls_data-base_quan        = ls_file-col07.    "基准数量</span></span><br><span class="line"><span class="comment">*    ls_data-bom_status       = ls_file-col08.    "BOM状态</span></span><br><span class="line"><span class="comment">*    ls_data-item_categ       = ls_file-col09.    "项目类别（物料单）</span></span><br><span class="line"><span class="comment">*    ls_data-item_no          = ls_file-col10.    "BOM 项目号</span></span><br><span class="line"><span class="comment">*    ls_data-component        = ls_file-col11.    "子物料号</span></span><br><span class="line"><span class="comment">*    ls_data-maktx2           = ls_file-col12.    "子物料描述</span></span><br><span class="line"><span class="comment">*    ls_data-comp_qty         = ls_file-col13.    "数量</span></span><br><span class="line"><span class="comment">*    ls_data-comp_unit        = ls_file-col14.    "组件计量单位</span></span><br><span class="line"><span class="comment">*    ls_data-item_text1       = ls_file-col15.    "BOM行项目文本描述1</span></span><br><span class="line"><span class="comment">*    ls_data-sortstring       = ls_file-col16.    "排序字符串</span></span><br><span class="line"><span class="comment">*    ls_data-comp_scrap       = ls_file-col17.    "损耗率</span></span><br><span class="line"><span class="comment">**    ls_data-dep_intern1      = ls_file-col18.    "相关性1</span></span><br><span class="line"><span class="comment">**    ls_data-dep_intern2      = ls_file-col19.    "相关性2</span></span><br><span class="line"><span class="comment">**    ls_data-dep_intern3      = ls_file-col20.    "相关性3</span></span><br><span class="line"><span class="comment">**    ls_data-dep_intern4      = ls_file-col21.    "相关性4</span></span><br><span class="line"><span class="comment">*    ls_data-ai_group         = ls_file-col18.    "替代项目：组</span></span><br><span class="line"><span class="comment">*    ls_data-ai_prio          = ls_file-col19.    "优先级</span></span><br><span class="line"><span class="comment">*    ls_data-ai_strateg       = ls_file-col20.    "替代项目：策略</span></span><br><span class="line"><span class="comment">*    ls_data-usage_prob       = ls_file-col21.    "使用可能性按 % (BTCI)</span></span><br><span class="line"><span class="comment">*    IF ls_file-col22 EQ 'N'.</span></span><br><span class="line"><span class="comment">*      ls_data-rel_cost         = ''.    "成本标志: 与成本核算相关项目</span></span><br><span class="line"><span class="comment">*    ELSE.</span></span><br><span class="line"><span class="comment">*      ls_data-rel_cost         = 'X'.    "成本标志: 与成本核算相关项目</span></span><br><span class="line"><span class="comment">*    ENDIF.</span></span><br><span class="line"><span class="comment">*    ls_data-bulk_mat         = ls_file-col23.    "散装物料</span></span><br><span class="line"><span class="comment">**    ls_data-lead_time        = ls_file-col24.    "提前期偏置(非必须，可空着)</span></span><br><span class="line"><span class="comment">**    ls_data-op_lead_tm       = ls_file-col25.    "工序提前期偏置(非必须，可空着)</span></span><br><span class="line"><span class="comment">*    ls_data-issue_loc        = ls_file-col24.    "生产仓库地点</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">**   主件物料(母件）</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*    CALL FUNCTION 'CONVERSION_EXIT_MATN2_INPUT'</span></span><br><span class="line"><span class="comment">*      EXPORTING</span></span><br><span class="line"><span class="comment">*        input            = ls_data-matnr</span></span><br><span class="line"><span class="comment">*      IMPORTING</span></span><br><span class="line"><span class="comment">*        output           = ls_data-matnr</span></span><br><span class="line"><span class="comment">*      EXCEPTIONS</span></span><br><span class="line"><span class="comment">*        number_not_found = 0</span></span><br><span class="line"><span class="comment">*        length_error     = 0</span></span><br><span class="line"><span class="comment">*        OTHERS           = 0.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">**   子物料号</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*    CALL FUNCTION 'CONVERSION_EXIT_MATN2_INPUT'</span></span><br><span class="line"><span class="comment">*      EXPORTING</span></span><br><span class="line"><span class="comment">*        input            = ls_data-component</span></span><br><span class="line"><span class="comment">*      IMPORTING</span></span><br><span class="line"><span class="comment">*        output           = ls_data-component</span></span><br><span class="line"><span class="comment">*      EXCEPTIONS</span></span><br><span class="line"><span class="comment">*        number_not_found = 0</span></span><br><span class="line"><span class="comment">*        length_error     = 0</span></span><br><span class="line"><span class="comment">*        OTHERS           = 0.</span></span><br><span class="line"><span class="comment">**</span></span><br><span class="line"><span class="comment">**     SELECT SINGLE COUNT(*)</span></span><br><span class="line"><span class="comment">**       FROM ZEPP008_1</span></span><br><span class="line"><span class="comment">**       WHERE BNAME   = SY-UNAME</span></span><br><span class="line"><span class="comment">**        AND  WERKS   = LS_DATA-WERKS</span></span><br><span class="line"><span class="comment">**        AND  ZCHANGE = 'X'.</span></span><br><span class="line"><span class="comment">*    sy-subrc = 0."新增此行，跳过上一行程序的执行</span></span><br><span class="line"><span class="comment">*    IF sy-subrc = 0.</span></span><br><span class="line"><span class="comment">*      APPEND ls_data TO gt_data_in.</span></span><br><span class="line"><span class="comment">*    ELSE.</span></span><br><span class="line"><span class="comment">*      l_message = '没有该工厂的权限'.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">**     alv数据的编辑</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*      PERFORM frm_edit_alv USING ls_data-werks</span></span><br><span class="line"><span class="comment">*                                  ' '</span></span><br><span class="line"><span class="comment">*                                  ' '</span></span><br><span class="line"><span class="comment">*                                  ' '</span></span><br><span class="line"><span class="comment">*                                  l_message</span></span><br><span class="line"><span class="comment">*                                  icon_cancel.</span></span><br><span class="line"><span class="comment">*    ENDIF.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  ENDLOOP.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  SORT gt_data_in BY werks matnr stlan stlal item_no.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  SORT gt_alv BY werks ASCENDING.</span></span><br><span class="line"><span class="comment">*  DELETE ADJACENT DUPLICATES FROM gt_alv COMPARING werks.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  LOOP AT gt_data_in INTO ls_data.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*    IF sy-tabix &lt;&gt; 1.</span></span><br><span class="line"><span class="comment">*      IF cb_stlal = 'X'.</span></span><br><span class="line"><span class="comment">*        IF ls_data-werks   = ls_data_bak-werks AND</span></span><br><span class="line"><span class="comment">*           ls_data-matnr   = ls_data_bak-matnr AND</span></span><br><span class="line"><span class="comment">*           ls_data-stlan   = ls_data_bak-stlan AND</span></span><br><span class="line"><span class="comment">*           ls_data-stlal   = ls_data_bak-stlal AND</span></span><br><span class="line"><span class="comment">*           ls_data-item_no = ls_data_bak-item_no.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*          l_message = 'BOM项目号重复'.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">**         alv数据的编辑</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*          PERFORM frm_edit_alv USING ls_data-werks</span></span><br><span class="line"><span class="comment">*                                      ls_data-matnr</span></span><br><span class="line"><span class="comment">*                                      ls_data-stlan</span></span><br><span class="line"><span class="comment">*                                      ls_data-stlal</span></span><br><span class="line"><span class="comment">*                                      l_message</span></span><br><span class="line"><span class="comment">*                                      icon_cancel.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*          DELETE gt_data_in WHERE werks = ls_data-werks</span></span><br><span class="line"><span class="comment">*                             AND  matnr = ls_data-matnr</span></span><br><span class="line"><span class="comment">*                             AND  stlan = ls_data-stlan</span></span><br><span class="line"><span class="comment">*                             AND  stlal = ls_data-stlal.</span></span><br><span class="line"><span class="comment">*        ENDIF.</span></span><br><span class="line"><span class="comment">*      ELSE.</span></span><br><span class="line"><span class="comment">*        IF ls_data-werks   = ls_data_bak-werks AND</span></span><br><span class="line"><span class="comment">*           ls_data-matnr   = ls_data_bak-matnr AND</span></span><br><span class="line"><span class="comment">*           ls_data-stlan   = ls_data_bak-stlan AND</span></span><br><span class="line"><span class="comment">*           ls_data-item_no = ls_data_bak-item_no.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*          l_message = 'BOM项目号重复'.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">**         alv数据的编辑</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*          PERFORM frm_edit_alv USING ls_data-werks</span></span><br><span class="line"><span class="comment">*                                      ls_data-matnr</span></span><br><span class="line"><span class="comment">*                                      ls_data-stlan</span></span><br><span class="line"><span class="comment">*                                      ls_data-stlal</span></span><br><span class="line"><span class="comment">*                                      l_message</span></span><br><span class="line"><span class="comment">*                                      icon_cancel.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*          DELETE gt_data_in WHERE werks = ls_data-werks</span></span><br><span class="line"><span class="comment">*                             AND  matnr = ls_data-matnr</span></span><br><span class="line"><span class="comment">*                             AND  stlan = ls_data-stlan</span></span><br><span class="line"><span class="comment">*                             AND  stlal = ls_data-stlal.</span></span><br><span class="line"><span class="comment">*        ENDIF.</span></span><br><span class="line"><span class="comment">*      ENDIF.</span></span><br><span class="line"><span class="comment">*    ENDIF.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*    ls_data_bak = ls_data.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  ENDLOOP.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*ENDFORM.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  FRM_ALV_OUTPUT</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       展示alv信息</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*  --&gt;  p1        text</span></span><br><span class="line"><span class="comment">*  &lt;--  p2        text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">FORM</span> frm_alv_output .</span><br><span class="line"></span><br><span class="line">  DATA:</span><br><span class="line">    lt_fieldcat <span class="keyword">TYPE</span> slis_t_fieldcat_alv,</span><br><span class="line">    ls_filedcat <span class="keyword">TYPE</span> slis_fieldcat_alv,</span><br><span class="line">    ls_layout   <span class="keyword">TYPE</span> slis_layout_alv.</span><br><span class="line"></span><br><span class="line">  ls_layout-colwidth_optimize = 'X'.</span><br><span class="line">  ls_layout-zebra             = 'X'.</span><br><span class="line"></span><br><span class="line">  DEFINE d_filedcat.</span><br><span class="line">    ls_filedcat-fieldname = &amp;1.</span><br><span class="line">    ls_filedcat-seltext_l = &amp;2.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">IF</span> &amp;1 = 'ICON_ID'.</span><br><span class="line">      ls_filedcat-icon = 'X'.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">APPEND</span> ls_filedcat TO lt_fieldcat.</span><br><span class="line">    <span class="keyword">CLEAR</span> ls_filedcat.</span><br><span class="line">  END-OF-DEFINITION.</span><br><span class="line"></span><br><span class="line">  d_filedcat: 'WERKS'     '工厂' ,</span><br><span class="line">              'MATNR'     '主件物料(母件）' ,</span><br><span class="line">              'STLAN'     'BOM 用途'  ,</span><br><span class="line">              'STLAL'     '可选的 BOM'  ,</span><br><span class="line">              'MESSAGE'   '信息'      ,</span><br><span class="line">              'ICON_ID'   '提示'  .</span><br><span class="line"></span><br><span class="line">  CALL FUNCTION 'REUSE_ALV_GRID_DISPLAY'</span><br><span class="line">    EXPORTING</span><br><span class="line">      i_callback_program = sy-repid</span><br><span class="line"><span class="comment">*     I_CALLBACK_PF_STATUS_SET          = 'FRM_PF_STATUS_SET'</span></span><br><span class="line"><span class="comment">*     I_CALLBACK_USER_COMMAND           = 'FRM_USER_COMMAND'</span></span><br><span class="line">      is_layout          = ls_layout</span><br><span class="line">      it_fieldcat        = lt_fieldcat</span><br><span class="line">      i_save             = 'A'</span><br><span class="line">    TABLES</span><br><span class="line">      t_outtab           = gt_alv</span><br><span class="line">    EXCEPTIONS</span><br><span class="line">      program_error      = 1</span><br><span class="line">      OTHERS             = 2.</span><br><span class="line">  <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* Implement suitable error handling here</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  FRM_EDIT_ALV</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       alv数据的编辑</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*      --&gt;P_LS_DATA_WERKS  text</span></span><br><span class="line"><span class="comment">*      --&gt;P_LS_DATA_MATNR  text</span></span><br><span class="line"><span class="comment">*      --&gt;P_LS_DATA_STLAN  text</span></span><br><span class="line"><span class="comment">*      --&gt;P_LS_DATA_STLAL  text</span></span><br><span class="line"><span class="comment">*      --&gt;P_L_MESSAGE  text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">FORM</span> frm_edit_alv USING i_werks <span class="keyword">TYPE</span> csap_mbom-werks</span><br><span class="line">                             i_matnr   <span class="keyword">TYPE</span> csap_mbom-matnr</span><br><span class="line">                             i_stlan   <span class="keyword">TYPE</span> csap_mbom-stlan</span><br><span class="line">                             i_stlal   <span class="keyword">TYPE</span> csap_mbom-stlal</span><br><span class="line">                             i_message <span class="keyword">TYPE</span> char255</span><br><span class="line">                             i_icon_id <span class="keyword">TYPE</span> icon-id.</span><br><span class="line"></span><br><span class="line">  DATA:</span><br><span class="line">    ls_alv <span class="keyword">TYPE</span> typ_alv.</span><br><span class="line"></span><br><span class="line">  CALL FUNCTION 'CONVERSION_EXIT_MATN2_OUTPUT'</span><br><span class="line">    EXPORTING</span><br><span class="line">      <span class="keyword">input</span>  = i_matnr</span><br><span class="line">    IMPORTING</span><br><span class="line">      output = ls_alv-matnr.</span><br><span class="line"></span><br><span class="line">  ls_alv-werks    = i_werks.</span><br><span class="line">  ls_alv-stlan    = i_stlan.</span><br><span class="line">  ls_alv-stlal    = i_stlal.</span><br><span class="line">  ls_alv-message  = i_message.</span><br><span class="line">  ls_alv-icon_id  = i_icon_id.</span><br><span class="line">  <span class="keyword">APPEND</span> ls_alv TO gt_alv.</span><br><span class="line"></span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  FRM_BAPI_BOM_INS</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       创建BOM</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*  --&gt;  p1        text</span></span><br><span class="line"><span class="comment">*  &lt;--  p2        text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">FORM</span> frm_bapi_bom_ins .</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> cb_stlal &lt;&gt; 'X'.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*   可选BOM单一</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    PERFORM frm_bapi_bom_ins_bapi.</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*   可选BOM多个（创建可选的bom 抬头）</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    PERFORM frm_bapi_bom_ins_bdc.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*   修改BOM(明细行项目的追加)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    PERFORM frm_bapi_bom_upd_item.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  FRM_BAPI_BOM_UPD</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       修改BOM</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">FORM</span> frm_bapi_bom_upd .</span><br><span class="line"></span><br><span class="line">  DATA:</span><br><span class="line">    ls_tmp      LIKE <span class="keyword">LINE</span> OF  gt_data_in,</span><br><span class="line">    ls_data     LIKE <span class="keyword">LINE</span> OF  gt_data_in,</span><br><span class="line">    lt_stpo     <span class="keyword">TYPE</span> <span class="keyword">TABLE</span> OF stpo_api03,      "BOM 项目的 API 结构：ALL ＋标识的字段</span><br><span class="line">    ls_stpo     LIKE <span class="keyword">LINE</span> OF  lt_stpo,</span><br><span class="line">    lt_dep_data <span class="keyword">TYPE</span> <span class="keyword">TABLE</span> OF csdep_dat,       "BOMs：相关性的基本数据</span><br><span class="line">    ls_dep_data LIKE <span class="keyword">LINE</span> OF  lt_dep_data,</span><br><span class="line">    l_message   <span class="keyword">TYPE</span>          char255,                  "ALV信息</span><br><span class="line">    l_originno  <span class="keyword">TYPE</span>          i,</span><br><span class="line">    ls_stko     <span class="keyword">TYPE</span>          stko_api01.               "API BOM 表头结构：可以被更改的字段</span><br><span class="line"></span><br><span class="line">  DATA:</span><br><span class="line">    l_valid_from    <span class="keyword">TYPE</span> csap_mbom-datuv,</span><br><span class="line">    lt_stpo_sel     LIKE stpo_api02 OCCURS 0 WITH HEADER <span class="keyword">LINE</span>, "BOM 项目的 API 结构：能被修改的字段</span><br><span class="line">    lt_dep_data_sel LIKE csdep_dat  OCCURS 0 WITH HEADER <span class="keyword">LINE</span>. "BOMs：相关性的基本数据</span><br><span class="line"></span><br><span class="line">  LOOP AT gt_data_in INTO ls_tmp.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">CLEAR</span>:</span><br><span class="line">      ls_data,</span><br><span class="line">      ls_stpo,</span><br><span class="line">      ls_dep_data.</span><br><span class="line"></span><br><span class="line">    ls_data = ls_tmp.</span><br><span class="line"></span><br><span class="line">    AT NEW stlal.</span><br><span class="line">      REFRESH:</span><br><span class="line">        lt_stpo,</span><br><span class="line">        lt_dep_data,</span><br><span class="line">        lt_stpo_sel.</span><br><span class="line">      <span class="keyword">CLEAR</span>:</span><br><span class="line">        l_message,</span><br><span class="line">        l_valid_from,</span><br><span class="line">        l_originno,</span><br><span class="line">        ls_stko.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*     日期:转换</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      CALL FUNCTION 'CONVERT_DATE_TO_EXTERNAL'</span><br><span class="line">        EXPORTING</span><br><span class="line">          date_internal            = sy-datum</span><br><span class="line">        IMPORTING</span><br><span class="line">          date_external            = l_valid_from</span><br><span class="line">        EXCEPTIONS</span><br><span class="line">          date_internal_is_invalid = 1</span><br><span class="line">          OTHERS                   = 2.</span><br><span class="line">      <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* Implement suitable error handling here</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*     得到最新的BOM 行项目</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      CALL FUNCTION 'CSAP_MAT_BOM_OPEN'</span><br><span class="line">        EXPORTING</span><br><span class="line">          material    = ls_data-matnr     "主件物料(母件）</span><br><span class="line">          plant       = ls_data-werks     "工厂</span><br><span class="line">          bom_usage   = ls_data-stlan     "BOM用途</span><br><span class="line">          alternative = ls_data-stlal     "可选的 BOM</span><br><span class="line">          valid_from  = l_valid_from</span><br><span class="line"><span class="comment">*         CHANGE_NO   =</span></span><br><span class="line"><span class="comment">*         REVISION_LEVEL         =</span></span><br><span class="line"><span class="comment">*         FL_NO_CHANGE_DOC       = ' '</span></span><br><span class="line"><span class="comment">*        IMPORTING</span></span><br><span class="line"><span class="comment">*         O_STKO      =</span></span><br><span class="line"><span class="comment">*         FL_WARNING  =</span></span><br><span class="line">        TABLES</span><br><span class="line">          t_stpo      = lt_stpo_sel</span><br><span class="line">          t_dep_data  = lt_dep_data_sel</span><br><span class="line"><span class="comment">*         T_DEP_DESCR =</span></span><br><span class="line"><span class="comment">*         T_DEP_ORDER =</span></span><br><span class="line"><span class="comment">*         T_DEP_SOURCE           =</span></span><br><span class="line"><span class="comment">*         T_DEP_DOC   =</span></span><br><span class="line">        EXCEPTIONS</span><br><span class="line">          <span class="keyword">error</span>       = 1</span><br><span class="line">          OTHERS      = 2.</span><br><span class="line">      <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* Implement suitable error handling here</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line">      LOOP AT lt_stpo_sel.</span><br><span class="line">        CALL FUNCTION 'CONVERSION_EXIT_MATN2_INPUT'</span><br><span class="line">          EXPORTING</span><br><span class="line">            <span class="keyword">input</span>  = lt_stpo_sel-component</span><br><span class="line">          IMPORTING</span><br><span class="line">            output = lt_stpo_sel-component.</span><br><span class="line">        MODIFY lt_stpo_sel TRANSPORTING component.</span><br><span class="line">      ENDLOOP.</span><br><span class="line">    ENDAT.</span><br><span class="line"></span><br><span class="line">    l_originno = l_originno + 1.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">READ</span> <span class="keyword">TABLE</span> lt_stpo_sel WITH KEY item_no   = ls_data-item_no</span><br><span class="line">                                    component = ls_data-component.</span><br><span class="line">    <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*     删除标记是X</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      <span class="keyword">IF</span> ls_data-flg_del = 'X'.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*       BOM 项目的 API 结构：能被修改的字段</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        ls_stpo-fldelete   = 'X'.                    "删除标识</span><br><span class="line">        ls_stpo-bom_no     = lt_stpo_sel-bom_no.     "物料单</span><br><span class="line">        ls_stpo-item_node  = lt_stpo_sel-item_node.  "BOM 项目节点号</span><br><span class="line">        ls_stpo-item_count = lt_stpo_sel-item_count. "内部计数器</span><br><span class="line">        ls_stpo-item_categ = ls_data-item_categ  .   "项目类别（物料单）</span><br><span class="line">        ls_stpo-item_no    = ls_data-item_no  .      "BOM 项目号</span><br><span class="line">        ls_stpo-component  = ls_data-component.      "BOM 组件</span><br><span class="line">        <span class="keyword">APPEND</span> ls_stpo TO lt_stpo.</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*       BOM 项目的 API 结构：能被修改的字段</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        ls_stpo-fldelete   = ' '.                    "删除标识</span><br><span class="line">        ls_stpo-bom_no     = lt_stpo_sel-bom_no.     "物料单</span><br><span class="line">        ls_stpo-item_node  = lt_stpo_sel-item_node.  "BOM 项目节点号</span><br><span class="line">        ls_stpo-item_count = lt_stpo_sel-item_count. "内部计数器</span><br><span class="line"></span><br><span class="line">        ls_stpo-item_categ = ls_data-item_categ  .   "项目类别（物料单）</span><br><span class="line">        ls_stpo-item_no    = ls_data-item_no  .      "BOM 项目号</span><br><span class="line">        ls_stpo-component  = ls_data-component.      "BOM 组件</span><br><span class="line">        ls_stpo-comp_qty   = ls_data-comp_qty.       "组件数量 (BTCI)</span><br><span class="line">        ls_stpo-comp_unit  = ls_data-comp_unit.      "组件计量单位</span><br><span class="line">        ls_stpo-item_text1 = ls_data-item_text1.     "BOM 项目文本（行1）</span><br><span class="line">        ls_stpo-sortstring = ls_data-sortstring.     "排序字符串</span><br><span class="line">        ls_stpo-comp_scrap = ls_data-comp_scrap.     "部件废品用百分比表示(BTCI)</span><br><span class="line">        ls_stpo-ai_group   = ls_data-ai_group.       "替代项目：组</span><br><span class="line">        ls_stpo-ai_prio    = ls_data-ai_prio.        "备选项目：优先级</span><br><span class="line">        ls_stpo-ai_strateg = ls_data-ai_strateg.     "替代项目：策略</span><br><span class="line">        ls_stpo-usage_prob = ls_data-usage_prob.     "使用可能性按 % (BTCI)</span><br><span class="line">        ls_stpo-rel_cost   = ls_data-rel_cost.       "标识：与成本核算相关的项目</span><br><span class="line">        ls_stpo-bulk_mat   = ls_data-bulk_mat.       "标识：散装物料</span><br><span class="line">        ls_stpo-lead_time  = ls_data-lead_time.      "跟踪时间（批输入）</span><br><span class="line">        ls_stpo-op_lead_tm = ls_data-op_lead_tm.     "工序(BTCI)引导时间偏移</span><br><span class="line">        ls_stpo-issue_loc  = ls_data-issue_loc.      "生产订单的发货地点</span><br><span class="line">        ls_stpo-identifier = l_originno.             "特定客户的 APIs 对象标识符</span><br><span class="line">        <span class="keyword">APPEND</span> ls_stpo TO lt_stpo.</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">ELSE</span>.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*     BOM 项目的 API 结构：能被修改的字段</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      ls_stpo-fldelete   = ' '.                    "删除标识</span><br><span class="line"></span><br><span class="line">      ls_stpo-item_categ = ls_data-item_categ  .   "项目类别（物料单）</span><br><span class="line">      ls_stpo-item_no    = ls_data-item_no  .      "BOM 项目号</span><br><span class="line">      ls_stpo-component  = ls_data-component.      "BOM 组件</span><br><span class="line">      ls_stpo-comp_qty   = ls_data-comp_qty.       "组件数量 (BTCI)</span><br><span class="line">      ls_stpo-comp_unit  = ls_data-comp_unit.      "组件计量单位</span><br><span class="line">      ls_stpo-item_text1 = ls_data-item_text1.     "BOM 项目文本（行1）</span><br><span class="line">      ls_stpo-sortstring = ls_data-sortstring.     "排序字符串</span><br><span class="line">      ls_stpo-comp_scrap = ls_data-comp_scrap.     "部件废品用百分比表示(BTCI)</span><br><span class="line">      ls_stpo-ai_group   = ls_data-ai_group.       "替代项目：组</span><br><span class="line">      ls_stpo-ai_prio    = ls_data-ai_prio.        "备选项目：优先级</span><br><span class="line">      ls_stpo-ai_strateg = ls_data-ai_strateg.     "替代项目：策略</span><br><span class="line">      ls_stpo-usage_prob = ls_data-usage_prob.     "使用可能性按 % (BTCI)</span><br><span class="line">      ls_stpo-rel_cost   = ls_data-rel_cost.       "标识：与成本核算相关的项目</span><br><span class="line">      ls_stpo-bulk_mat   = ls_data-bulk_mat.       "标识：散装物料</span><br><span class="line">      ls_stpo-lead_time  = ls_data-lead_time.      "跟踪时间（批输入）</span><br><span class="line">      ls_stpo-op_lead_tm = ls_data-op_lead_tm.     "工序(BTCI)引导时间偏移</span><br><span class="line">      ls_stpo-issue_loc  = ls_data-issue_loc.      "生产订单的发货地点</span><br><span class="line">      ls_stpo-identifier = l_originno.             "特定客户的 APIs 对象标识符</span><br><span class="line">      <span class="keyword">APPEND</span> ls_stpo TO lt_stpo.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*   BOMs：相关性的基本数据</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    LOOP AT lt_dep_data_sel WHERE bom_no     = lt_stpo_sel-bom_no</span><br><span class="line">                               AND item_node  = lt_stpo_sel-item_node</span><br><span class="line">                               AND item_count = lt_stpo_sel-item_count.</span><br><span class="line">      <span class="keyword">IF</span> lt_dep_data_sel-dep_intern &lt;&gt; ls_data-dep_intern1 AND</span><br><span class="line">         lt_dep_data_sel-dep_intern &lt;&gt; ls_data-dep_intern2 AND</span><br><span class="line">         lt_dep_data_sel-dep_intern &lt;&gt; ls_data-dep_intern3 AND</span><br><span class="line">         lt_dep_data_sel-dep_intern &lt;&gt; ls_data-dep_intern4.</span><br><span class="line"></span><br><span class="line">        <span class="keyword">CLEAR</span> ls_dep_data.</span><br><span class="line">        ls_dep_data-fldelete    = 'X'.                       "删除标识</span><br><span class="line">        ls_dep_data-object_id   = '2'.                       "APIs 的 BOM 对象标识符</span><br><span class="line">        ls_dep_data-identifier  = l_originno.                "特定客户的 APIs 对象标识符</span><br><span class="line">        ls_dep_data-bom_no      = lt_dep_data_sel-bom_no.    "物料单</span><br><span class="line">        ls_dep_data-item_node   = lt_dep_data_sel-item_node. "BOM 项目节点号</span><br><span class="line">        ls_dep_data-item_count  = lt_dep_data_sel-item_count."内部计数器</span><br><span class="line">        ls_dep_data-dep_intern  = lt_dep_data_sel-dep_intern."相关性的内部名称</span><br><span class="line">        <span class="keyword">APPEND</span> ls_dep_data TO lt_dep_data.</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line">    ENDLOOP.</span><br><span class="line">    <span class="keyword">IF</span> ls_data-dep_intern1 IS NOT INITIAL .</span><br><span class="line">      <span class="keyword">CLEAR</span> ls_dep_data.</span><br><span class="line">      ls_dep_data-object_id   = '2'.                "APIs 的 BOM 对象标识符</span><br><span class="line">      ls_dep_data-identifier  = l_originno.         "特定客户的 APIs 对象标识符</span><br><span class="line">      ls_dep_data-dep_intern  = ls_data-dep_intern1."相关性的内部名称</span><br><span class="line">      <span class="keyword">APPEND</span> ls_dep_data TO lt_dep_data.</span><br><span class="line">    ENDIF.</span><br><span class="line">    <span class="keyword">IF</span> ls_data-dep_intern2 IS NOT INITIAL .</span><br><span class="line">      <span class="keyword">CLEAR</span> ls_dep_data.</span><br><span class="line">      ls_dep_data-object_id   = '2'.                "APIs 的 BOM 对象标识符</span><br><span class="line">      ls_dep_data-identifier  = l_originno.         "特定客户的 APIs 对象标识符</span><br><span class="line">      ls_dep_data-dep_intern  = ls_data-dep_intern2."相关性的内部名称</span><br><span class="line">      <span class="keyword">APPEND</span> ls_dep_data TO lt_dep_data.</span><br><span class="line">    ENDIF.</span><br><span class="line">    <span class="keyword">IF</span> ls_data-dep_intern3 IS NOT INITIAL .</span><br><span class="line">      <span class="keyword">CLEAR</span> ls_dep_data.</span><br><span class="line">      ls_dep_data-object_id   = '2'.                "APIs 的 BOM 对象标识符</span><br><span class="line">      ls_dep_data-identifier  = l_originno.         "特定客户的 APIs 对象标识符</span><br><span class="line">      ls_dep_data-dep_intern  = ls_data-dep_intern3."相关性的内部名称</span><br><span class="line">      <span class="keyword">APPEND</span> ls_dep_data TO lt_dep_data.</span><br><span class="line">    ENDIF.</span><br><span class="line">    <span class="keyword">IF</span> ls_data-dep_intern4 IS NOT INITIAL .</span><br><span class="line">      <span class="keyword">CLEAR</span> ls_dep_data.</span><br><span class="line">      ls_dep_data-object_id   = '2'.                "APIs 的 BOM 对象标识符</span><br><span class="line">      ls_dep_data-identifier  = l_originno.         "特定客户的 APIs 对象标识符</span><br><span class="line">      ls_dep_data-dep_intern  = ls_data-dep_intern4."相关性的内部名称</span><br><span class="line">      <span class="keyword">APPEND</span> ls_dep_data TO lt_dep_data.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line">    AT END OF stlal.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*     API BOM 表头结构：可以被更改的字段</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      ls_stko-bom_status = ls_data-bom_status.   "BOM 状态</span><br><span class="line">      ls_stko-base_quan  = ls_data-base_quan.    "基准数量(BTCI)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*     修改BOM</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      CALL FUNCTION 'CSAP_MAT_BOM_MAINTAIN'</span><br><span class="line">        EXPORTING</span><br><span class="line">          material           = ls_data-matnr     "主件物料(母件）</span><br><span class="line">          plant              = ls_data-werks     "工厂</span><br><span class="line">          bom_usage          = ls_data-stlan     "BOM用途</span><br><span class="line">          alternative        = ls_data-stlal     "可选的 BOM</span><br><span class="line"><span class="comment">*         VALID_FROM         =</span></span><br><span class="line"><span class="comment">*         CHANGE_NO          =</span></span><br><span class="line"><span class="comment">*         REVISION_LEVEL     =</span></span><br><span class="line">          i_stko             = ls_stko</span><br><span class="line">          fl_commit_and_wait = 'X'</span><br><span class="line">          fl_bom_create      = 'X'</span><br><span class="line">          fl_new_item        = 'X'</span><br><span class="line">          fl_default_values  = ' '</span><br><span class="line"><span class="comment">*         FL_COMPLETE        = 'X'</span></span><br><span class="line">        TABLES</span><br><span class="line">          t_stpo             = lt_stpo</span><br><span class="line">          t_dep_data         = lt_dep_data</span><br><span class="line">        EXCEPTIONS</span><br><span class="line">          <span class="keyword">error</span>              = 1</span><br><span class="line">          OTHERS             = 2.</span><br><span class="line">      <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line">        CALL FUNCTION 'BAPI_TRANSACTION_COMMIT'</span><br><span class="line">          EXPORTING</span><br><span class="line">            wait = 'X'.</span><br><span class="line"></span><br><span class="line">        l_message = '修改BOM成功'.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*       alv数据的编辑</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        PERFORM frm_edit_alv USING ls_data-werks</span><br><span class="line">                                    ls_data-matnr</span><br><span class="line">                                    ls_data-stlan</span><br><span class="line">                                    ls_data-stlal</span><br><span class="line">                                    l_message</span><br><span class="line">                                    icon_okay.</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line">        CALL FUNCTION 'BAPI_TRANSACTION_ROLLBACK'.</span><br><span class="line"></span><br><span class="line">        MESSAGE ID sy-msgid <span class="keyword">TYPE</span> sy-msgty NUMBER sy-msgno</span><br><span class="line">          WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4</span><br><span class="line">          INTO l_message.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*       alv数据的编辑</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        PERFORM frm_edit_alv USING ls_data-werks</span><br><span class="line">                                    ls_data-matnr</span><br><span class="line">                                    ls_data-stlan</span><br><span class="line">                                    ls_data-stlal</span><br><span class="line">                                    l_message</span><br><span class="line">                                    icon_cancel.</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line">      CALL FUNCTION 'CSAP_MAT_BOM_CLOSE'</span><br><span class="line"><span class="comment">*        EXPORTING</span></span><br><span class="line"><span class="comment">*          FL_COMMIT_AND_WAIT       = 'X'</span></span><br><span class="line"><span class="comment">*        IMPORTING</span></span><br><span class="line"><span class="comment">*          FL_WARNING               =</span></span><br><span class="line">        EXCEPTIONS</span><br><span class="line">          <span class="keyword">error</span>  = 1</span><br><span class="line">          OTHERS = 2.</span><br><span class="line">      <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* Implement suitable error handling here</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line">    ENDAT.</span><br><span class="line"></span><br><span class="line">  ENDLOOP.</span><br><span class="line"></span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  FRM_BAPI_BOM_DEL</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       删除BOM</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">FORM</span> frm_bapi_bom_del .</span><br><span class="line"></span><br><span class="line">  DATA:</span><br><span class="line">    ls_data   LIKE <span class="keyword">LINE</span> OF gt_data_in,</span><br><span class="line">    l_message <span class="keyword">TYPE</span>         char255.                  "ALV信息</span><br><span class="line"></span><br><span class="line">  LOOP AT gt_data_in INTO ls_data.</span><br><span class="line"></span><br><span class="line">    AT END OF stlal.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*     删除BOM</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      CALL FUNCTION 'CSAP_MAT_BOM_DELETE'</span><br><span class="line">        EXPORTING</span><br><span class="line">          material           = ls_data-matnr     "主件物料(母件）</span><br><span class="line">          plant              = ls_data-werks     "工厂</span><br><span class="line">          bom_usage          = ls_data-stlan     "BOM用途</span><br><span class="line">          alternative        = ls_data-stlal     "可选的 BOM</span><br><span class="line"><span class="comment">*         VALID_FROM         =</span></span><br><span class="line"><span class="comment">*         CHANGE_NO          =</span></span><br><span class="line"><span class="comment">*         REVISION_LEVEL     =</span></span><br><span class="line"><span class="comment">*         FL_NO_CHANGE_DOC   = ' '</span></span><br><span class="line">          fl_commit_and_wait = 'X'</span><br><span class="line"><span class="comment">*       IMPORTING</span></span><br><span class="line"><span class="comment">*         FL_WARNING         =</span></span><br><span class="line">        EXCEPTIONS</span><br><span class="line">          <span class="keyword">error</span>              = 1</span><br><span class="line">          OTHERS             = 2.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line">        CALL FUNCTION 'BAPI_TRANSACTION_COMMIT'</span><br><span class="line">          EXPORTING</span><br><span class="line">            wait = 'X'.</span><br><span class="line"></span><br><span class="line">        l_message = '删除BOM成功'.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*       alv数据的编辑</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        PERFORM frm_edit_alv USING ls_data-werks</span><br><span class="line">                                    ls_data-matnr</span><br><span class="line">                                    ls_data-stlan</span><br><span class="line">                                    ls_data-stlal</span><br><span class="line">                                    l_message</span><br><span class="line">                                    icon_okay.</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line">        CALL FUNCTION 'BAPI_TRANSACTION_ROLLBACK'.</span><br><span class="line"></span><br><span class="line">        MESSAGE ID sy-msgid <span class="keyword">TYPE</span> sy-msgty NUMBER sy-msgno</span><br><span class="line">          WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4</span><br><span class="line">          INTO l_message.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*       alv数据的编辑</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        PERFORM frm_edit_alv USING ls_data-werks</span><br><span class="line">                                    ls_data-matnr</span><br><span class="line">                                    ls_data-stlan</span><br><span class="line">                                    ls_data-stlal</span><br><span class="line">                                    l_message</span><br><span class="line">                                    icon_cancel.</span><br><span class="line">      ENDIF.</span><br><span class="line">    ENDAT.</span><br><span class="line"></span><br><span class="line">  ENDLOOP.</span><br><span class="line"></span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  FRM_BAPI_BOM_INS_BAPI</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       可选BOM单一</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">FORM</span> frm_bapi_bom_ins_bapi .</span><br><span class="line"></span><br><span class="line">  DATA:</span><br><span class="line">    ls_tmp       LIKE <span class="keyword">LINE</span> OF  gt_data_in,</span><br><span class="line">    ls_data      LIKE <span class="keyword">LINE</span> OF  gt_data_in,</span><br><span class="line">    lt_stpo      <span class="keyword">TYPE</span> <span class="keyword">TABLE</span> OF stpo_api01,      "BOM 项目的 API 结构：能被修改的字段</span><br><span class="line">    ls_stpo      LIKE <span class="keyword">LINE</span> OF  lt_stpo,</span><br><span class="line">    lt_dep_data  <span class="keyword">TYPE</span> <span class="keyword">TABLE</span> OF csdep_dat,       "BOMs：相关性的基本数据</span><br><span class="line">    ls_dep_data  LIKE <span class="keyword">LINE</span> OF  lt_dep_data,</span><br><span class="line">    l_valid_from <span class="keyword">TYPE</span>          csap_mbom-datuv,          "有效日期自 (BTCI)</span><br><span class="line">    l_message    <span class="keyword">TYPE</span>          char255,                  "ALV信息</span><br><span class="line">    l_originno   <span class="keyword">TYPE</span>          i,</span><br><span class="line">    ls_stko      <span class="keyword">TYPE</span>          stko_api01.               "API BOM 表头结构：可以被更改的字段</span><br><span class="line"></span><br><span class="line">  LOOP AT gt_data_in INTO ls_tmp.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">CLEAR</span>:</span><br><span class="line">      ls_data,</span><br><span class="line">      ls_stpo,</span><br><span class="line">      ls_dep_data.</span><br><span class="line"></span><br><span class="line">    ls_data = ls_tmp.</span><br><span class="line"></span><br><span class="line">    AT NEW stlan.</span><br><span class="line">      REFRESH:</span><br><span class="line">        lt_stpo,</span><br><span class="line">        lt_dep_data.</span><br><span class="line">      <span class="keyword">CLEAR</span>:</span><br><span class="line">        l_valid_from,</span><br><span class="line">        l_message,</span><br><span class="line">        l_originno,</span><br><span class="line">        ls_stko.</span><br><span class="line">    ENDAT.</span><br><span class="line"></span><br><span class="line">    l_originno = l_originno + 1.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*   BOM 项目的 API 结构：能被修改的字段</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    ls_stpo-item_categ = ls_data-item_categ  .   "项目类别（物料单）</span><br><span class="line">    ls_stpo-item_no    = ls_data-item_no  .      "BOM 项目号</span><br><span class="line">    ls_stpo-component  = ls_data-component.      "BOM 组件</span><br><span class="line">    ls_stpo-comp_qty   = ls_data-comp_qty.       "组件数量 (BTCI)</span><br><span class="line">    ls_stpo-comp_unit  = ls_data-comp_unit.      "组件计量单位</span><br><span class="line">    ls_stpo-item_text1 = ls_data-item_text1.     "BOM 项目文本（行1）</span><br><span class="line">    ls_stpo-sortstring = ls_data-sortstring.     "排序字符串</span><br><span class="line">    ls_stpo-comp_scrap = ls_data-comp_scrap.     "部件废品用百分比表示(BTCI)</span><br><span class="line">    ls_stpo-ai_group   = ls_data-ai_group.       "替代项目：组</span><br><span class="line">    ls_stpo-ai_prio    = ls_data-ai_prio.        "备选项目：优先级</span><br><span class="line">    ls_stpo-ai_strateg = ls_data-ai_strateg.     "替代项目：策略</span><br><span class="line">    ls_stpo-usage_prob = ls_data-usage_prob.     "使用可能性按 % (BTCI)</span><br><span class="line">    ls_stpo-rel_cost   = ls_data-rel_cost.       "标识：与成本核算相关的项目</span><br><span class="line">    ls_stpo-bulk_mat   = ls_data-bulk_mat.       "标识：散装物料</span><br><span class="line">    ls_stpo-lead_time  = ls_data-lead_time.      "跟踪时间（批输入）</span><br><span class="line">    ls_stpo-op_lead_tm = ls_data-op_lead_tm.     "工序(BTCI)引导时间偏移</span><br><span class="line">    ls_stpo-issue_loc  = ls_data-issue_loc.      "生产订单的发货地点</span><br><span class="line">    ls_stpo-identifier = l_originno.             "特定客户的 APIs 对象标识符</span><br><span class="line"></span><br><span class="line">    <span class="keyword">IF</span> ls_stpo-bulk_mat IS NOT INITIAL.</span><br><span class="line">      ls_stpo-rel_prod = 'X'.             "特定客户的 APIs 对象标识符</span><br><span class="line">    ENDIF.</span><br><span class="line">    <span class="keyword">APPEND</span> ls_stpo TO lt_stpo.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*   BOMs：相关性的基本数据</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">IF</span> ls_data-dep_intern1 IS NOT INITIAL .</span><br><span class="line">      <span class="keyword">CLEAR</span> ls_dep_data.</span><br><span class="line">      ls_dep_data-object_id   = '2'.                "APIs 的 BOM 对象标识符</span><br><span class="line">      ls_dep_data-identifier  = l_originno.         "特定客户的 APIs 对象标识符</span><br><span class="line">      ls_dep_data-dep_intern  = ls_data-dep_intern1."相关性的内部名称</span><br><span class="line">      <span class="keyword">APPEND</span> ls_dep_data TO lt_dep_data.</span><br><span class="line">    ENDIF.</span><br><span class="line">    <span class="keyword">IF</span> ls_data-dep_intern2 IS NOT INITIAL .</span><br><span class="line">      <span class="keyword">CLEAR</span> ls_dep_data.</span><br><span class="line">      ls_dep_data-object_id   = '2'.                "APIs 的 BOM 对象标识符</span><br><span class="line">      ls_dep_data-identifier  = l_originno.         "特定客户的 APIs 对象标识符</span><br><span class="line">      ls_dep_data-dep_intern  = ls_data-dep_intern2."相关性的内部名称</span><br><span class="line">      <span class="keyword">APPEND</span> ls_dep_data TO lt_dep_data.</span><br><span class="line">    ENDIF.</span><br><span class="line">    <span class="keyword">IF</span> ls_data-dep_intern3 IS NOT INITIAL .</span><br><span class="line">      <span class="keyword">CLEAR</span> ls_dep_data.</span><br><span class="line">      ls_dep_data-object_id   = '2'.                "APIs 的 BOM 对象标识符</span><br><span class="line">      ls_dep_data-identifier  = l_originno.         "特定客户的 APIs 对象标识符</span><br><span class="line">      ls_dep_data-dep_intern  = ls_data-dep_intern3."相关性的内部名称</span><br><span class="line">      <span class="keyword">APPEND</span> ls_dep_data TO lt_dep_data.</span><br><span class="line">    ENDIF.</span><br><span class="line">    <span class="keyword">IF</span> ls_data-dep_intern4 IS NOT INITIAL .</span><br><span class="line">      <span class="keyword">CLEAR</span> ls_dep_data.</span><br><span class="line">      ls_dep_data-object_id   = '2'.                "APIs 的 BOM 对象标识符</span><br><span class="line">      ls_dep_data-identifier  = l_originno.         "特定客户的 APIs 对象标识符</span><br><span class="line">      ls_dep_data-dep_intern  = ls_data-dep_intern4."相关性的内部名称</span><br><span class="line">      <span class="keyword">APPEND</span> ls_dep_data TO lt_dep_data.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line">    AT END OF stlan.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*     API BOM 表头结构：可以被更改的字段</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      ls_stko-bom_status = ls_data-bom_status.   "BOM 状态</span><br><span class="line">      ls_stko-base_quan  = ls_data-base_quan.    "基准数量(BTCI)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*     日期:转换</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      CALL FUNCTION 'CONVERT_DATE_TO_EXTERNAL'</span><br><span class="line">        EXPORTING</span><br><span class="line">          date_internal            = sy-datum</span><br><span class="line">        IMPORTING</span><br><span class="line">          date_external            = l_valid_from</span><br><span class="line">        EXCEPTIONS</span><br><span class="line">          date_internal_is_invalid = 1</span><br><span class="line">          OTHERS                   = 2.</span><br><span class="line">      <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* Implement suitable error handling here</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*     创建BOM</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      CALL FUNCTION 'CSAP_MAT_BOM_CREATE'</span><br><span class="line">        EXPORTING</span><br><span class="line">          material           = ls_data-matnr     "主件物料(母件）</span><br><span class="line">          plant              = ls_data-werks     "工厂</span><br><span class="line">          bom_usage          = ls_data-stlan     "BOM用途</span><br><span class="line">          valid_from         = l_valid_from      "有效起</span><br><span class="line"><span class="comment">*         VALID_FROM         = LS_DATA-DATUV     "有效起</span></span><br><span class="line"><span class="comment">*         CHANGE_NO          = LS_DATA-AENNR     "更改号</span></span><br><span class="line"><span class="comment">*         REVISION_LEVEL     = LS_DATA-REVLV     "版次</span></span><br><span class="line">          i_stko             = ls_stko</span><br><span class="line">          fl_commit_and_wait = 'X'</span><br><span class="line"><span class="comment">*         FL_DEFAULT_VALUES  = ' '</span></span><br><span class="line">        TABLES</span><br><span class="line">          t_stpo             = lt_stpo</span><br><span class="line">          t_dep_data         = lt_dep_data</span><br><span class="line">        EXCEPTIONS</span><br><span class="line">          <span class="keyword">error</span>              = 1</span><br><span class="line">          OTHERS             = 2.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line">        CALL FUNCTION 'BAPI_TRANSACTION_COMMIT'</span><br><span class="line">          EXPORTING</span><br><span class="line">            wait = 'X'.</span><br><span class="line"></span><br><span class="line">        l_message = '创建BOM成功'.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*       alv数据的编辑</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        PERFORM frm_edit_alv USING ls_data-werks</span><br><span class="line">                                    ls_data-matnr</span><br><span class="line">                                    ls_data-stlan</span><br><span class="line">                                    ls_data-stlal</span><br><span class="line">                                    l_message</span><br><span class="line">                                    icon_okay.</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line">        CALL FUNCTION 'BAPI_TRANSACTION_ROLLBACK'.</span><br><span class="line"></span><br><span class="line">        MESSAGE ID sy-msgid <span class="keyword">TYPE</span> sy-msgty NUMBER sy-msgno</span><br><span class="line">          WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4</span><br><span class="line">          INTO l_message.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*       alv数据的编辑</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        PERFORM frm_edit_alv USING ls_data-werks</span><br><span class="line">                                    ls_data-matnr</span><br><span class="line">                                    ls_data-stlan</span><br><span class="line">                                    ls_data-stlal</span><br><span class="line">                                    l_message</span><br><span class="line">                                    icon_cancel.</span><br><span class="line">      ENDIF.</span><br><span class="line">    ENDAT.</span><br><span class="line"></span><br><span class="line">  ENDLOOP.</span><br><span class="line"></span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  FRM_BAPI_BOM_INS_BDC</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       可选BOM多个（创建可选的bom 抬头）</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">FORM</span> frm_bapi_bom_ins_bdc .</span><br><span class="line"></span><br><span class="line">  DATA:</span><br><span class="line">    ls_tmp    LIKE <span class="keyword">LINE</span> OF gt_data_in,</span><br><span class="line">    ls_data   LIKE <span class="keyword">LINE</span> OF gt_data_in,</span><br><span class="line">    l_message <span class="keyword">TYPE</span>         char255.                  "ALV信息</span><br><span class="line"></span><br><span class="line">  DATA:</span><br><span class="line">    ls_bom_header <span class="keyword">TYPE</span> bicsk,          "BOM 表头数据的批输入结构</span><br><span class="line">    ls_group_data <span class="keyword">TYPE</span> bgr00,</span><br><span class="line">    l_msgid       <span class="keyword">TYPE</span> t100-arbgb,</span><br><span class="line">    l_msgno       <span class="keyword">TYPE</span> t100-msgnr,</span><br><span class="line">    l_msgty       <span class="keyword">TYPE</span> sy-msgty,</span><br><span class="line">    l_msgv1       <span class="keyword">TYPE</span> sy-msgv1,</span><br><span class="line">    l_msgv2       <span class="keyword">TYPE</span> sy-msgv2,</span><br><span class="line">    l_msgv3       <span class="keyword">TYPE</span> sy-msgv3,</span><br><span class="line">    l_msgv4       <span class="keyword">TYPE</span> sy-msgv4,</span><br><span class="line">    lt_bom_item   LIKE bicsp OCCURS 0 WITH HEADER <span class="keyword">LINE</span>, "BOM项数据的批输入结构</span><br><span class="line">    lt_sub_item   LIKE bicsu OCCURS 0 WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line"></span><br><span class="line">  LOOP AT gt_data_in INTO ls_tmp.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">CLEAR</span>:</span><br><span class="line">      ls_data.</span><br><span class="line"></span><br><span class="line">    ls_data = ls_tmp.</span><br><span class="line"></span><br><span class="line">    AT NEW stlan.</span><br><span class="line">      <span class="keyword">CLEAR</span>:</span><br><span class="line">        ls_bom_header,</span><br><span class="line">        ls_group_data,</span><br><span class="line">        l_msgid      ,</span><br><span class="line">        l_msgno      ,</span><br><span class="line">        l_msgty      ,</span><br><span class="line">        l_msgv1      ,</span><br><span class="line">        l_msgv2      ,</span><br><span class="line">        l_msgv3      ,</span><br><span class="line">        l_msgv4      ,</span><br><span class="line">        lt_bom_item  ,</span><br><span class="line">        lt_sub_item  .</span><br><span class="line">    ENDAT.</span><br><span class="line"></span><br><span class="line">    AT END OF stlan.</span><br><span class="line">      ls_bom_header-tcode = 'CS01'.</span><br><span class="line">      ls_bom_header-werks = ls_data-werks.</span><br><span class="line">      ls_bom_header-matnr = ls_data-matnr.</span><br><span class="line">      ls_bom_header-bmeng = ls_data-base_quan.</span><br><span class="line">      ls_bom_header-stlal = ls_data-stlal.</span><br><span class="line">      ls_bom_header-stlan = ls_data-stlan.</span><br><span class="line">      ls_bom_header-stlst = ls_data-bom_status.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*     日期:转换</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      CALL FUNCTION 'CONVERT_DATE_TO_EXTERNAL'</span><br><span class="line">        EXPORTING</span><br><span class="line">          date_internal            = sy-datum</span><br><span class="line">        IMPORTING</span><br><span class="line">          date_external            = ls_bom_header-datuv</span><br><span class="line">        EXCEPTIONS</span><br><span class="line">          date_internal_is_invalid = 1</span><br><span class="line">          OTHERS                   = 2.</span><br><span class="line">      <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* Implement suitable error handling here</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line">      CALL FUNCTION 'CS_BI_BOM_CREATE_BATCH_INPUT1'</span><br><span class="line">        EXPORTING</span><br><span class="line"><span class="comment">*         BDC_FLAG     = ' '</span></span><br><span class="line">          bom_header   = ls_bom_header</span><br><span class="line"><span class="comment">*         CLOSE_GROUP  = ' '</span></span><br><span class="line">          commit_work  = 'X'</span><br><span class="line">          group_data   = ls_group_data</span><br><span class="line"><span class="comment">*         NEW_GROUP    = ' '</span></span><br><span class="line">          tcode_mode   = '<span class="keyword">N</span>'</span><br><span class="line">          tcode_update = 'S'</span><br><span class="line">        IMPORTING</span><br><span class="line">          msgid        = l_msgid</span><br><span class="line">          msgno        = l_msgno</span><br><span class="line">          msgty        = l_msgty</span><br><span class="line">          msgv1        = l_msgv1</span><br><span class="line">          msgv2        = l_msgv2</span><br><span class="line">          msgv3        = l_msgv3</span><br><span class="line">          msgv4        = l_msgv4</span><br><span class="line">        TABLES</span><br><span class="line">          bom_item     = lt_bom_item</span><br><span class="line">          bom_sub_item = lt_sub_item.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">IF</span> l_msgty = '<span class="keyword">E</span>' OR l_msgty = 'A'.</span><br><span class="line">        CALL FUNCTION 'BAPI_TRANSACTION_ROLLBACK'.</span><br><span class="line">        MESSAGE ID l_msgid <span class="keyword">TYPE</span> l_msgty NUMBER l_msgno</span><br><span class="line">          WITH l_msgv1 l_msgv2 l_msgv3 l_msgv4</span><br><span class="line">          INTO l_message.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*       alv数据的编辑</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        PERFORM frm_edit_alv USING ls_data-werks</span><br><span class="line">                                    ls_data-matnr</span><br><span class="line">                                    ls_data-stlan</span><br><span class="line">                                    ls_data-stlal</span><br><span class="line">                                    l_message</span><br><span class="line">                                    icon_cancel.</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line">        CALL FUNCTION 'BAPI_TRANSACTION_COMMIT'</span><br><span class="line">          EXPORTING</span><br><span class="line">            wait = 'X'.</span><br><span class="line"></span><br><span class="line">        l_message = '创建BOM成功'.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*       alv数据的编辑</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        PERFORM frm_edit_alv USING ls_data-werks</span><br><span class="line">                                    ls_data-matnr</span><br><span class="line">                                    ls_data-stlan</span><br><span class="line">                                    ls_data-stlal</span><br><span class="line">                                    l_message</span><br><span class="line">                                    icon_okay.</span><br><span class="line">      ENDIF.</span><br><span class="line">    ENDAT.</span><br><span class="line"></span><br><span class="line">  ENDLOOP.</span><br><span class="line"></span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  FRM_BAPI_BOM_UPD_ITEM</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       修改BOM(明细行项目的追加)</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*  --&gt;  p1        text</span></span><br><span class="line"><span class="comment">*  &lt;--  p2        text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">FORM</span> frm_bapi_bom_upd_item .</span><br><span class="line"></span><br><span class="line">  DATA:</span><br><span class="line">    ls_tmp      LIKE <span class="keyword">LINE</span> OF  gt_data_in,</span><br><span class="line">    ls_data     LIKE <span class="keyword">LINE</span> OF  gt_data_in,</span><br><span class="line">    lt_stpo     <span class="keyword">TYPE</span> <span class="keyword">TABLE</span> OF stpo_api03,      "BOM 项目的 API 结构：ALL ＋标识的字段</span><br><span class="line">    ls_stpo     LIKE <span class="keyword">LINE</span> OF  lt_stpo,</span><br><span class="line">    lt_dep_data <span class="keyword">TYPE</span> <span class="keyword">TABLE</span> OF csdep_dat,       "BOMs：相关性的基本数据</span><br><span class="line">    ls_dep_data LIKE <span class="keyword">LINE</span> OF  lt_dep_data,</span><br><span class="line">    l_message   <span class="keyword">TYPE</span>          char255,                  "ALV信息</span><br><span class="line">    l_originno  <span class="keyword">TYPE</span>          i,</span><br><span class="line">    ls_stko     <span class="keyword">TYPE</span>          stko_api01.               "API BOM 表头结构：可以被更改的字段</span><br><span class="line"></span><br><span class="line">  FIELD-SYMBOLS:</span><br><span class="line">    &lt;ls_fs_alv&gt; LIKE <span class="keyword">LINE</span> OF gt_alv.</span><br><span class="line"></span><br><span class="line">  LOOP AT gt_data_in INTO ls_tmp.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">CLEAR</span>:</span><br><span class="line">      ls_data,</span><br><span class="line">      ls_stpo,</span><br><span class="line">      ls_dep_data.</span><br><span class="line"></span><br><span class="line">    ls_data = ls_tmp.</span><br><span class="line"></span><br><span class="line">    AT NEW stlal.</span><br><span class="line">      REFRESH:</span><br><span class="line">        lt_stpo,</span><br><span class="line">        lt_dep_data.</span><br><span class="line">      <span class="keyword">CLEAR</span>:</span><br><span class="line">        l_message,</span><br><span class="line">        l_originno,</span><br><span class="line">        ls_stko.</span><br><span class="line">    ENDAT.</span><br><span class="line"></span><br><span class="line">    l_originno = l_originno + 1.</span><br><span class="line"></span><br><span class="line">    ls_stpo-item_categ = ls_data-item_categ  .   "项目类别（物料单）</span><br><span class="line">    ls_stpo-item_no    = ls_data-item_no  .      "BOM 项目号</span><br><span class="line">    ls_stpo-component  = ls_data-component.      "BOM 组件</span><br><span class="line">    ls_stpo-comp_qty   = ls_data-comp_qty.       "组件数量 (BTCI)</span><br><span class="line">    ls_stpo-comp_unit  = ls_data-comp_unit.      "组件计量单位</span><br><span class="line">    ls_stpo-item_text1 = ls_data-item_text1.     "BOM 项目文本（行1）</span><br><span class="line">    ls_stpo-sortstring = ls_data-sortstring.     "排序字符串</span><br><span class="line">    ls_stpo-comp_scrap = ls_data-comp_scrap.     "部件废品用百分比表示(BTCI)</span><br><span class="line">    ls_stpo-ai_group   = ls_data-ai_group.       "替代项目：组</span><br><span class="line">    ls_stpo-ai_prio    = ls_data-ai_prio.        "备选项目：优先级</span><br><span class="line">    ls_stpo-ai_strateg = ls_data-ai_strateg.     "替代项目：策略</span><br><span class="line">    ls_stpo-usage_prob = ls_data-usage_prob.     "使用可能性按 % (BTCI)</span><br><span class="line">    ls_stpo-rel_cost   = ls_data-rel_cost.       "标识：与成本核算相关的项目</span><br><span class="line">    ls_stpo-bulk_mat   = ls_data-bulk_mat.       "标识：散装物料</span><br><span class="line">    ls_stpo-lead_time  = ls_data-lead_time.      "跟踪时间（批输入）</span><br><span class="line">    ls_stpo-op_lead_tm = ls_data-op_lead_tm.     "工序(BTCI)引导时间偏移</span><br><span class="line">    ls_stpo-issue_loc  = ls_data-issue_loc.      "生产订单的发货地点</span><br><span class="line">    ls_stpo-identifier = l_originno.             "特定客户的 APIs 对象标识符</span><br><span class="line">    <span class="keyword">APPEND</span> ls_stpo TO lt_stpo.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*   BOMs：相关性的基本数据</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">IF</span> ls_data-dep_intern1 IS NOT INITIAL .</span><br><span class="line">      <span class="keyword">CLEAR</span> ls_dep_data.</span><br><span class="line">      ls_dep_data-object_id   = '2'.                "APIs 的 BOM 对象标识符</span><br><span class="line">      ls_dep_data-identifier  = l_originno.         "特定客户的 APIs 对象标识符</span><br><span class="line">      ls_dep_data-dep_intern  = ls_data-dep_intern1."相关性的内部名称</span><br><span class="line">      <span class="keyword">APPEND</span> ls_dep_data TO lt_dep_data.</span><br><span class="line">    ENDIF.</span><br><span class="line">    <span class="keyword">IF</span> ls_data-dep_intern2 IS NOT INITIAL .</span><br><span class="line">      <span class="keyword">CLEAR</span> ls_dep_data.</span><br><span class="line">      ls_dep_data-object_id   = '2'.                "APIs 的 BOM 对象标识符</span><br><span class="line">      ls_dep_data-identifier  = l_originno.         "特定客户的 APIs 对象标识符</span><br><span class="line">      ls_dep_data-dep_intern  = ls_data-dep_intern2."相关性的内部名称</span><br><span class="line">      <span class="keyword">APPEND</span> ls_dep_data TO lt_dep_data.</span><br><span class="line">    ENDIF.</span><br><span class="line">    <span class="keyword">IF</span> ls_data-dep_intern3 IS NOT INITIAL .</span><br><span class="line">      <span class="keyword">CLEAR</span> ls_dep_data.</span><br><span class="line">      ls_dep_data-object_id   = '2'.                "APIs 的 BOM 对象标识符</span><br><span class="line">      ls_dep_data-identifier  = l_originno.         "特定客户的 APIs 对象标识符</span><br><span class="line">      ls_dep_data-dep_intern  = ls_data-dep_intern3."相关性的内部名称</span><br><span class="line">      <span class="keyword">APPEND</span> ls_dep_data TO lt_dep_data.</span><br><span class="line">    ENDIF.</span><br><span class="line">    <span class="keyword">IF</span> ls_data-dep_intern4 IS NOT INITIAL .</span><br><span class="line">      <span class="keyword">CLEAR</span> ls_dep_data.</span><br><span class="line">      ls_dep_data-object_id   = '2'.                "APIs 的 BOM 对象标识符</span><br><span class="line">      ls_dep_data-identifier  = l_originno.         "特定客户的 APIs 对象标识符</span><br><span class="line">      ls_dep_data-dep_intern  = ls_data-dep_intern4."相关性的内部名称</span><br><span class="line">      <span class="keyword">APPEND</span> ls_dep_data TO lt_dep_data.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line">    AT END OF stlal.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*     API BOM 表头结构：可以被更改的字段</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      ls_stko-bom_status = ls_data-bom_status.   "BOM 状态</span><br><span class="line">      ls_stko-base_quan  = ls_data-base_quan.    "基准数量(BTCI)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*     修改BOM</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      CALL FUNCTION 'CSAP_MAT_BOM_MAINTAIN'</span><br><span class="line">        EXPORTING</span><br><span class="line">          material           = ls_data-matnr     "主件物料(母件）</span><br><span class="line">          plant              = ls_data-werks     "工厂</span><br><span class="line">          bom_usage          = ls_data-stlan     "BOM用途</span><br><span class="line">          alternative        = ls_data-stlal     "可选的 BOM</span><br><span class="line"><span class="comment">*         VALID_FROM         =</span></span><br><span class="line"><span class="comment">*         CHANGE_NO          =</span></span><br><span class="line"><span class="comment">*         REVISION_LEVEL     =</span></span><br><span class="line">          i_stko             = ls_stko</span><br><span class="line">          fl_commit_and_wait = 'X'</span><br><span class="line">          fl_bom_create      = 'X'</span><br><span class="line">          fl_new_item        = 'X'</span><br><span class="line">          fl_default_values  = ' '</span><br><span class="line"><span class="comment">*         FL_COMPLETE        = 'X'</span></span><br><span class="line">        TABLES</span><br><span class="line">          t_stpo             = lt_stpo</span><br><span class="line">          t_dep_data         = lt_dep_data</span><br><span class="line">        EXCEPTIONS</span><br><span class="line">          <span class="keyword">error</span>              = 1</span><br><span class="line">          OTHERS             = 2.</span><br><span class="line">      <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line">        CALL FUNCTION 'BAPI_TRANSACTION_COMMIT'</span><br><span class="line">          EXPORTING</span><br><span class="line">            wait = 'X'.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line">        CALL FUNCTION 'BAPI_TRANSACTION_ROLLBACK'.</span><br><span class="line"></span><br><span class="line">        MESSAGE ID sy-msgid <span class="keyword">TYPE</span> sy-msgty NUMBER sy-msgno</span><br><span class="line">          WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4</span><br><span class="line">          INTO l_message.</span><br><span class="line"></span><br><span class="line">        LOOP AT gt_alv ASSIGNING &lt;ls_fs_alv&gt;.</span><br><span class="line"></span><br><span class="line">          CALL FUNCTION 'CONVERSION_EXIT_MATN2_OUTPUT'</span><br><span class="line">            EXPORTING</span><br><span class="line">              <span class="keyword">input</span>  = ls_data-matnr</span><br><span class="line">            IMPORTING</span><br><span class="line">              output = ls_data-matnr.</span><br><span class="line"></span><br><span class="line">          <span class="keyword">IF</span> ls_data-matnr = &lt;ls_fs_alv&gt;-matnr.</span><br><span class="line">            &lt;ls_fs_alv&gt;-message = l_message.</span><br><span class="line">            &lt;ls_fs_alv&gt;-icon_id = icon_cancel.</span><br><span class="line">          ENDIF.</span><br><span class="line"></span><br><span class="line">        ENDLOOP.</span><br><span class="line">      ENDIF.</span><br><span class="line">    ENDAT.</span><br><span class="line"></span><br><span class="line">  ENDLOOP.</span><br><span class="line"></span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  FRM_MODIFY_SCREEN</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*  --&gt;  p1        text</span></span><br><span class="line"><span class="comment">*  &lt;--  p2        text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">FORM</span> frm_modify_screen .</span><br><span class="line"></span><br><span class="line"><span class="comment">*  LOOP AT SCREEN.</span></span><br><span class="line"><span class="comment">*    CASE 'X'.</span></span><br><span class="line"><span class="comment">*      WHEN rb_ins.</span></span><br><span class="line"><span class="comment">*        IF screen-name = 'CB_STLAL'.</span></span><br><span class="line"><span class="comment">*          screen-active = 1.</span></span><br><span class="line"><span class="comment">*        ENDIF.</span></span><br><span class="line"><span class="comment">*      WHEN rb_upd.</span></span><br><span class="line"><span class="comment">*        IF screen-name = 'CB_STLAL'.</span></span><br><span class="line"><span class="comment">*          screen-active = 0.</span></span><br><span class="line"><span class="comment">*        ENDIF.</span></span><br><span class="line"><span class="comment">*      WHEN rb_del.</span></span><br><span class="line"><span class="comment">*        IF screen-name = 'CB_STLAL'.</span></span><br><span class="line"><span class="comment">*          screen-active = 0.</span></span><br><span class="line"><span class="comment">*        ENDIF.</span></span><br><span class="line"><span class="comment">*      WHEN OTHERS.</span></span><br><span class="line"><span class="comment">*    ENDCASE.</span></span><br><span class="line"><span class="comment">*    MODIFY SCREEN.</span></span><br><span class="line"><span class="comment">*  ENDLOOP.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  LOOP AT SCREEN.</span></span><br><span class="line"><span class="comment">*    IF rb_in = 'X'.</span></span><br><span class="line"><span class="comment">*      IF screen-group1 = 'G1'.</span></span><br><span class="line"><span class="comment">*        screen-active = 1.</span></span><br><span class="line"><span class="comment">*      ENDIF.</span></span><br><span class="line"><span class="comment">*      IF screen-group1 = 'G2'.</span></span><br><span class="line"><span class="comment">*        screen-active = 0.</span></span><br><span class="line"><span class="comment">*      ENDIF.</span></span><br><span class="line"><span class="comment">*    ELSE.</span></span><br><span class="line"><span class="comment">*      IF screen-group1 = 'G1'.</span></span><br><span class="line"><span class="comment">*        screen-active = 0.</span></span><br><span class="line"><span class="comment">*      ENDIF.</span></span><br><span class="line"><span class="comment">*      IF screen-group1 = 'G2'.</span></span><br><span class="line"><span class="comment">*        screen-active = 1.</span></span><br><span class="line"><span class="comment">*      ENDIF.</span></span><br><span class="line"><span class="comment">*    ENDIF.</span></span><br><span class="line"><span class="comment">*    MODIFY SCREEN.</span></span><br><span class="line"><span class="comment">*  ENDLOOP.</span></span><br><span class="line"></span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  FRM_GET_DATA_OUT</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       导出数据的取得</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*  --&gt;  p1        text</span></span><br><span class="line"><span class="comment">*  &lt;--  p2        text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">FORM</span> frm_get_data_out .</span><br><span class="line"></span><br><span class="line">  DATA:</span><br><span class="line">    ls_data   LIKE <span class="keyword">LINE</span> OF  gt_data_out,</span><br><span class="line">    lt_mast   <span class="keyword">TYPE</span> <span class="keyword">TABLE</span> OF typ_mast,</span><br><span class="line">    ls_mast   LIKE <span class="keyword">LINE</span> OF  lt_mast,</span><br><span class="line">    ls_stpox  <span class="keyword">TYPE</span> <span class="keyword">TABLE</span> OF stpox WITH HEADER <span class="keyword">LINE</span> ,</span><br><span class="line">    ls_cstmat <span class="keyword">TYPE</span> <span class="keyword">TABLE</span> OF cstmat WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line"><span class="comment">*    l_valid_from TYPE          csap_mbom-datuv,</span></span><br><span class="line"><span class="comment">*    l_line       TYPE          i,</span></span><br><span class="line"><span class="comment">*    l_maktx      TYPE          makt-maktx,</span></span><br><span class="line"><span class="comment">*    ls_stko      TYPE          stko_api02,                          "BOM 表头的 API 结构： 所有字段</span></span><br><span class="line"><span class="comment">*    lt_stpo      LIKE          stpo_api02 OCCURS 0 WITH HEADER LINE, "BOM 项目的 API 结构：能被修改的字段</span></span><br><span class="line"><span class="comment">*    lt_dep_data  LIKE          csdep_dat  OCCURS 0 WITH HEADER LINE. "BOMs：相关性的基本数据</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">** 日期:转换</span></span><br><span class="line"><span class="comment">*  CALL FUNCTION 'CONVERT_DATE_TO_EXTERNAL'</span></span><br><span class="line"><span class="comment">*    EXPORTING</span></span><br><span class="line"><span class="comment">*      date_internal            = sy-datum</span></span><br><span class="line"><span class="comment">*    IMPORTING</span></span><br><span class="line"><span class="comment">*      date_external            = l_valid_from</span></span><br><span class="line"><span class="comment">*    EXCEPTIONS</span></span><br><span class="line"><span class="comment">*      date_internal_is_invalid = 1</span></span><br><span class="line"><span class="comment">*      OTHERS                   = 2.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  SELECT matnr     "物料编号</span><br><span class="line">        werks     "工厂</span><br><span class="line">        stlan     "BOM 用途</span><br><span class="line">        stlal     "可选的 BOM</span><br><span class="line">    FROM mast</span><br><span class="line">    INTO <span class="keyword">TABLE</span> lt_mast</span><br><span class="line">   WHERE matnr <span class="keyword">IN</span> s_matnr</span><br><span class="line">    AND  werks <span class="keyword">IN</span> s_werks</span><br><span class="line">    AND  stlan <span class="keyword">IN</span> s_stlan</span><br><span class="line">    AND  stlal <span class="keyword">IN</span> s_stlal.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">SORT</span> lt_mast <span class="keyword">BY</span> werks matnr stlan stlal.</span><br><span class="line"></span><br><span class="line">  LOOP AT lt_mast INTO ls_mast.</span><br><span class="line"><span class="comment">*    CLEAR:</span></span><br><span class="line"><span class="comment">*      ls_stko,</span></span><br><span class="line"><span class="comment">*      lt_stpo,</span></span><br><span class="line"><span class="comment">*      lt_dep_data.</span></span><br><span class="line">    <span class="keyword">CLEAR</span>:ls_cstmat,ls_cstmat[],ls_stpox,ls_stpox[].</span><br><span class="line"></span><br><span class="line"><span class="comment">*   得到最新的BOM 行项目</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*    CALL FUNCTION 'CSAP_MAT_BOM_OPEN'</span></span><br><span class="line"><span class="comment">*      EXPORTING</span></span><br><span class="line"><span class="comment">*        material    = ls_mast-matnr     "主件物料(母件）</span></span><br><span class="line"><span class="comment">*        plant       = ls_mast-werks     "工厂</span></span><br><span class="line"><span class="comment">*        bom_usage   = ls_mast-stlan     "BOM用途</span></span><br><span class="line"><span class="comment">*        alternative = ls_mast-stlal     "可选的 BOM</span></span><br><span class="line"><span class="comment">*        valid_from  = l_valid_from      "有效日期自 (BTCI)</span></span><br><span class="line"><span class="comment">**       CHANGE_NO   =</span></span><br><span class="line"><span class="comment">**       REVISION_LEVEL         =</span></span><br><span class="line"><span class="comment">**       FL_NO_CHANGE_DOC       = ' '</span></span><br><span class="line"><span class="comment">*      IMPORTING</span></span><br><span class="line"><span class="comment">*        o_stko      = ls_stko</span></span><br><span class="line"><span class="comment">**       FL_WARNING  =</span></span><br><span class="line"><span class="comment">*      TABLES</span></span><br><span class="line"><span class="comment">*        t_stpo      = lt_stpo</span></span><br><span class="line"><span class="comment">*        t_dep_data  = lt_dep_data</span></span><br><span class="line"><span class="comment">**       T_DEP_DESCR =</span></span><br><span class="line"><span class="comment">**       T_DEP_ORDER =</span></span><br><span class="line"><span class="comment">**       T_DEP_SOURCE           =</span></span><br><span class="line"><span class="comment">**       T_DEP_DOC   =</span></span><br><span class="line"><span class="comment">*      EXCEPTIONS</span></span><br><span class="line"><span class="comment">*        error       = 1</span></span><br><span class="line"><span class="comment">*        OTHERS      = 2.</span></span><br><span class="line">    CALL FUNCTION 'CS_BOM_EXPL_MAT_V2'</span><br><span class="line">      EXPORTING</span><br><span class="line">        capid                 = 'PP01'</span><br><span class="line">        datuv                 = sy-datum  "（BOM展开日期)</span><br><span class="line">        mehrs                 = 'X'  "（X：BOM 多层展开；空：单层展开）</span><br><span class="line">        stlal                 = ls_mast-stlal</span><br><span class="line">        stlan                 = ls_mast-stlan</span><br><span class="line">        mtnrv                 = ls_mast-matnr</span><br><span class="line">        werks                 = ls_mast-werks</span><br><span class="line">      IMPORTING</span><br><span class="line">        topmat                = ls_cstmat</span><br><span class="line">      TABLES</span><br><span class="line">        stb                   = ls_stpox</span><br><span class="line">        "matcat                = ls_matcat</span><br><span class="line">      EXCEPTIONS</span><br><span class="line">        alt_not_found         = 1</span><br><span class="line">        call_invalid          = 2</span><br><span class="line">        material_not_found    = 3</span><br><span class="line">        missing_authorization = 4</span><br><span class="line">        no_bom_found          = 5</span><br><span class="line">        no_plant_data         = 6</span><br><span class="line">        no_suitable_bom_found = 7</span><br><span class="line">        conversion_error      = 8</span><br><span class="line">        OTHERS                = 9.</span><br><span class="line">    <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line"><span class="comment">*Implement suitable error handling here</span></span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line">    CALL FUNCTION 'CSAP_MAT_BOM_CLOSE'</span><br><span class="line"><span class="comment">*      EXPORTING</span></span><br><span class="line"><span class="comment">*        FL_COMMIT_AND_WAIT       = 'X'</span></span><br><span class="line"><span class="comment">*      IMPORTING</span></span><br><span class="line"><span class="comment">*        FL_WARNING               =</span></span><br><span class="line">      EXCEPTIONS</span><br><span class="line">        <span class="keyword">error</span>  = 1</span><br><span class="line">        OTHERS = 2.</span><br><span class="line">    <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line"><span class="comment">*Implement suitable error handling here</span></span><br><span class="line">    ENDIF.</span><br><span class="line">    LOOP AT ls_stpox.</span><br><span class="line">      ls_data-werks = ls_mast-werks.</span><br><span class="line">      ls_data-matnr = ls_mast-matnr.</span><br><span class="line">      ls_data-stlan = ls_mast-stlan.</span><br><span class="line">      ls_data-stlal = ls_mast-stlal.</span><br><span class="line">      ls_data-postp = ls_stpox-postp.</span><br><span class="line">      ls_data-posnr = ls_stpox-posnr.</span><br><span class="line">      ls_data-idnrk = ls_stpox-idnrk.</span><br><span class="line">      ls_data-ojtxp = ls_stpox-ojtxp.</span><br><span class="line">      ls_data-mnglg = ls_stpox-mnglg.</span><br><span class="line">      ls_data-meins = ls_stpox-meins.</span><br><span class="line">      ls_data-ojtxb = ls_stpox-ojtxb.</span><br><span class="line">      ls_data-sortf = ls_stpox-sortf.</span><br><span class="line">      ls_data-alpgr = ls_stpox-alpgr.</span><br><span class="line">      ls_data-alprf = ls_stpox-alprf.</span><br><span class="line">      ls_data-alpst = ls_stpox-alpst.</span><br><span class="line">      ls_data-ewahr = ls_stpox-ewahr.</span><br><span class="line">      ls_data-sanka = ls_stpox-sanka.</span><br><span class="line">      ls_data-mschg = ls_stpox-mschg.</span><br><span class="line">      ls_data-lgpro = ls_stpox-lgpro.</span><br><span class="line">      <span class="keyword">READ</span> <span class="keyword">TABLE</span> ls_cstmat</span><br><span class="line">         WITH KEY werks = ls_mast-werks</span><br><span class="line">         matnr = ls_mast-werks</span><br><span class="line">         stlan = ls_mast-stlan</span><br><span class="line">         stlal = ls_mast-stlal.</span><br><span class="line">      ls_data-bmeng = ls_cstmat-bmeng.</span><br><span class="line">      ls_data-stlst = ls_cstmat-stlst.</span><br><span class="line">      ls_data-kausf = ls_cstmat-kausf.</span><br><span class="line">      SELECT SINGLE maktx</span><br><span class="line">        FROM makt</span><br><span class="line">        INTO ls_data-maktx</span><br><span class="line">       WHERE matnr = ls_data-matnr.</span><br><span class="line">      CALL FUNCTION 'CONVERSION_EXIT_MATN1_OUTPUT'</span><br><span class="line">        EXPORTING</span><br><span class="line">          <span class="keyword">input</span>  = ls_data-matnr</span><br><span class="line">        IMPORTING</span><br><span class="line">          output = ls_data-matnr.</span><br><span class="line">      CALL FUNCTION 'CONVERSION_EXIT_MATN1_OUTPUT'</span><br><span class="line">        EXPORTING</span><br><span class="line">          <span class="keyword">input</span>  = ls_data-idnrk</span><br><span class="line">        IMPORTING</span><br><span class="line">          output = ls_data-idnrk.</span><br><span class="line">      <span class="keyword">APPEND</span> ls_data TO gt_data_out.</span><br><span class="line">      <span class="keyword">CLEAR</span>: ls_stpox,ls_data.</span><br><span class="line">    ENDLOOP.</span><br><span class="line"><span class="comment">*    LOOP AT lt_stpo.</span></span><br><span class="line"><span class="comment">*      ls_data-werks        = ls_mast-werks.         "工厂</span></span><br><span class="line"><span class="comment">*      ls_data-matnr        = ls_mast-matnr.         "主件物料(母件）</span></span><br><span class="line"><span class="comment">*      ls_data-stlan        = ls_mast-stlan.         "BOM用途</span></span><br><span class="line"><span class="comment">*      ls_data-stlal        = ls_mast-stlal.         "可选的 BOM</span></span><br><span class="line"><span class="comment">*      ls_data-base_quan    = ls_stko-base_quan.     "基准数量</span></span><br><span class="line"><span class="comment">*      ls_data-bom_status   = ls_stko-bom_status.    "BOM状态</span></span><br><span class="line"><span class="comment">*      ls_data-item_categ   = lt_stpo-item_categ.    "项目类别（物料单）</span></span><br><span class="line"><span class="comment">*      ls_data-item_no      = lt_stpo-item_no   .    "BOM 项目号</span></span><br><span class="line"><span class="comment">*      ls_data-component    = lt_stpo-component .    "子物料号</span></span><br><span class="line"><span class="comment">*      ls_data-comp_qty     = lt_stpo-comp_qty  .    "数量</span></span><br><span class="line"><span class="comment">*      ls_data-comp_unit    = lt_stpo-comp_unit .    "组件计量单位</span></span><br><span class="line"><span class="comment">*      ls_data-item_text1   = lt_stpo-item_text1.    "BOM行项目文本描述1</span></span><br><span class="line"><span class="comment">*      ls_data-sortstring   = lt_stpo-sortstring.    "排序字符串</span></span><br><span class="line"><span class="comment">*      ls_data-comp_scrap   = lt_stpo-comp_scrap.    "损耗率</span></span><br><span class="line"><span class="comment">*      ls_data-ai_group     = lt_stpo-ai_group  .    "替代项目：组</span></span><br><span class="line"><span class="comment">*      ls_data-ai_prio      = lt_stpo-ai_prio   .    "优先级</span></span><br><span class="line"><span class="comment">*      ls_data-ai_strateg   = lt_stpo-ai_strateg.    "替代项目：策略</span></span><br><span class="line"><span class="comment">*      ls_data-usage_prob   = lt_stpo-usage_prob.    "使用可能性按 % (BTCI)</span></span><br><span class="line"><span class="comment">*      ls_data-rel_cost     = lt_stpo-rel_cost  .    "成本标志: 与成本核算相关项目</span></span><br><span class="line"><span class="comment">*      ls_data-bulk_mat     = lt_stpo-bulk_mat  .    "散装物料</span></span><br><span class="line"><span class="comment">**      ls_data-lead_time    = lt_stpo-lead_time .    "提前期偏置(非必须，可空着)</span></span><br><span class="line"><span class="comment">**      ls_data-op_lead_tm   = lt_stpo-op_lead_tm.    "工序提前期偏置(非必须，可空着)</span></span><br><span class="line"><span class="comment">*      ls_data-issue_loc    = lt_stpo-issue_loc .    "生产仓库地点</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*      CLEAR l_line.</span></span><br><span class="line"><span class="comment">*      LOOP AT lt_dep_data WHERE bom_no     = lt_stpo-bom_no</span></span><br><span class="line"><span class="comment">*                           AND  item_node  = lt_stpo-item_node</span></span><br><span class="line"><span class="comment">*                           AND  item_count = lt_stpo-item_count.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*        l_line = l_line + 1.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*        CASE l_line.</span></span><br><span class="line"><span class="comment">**          WHEN 1.</span></span><br><span class="line"><span class="comment">**            ls_data-dep_intern1      = lt_dep_data-dep_intern.    "相关性1</span></span><br><span class="line"><span class="comment">**          WHEN 2.</span></span><br><span class="line"><span class="comment">**            ls_data-dep_intern2      = lt_dep_data-dep_intern.    "相关性2</span></span><br><span class="line"><span class="comment">**          WHEN 3.</span></span><br><span class="line"><span class="comment">**            ls_data-dep_intern3      = lt_dep_data-dep_intern.    "相关性3</span></span><br><span class="line"><span class="comment">**          WHEN 4.</span></span><br><span class="line"><span class="comment">**            ls_data-dep_intern4      = lt_dep_data-dep_intern.    "相关性4</span></span><br><span class="line"><span class="comment">*          WHEN OTHERS.</span></span><br><span class="line"><span class="comment">*        ENDCASE.</span></span><br><span class="line"><span class="comment">*      ENDLOOP.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*      CALL FUNCTION 'CONVERSION_EXIT_MATN1_OUTPUT'</span></span><br><span class="line"><span class="comment">*        EXPORTING</span></span><br><span class="line"><span class="comment">*          input  = ls_data-matnr</span></span><br><span class="line"><span class="comment">*        IMPORTING</span></span><br><span class="line"><span class="comment">*          output = ls_data-matnr.</span></span><br><span class="line"><span class="comment">*      CALL FUNCTION 'CONVERSION_EXIT_MATN2_INPUT'</span></span><br><span class="line"><span class="comment">*        EXPORTING</span></span><br><span class="line"><span class="comment">*          input            = lt_stpo-component</span></span><br><span class="line"><span class="comment">*        IMPORTING</span></span><br><span class="line"><span class="comment">*          output           = lt_stpo-component</span></span><br><span class="line"><span class="comment">*        EXCEPTIONS</span></span><br><span class="line"><span class="comment">*          number_not_found = 0</span></span><br><span class="line"><span class="comment">*          length_error     = 0</span></span><br><span class="line"><span class="comment">*          OTHERS           = 0.</span></span><br><span class="line"><span class="comment">**     主物料描述</span></span><br><span class="line"><span class="comment">*      CLEAR l_maktx.</span></span><br><span class="line"><span class="comment">*      SELECT SINGLE maktx</span></span><br><span class="line"><span class="comment">*        FROM makt</span></span><br><span class="line"><span class="comment">*        INTO l_maktx</span></span><br><span class="line"><span class="comment">*       WHERE matnr = ls_mast-matnr</span></span><br><span class="line"><span class="comment">*        AND  spras = sy-langu.</span></span><br><span class="line"><span class="comment">*      ls_data-maktx1 = l_maktx.</span></span><br><span class="line"><span class="comment">**     子物料描述</span></span><br><span class="line"><span class="comment">*      CLEAR l_maktx.</span></span><br><span class="line"><span class="comment">*      SELECT SINGLE maktx</span></span><br><span class="line"><span class="comment">*        FROM makt</span></span><br><span class="line"><span class="comment">*        INTO l_maktx</span></span><br><span class="line"><span class="comment">*       WHERE matnr = lt_stpo-component</span></span><br><span class="line"><span class="comment">*        AND  spras = sy-langu.</span></span><br><span class="line"><span class="comment">*      ls_data-maktx2 = l_maktx.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*      APPEND ls_data TO gt_data_out.</span></span><br><span class="line"><span class="comment">*      CLEAR ls_data.</span></span><br><span class="line"><span class="comment">*    ENDLOOP.</span></span><br><span class="line"></span><br><span class="line">  ENDLOOP.</span><br><span class="line"></span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  FRM_EXCEL_OUTPUT</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       展示EXCEL</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*  --&gt;  p1        text</span></span><br><span class="line"><span class="comment">*  &lt;--  p2        text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">FORM</span> frm_excel_output .</span><br><span class="line"></span><br><span class="line"><span class="comment">*  DATA:</span></span><br><span class="line"><span class="comment">*    l_filename    TYPE          string,</span></span><br><span class="line"><span class="comment">*    lt_fieldnames TYPE TABLE OF typ_fieldnames,</span></span><br><span class="line"><span class="comment">*    ls_fieldnames TYPE          typ_fieldnames.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  l_filename = p_dfile.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  CLEAR ls_fieldnames.</span></span><br><span class="line"><span class="comment">*  ls_fieldnames-name = '删除标记'.</span></span><br><span class="line"><span class="comment">*  APPEND ls_fieldnames-name TO lt_fieldnames.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  CLEAR ls_fieldnames.</span></span><br><span class="line"><span class="comment">*  ls_fieldnames-name = '工厂'.</span></span><br><span class="line"><span class="comment">*  APPEND ls_fieldnames-name TO lt_fieldnames.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  CLEAR ls_fieldnames.</span></span><br><span class="line"><span class="comment">*  ls_fieldnames-name = '主件物料'.</span></span><br><span class="line"><span class="comment">*  APPEND ls_fieldnames-name TO lt_fieldnames.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  CLEAR ls_fieldnames.</span></span><br><span class="line"><span class="comment">*  ls_fieldnames-name = '主物料描述'.</span></span><br><span class="line"><span class="comment">*  APPEND ls_fieldnames-name TO lt_fieldnames.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  CLEAR ls_fieldnames.</span></span><br><span class="line"><span class="comment">*  ls_fieldnames-name = 'BOM用途'.</span></span><br><span class="line"><span class="comment">*  APPEND ls_fieldnames-name TO lt_fieldnames.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  CLEAR ls_fieldnames.</span></span><br><span class="line"><span class="comment">*  ls_fieldnames-name = '可选的 BOM'.</span></span><br><span class="line"><span class="comment">*  APPEND ls_fieldnames-name TO lt_fieldnames.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  CLEAR ls_fieldnames.</span></span><br><span class="line"><span class="comment">*  ls_fieldnames-name = '基准数量'.</span></span><br><span class="line"><span class="comment">*  APPEND ls_fieldnames-name TO lt_fieldnames.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  CLEAR ls_fieldnames.</span></span><br><span class="line"><span class="comment">*  ls_fieldnames-name = 'BOM状态'.</span></span><br><span class="line"><span class="comment">*  APPEND ls_fieldnames-name TO lt_fieldnames.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  CLEAR ls_fieldnames.</span></span><br><span class="line"><span class="comment">*  ls_fieldnames-name = '项目类别'.</span></span><br><span class="line"><span class="comment">*  APPEND ls_fieldnames-name TO lt_fieldnames.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  CLEAR ls_fieldnames.</span></span><br><span class="line"><span class="comment">*  ls_fieldnames-name = 'BOM 项目号'.</span></span><br><span class="line"><span class="comment">*  APPEND ls_fieldnames-name TO lt_fieldnames.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  CLEAR ls_fieldnames.</span></span><br><span class="line"><span class="comment">*  ls_fieldnames-name = '子物料号'.</span></span><br><span class="line"><span class="comment">*  APPEND ls_fieldnames-name TO lt_fieldnames.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  CLEAR ls_fieldnames.</span></span><br><span class="line"><span class="comment">*  ls_fieldnames-name = '子物料描述'.</span></span><br><span class="line"><span class="comment">*  APPEND ls_fieldnames-name TO lt_fieldnames.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  CLEAR ls_fieldnames.</span></span><br><span class="line"><span class="comment">*  ls_fieldnames-name = '数量'.</span></span><br><span class="line"><span class="comment">*  APPEND ls_fieldnames-name TO lt_fieldnames.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  CLEAR ls_fieldnames.</span></span><br><span class="line"><span class="comment">*  ls_fieldnames-name = '计量单位'.</span></span><br><span class="line"><span class="comment">*  APPEND ls_fieldnames-name TO lt_fieldnames.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  CLEAR ls_fieldnames.</span></span><br><span class="line"><span class="comment">*  ls_fieldnames-name = '行项目文本'.</span></span><br><span class="line"><span class="comment">*  APPEND ls_fieldnames-name TO lt_fieldnames.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  CLEAR ls_fieldnames.</span></span><br><span class="line"><span class="comment">*  ls_fieldnames-name = '排序字符串'.</span></span><br><span class="line"><span class="comment">*  APPEND ls_fieldnames-name TO lt_fieldnames.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  CLEAR ls_fieldnames.</span></span><br><span class="line"><span class="comment">*  ls_fieldnames-name = '损耗率'.</span></span><br><span class="line"><span class="comment">*  APPEND ls_fieldnames-name TO lt_fieldnames.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">**  CLEAR ls_fieldnames.</span></span><br><span class="line"><span class="comment">**  ls_fieldnames-name = '相关性1'.</span></span><br><span class="line"><span class="comment">**  APPEND ls_fieldnames-name TO lt_fieldnames.</span></span><br><span class="line"><span class="comment">**</span></span><br><span class="line"><span class="comment">**  CLEAR ls_fieldnames.</span></span><br><span class="line"><span class="comment">**  ls_fieldnames-name = '相关性2'.</span></span><br><span class="line"><span class="comment">**  APPEND ls_fieldnames-name TO lt_fieldnames.</span></span><br><span class="line"><span class="comment">**</span></span><br><span class="line"><span class="comment">**  CLEAR ls_fieldnames.</span></span><br><span class="line"><span class="comment">**  ls_fieldnames-name = '相关性3'.</span></span><br><span class="line"><span class="comment">**  APPEND ls_fieldnames-name TO lt_fieldnames.</span></span><br><span class="line"><span class="comment">**</span></span><br><span class="line"><span class="comment">**  CLEAR ls_fieldnames.</span></span><br><span class="line"><span class="comment">**  ls_fieldnames-name = '相关性4'.</span></span><br><span class="line"><span class="comment">**  APPEND ls_fieldnames-name TO lt_fieldnames.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  CLEAR ls_fieldnames.</span></span><br><span class="line"><span class="comment">*  ls_fieldnames-name = '替代：组'.</span></span><br><span class="line"><span class="comment">*  APPEND ls_fieldnames-name TO lt_fieldnames.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  CLEAR ls_fieldnames.</span></span><br><span class="line"><span class="comment">*  ls_fieldnames-name = '优先级'.</span></span><br><span class="line"><span class="comment">*  APPEND ls_fieldnames-name TO lt_fieldnames.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  CLEAR ls_fieldnames.</span></span><br><span class="line"><span class="comment">*  ls_fieldnames-name = '替代:策略'.</span></span><br><span class="line"><span class="comment">*  APPEND ls_fieldnames-name TO lt_fieldnames.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  CLEAR ls_fieldnames.</span></span><br><span class="line"><span class="comment">*  ls_fieldnames-name = '使用可能性'.</span></span><br><span class="line"><span class="comment">*  APPEND ls_fieldnames-name TO lt_fieldnames.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  CLEAR ls_fieldnames.</span></span><br><span class="line"><span class="comment">*  ls_fieldnames-name = '成本标志'.</span></span><br><span class="line"><span class="comment">*  APPEND ls_fieldnames-name TO lt_fieldnames.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  CLEAR ls_fieldnames.</span></span><br><span class="line"><span class="comment">*  ls_fieldnames-name = '散装物料'.</span></span><br><span class="line"><span class="comment">*  APPEND ls_fieldnames-name TO lt_fieldnames.</span></span><br><span class="line"><span class="comment">**</span></span><br><span class="line"><span class="comment">**  CLEAR ls_fieldnames.</span></span><br><span class="line"><span class="comment">**  ls_fieldnames-name = '提前期偏置'.</span></span><br><span class="line"><span class="comment">**  APPEND ls_fieldnames-name TO lt_fieldnames.</span></span><br><span class="line"><span class="comment">**</span></span><br><span class="line"><span class="comment">**  CLEAR ls_fieldnames.</span></span><br><span class="line"><span class="comment">**  ls_fieldnames-name = '工序偏置'.</span></span><br><span class="line"><span class="comment">**  APPEND ls_fieldnames-name TO lt_fieldnames.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  CLEAR ls_fieldnames.</span></span><br><span class="line"><span class="comment">*  ls_fieldnames-name = '仓库地点'.</span></span><br><span class="line"><span class="comment">*  APPEND ls_fieldnames-name TO lt_fieldnames.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  CALL FUNCTION 'GUI_DOWNLOAD'</span></span><br><span class="line"><span class="comment">*    EXPORTING</span></span><br><span class="line"><span class="comment">*      filename                = l_filename</span></span><br><span class="line"><span class="comment">*      "filetype                = 'DBF'</span></span><br><span class="line"><span class="comment">*      filetype                = 'DAT'</span></span><br><span class="line"><span class="comment">*      "ASC</span></span><br><span class="line"><span class="comment">*      write_field_separator   = 'X'</span></span><br><span class="line"><span class="comment">*      codepage                = '8400'</span></span><br><span class="line"><span class="comment">*      "codepage                = '4110'</span></span><br><span class="line"><span class="comment">*    TABLES</span></span><br><span class="line"><span class="comment">*      data_tab                = gt_data_out</span></span><br><span class="line"><span class="comment">*      fieldnames              = lt_fieldnames</span></span><br><span class="line"><span class="comment">*    EXCEPTIONS</span></span><br><span class="line"><span class="comment">*      file_write_error        = 1</span></span><br><span class="line"><span class="comment">*      no_batch                = 2</span></span><br><span class="line"><span class="comment">*      gui_refuse_filetransfer = 3</span></span><br><span class="line"><span class="comment">*      invalid_type            = 4</span></span><br><span class="line"><span class="comment">*      no_authority            = 5</span></span><br><span class="line"><span class="comment">*      unknown_error           = 6</span></span><br><span class="line"><span class="comment">*      header_not_allowed      = 7</span></span><br><span class="line"><span class="comment">*      separator_not_allowed   = 8</span></span><br><span class="line"><span class="comment">*      filesize_not_allowed    = 9</span></span><br><span class="line"><span class="comment">*      header_too_long         = 10</span></span><br><span class="line"><span class="comment">*      dp_error_create         = 11</span></span><br><span class="line"><span class="comment">*      dp_error_send           = 12</span></span><br><span class="line"><span class="comment">*      dp_error_write          = 13</span></span><br><span class="line"><span class="comment">*      unknown_dp_error        = 14</span></span><br><span class="line"><span class="comment">*      access_denied           = 15</span></span><br><span class="line"><span class="comment">*      dp_out_of_memory        = 16</span></span><br><span class="line"><span class="comment">*      disk_full               = 17</span></span><br><span class="line"><span class="comment">*      dp_timeout              = 18</span></span><br><span class="line"><span class="comment">*      file_not_found          = 19</span></span><br><span class="line"><span class="comment">*      dataprovider_exception  = 20</span></span><br><span class="line"><span class="comment">*      control_flush_error     = 21</span></span><br><span class="line"><span class="comment">*      OTHERS                  = 22.</span></span><br><span class="line"><span class="comment">*  IF sy-subrc &lt;&gt; 0.</span></span><br><span class="line"><span class="comment">*    MESSAGE ID sy-msgid TYPE 'S' NUMBER sy-msgno</span></span><br><span class="line"><span class="comment">*    WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4 DISPLAY LIKE 'E'.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*    LEAVE LIST-PROCESSING.</span></span><br><span class="line"><span class="comment">*  ELSE.</span></span><br><span class="line"><span class="comment">*    MESSAGE '数据导出成功' TYPE 'S'.</span></span><br><span class="line"><span class="comment">*  ENDIF.</span></span><br><span class="line">  DATA: ls_layout <span class="keyword">TYPE</span> lvc_s_layo.</span><br><span class="line">  DATA: gs_field_cat <span class="keyword">TYPE</span> lvc_s_fcat.</span><br><span class="line">  DATA: gt_field_cat <span class="keyword">TYPE</span> lvc_t_fcat.</span><br><span class="line">  <span class="keyword">CLEAR</span>:ls_layout,gt_field_cat[].</span><br><span class="line">  ls_layout-cwidth_opt = 'A'.</span><br><span class="line">  ls_layout-zebra = 'X'.</span><br><span class="line">  DATA <span class="keyword">line</span> <span class="keyword">TYPE</span> i VALUE 0.</span><br><span class="line">  DEFINE dingyi.</span><br><span class="line">    <span class="keyword">LINE</span> = <span class="keyword">LINE</span> + 1.</span><br><span class="line">    gs_field_cat-col_pos = <span class="keyword">LINE</span>.</span><br><span class="line">    gs_field_cat-fieldname = &amp;1.</span><br><span class="line">    gs_field_cat-scrtext_m = &amp;2.</span><br><span class="line"><span class="comment">*    gs_field_cat-edit = 'x'.</span></span><br><span class="line">    <span class="keyword">APPEND</span> gs_field_cat TO gt_field_cat.</span><br><span class="line">    <span class="keyword">CLEAR</span> gs_field_cat.</span><br><span class="line">  END-OF-DEFINITION.</span><br><span class="line">  "dingyi  'FLG_DEL' '删除标记'.</span><br><span class="line">  dingyi  'WERKS' '工厂'.</span><br><span class="line">  dingyi  'MATNR' '主件物料(母件）'.</span><br><span class="line">  dingyi  'MAKTX'  '主物料描述'.</span><br><span class="line">  dingyi  'STLAN' 'BOM用途'.</span><br><span class="line">  dingyi  'STLAL' '可选的 BOM'.</span><br><span class="line">  dingyi  'BMENG' '基准数量'.</span><br><span class="line">  dingyi  'STLST'  'BOM状态'.</span><br><span class="line">  dingyi  'POSTP'  '项目类别'.</span><br><span class="line">  dingyi  'POSNR' 'BOM 项目号'.</span><br><span class="line">  dingyi  'IDNRK' '子物料号'.</span><br><span class="line">  dingyi  'ojtxp'  '子物料描述'.</span><br><span class="line">  dingyi  'MNGLG'  '数量'.</span><br><span class="line">  dingyi  'MEINS' '组件计量单位'.</span><br><span class="line">  dingyi  'OJTXB'  'BOM行项目文本描述1'.</span><br><span class="line">  dingyi  'SORTF'  '排序字符串'.</span><br><span class="line">  dingyi  'KAUSF'  '损耗率'.</span><br><span class="line">  dingyi  'ALPGR'  '替代项目：组'.</span><br><span class="line">  dingyi  'ALPRF' '优先级'.</span><br><span class="line">  dingyi  'ALPST'  '替代项目：策略'.</span><br><span class="line">  dingyi  'EWAHR'  '使用可能性按 % (BTCI)'.</span><br><span class="line">  dingyi  'SANKA'  '成本标志: 与成本核算相关项目'.</span><br><span class="line">  dingyi  'MSCHG'  '散装物料'.</span><br><span class="line">  dingyi  'LGPRO' '生产仓库地点'.</span><br><span class="line">  CALL FUNCTION 'REUSE_ALV_GRID_DISPLAY_LVC'</span><br><span class="line">    EXPORTING</span><br><span class="line"><span class="comment">*     I_INTERFACE_CHECK  = ' '</span></span><br><span class="line"><span class="comment">*     I_BYPASSING_BUFFER =</span></span><br><span class="line"><span class="comment">*     I_BUFFER_ACTIVE    =</span></span><br><span class="line">      i_callback_program = sy-repid</span><br><span class="line"><span class="comment">*     i_callback_pf_status_set = 'STATUS'</span></span><br><span class="line"><span class="comment">*     i_callback_user_command  = 'USER_COMMAND_01'</span></span><br><span class="line">      is_layout_lvc      = ls_layout</span><br><span class="line">      it_fieldcat_lvc    = gt_field_cat[]</span><br><span class="line">    TABLES</span><br><span class="line">      t_outtab           = gt_data_out</span><br><span class="line"><span class="comment">*   EXCEPTIONS</span></span><br><span class="line"><span class="comment">*     PROGRAM_ERROR      = 1</span></span><br><span class="line"><span class="comment">*     OTHERS             = 2</span></span><br><span class="line">    .</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ENDFORM.</span></span><br></pre></td></tr></table></figure>
<h3 id="物料主数据导入程序">物料主数据导入程序</h3><h4 id="主程序">主程序</h4><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp; Report  ZSTMM001</span></span><br><span class="line"><span class="comment">*&amp;</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;</span></span><br><span class="line"><span class="comment">*&amp;</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">REPORT</span> zhlt_mmu_mara02.</span><br><span class="line"><span class="keyword">INCLUDE</span> zhlt_decdownmodel.  "下载模板</span><br><span class="line"><span class="keyword">INCLUDE</span> zhlt_mmc_mara02_01.</span><br><span class="line"><span class="keyword">INCLUDE</span> zhlt_mmc_mara02_02.</span><br><span class="line"></span><br><span class="line">AT SELECTION-SCREEN.</span><br><span class="line"></span><br><span class="line">CASE sy-ucomm.</span><br><span class="line">WHEN 'FC01'.</span><br><span class="line">  PERFORM zdownload_model USING 'ZHLT_TRANS_MARA01'.</span><br><span class="line">ENDCASE.</span><br><span class="line"></span><br><span class="line">START-OF-SELECTION.</span><br><span class="line"></span><br><span class="line">DATA:v1 <span class="keyword">TYPE</span> C LENGTH 2.</span><br><span class="line"><span class="keyword">IF</span> p1 = 'X'.</span><br><span class="line">  v1 = 'P1'.</span><br><span class="line">ELSEIF p2 = 'X'.</span><br><span class="line">  v1 = 'P2'.</span><br><span class="line">ELSEIF p3 = 'X'.</span><br><span class="line">  v1 = 'P3'.</span><br><span class="line">ELSEIF p4 = 'X'.</span><br><span class="line">  v1 = 'P4'.</span><br><span class="line">ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*AUTHORITY-CHECK OBJECT 'ZMM_MM01' ID 'ZMM_MM01' FIELD v1.</span></span><br><span class="line"><span class="comment">*IF sy-subrc &lt;&gt; 0.</span></span><br><span class="line"><span class="comment">*  MESSAGE '您无权使用该导入方式...' TYPE 'S' DISPLAY LIKE 'E'.</span></span><br><span class="line"><span class="comment">*  EXIT.</span></span><br><span class="line"><span class="comment">*ENDIF.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">IF</span> p_file IS NOT INITIAL.</span><br><span class="line">  PERFORM get_data.</span><br><span class="line">  PERFORM set_alv.</span><br><span class="line">  PERFORM show_alv.</span><br><span class="line"><span class="keyword">ELSE</span>.</span><br><span class="line">  MESSAGE '请选择文件' <span class="keyword">TYPE</span> 'S' <span class="keyword">DISPLAY</span> LIKE '<span class="keyword">E</span>'.</span><br><span class="line">ENDIF.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">END-OF-SELECTION.</span><br><span class="line"></span><br><span class="line"><span class="comment">*Text elements</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------</span></span><br><span class="line"><span class="comment">* 001 下载模板</span></span><br><span class="line"><span class="comment">* 002</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*Selection texts</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------</span></span><br><span class="line"><span class="comment">* P1         按完整数据创建</span></span><br><span class="line"><span class="comment">* P2         按基础数据创建</span></span><br><span class="line"><span class="comment">* P3         按后勤模块创建</span></span><br><span class="line"><span class="comment">* P4         按财务模块创建</span></span><br><span class="line"><span class="comment">* P_FILE         选择文件</span></span><br></pre></td></tr></table></figure>
<h4 id="zhlt_decdownmodel">zhlt_decdownmodel</h4><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">*<span class="subst">&amp;</span>---------------------------------------------------------------------*</span><br><span class="line">*<span class="subst">&amp;</span>  包含                ZHLT_DECDOWNMODEL</span><br><span class="line">*<span class="subst">&amp;</span>---------------------------------------------------------------------*</span><br><span class="line"></span><br><span class="line">FORM zdownload_model USING strans_name <span class="keyword">TYPE</span> <span class="built_in">string</span><span class="built_in">.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  </span><span class="built_in">DATA</span>:</span><br><span class="line">    ls_object     <span class="keyword">TYPE</span> wwwdatatab,</span><br><span class="line">    l_filename    <span class="keyword">TYPE</span> <span class="built_in">string</span>,</span><br><span class="line">    l_path        <span class="keyword">TYPE</span> <span class="built_in">string</span>,</span><br><span class="line">    l_fullpath    <span class="keyword">TYPE</span> <span class="built_in">string</span>,</span><br><span class="line">    l_title       <span class="keyword">TYPE</span> <span class="built_in">string</span>,</span><br><span class="line">    l_destination <span class="keyword">TYPE</span> rlgrap<span class="attribute">-filename</span><span class="built_in">.</span><br><span class="line"></span><br><span class="line">  </span><span class="keyword">SELECT</span> SINGLE *</span><br><span class="line">  FROM wwwdata</span><br><span class="line">  <span class="keyword">INTO</span> CORRESPONDING FIELDS OF ls_object</span><br><span class="line">  <span class="keyword">WHERE</span> objid = <span class="string">'ZSTMM001'</span><span class="built_in">.    </span><span class="string">"smw0里对象名称</span><br><span class="line"></span><br><span class="line">  IF sy-subrc &lt;&gt; 0.</span><br><span class="line"></span><br><span class="line">    MESSAGE 'smw0里对象名称没有找到' TYPE 'E'.</span><br><span class="line"></span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">  l_title = ls_object-text.            "</span>WWWDATA 对象的短文本</span><br><span class="line"></span><br><span class="line">  CALL METHOD cl_gui_frontend_services=&gt;file_save_dialog</span><br><span class="line">    EXPORTING</span><br><span class="line">      window_title      = <span class="string">'模板下载'</span></span><br><span class="line">      default_extension = <span class="string">'xls'</span></span><br><span class="line">      default_file_name = l_title</span><br><span class="line">      file_filter       = <span class="string">'EXCEL(*.xls)|*.xls*'</span></span><br><span class="line">    CHANGING</span><br><span class="line">      filename          = l_filename</span><br><span class="line">      path              = l_path</span><br><span class="line">      fullpath          = l_fullpath</span><br><span class="line">    EXCEPTIONS</span><br><span class="line">      cntl_err<span class="subst">or</span>        = <span class="number">1</span></span><br><span class="line">      error_no_gui      = <span class="number">2</span></span><br><span class="line">      OTHERS            = <span class="number">3.</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> l_fullpath IS <span class="subst">NOT</span> INITIAL<span class="built_in">.</span><br><span class="line"></span><br><span class="line">    </span>l_destination = l_fullpath<span class="built_in">.</span><br><span class="line"></span><br><span class="line">    </span>CALL FUNCTION <span class="string">'DOWNLOAD_WEB_OBJECT'</span></span><br><span class="line">      EXPORTING</span><br><span class="line">        key         = ls_object</span><br><span class="line">        destination = l_destination<span class="built_in">.</span><br><span class="line"></span><br><span class="line">  </span>ENDIF<span class="built_in">.</span><br><span class="line"></span><br><span class="line"></span>ENDFORM<span class="built_in">.</span></span><br></pre></td></tr></table></figure>
<h4 id="zhlt_mmc_mara02_01">zhlt_mmc_mara02_01</h4><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;  包含                ZHLT_MMC_MARA02_01</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"></span><br><span class="line"><span class="comment">*Code listing for: ZHLT_MMC_MARA02_01</span></span><br><span class="line"><span class="comment">*Description: Include ZHLT_MMC_MARA02_01</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;  包含                ZHLT_MMC_MARA02_01</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line">TYPES:BEGIN OF wa_mara,</span><br><span class="line">        rowid   <span class="keyword">TYPE</span> numc05, "  交货计划行号</span><br><span class="line">        matnr   <span class="keyword">TYPE</span> matnr, " 物料号</span><br><span class="line">        maktx   <span class="keyword">TYPE</span> maktx, " 物料描述（短文本）</span><br><span class="line">        maktg   <span class="keyword">TYPE</span> maktg, "物料描述（英文描述）</span><br><span class="line">        mbrsh   <span class="keyword">TYPE</span> mbrsh, " 行业领域</span><br><span class="line">        mtart   <span class="keyword">TYPE</span> mtart, " 物料类型</span><br><span class="line">        meins   <span class="keyword">TYPE</span> meins, " 基本计量单位</span><br><span class="line">        matkl   <span class="keyword">TYPE</span> matkl, " 物料组</span><br><span class="line">        bismt   <span class="keyword">TYPE</span> bismt, " 旧物料号</span><br><span class="line">        extwg   <span class="keyword">TYPE</span> extwg, "旧物料组</span><br><span class="line">        spart   <span class="keyword">TYPE</span> spart, " 产品组</span><br><span class="line">        mstae   <span class="keyword">TYPE</span> mstae,"跨工厂物料状态</span><br><span class="line">        brgew   <span class="keyword">TYPE</span> brgew, " 毛重</span><br><span class="line">        ntgew   <span class="keyword">TYPE</span> ntgew, " 净重</span><br><span class="line">        gewei   <span class="keyword">TYPE</span> gewei, " 重量单位</span><br><span class="line">        groes   <span class="keyword">TYPE</span> groes, " 大小/量纲</span><br><span class="line">        labor   <span class="keyword">TYPE</span> labor, "实验室/设计室</span><br><span class="line">        ean11   <span class="keyword">TYPE</span> ean11, " 国际文件号(EAN/UPC)</span><br><span class="line">        meinh   <span class="keyword">TYPE</span> meinh, "可选计量单位</span><br><span class="line">        umren1  <span class="keyword">TYPE</span> umren,"转换为基本计量单位的分母</span><br><span class="line">        umrez1  <span class="keyword">TYPE</span> umrez,"基本计量单位转换分子</span><br><span class="line">        zzxh    <span class="keyword">TYPE</span> zzxh, "型号</span><br><span class="line">        zzys    <span class="keyword">TYPE</span> zzys, "颜色</span><br><span class="line">        zzmc    <span class="keyword">TYPE</span> zzmc, "车型名称</span><br><span class="line">        zzdcrl  <span class="keyword">TYPE</span> zzdcrl, "车型使用电池容量</span><br><span class="line">        vkorg   <span class="keyword">TYPE</span> vkorg, " 销售组织</span><br><span class="line">        vtweg   <span class="keyword">TYPE</span> vtweg, " 分销渠道</span><br><span class="line">        vrkme   <span class="keyword">TYPE</span> vrkme,"销售单位</span><br><span class="line">        umren2  <span class="keyword">TYPE</span> umren,"转换为基本计量单位的分母</span><br><span class="line">        umrez2  <span class="keyword">TYPE</span> umrez,"基本计量单位转换分子</span><br><span class="line">        dwerk   <span class="keyword">TYPE</span> dwerk, "交货工厂</span><br><span class="line">        taxkm   <span class="keyword">TYPE</span> taxkm, " 物料的税分类</span><br><span class="line">        aumng   <span class="keyword">TYPE</span> aumng,"最小订购量</span><br><span class="line">        ktgrm   <span class="keyword">TYPE</span> ktgrm, " 该物料的科目设置组</span><br><span class="line">        mtpos   <span class="keyword">TYPE</span> mtpos, " 来自物料主文件的项目类别组</span><br><span class="line">        werks   <span class="keyword">TYPE</span> werks_d, " 工厂</span><br><span class="line">        mtvfp   <span class="keyword">TYPE</span> mtvfp, " 可用性检查的检查组</span><br><span class="line">        tragr   <span class="keyword">TYPE</span> tragr, " 运输组</span><br><span class="line">        ladgr   <span class="keyword">TYPE</span> ladgr, " 装载组</span><br><span class="line">        ekorg   <span class="keyword">TYPE</span> ekorg,"采购组织</span><br><span class="line">        ekgrp   <span class="keyword">TYPE</span> ekgrp, " 采购组</span><br><span class="line">        bstme   <span class="keyword">TYPE</span> bstme,"采购单位</span><br><span class="line">        umren3  <span class="keyword">TYPE</span> umren,"转换为基本计量单位的分母</span><br><span class="line">        umrez3  <span class="keyword">TYPE</span> umrez,"基本计量单位转换分子</span><br><span class="line">        xchar   <span class="keyword">TYPE</span> xchar, "批量管理标识(内部)</span><br><span class="line">        kautb   <span class="keyword">TYPE</span> kautb, <span class="string">"标识: "</span>允许自动采购订单"</span><br><span class="line">        <span class="string">"insmk   TYPE insmk_mat, "</span>过帐到检验库存</span><br><span class="line">        dismm   <span class="keyword">TYPE</span> dismm, " 物料需求计划类型</span><br><span class="line">        dispo   <span class="keyword">TYPE</span> dispo, " MRP 控制者（物料计划人）</span><br><span class="line">        disls   <span class="keyword">TYPE</span> disls, " 批量 (物料计划)</span><br><span class="line">        bstmi   <span class="keyword">TYPE</span> bstmi, " 最小批量</span><br><span class="line">        bstrf   <span class="keyword">TYPE</span> bstrf, " 采购订单数量的舍入值</span><br><span class="line">        ausss   <span class="keyword">TYPE</span> ausss, " 装配报废百分比</span><br><span class="line">        beskz   <span class="keyword">TYPE</span> beskz, " 采购类型</span><br><span class="line">        sobsl   <span class="keyword">TYPE</span> sobsl, " 特殊采购类型</span><br><span class="line">        schgt   <span class="keyword">TYPE</span> schgt,  "散装物料</span><br><span class="line">        <span class="string">"dzeit   TYPE dzeit,  "</span>厂内生产时间</span><br><span class="line">        rgekz   <span class="keyword">TYPE</span> rgekz, "反冲</span><br><span class="line">        lgpro   <span class="keyword">TYPE</span> lgpro, " 发货库存地点</span><br><span class="line">        lgfsb   <span class="keyword">TYPE</span> lgfsb, " 外部采购的缺省仓储位置</span><br><span class="line">        plifz   <span class="keyword">TYPE</span> plifz, " 计划的天数内交货</span><br><span class="line">        fhori   <span class="keyword">TYPE</span> fhori, " 浮动的计划边际码</span><br><span class="line">        eisbe   <span class="keyword">TYPE</span> eisbe, " 安全库存</span><br><span class="line">        strgr   <span class="keyword">TYPE</span> strgr, " 计划策略组</span><br><span class="line">        vrmod   <span class="keyword">TYPE</span> vrmod, " 消耗模式</span><br><span class="line">        vint1   <span class="keyword">TYPE</span> vint1, " 消耗期间:逆向</span><br><span class="line">        vint2   <span class="keyword">TYPE</span> vint2, " 消耗时期-向前</span><br><span class="line">        miskz   <span class="keyword">TYPE</span> miskz, "综合MRP</span><br><span class="line"><span class="comment">*        prgrp   TYPE vpmat, " 计划物料</span></span><br><span class="line"><span class="comment">*        prwrk   TYPE vpwrk, " 计划工厂</span></span><br><span class="line"><span class="comment">*        umref   TYPE umref, " 转换因子</span></span><br><span class="line"><span class="comment">*        mtvfp1  TYPE mtvfp, "可用性检查</span></span><br><span class="line">        kausf   <span class="keyword">TYPE</span> kausf, " 部件废品百分数</span><br><span class="line">        sbdkz   <span class="keyword">TYPE</span> sbdkz, " 对于独立和集中需求的相关需求标识</span><br><span class="line">        fevor   <span class="keyword">TYPE</span> fevor, " 生产管理员</span><br><span class="line"><span class="comment">*        bearz   TYPE bearz, " 处理时间</span></span><br><span class="line"><span class="comment">*        basmg   TYPE basmg, "基准数量</span></span><br><span class="line">        ueetk   <span class="keyword">TYPE</span> ueetk, " 标识：允许未限制的过量交货</span><br><span class="line">        ueeto   <span class="keyword">TYPE</span> ueeto, " 超量交货容差限制</span><br><span class="line">        mhdhb   <span class="keyword">TYPE</span> mhdhb, " 总货架寿命</span><br><span class="line">        mhdrz   <span class="keyword">TYPE</span> mhdrz, " 最短剩余货架寿命</span><br><span class="line">        bwkey   <span class="keyword">TYPE</span> bwkey,"评估范围</span><br><span class="line">        bklas   <span class="keyword">TYPE</span> bklas, " 评估类</span><br><span class="line">        vprsv   <span class="keyword">TYPE</span> vprsv, " 价格控制指示符</span><br><span class="line">        <span class="string">"stprs   TYPE stprs, "</span> 价格</span><br><span class="line">        peinh   <span class="keyword">TYPE</span> peinh, " 价格单位</span><br><span class="line">        ncost   <span class="keyword">TYPE</span> ck_no_costing, "无成本核算</span><br><span class="line">        ekalr   <span class="keyword">TYPE</span> ck_ekalrel, "物料根据数量结构进行成本核算</span><br><span class="line">        hkmat   <span class="keyword">TYPE</span> hkmat, "物料来源</span><br><span class="line">        awsls   <span class="keyword">TYPE</span> awsls, "差异码</span><br><span class="line">        losgr   <span class="keyword">TYPE</span> losgr, "成本核算批量</span><br><span class="line">        <span class="string">"prctr   TYPE prctr, "</span> 利润中心</span><br><span class="line">        <span class="keyword">type</span>    <span class="keyword">TYPE</span> bapi_mtype, " 消息类型</span><br><span class="line">        message <span class="keyword">TYPE</span> bapi_msg, " 消息文本</span><br><span class="line">        ersda   <span class="keyword">TYPE</span> ersda, " 创建日期</span><br><span class="line">        zeinr   <span class="keyword">TYPE</span> dzeinr, "旧版本物料</span><br><span class="line">      END OF wa_mara.</span><br><span class="line"></span><br><span class="line">TABLES:</span><br><span class="line">  sscrfields,"选择屏幕-新增按钮</span><br><span class="line">  csap_mbom.</span><br><span class="line">DATA:it_mara <span class="keyword">TYPE</span> wa_mara OCCURS 0 WITH HEADER <span class="keyword">LINE</span> .</span><br><span class="line">DATA <span class="keyword">return</span> <span class="keyword">TYPE</span> bapiret2. "消息</span><br><span class="line">DATA:bapimatinr <span class="keyword">TYPE</span> <span class="keyword">TABLE</span> OF bapimatinr WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">DATA:bapireturn1 <span class="keyword">TYPE</span> bapireturn1.</span><br><span class="line">DATA return1 <span class="keyword">TYPE</span> bapireturn1.</span><br><span class="line">DATA:o_matnr <span class="keyword">TYPE</span> mara-matnr,</span><br><span class="line">     n_matnr <span class="keyword">TYPE</span> mara-matnr.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DATA: headdata             <span class="keyword">TYPE</span> bapimathead,     "表头数据</span><br><span class="line">      clientdata           <span class="keyword">TYPE</span> bapi_mara,       "基本数据</span><br><span class="line">      clientdatax          <span class="keyword">TYPE</span> bapi_marax,</span><br><span class="line">      plantdata            <span class="keyword">TYPE</span> bapi_marc,       "工厂数据</span><br><span class="line">      plantdatax           <span class="keyword">TYPE</span> bapi_marcx,</span><br><span class="line">      planningdata         <span class="keyword">TYPE</span> bapi_mpgd,       "计划数据</span><br><span class="line">      planningdatax        <span class="keyword">TYPE</span> bapi_mpgdx,</span><br><span class="line">      storagelocationdata  <span class="keyword">TYPE</span> bapi_mard,       "库存数据</span><br><span class="line">      storagelocationdatax <span class="keyword">TYPE</span> bapi_mardx,</span><br><span class="line">      valuetiondata        <span class="keyword">TYPE</span> bapi_mbew,       "评估数据</span><br><span class="line">      valuetiondatax       <span class="keyword">TYPE</span> bapi_mbewx,</span><br><span class="line">      salesdata            <span class="keyword">TYPE</span> bapi_mvke,       "销售数据</span><br><span class="line">      salesdatax           <span class="keyword">TYPE</span> bapi_mvkex.</span><br><span class="line"><span class="comment">*物料描述</span></span><br><span class="line">DATA: materialdescription <span class="keyword">TYPE</span> <span class="keyword">TABLE</span> OF bapi_makt WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line"><span class="comment">*计量单位</span></span><br><span class="line">DATA: unitsofmeasure <span class="keyword">TYPE</span> <span class="keyword">TABLE</span> OF bapi_marm WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">DATA: unitsofmeasurex <span class="keyword">TYPE</span> <span class="keyword">TABLE</span> OF bapi_marmx WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line"><span class="comment">*税分类</span></span><br><span class="line">DATA: taxclassifications <span class="keyword">TYPE</span> <span class="keyword">TABLE</span> OF bapi_mlan WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">DATA pr_unit <span class="keyword">TYPE</span> meins."基本单位</span><br><span class="line">DATA pr_unit2 <span class="keyword">TYPE</span> meins."重量单位</span><br><span class="line"></span><br><span class="line"><span class="comment">*扩展字段</span></span><br><span class="line">DATA:  BEGIN OF w_extensionin OCCURS 0.</span><br><span class="line">        <span class="keyword">INCLUDE</span> STRUCTURE bapiparex.</span><br><span class="line">DATA:  END OF w_extensionin.</span><br><span class="line">DATA:  BEGIN OF w_extensioninx OCCURS 0.</span><br><span class="line">        <span class="keyword">INCLUDE</span> STRUCTURE bapiparexx.</span><br><span class="line">DATA:  END OF w_extensioninx.</span><br><span class="line">DATA zzbapi_te_mara LIKE bapi_te_mara.</span><br><span class="line">DATA zzbapi_te_marax LIKE bapi_te_marax.</span><br><span class="line"></span><br><span class="line">DATA:gt_lines LIKE <span class="keyword">TABLE</span> OF zalsmex_tabline1."具有 Excel 数据的表行</span><br><span class="line"></span><br><span class="line">"alv显示定义</span><br><span class="line">DATA: ls_layout <span class="keyword">TYPE</span> lvc_s_layo.</span><br><span class="line">DATA: gs_field_cat <span class="keyword">TYPE</span> lvc_s_fcat.</span><br><span class="line">DATA: gt_field_cat <span class="keyword">TYPE</span> lvc_t_fcat.</span><br><span class="line">DATA: g_alv_grid <span class="keyword">TYPE</span> REF TO cl_gui_alv_grid, "ALV控件</span><br><span class="line">      alv_ctner  <span class="keyword">TYPE</span> REF TO cl_gui_custom_container.</span><br><span class="line"></span><br><span class="line">DATA ran_int LIKE qf00-ran_int.</span><br><span class="line">DATA ran_cahr <span class="keyword">TYPE</span> char10.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">INITIALIZATION.</span><br><span class="line"><span class="comment">*设定按钮图标样式</span></span><br><span class="line">  "CONCATENATE '@48@ ' TEXT-001 INTO ctr_button.</span><br><span class="line"></span><br><span class="line"><span class="comment">*设定下载按钮对应的按钮'FC01'</span></span><br><span class="line">  SELECTION-SCREEN FUNCTION KEY 1.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  sscrfields-functxt_01 = '下载数据导入模板'."ctr_button.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*  SELECTION-SCREEN BEGIN OF BLOCK b1 WITH FRAME TITLE text-002.</span></span><br><span class="line"><span class="comment">*  PARAMETERS: p1 TYPE c RADIOBUTTON GROUP g1 USER-COMMAND ok_code DEFAULT 'X',</span></span><br><span class="line"><span class="comment">*  p2 TYPE c RADIOBUTTON GROUP g1  , "单选按钮</span></span><br><span class="line"><span class="comment">*  p3 TYPE c RADIOBUTTON GROUP g1  , "单选按钮</span></span><br><span class="line"><span class="comment">*  p4 TYPE c RADIOBUTTON GROUP g1  . "单选按钮</span></span><br><span class="line"><span class="comment">*  SELECTION-SCREEN END OF BLOCK b1.</span></span><br><span class="line"></span><br><span class="line">  DATA: p1 <span class="keyword">TYPE</span> c VALUE 'X',</span><br><span class="line">        p2 <span class="keyword">TYPE</span> c,</span><br><span class="line">        p3 <span class="keyword">TYPE</span> c,</span><br><span class="line">        p4 <span class="keyword">TYPE</span> c.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*构建导入屏幕元素</span></span><br><span class="line">  SELECTION-SCREEN BEGIN OF BLOCK b01 WITH FRAME TITLE text-t02.</span><br><span class="line"></span><br><span class="line">  PARAMETERS: p_file <span class="keyword">TYPE</span> rlgrap-filename..</span><br><span class="line"></span><br><span class="line">  SELECTION-SCREEN END OF BLOCK b01.</span><br><span class="line"></span><br><span class="line">AT SELECTION-SCREEN <span class="keyword">ON</span> VALUE-REQUEST <span class="keyword">FOR</span> p_file.</span><br><span class="line"></span><br><span class="line">  DATA:</span><br><span class="line">    lv_subrc      <span class="keyword">TYPE</span> i,</span><br><span class="line">    ls_filename   <span class="keyword">TYPE</span> file_table,</span><br><span class="line">    lt_filetables <span class="keyword">TYPE</span> filetable. "路径列表</span><br><span class="line"></span><br><span class="line">  CALL METHOD cl_gui_frontend_services=&gt;file_open_dialog</span><br><span class="line">    EXPORTING</span><br><span class="line"><span class="comment">*     WINDOW_TITLE            =</span></span><br><span class="line"><span class="comment">*     DEFAULT_EXTENSION       =</span></span><br><span class="line"><span class="comment">*     DEFAULT_FILENAME        =</span></span><br><span class="line"><span class="comment">*     FILE_FILTER             =</span></span><br><span class="line">      initial_directory       = 'C:\'</span><br><span class="line"><span class="comment">*     multiselection          = ''</span></span><br><span class="line">    CHANGING</span><br><span class="line">      file_table              = lt_filetables[]</span><br><span class="line">      rc                      = lv_subrc</span><br><span class="line"><span class="comment">*     USER_ACTION             =</span></span><br><span class="line">    EXCEPTIONS</span><br><span class="line">      file_open_dialog_failed = 1</span><br><span class="line">      cntl_error              = 2</span><br><span class="line">      error_no_gui            = 3</span><br><span class="line">      OTHERS                  = 4.</span><br><span class="line">  <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line"><span class="comment">* MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO</span></span><br><span class="line"><span class="comment">*            WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.</span></span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line">    LOOP AT lt_filetables INTO ls_filename.</span><br><span class="line">      p_file = ls_filename-filename.</span><br><span class="line">    ENDLOOP.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*Extracted by Direct Download Enterprise version 1.3 - E.G.Mellodew. 1998-2004 UK. Sap Release 740</span></span><br></pre></td></tr></table></figure>
<h4 id="zhlt_mmc_mara02_02">zhlt_mmc_mara02_02</h4><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br><span class="line">1073</span><br><span class="line">1074</span><br><span class="line">1075</span><br><span class="line">1076</span><br><span class="line">1077</span><br><span class="line">1078</span><br><span class="line">1079</span><br><span class="line">1080</span><br><span class="line">1081</span><br><span class="line">1082</span><br><span class="line">1083</span><br><span class="line">1084</span><br><span class="line">1085</span><br><span class="line">1086</span><br><span class="line">1087</span><br><span class="line">1088</span><br><span class="line">1089</span><br><span class="line">1090</span><br><span class="line">1091</span><br><span class="line">1092</span><br><span class="line">1093</span><br><span class="line">1094</span><br><span class="line">1095</span><br><span class="line">1096</span><br><span class="line">1097</span><br><span class="line">1098</span><br><span class="line">1099</span><br><span class="line">1100</span><br><span class="line">1101</span><br><span class="line">1102</span><br><span class="line">1103</span><br><span class="line">1104</span><br><span class="line">1105</span><br><span class="line">1106</span><br><span class="line">1107</span><br><span class="line">1108</span><br><span class="line">1109</span><br><span class="line">1110</span><br><span class="line">1111</span><br><span class="line">1112</span><br><span class="line">1113</span><br><span class="line">1114</span><br><span class="line">1115</span><br><span class="line">1116</span><br><span class="line">1117</span><br><span class="line">1118</span><br><span class="line">1119</span><br><span class="line">1120</span><br><span class="line">1121</span><br><span class="line">1122</span><br><span class="line">1123</span><br><span class="line">1124</span><br><span class="line">1125</span><br><span class="line">1126</span><br><span class="line">1127</span><br><span class="line">1128</span><br><span class="line">1129</span><br><span class="line">1130</span><br><span class="line">1131</span><br><span class="line">1132</span><br><span class="line">1133</span><br><span class="line">1134</span><br><span class="line">1135</span><br><span class="line">1136</span><br><span class="line">1137</span><br><span class="line">1138</span><br><span class="line">1139</span><br><span class="line">1140</span><br><span class="line">1141</span><br><span class="line">1142</span><br><span class="line">1143</span><br><span class="line">1144</span><br><span class="line">1145</span><br><span class="line">1146</span><br><span class="line">1147</span><br><span class="line">1148</span><br><span class="line">1149</span><br><span class="line">1150</span><br><span class="line">1151</span><br><span class="line">1152</span><br><span class="line">1153</span><br><span class="line">1154</span><br><span class="line">1155</span><br><span class="line">1156</span><br><span class="line">1157</span><br><span class="line">1158</span><br><span class="line">1159</span><br><span class="line">1160</span><br><span class="line">1161</span><br><span class="line">1162</span><br><span class="line">1163</span><br><span class="line">1164</span><br><span class="line">1165</span><br><span class="line">1166</span><br><span class="line">1167</span><br><span class="line">1168</span><br><span class="line">1169</span><br><span class="line">1170</span><br><span class="line">1171</span><br><span class="line">1172</span><br><span class="line">1173</span><br><span class="line">1174</span><br><span class="line">1175</span><br><span class="line">1176</span><br><span class="line">1177</span><br><span class="line">1178</span><br><span class="line">1179</span><br><span class="line">1180</span><br><span class="line">1181</span><br><span class="line">1182</span><br><span class="line">1183</span><br><span class="line">1184</span><br><span class="line">1185</span><br><span class="line">1186</span><br><span class="line">1187</span><br><span class="line">1188</span><br><span class="line">1189</span><br><span class="line">1190</span><br><span class="line">1191</span><br><span class="line">1192</span><br><span class="line">1193</span><br><span class="line">1194</span><br><span class="line">1195</span><br><span class="line">1196</span><br><span class="line">1197</span><br><span class="line">1198</span><br><span class="line">1199</span><br><span class="line">1200</span><br><span class="line">1201</span><br><span class="line">1202</span><br><span class="line">1203</span><br><span class="line">1204</span><br><span class="line">1205</span><br><span class="line">1206</span><br><span class="line">1207</span><br><span class="line">1208</span><br><span class="line">1209</span><br><span class="line">1210</span><br><span class="line">1211</span><br><span class="line">1212</span><br><span class="line">1213</span><br><span class="line">1214</span><br><span class="line">1215</span><br><span class="line">1216</span><br><span class="line">1217</span><br><span class="line">1218</span><br><span class="line">1219</span><br><span class="line">1220</span><br><span class="line">1221</span><br><span class="line">1222</span><br><span class="line">1223</span><br><span class="line">1224</span><br><span class="line">1225</span><br><span class="line">1226</span><br><span class="line">1227</span><br><span class="line">1228</span><br><span class="line">1229</span><br><span class="line">1230</span><br><span class="line">1231</span><br><span class="line">1232</span><br><span class="line">1233</span><br><span class="line">1234</span><br><span class="line">1235</span><br><span class="line">1236</span><br><span class="line">1237</span><br><span class="line">1238</span><br><span class="line">1239</span><br><span class="line">1240</span><br><span class="line">1241</span><br><span class="line">1242</span><br><span class="line">1243</span><br><span class="line">1244</span><br><span class="line">1245</span><br><span class="line">1246</span><br><span class="line">1247</span><br><span class="line">1248</span><br><span class="line">1249</span><br><span class="line">1250</span><br><span class="line">1251</span><br><span class="line">1252</span><br><span class="line">1253</span><br><span class="line">1254</span><br><span class="line">1255</span><br><span class="line">1256</span><br><span class="line">1257</span><br><span class="line">1258</span><br><span class="line">1259</span><br><span class="line">1260</span><br><span class="line">1261</span><br><span class="line">1262</span><br><span class="line">1263</span><br><span class="line">1264</span><br><span class="line">1265</span><br><span class="line">1266</span><br><span class="line">1267</span><br><span class="line">1268</span><br><span class="line">1269</span><br><span class="line">1270</span><br><span class="line">1271</span><br><span class="line">1272</span><br><span class="line">1273</span><br><span class="line">1274</span><br><span class="line">1275</span><br><span class="line">1276</span><br><span class="line">1277</span><br><span class="line">1278</span><br><span class="line">1279</span><br><span class="line">1280</span><br><span class="line">1281</span><br><span class="line">1282</span><br><span class="line">1283</span><br><span class="line">1284</span><br><span class="line">1285</span><br><span class="line">1286</span><br><span class="line">1287</span><br><span class="line">1288</span><br><span class="line">1289</span><br><span class="line">1290</span><br><span class="line">1291</span><br><span class="line">1292</span><br><span class="line">1293</span><br><span class="line">1294</span><br><span class="line">1295</span><br><span class="line">1296</span><br><span class="line">1297</span><br><span class="line">1298</span><br><span class="line">1299</span><br><span class="line">1300</span><br><span class="line">1301</span><br><span class="line">1302</span><br><span class="line">1303</span><br><span class="line">1304</span><br><span class="line">1305</span><br><span class="line">1306</span><br><span class="line">1307</span><br><span class="line">1308</span><br><span class="line">1309</span><br><span class="line">1310</span><br><span class="line">1311</span><br><span class="line">1312</span><br><span class="line">1313</span><br><span class="line">1314</span><br><span class="line">1315</span><br><span class="line">1316</span><br><span class="line">1317</span><br><span class="line">1318</span><br><span class="line">1319</span><br><span class="line">1320</span><br><span class="line">1321</span><br><span class="line">1322</span><br><span class="line">1323</span><br><span class="line">1324</span><br><span class="line">1325</span><br><span class="line">1326</span><br><span class="line">1327</span><br><span class="line">1328</span><br><span class="line">1329</span><br><span class="line">1330</span><br><span class="line">1331</span><br><span class="line">1332</span><br><span class="line">1333</span><br><span class="line">1334</span><br><span class="line">1335</span><br><span class="line">1336</span><br><span class="line">1337</span><br><span class="line">1338</span><br><span class="line">1339</span><br><span class="line">1340</span><br><span class="line">1341</span><br><span class="line">1342</span><br><span class="line">1343</span><br><span class="line">1344</span><br><span class="line">1345</span><br><span class="line">1346</span><br><span class="line">1347</span><br><span class="line">1348</span><br><span class="line">1349</span><br><span class="line">1350</span><br><span class="line">1351</span><br><span class="line">1352</span><br><span class="line">1353</span><br><span class="line">1354</span><br><span class="line">1355</span><br><span class="line">1356</span><br><span class="line">1357</span><br><span class="line">1358</span><br><span class="line">1359</span><br><span class="line">1360</span><br><span class="line">1361</span><br><span class="line">1362</span><br><span class="line">1363</span><br><span class="line">1364</span><br><span class="line">1365</span><br><span class="line">1366</span><br><span class="line">1367</span><br><span class="line">1368</span><br><span class="line">1369</span><br><span class="line">1370</span><br><span class="line">1371</span><br><span class="line">1372</span><br><span class="line">1373</span><br><span class="line">1374</span><br><span class="line">1375</span><br><span class="line">1376</span><br><span class="line">1377</span><br><span class="line">1378</span><br><span class="line">1379</span><br><span class="line">1380</span><br><span class="line">1381</span><br><span class="line">1382</span><br><span class="line">1383</span><br><span class="line">1384</span><br><span class="line">1385</span><br><span class="line">1386</span><br><span class="line">1387</span><br><span class="line">1388</span><br><span class="line">1389</span><br><span class="line">1390</span><br><span class="line">1391</span><br><span class="line">1392</span><br><span class="line">1393</span><br><span class="line">1394</span><br><span class="line">1395</span><br><span class="line">1396</span><br><span class="line">1397</span><br><span class="line">1398</span><br><span class="line">1399</span><br><span class="line">1400</span><br><span class="line">1401</span><br><span class="line">1402</span><br><span class="line">1403</span><br><span class="line">1404</span><br><span class="line">1405</span><br><span class="line">1406</span><br><span class="line">1407</span><br><span class="line">1408</span><br><span class="line">1409</span><br><span class="line">1410</span><br><span class="line">1411</span><br><span class="line">1412</span><br><span class="line">1413</span><br><span class="line">1414</span><br><span class="line">1415</span><br><span class="line">1416</span><br><span class="line">1417</span><br><span class="line">1418</span><br><span class="line">1419</span><br><span class="line">1420</span><br><span class="line">1421</span><br><span class="line">1422</span><br><span class="line">1423</span><br><span class="line">1424</span><br><span class="line">1425</span><br><span class="line">1426</span><br><span class="line">1427</span><br><span class="line">1428</span><br><span class="line">1429</span><br><span class="line">1430</span><br><span class="line">1431</span><br><span class="line">1432</span><br><span class="line">1433</span><br><span class="line">1434</span><br><span class="line">1435</span><br><span class="line">1436</span><br><span class="line">1437</span><br><span class="line">1438</span><br><span class="line">1439</span><br><span class="line">1440</span><br><span class="line">1441</span><br><span class="line">1442</span><br><span class="line">1443</span><br><span class="line">1444</span><br><span class="line">1445</span><br><span class="line">1446</span><br><span class="line">1447</span><br><span class="line">1448</span><br><span class="line">1449</span><br><span class="line">1450</span><br><span class="line">1451</span><br><span class="line">1452</span><br><span class="line">1453</span><br><span class="line">1454</span><br><span class="line">1455</span><br><span class="line">1456</span><br><span class="line">1457</span><br><span class="line">1458</span><br><span class="line">1459</span><br><span class="line">1460</span><br><span class="line">1461</span><br><span class="line">1462</span><br><span class="line">1463</span><br><span class="line">1464</span><br><span class="line">1465</span><br><span class="line">1466</span><br><span class="line">1467</span><br><span class="line">1468</span><br><span class="line">1469</span><br><span class="line">1470</span><br><span class="line">1471</span><br><span class="line">1472</span><br><span class="line">1473</span><br><span class="line">1474</span><br><span class="line">1475</span><br><span class="line">1476</span><br><span class="line">1477</span><br><span class="line">1478</span><br><span class="line">1479</span><br><span class="line">1480</span><br><span class="line">1481</span><br><span class="line">1482</span><br><span class="line">1483</span><br><span class="line">1484</span><br><span class="line">1485</span><br><span class="line">1486</span><br><span class="line">1487</span><br><span class="line">1488</span><br><span class="line">1489</span><br><span class="line">1490</span><br><span class="line">1491</span><br><span class="line">1492</span><br><span class="line">1493</span><br><span class="line">1494</span><br><span class="line">1495</span><br><span class="line">1496</span><br><span class="line">1497</span><br><span class="line">1498</span><br><span class="line">1499</span><br><span class="line">1500</span><br><span class="line">1501</span><br><span class="line">1502</span><br><span class="line">1503</span><br><span class="line">1504</span><br><span class="line">1505</span><br><span class="line">1506</span><br><span class="line">1507</span><br><span class="line">1508</span><br><span class="line">1509</span><br><span class="line">1510</span><br><span class="line">1511</span><br><span class="line">1512</span><br><span class="line">1513</span><br><span class="line">1514</span><br><span class="line">1515</span><br><span class="line">1516</span><br><span class="line">1517</span><br><span class="line">1518</span><br><span class="line">1519</span><br><span class="line">1520</span><br><span class="line">1521</span><br><span class="line">1522</span><br><span class="line">1523</span><br><span class="line">1524</span><br><span class="line">1525</span><br><span class="line">1526</span><br><span class="line">1527</span><br><span class="line">1528</span><br><span class="line">1529</span><br><span class="line">1530</span><br><span class="line">1531</span><br><span class="line">1532</span><br><span class="line">1533</span><br><span class="line">1534</span><br><span class="line">1535</span><br><span class="line">1536</span><br><span class="line">1537</span><br><span class="line">1538</span><br><span class="line">1539</span><br><span class="line">1540</span><br><span class="line">1541</span><br><span class="line">1542</span><br><span class="line">1543</span><br><span class="line">1544</span><br><span class="line">1545</span><br><span class="line">1546</span><br><span class="line">1547</span><br><span class="line">1548</span><br><span class="line">1549</span><br><span class="line">1550</span><br><span class="line">1551</span><br><span class="line">1552</span><br><span class="line">1553</span><br><span class="line">1554</span><br><span class="line">1555</span><br><span class="line">1556</span><br><span class="line">1557</span><br><span class="line">1558</span><br><span class="line">1559</span><br><span class="line">1560</span><br><span class="line">1561</span><br><span class="line">1562</span><br><span class="line">1563</span><br><span class="line">1564</span><br><span class="line">1565</span><br><span class="line">1566</span><br><span class="line">1567</span><br><span class="line">1568</span><br><span class="line">1569</span><br><span class="line">1570</span><br><span class="line">1571</span><br><span class="line">1572</span><br><span class="line">1573</span><br><span class="line">1574</span><br><span class="line">1575</span><br><span class="line">1576</span><br><span class="line">1577</span><br><span class="line">1578</span><br><span class="line">1579</span><br><span class="line">1580</span><br><span class="line">1581</span><br><span class="line">1582</span><br><span class="line">1583</span><br><span class="line">1584</span><br><span class="line">1585</span><br><span class="line">1586</span><br><span class="line">1587</span><br><span class="line">1588</span><br><span class="line">1589</span><br><span class="line">1590</span><br><span class="line">1591</span><br><span class="line">1592</span><br><span class="line">1593</span><br><span class="line">1594</span><br><span class="line">1595</span><br><span class="line">1596</span><br><span class="line">1597</span><br><span class="line">1598</span><br><span class="line">1599</span><br><span class="line">1600</span><br><span class="line">1601</span><br><span class="line">1602</span><br><span class="line">1603</span><br><span class="line">1604</span><br><span class="line">1605</span><br><span class="line">1606</span><br><span class="line">1607</span><br><span class="line">1608</span><br><span class="line">1609</span><br><span class="line">1610</span><br><span class="line">1611</span><br><span class="line">1612</span><br><span class="line">1613</span><br><span class="line">1614</span><br><span class="line">1615</span><br><span class="line">1616</span><br><span class="line">1617</span><br><span class="line">1618</span><br><span class="line">1619</span><br><span class="line">1620</span><br><span class="line">1621</span><br><span class="line">1622</span><br><span class="line">1623</span><br><span class="line">1624</span><br><span class="line">1625</span><br><span class="line">1626</span><br><span class="line">1627</span><br><span class="line">1628</span><br><span class="line">1629</span><br><span class="line">1630</span><br><span class="line">1631</span><br><span class="line">1632</span><br><span class="line">1633</span><br><span class="line">1634</span><br><span class="line">1635</span><br><span class="line">1636</span><br><span class="line">1637</span><br><span class="line">1638</span><br><span class="line">1639</span><br><span class="line">1640</span><br><span class="line">1641</span><br><span class="line">1642</span><br><span class="line">1643</span><br><span class="line">1644</span><br><span class="line">1645</span><br><span class="line">1646</span><br><span class="line">1647</span><br><span class="line">1648</span><br><span class="line">1649</span><br><span class="line">1650</span><br><span class="line">1651</span><br><span class="line">1652</span><br><span class="line">1653</span><br><span class="line">1654</span><br><span class="line">1655</span><br><span class="line">1656</span><br><span class="line">1657</span><br><span class="line">1658</span><br><span class="line">1659</span><br><span class="line">1660</span><br><span class="line">1661</span><br><span class="line">1662</span><br><span class="line">1663</span><br><span class="line">1664</span><br><span class="line">1665</span><br><span class="line">1666</span><br><span class="line">1667</span><br><span class="line">1668</span><br><span class="line">1669</span><br><span class="line">1670</span><br><span class="line">1671</span><br><span class="line">1672</span><br><span class="line">1673</span><br><span class="line">1674</span><br><span class="line">1675</span><br><span class="line">1676</span><br><span class="line">1677</span><br><span class="line">1678</span><br><span class="line">1679</span><br><span class="line">1680</span><br><span class="line">1681</span><br><span class="line">1682</span><br><span class="line">1683</span><br><span class="line">1684</span><br><span class="line">1685</span><br><span class="line">1686</span><br><span class="line">1687</span><br><span class="line">1688</span><br><span class="line">1689</span><br><span class="line">1690</span><br><span class="line">1691</span><br><span class="line">1692</span><br><span class="line">1693</span><br><span class="line">1694</span><br><span class="line">1695</span><br><span class="line">1696</span><br><span class="line">1697</span><br><span class="line">1698</span><br><span class="line">1699</span><br><span class="line">1700</span><br><span class="line">1701</span><br><span class="line">1702</span><br><span class="line">1703</span><br><span class="line">1704</span><br><span class="line">1705</span><br><span class="line">1706</span><br><span class="line">1707</span><br><span class="line">1708</span><br><span class="line">1709</span><br><span class="line">1710</span><br><span class="line">1711</span><br><span class="line">1712</span><br><span class="line">1713</span><br><span class="line">1714</span><br><span class="line">1715</span><br><span class="line">1716</span><br><span class="line">1717</span><br><span class="line">1718</span><br><span class="line">1719</span><br><span class="line">1720</span><br><span class="line">1721</span><br><span class="line">1722</span><br><span class="line">1723</span><br><span class="line">1724</span><br><span class="line">1725</span><br><span class="line">1726</span><br><span class="line">1727</span><br><span class="line">1728</span><br><span class="line">1729</span><br><span class="line">1730</span><br><span class="line">1731</span><br><span class="line">1732</span><br><span class="line">1733</span><br><span class="line">1734</span><br><span class="line">1735</span><br><span class="line">1736</span><br><span class="line">1737</span><br><span class="line">1738</span><br><span class="line">1739</span><br><span class="line">1740</span><br><span class="line">1741</span><br><span class="line">1742</span><br><span class="line">1743</span><br><span class="line">1744</span><br><span class="line">1745</span><br><span class="line">1746</span><br><span class="line">1747</span><br><span class="line">1748</span><br><span class="line">1749</span><br><span class="line">1750</span><br><span class="line">1751</span><br><span class="line">1752</span><br><span class="line">1753</span><br><span class="line">1754</span><br><span class="line">1755</span><br><span class="line">1756</span><br><span class="line">1757</span><br><span class="line">1758</span><br><span class="line">1759</span><br><span class="line">1760</span><br><span class="line">1761</span><br><span class="line">1762</span><br><span class="line">1763</span><br><span class="line">1764</span><br><span class="line">1765</span><br><span class="line">1766</span><br><span class="line">1767</span><br><span class="line">1768</span><br><span class="line">1769</span><br><span class="line">1770</span><br><span class="line">1771</span><br><span class="line">1772</span><br><span class="line">1773</span><br><span class="line">1774</span><br><span class="line">1775</span><br><span class="line">1776</span><br><span class="line">1777</span><br><span class="line">1778</span><br><span class="line">1779</span><br><span class="line">1780</span><br><span class="line">1781</span><br><span class="line">1782</span><br><span class="line">1783</span><br><span class="line">1784</span><br><span class="line">1785</span><br><span class="line">1786</span><br><span class="line">1787</span><br><span class="line">1788</span><br><span class="line">1789</span><br><span class="line">1790</span><br><span class="line">1791</span><br><span class="line">1792</span><br><span class="line">1793</span><br><span class="line">1794</span><br><span class="line">1795</span><br><span class="line">1796</span><br><span class="line">1797</span><br><span class="line">1798</span><br><span class="line">1799</span><br><span class="line">1800</span><br><span class="line">1801</span><br><span class="line">1802</span><br><span class="line">1803</span><br><span class="line">1804</span><br><span class="line">1805</span><br><span class="line">1806</span><br><span class="line">1807</span><br><span class="line">1808</span><br><span class="line">1809</span><br><span class="line">1810</span><br><span class="line">1811</span><br><span class="line">1812</span><br><span class="line">1813</span><br><span class="line">1814</span><br><span class="line">1815</span><br><span class="line">1816</span><br><span class="line">1817</span><br><span class="line">1818</span><br><span class="line">1819</span><br><span class="line">1820</span><br><span class="line">1821</span><br><span class="line">1822</span><br><span class="line">1823</span><br><span class="line">1824</span><br><span class="line">1825</span><br><span class="line">1826</span><br><span class="line">1827</span><br><span class="line">1828</span><br><span class="line">1829</span><br><span class="line">1830</span><br><span class="line">1831</span><br><span class="line">1832</span><br><span class="line">1833</span><br><span class="line">1834</span><br><span class="line">1835</span><br><span class="line">1836</span><br><span class="line">1837</span><br><span class="line">1838</span><br><span class="line">1839</span><br><span class="line">1840</span><br><span class="line">1841</span><br><span class="line">1842</span><br><span class="line">1843</span><br><span class="line">1844</span><br><span class="line">1845</span><br><span class="line">1846</span><br><span class="line">1847</span><br><span class="line">1848</span><br><span class="line">1849</span><br><span class="line">1850</span><br><span class="line">1851</span><br><span class="line">1852</span><br><span class="line">1853</span><br><span class="line">1854</span><br><span class="line">1855</span><br><span class="line">1856</span><br><span class="line">1857</span><br><span class="line">1858</span><br><span class="line">1859</span><br><span class="line">1860</span><br><span class="line">1861</span><br><span class="line">1862</span><br><span class="line">1863</span><br><span class="line">1864</span><br><span class="line">1865</span><br><span class="line">1866</span><br><span class="line">1867</span><br><span class="line">1868</span><br><span class="line">1869</span><br><span class="line">1870</span><br><span class="line">1871</span><br><span class="line">1872</span><br><span class="line">1873</span><br><span class="line">1874</span><br><span class="line">1875</span><br><span class="line">1876</span><br><span class="line">1877</span><br><span class="line">1878</span><br><span class="line">1879</span><br><span class="line">1880</span><br><span class="line">1881</span><br><span class="line">1882</span><br><span class="line">1883</span><br><span class="line">1884</span><br><span class="line">1885</span><br><span class="line">1886</span><br><span class="line">1887</span><br><span class="line">1888</span><br><span class="line">1889</span><br><span class="line">1890</span><br><span class="line">1891</span><br><span class="line">1892</span><br><span class="line">1893</span><br><span class="line">1894</span><br><span class="line">1895</span><br><span class="line">1896</span><br><span class="line">1897</span><br><span class="line">1898</span><br><span class="line">1899</span><br><span class="line">1900</span><br><span class="line">1901</span><br><span class="line">1902</span><br><span class="line">1903</span><br><span class="line">1904</span><br><span class="line">1905</span><br><span class="line">1906</span><br><span class="line">1907</span><br><span class="line">1908</span><br><span class="line">1909</span><br><span class="line">1910</span><br><span class="line">1911</span><br><span class="line">1912</span><br><span class="line">1913</span><br><span class="line">1914</span><br><span class="line">1915</span><br><span class="line">1916</span><br><span class="line">1917</span><br><span class="line">1918</span><br><span class="line">1919</span><br><span class="line">1920</span><br><span class="line">1921</span><br><span class="line">1922</span><br><span class="line">1923</span><br><span class="line">1924</span><br><span class="line">1925</span><br><span class="line">1926</span><br><span class="line">1927</span><br><span class="line">1928</span><br><span class="line">1929</span><br><span class="line">1930</span><br><span class="line">1931</span><br><span class="line">1932</span><br><span class="line">1933</span><br><span class="line">1934</span><br><span class="line">1935</span><br><span class="line">1936</span><br><span class="line">1937</span><br><span class="line">1938</span><br><span class="line">1939</span><br><span class="line">1940</span><br><span class="line">1941</span><br><span class="line">1942</span><br><span class="line">1943</span><br><span class="line">1944</span><br><span class="line">1945</span><br><span class="line">1946</span><br><span class="line">1947</span><br><span class="line">1948</span><br><span class="line">1949</span><br><span class="line">1950</span><br><span class="line">1951</span><br><span class="line">1952</span><br><span class="line">1953</span><br><span class="line">1954</span><br><span class="line">1955</span><br><span class="line">1956</span><br><span class="line">1957</span><br><span class="line">1958</span><br><span class="line">1959</span><br><span class="line">1960</span><br><span class="line">1961</span><br><span class="line">1962</span><br><span class="line">1963</span><br><span class="line">1964</span><br><span class="line">1965</span><br><span class="line">1966</span><br><span class="line">1967</span><br><span class="line">1968</span><br><span class="line">1969</span><br><span class="line">1970</span><br><span class="line">1971</span><br><span class="line">1972</span><br><span class="line">1973</span><br><span class="line">1974</span><br><span class="line">1975</span><br><span class="line">1976</span><br><span class="line">1977</span><br><span class="line">1978</span><br><span class="line">1979</span><br><span class="line">1980</span><br><span class="line">1981</span><br><span class="line">1982</span><br><span class="line">1983</span><br><span class="line">1984</span><br><span class="line">1985</span><br><span class="line">1986</span><br><span class="line">1987</span><br><span class="line">1988</span><br><span class="line">1989</span><br><span class="line">1990</span><br><span class="line">1991</span><br><span class="line">1992</span><br><span class="line">1993</span><br><span class="line">1994</span><br><span class="line">1995</span><br><span class="line">1996</span><br><span class="line">1997</span><br><span class="line">1998</span><br><span class="line">1999</span><br><span class="line">2000</span><br><span class="line">2001</span><br><span class="line">2002</span><br><span class="line">2003</span><br><span class="line">2004</span><br><span class="line">2005</span><br><span class="line">2006</span><br><span class="line">2007</span><br><span class="line">2008</span><br><span class="line">2009</span><br><span class="line">2010</span><br><span class="line">2011</span><br><span class="line">2012</span><br><span class="line">2013</span><br><span class="line">2014</span><br><span class="line">2015</span><br><span class="line">2016</span><br><span class="line">2017</span><br><span class="line">2018</span><br><span class="line">2019</span><br><span class="line">2020</span><br><span class="line">2021</span><br><span class="line">2022</span><br><span class="line">2023</span><br><span class="line">2024</span><br><span class="line">2025</span><br><span class="line">2026</span><br><span class="line">2027</span><br><span class="line">2028</span><br><span class="line">2029</span><br><span class="line">2030</span><br><span class="line">2031</span><br><span class="line">2032</span><br><span class="line">2033</span><br><span class="line">2034</span><br><span class="line">2035</span><br><span class="line">2036</span><br><span class="line">2037</span><br><span class="line">2038</span><br><span class="line">2039</span><br><span class="line">2040</span><br><span class="line">2041</span><br><span class="line">2042</span><br><span class="line">2043</span><br><span class="line">2044</span><br><span class="line">2045</span><br><span class="line">2046</span><br><span class="line">2047</span><br><span class="line">2048</span><br><span class="line">2049</span><br><span class="line">2050</span><br><span class="line">2051</span><br><span class="line">2052</span><br><span class="line">2053</span><br><span class="line">2054</span><br><span class="line">2055</span><br><span class="line">2056</span><br><span class="line">2057</span><br><span class="line">2058</span><br><span class="line">2059</span><br><span class="line">2060</span><br><span class="line">2061</span><br><span class="line">2062</span><br><span class="line">2063</span><br><span class="line">2064</span><br><span class="line">2065</span><br><span class="line">2066</span><br><span class="line">2067</span><br><span class="line">2068</span><br><span class="line">2069</span><br><span class="line">2070</span><br><span class="line">2071</span><br><span class="line">2072</span><br><span class="line">2073</span><br><span class="line">2074</span><br><span class="line">2075</span><br><span class="line">2076</span><br><span class="line">2077</span><br><span class="line">2078</span><br><span class="line">2079</span><br><span class="line">2080</span><br><span class="line">2081</span><br><span class="line">2082</span><br><span class="line">2083</span><br><span class="line">2084</span><br><span class="line">2085</span><br><span class="line">2086</span><br><span class="line">2087</span><br><span class="line">2088</span><br><span class="line">2089</span><br><span class="line">2090</span><br><span class="line">2091</span><br><span class="line">2092</span><br><span class="line">2093</span><br><span class="line">2094</span><br><span class="line">2095</span><br><span class="line">2096</span><br><span class="line">2097</span><br><span class="line">2098</span><br><span class="line">2099</span><br><span class="line">2100</span><br><span class="line">2101</span><br><span class="line">2102</span><br><span class="line">2103</span><br><span class="line">2104</span><br><span class="line">2105</span><br><span class="line">2106</span><br><span class="line">2107</span><br><span class="line">2108</span><br><span class="line">2109</span><br><span class="line">2110</span><br><span class="line">2111</span><br><span class="line">2112</span><br><span class="line">2113</span><br><span class="line">2114</span><br><span class="line">2115</span><br><span class="line">2116</span><br><span class="line">2117</span><br><span class="line">2118</span><br><span class="line">2119</span><br><span class="line">2120</span><br><span class="line">2121</span><br><span class="line">2122</span><br><span class="line">2123</span><br><span class="line">2124</span><br><span class="line">2125</span><br><span class="line">2126</span><br><span class="line">2127</span><br><span class="line">2128</span><br><span class="line">2129</span><br><span class="line">2130</span><br><span class="line">2131</span><br><span class="line">2132</span><br><span class="line">2133</span><br><span class="line">2134</span><br><span class="line">2135</span><br><span class="line">2136</span><br><span class="line">2137</span><br><span class="line">2138</span><br><span class="line">2139</span><br><span class="line">2140</span><br><span class="line">2141</span><br><span class="line">2142</span><br><span class="line">2143</span><br><span class="line">2144</span><br><span class="line">2145</span><br><span class="line">2146</span><br><span class="line">2147</span><br><span class="line">2148</span><br><span class="line">2149</span><br><span class="line">2150</span><br><span class="line">2151</span><br><span class="line">2152</span><br><span class="line">2153</span><br><span class="line">2154</span><br><span class="line">2155</span><br><span class="line">2156</span><br><span class="line">2157</span><br><span class="line">2158</span><br><span class="line">2159</span><br><span class="line">2160</span><br><span class="line">2161</span><br><span class="line">2162</span><br><span class="line">2163</span><br><span class="line">2164</span><br><span class="line">2165</span><br><span class="line">2166</span><br><span class="line">2167</span><br><span class="line">2168</span><br><span class="line">2169</span><br><span class="line">2170</span><br><span class="line">2171</span><br><span class="line">2172</span><br><span class="line">2173</span><br><span class="line">2174</span><br><span class="line">2175</span><br><span class="line">2176</span><br><span class="line">2177</span><br><span class="line">2178</span><br><span class="line">2179</span><br><span class="line">2180</span><br><span class="line">2181</span><br><span class="line">2182</span><br><span class="line">2183</span><br><span class="line">2184</span><br><span class="line">2185</span><br><span class="line">2186</span><br><span class="line">2187</span><br><span class="line">2188</span><br><span class="line">2189</span><br><span class="line">2190</span><br><span class="line">2191</span><br><span class="line">2192</span><br><span class="line">2193</span><br><span class="line">2194</span><br><span class="line">2195</span><br><span class="line">2196</span><br><span class="line">2197</span><br><span class="line">2198</span><br><span class="line">2199</span><br><span class="line">2200</span><br><span class="line">2201</span><br><span class="line">2202</span><br><span class="line">2203</span><br><span class="line">2204</span><br><span class="line">2205</span><br><span class="line">2206</span><br><span class="line">2207</span><br><span class="line">2208</span><br><span class="line">2209</span><br><span class="line">2210</span><br><span class="line">2211</span><br><span class="line">2212</span><br><span class="line">2213</span><br><span class="line">2214</span><br><span class="line">2215</span><br><span class="line">2216</span><br><span class="line">2217</span><br><span class="line">2218</span><br><span class="line">2219</span><br><span class="line">2220</span><br><span class="line">2221</span><br><span class="line">2222</span><br><span class="line">2223</span><br><span class="line">2224</span><br><span class="line">2225</span><br><span class="line">2226</span><br><span class="line">2227</span><br><span class="line">2228</span><br><span class="line">2229</span><br><span class="line">2230</span><br><span class="line">2231</span><br><span class="line">2232</span><br><span class="line">2233</span><br><span class="line">2234</span><br><span class="line">2235</span><br><span class="line">2236</span><br><span class="line">2237</span><br><span class="line">2238</span><br><span class="line">2239</span><br><span class="line">2240</span><br><span class="line">2241</span><br><span class="line">2242</span><br><span class="line">2243</span><br><span class="line">2244</span><br><span class="line">2245</span><br><span class="line">2246</span><br><span class="line">2247</span><br><span class="line">2248</span><br><span class="line">2249</span><br><span class="line">2250</span><br><span class="line">2251</span><br><span class="line">2252</span><br><span class="line">2253</span><br><span class="line">2254</span><br><span class="line">2255</span><br><span class="line">2256</span><br><span class="line">2257</span><br><span class="line">2258</span><br><span class="line">2259</span><br><span class="line">2260</span><br><span class="line">2261</span><br><span class="line">2262</span><br><span class="line">2263</span><br><span class="line">2264</span><br><span class="line">2265</span><br><span class="line">2266</span><br><span class="line">2267</span><br><span class="line">2268</span><br><span class="line">2269</span><br><span class="line">2270</span><br><span class="line">2271</span><br><span class="line">2272</span><br><span class="line">2273</span><br><span class="line">2274</span><br><span class="line">2275</span><br><span class="line">2276</span><br><span class="line">2277</span><br><span class="line">2278</span><br><span class="line">2279</span><br><span class="line">2280</span><br><span class="line">2281</span><br><span class="line">2282</span><br><span class="line">2283</span><br><span class="line">2284</span><br><span class="line">2285</span><br><span class="line">2286</span><br><span class="line">2287</span><br><span class="line">2288</span><br><span class="line">2289</span><br><span class="line">2290</span><br><span class="line">2291</span><br><span class="line">2292</span><br><span class="line">2293</span><br><span class="line">2294</span><br><span class="line">2295</span><br><span class="line">2296</span><br><span class="line">2297</span><br><span class="line">2298</span><br><span class="line">2299</span><br><span class="line">2300</span><br><span class="line">2301</span><br><span class="line">2302</span><br><span class="line">2303</span><br><span class="line">2304</span><br><span class="line">2305</span><br><span class="line">2306</span><br><span class="line">2307</span><br><span class="line">2308</span><br><span class="line">2309</span><br><span class="line">2310</span><br><span class="line">2311</span><br><span class="line">2312</span><br><span class="line">2313</span><br><span class="line">2314</span><br><span class="line">2315</span><br><span class="line">2316</span><br><span class="line">2317</span><br><span class="line">2318</span><br><span class="line">2319</span><br><span class="line">2320</span><br><span class="line">2321</span><br><span class="line">2322</span><br><span class="line">2323</span><br><span class="line">2324</span><br><span class="line">2325</span><br><span class="line">2326</span><br><span class="line">2327</span><br><span class="line">2328</span><br><span class="line">2329</span><br><span class="line">2330</span><br><span class="line">2331</span><br><span class="line">2332</span><br><span class="line">2333</span><br><span class="line">2334</span><br><span class="line">2335</span><br><span class="line">2336</span><br><span class="line">2337</span><br><span class="line">2338</span><br><span class="line">2339</span><br><span class="line">2340</span><br><span class="line">2341</span><br><span class="line">2342</span><br><span class="line">2343</span><br><span class="line">2344</span><br><span class="line">2345</span><br><span class="line">2346</span><br><span class="line">2347</span><br><span class="line">2348</span><br><span class="line">2349</span><br><span class="line">2350</span><br><span class="line">2351</span><br><span class="line">2352</span><br><span class="line">2353</span><br><span class="line">2354</span><br><span class="line">2355</span><br><span class="line">2356</span><br><span class="line">2357</span><br><span class="line">2358</span><br><span class="line">2359</span><br><span class="line">2360</span><br><span class="line">2361</span><br><span class="line">2362</span><br><span class="line">2363</span><br><span class="line">2364</span><br><span class="line">2365</span><br><span class="line">2366</span><br><span class="line">2367</span><br><span class="line">2368</span><br><span class="line">2369</span><br><span class="line">2370</span><br><span class="line">2371</span><br><span class="line">2372</span><br><span class="line">2373</span><br><span class="line">2374</span><br><span class="line">2375</span><br><span class="line">2376</span><br><span class="line">2377</span><br><span class="line">2378</span><br><span class="line">2379</span><br><span class="line">2380</span><br><span class="line">2381</span><br><span class="line">2382</span><br><span class="line">2383</span><br><span class="line">2384</span><br><span class="line">2385</span><br><span class="line">2386</span><br><span class="line">2387</span><br><span class="line">2388</span><br><span class="line">2389</span><br><span class="line">2390</span><br><span class="line">2391</span><br><span class="line">2392</span><br><span class="line">2393</span><br><span class="line">2394</span><br><span class="line">2395</span><br><span class="line">2396</span><br><span class="line">2397</span><br><span class="line">2398</span><br><span class="line">2399</span><br><span class="line">2400</span><br><span class="line">2401</span><br><span class="line">2402</span><br><span class="line">2403</span><br><span class="line">2404</span><br><span class="line">2405</span><br><span class="line">2406</span><br><span class="line">2407</span><br><span class="line">2408</span><br><span class="line">2409</span><br><span class="line">2410</span><br><span class="line">2411</span><br><span class="line">2412</span><br><span class="line">2413</span><br><span class="line">2414</span><br><span class="line">2415</span><br><span class="line">2416</span><br><span class="line">2417</span><br><span class="line">2418</span><br><span class="line">2419</span><br><span class="line">2420</span><br><span class="line">2421</span><br><span class="line">2422</span><br><span class="line">2423</span><br><span class="line">2424</span><br><span class="line">2425</span><br><span class="line">2426</span><br><span class="line">2427</span><br><span class="line">2428</span><br><span class="line">2429</span><br><span class="line">2430</span><br><span class="line">2431</span><br><span class="line">2432</span><br><span class="line">2433</span><br><span class="line">2434</span><br><span class="line">2435</span><br><span class="line">2436</span><br><span class="line">2437</span><br><span class="line">2438</span><br><span class="line">2439</span><br><span class="line">2440</span><br><span class="line">2441</span><br><span class="line">2442</span><br><span class="line">2443</span><br><span class="line">2444</span><br><span class="line">2445</span><br><span class="line">2446</span><br><span class="line">2447</span><br><span class="line">2448</span><br><span class="line">2449</span><br><span class="line">2450</span><br><span class="line">2451</span><br><span class="line">2452</span><br><span class="line">2453</span><br><span class="line">2454</span><br><span class="line">2455</span><br><span class="line">2456</span><br><span class="line">2457</span><br><span class="line">2458</span><br><span class="line">2459</span><br><span class="line">2460</span><br><span class="line">2461</span><br><span class="line">2462</span><br><span class="line">2463</span><br><span class="line">2464</span><br><span class="line">2465</span><br><span class="line">2466</span><br><span class="line">2467</span><br><span class="line">2468</span><br><span class="line">2469</span><br><span class="line">2470</span><br><span class="line">2471</span><br><span class="line">2472</span><br><span class="line">2473</span><br><span class="line">2474</span><br><span class="line">2475</span><br><span class="line">2476</span><br><span class="line">2477</span><br><span class="line">2478</span><br><span class="line">2479</span><br><span class="line">2480</span><br><span class="line">2481</span><br><span class="line">2482</span><br><span class="line">2483</span><br><span class="line">2484</span><br><span class="line">2485</span><br><span class="line">2486</span><br><span class="line">2487</span><br><span class="line">2488</span><br><span class="line">2489</span><br><span class="line">2490</span><br><span class="line">2491</span><br><span class="line">2492</span><br><span class="line">2493</span><br><span class="line">2494</span><br><span class="line">2495</span><br><span class="line">2496</span><br><span class="line">2497</span><br><span class="line">2498</span><br><span class="line">2499</span><br><span class="line">2500</span><br><span class="line">2501</span><br><span class="line">2502</span><br><span class="line">2503</span><br><span class="line">2504</span><br><span class="line">2505</span><br><span class="line">2506</span><br><span class="line">2507</span><br><span class="line">2508</span><br><span class="line">2509</span><br><span class="line">2510</span><br><span class="line">2511</span><br><span class="line">2512</span><br><span class="line">2513</span><br><span class="line">2514</span><br><span class="line">2515</span><br><span class="line">2516</span><br><span class="line">2517</span><br><span class="line">2518</span><br><span class="line">2519</span><br><span class="line">2520</span><br><span class="line">2521</span><br><span class="line">2522</span><br><span class="line">2523</span><br><span class="line">2524</span><br><span class="line">2525</span><br><span class="line">2526</span><br><span class="line">2527</span><br><span class="line">2528</span><br><span class="line">2529</span><br><span class="line">2530</span><br><span class="line">2531</span><br><span class="line">2532</span><br><span class="line">2533</span><br><span class="line">2534</span><br><span class="line">2535</span><br><span class="line">2536</span><br><span class="line">2537</span><br><span class="line">2538</span><br><span class="line">2539</span><br><span class="line">2540</span><br><span class="line">2541</span><br><span class="line">2542</span><br><span class="line">2543</span><br><span class="line">2544</span><br><span class="line">2545</span><br><span class="line">2546</span><br><span class="line">2547</span><br><span class="line">2548</span><br><span class="line">2549</span><br><span class="line">2550</span><br><span class="line">2551</span><br><span class="line">2552</span><br><span class="line">2553</span><br><span class="line">2554</span><br><span class="line">2555</span><br><span class="line">2556</span><br><span class="line">2557</span><br><span class="line">2558</span><br><span class="line">2559</span><br><span class="line">2560</span><br><span class="line">2561</span><br><span class="line">2562</span><br><span class="line">2563</span><br><span class="line">2564</span><br><span class="line">2565</span><br><span class="line">2566</span><br><span class="line">2567</span><br><span class="line">2568</span><br><span class="line">2569</span><br><span class="line">2570</span><br><span class="line">2571</span><br><span class="line">2572</span><br><span class="line">2573</span><br><span class="line">2574</span><br><span class="line">2575</span><br><span class="line">2576</span><br><span class="line">2577</span><br><span class="line">2578</span><br><span class="line">2579</span><br><span class="line">2580</span><br><span class="line">2581</span><br><span class="line">2582</span><br><span class="line">2583</span><br><span class="line">2584</span><br><span class="line">2585</span><br><span class="line">2586</span><br><span class="line">2587</span><br><span class="line">2588</span><br><span class="line">2589</span><br><span class="line">2590</span><br><span class="line">2591</span><br><span class="line">2592</span><br><span class="line">2593</span><br><span class="line">2594</span><br><span class="line">2595</span><br><span class="line">2596</span><br><span class="line">2597</span><br><span class="line">2598</span><br><span class="line">2599</span><br><span class="line">2600</span><br><span class="line">2601</span><br><span class="line">2602</span><br><span class="line">2603</span><br><span class="line">2604</span><br><span class="line">2605</span><br><span class="line">2606</span><br><span class="line">2607</span><br><span class="line">2608</span><br><span class="line">2609</span><br><span class="line">2610</span><br><span class="line">2611</span><br><span class="line">2612</span><br><span class="line">2613</span><br><span class="line">2614</span><br><span class="line">2615</span><br><span class="line">2616</span><br><span class="line">2617</span><br><span class="line">2618</span><br><span class="line">2619</span><br><span class="line">2620</span><br><span class="line">2621</span><br><span class="line">2622</span><br><span class="line">2623</span><br><span class="line">2624</span><br><span class="line">2625</span><br><span class="line">2626</span><br><span class="line">2627</span><br><span class="line">2628</span><br><span class="line">2629</span><br><span class="line">2630</span><br><span class="line">2631</span><br><span class="line">2632</span><br><span class="line">2633</span><br><span class="line">2634</span><br><span class="line">2635</span><br><span class="line">2636</span><br><span class="line">2637</span><br><span class="line">2638</span><br><span class="line">2639</span><br><span class="line">2640</span><br><span class="line">2641</span><br><span class="line">2642</span><br><span class="line">2643</span><br><span class="line">2644</span><br><span class="line">2645</span><br><span class="line">2646</span><br><span class="line">2647</span><br><span class="line">2648</span><br><span class="line">2649</span><br><span class="line">2650</span><br><span class="line">2651</span><br><span class="line">2652</span><br><span class="line">2653</span><br><span class="line">2654</span><br><span class="line">2655</span><br><span class="line">2656</span><br><span class="line">2657</span><br><span class="line">2658</span><br><span class="line">2659</span><br><span class="line">2660</span><br><span class="line">2661</span><br><span class="line">2662</span><br><span class="line">2663</span><br><span class="line">2664</span><br><span class="line">2665</span><br><span class="line">2666</span><br><span class="line">2667</span><br><span class="line">2668</span><br><span class="line">2669</span><br><span class="line">2670</span><br><span class="line">2671</span><br><span class="line">2672</span><br><span class="line">2673</span><br><span class="line">2674</span><br><span class="line">2675</span><br><span class="line">2676</span><br><span class="line">2677</span><br><span class="line">2678</span><br><span class="line">2679</span><br><span class="line">2680</span><br><span class="line">2681</span><br><span class="line">2682</span><br><span class="line">2683</span><br><span class="line">2684</span><br><span class="line">2685</span><br><span class="line">2686</span><br><span class="line">2687</span><br><span class="line">2688</span><br><span class="line">2689</span><br><span class="line">2690</span><br><span class="line">2691</span><br><span class="line">2692</span><br><span class="line">2693</span><br><span class="line">2694</span><br><span class="line">2695</span><br><span class="line">2696</span><br><span class="line">2697</span><br><span class="line">2698</span><br><span class="line">2699</span><br><span class="line">2700</span><br><span class="line">2701</span><br><span class="line">2702</span><br><span class="line">2703</span><br><span class="line">2704</span><br><span class="line">2705</span><br><span class="line">2706</span><br><span class="line">2707</span><br><span class="line">2708</span><br><span class="line">2709</span><br><span class="line">2710</span><br><span class="line">2711</span><br><span class="line">2712</span><br><span class="line">2713</span><br><span class="line">2714</span><br><span class="line">2715</span><br><span class="line">2716</span><br><span class="line">2717</span><br><span class="line">2718</span><br><span class="line">2719</span><br><span class="line">2720</span><br><span class="line">2721</span><br><span class="line">2722</span><br><span class="line">2723</span><br><span class="line">2724</span><br><span class="line">2725</span><br><span class="line">2726</span><br><span class="line">2727</span><br><span class="line">2728</span><br><span class="line">2729</span><br><span class="line">2730</span><br><span class="line">2731</span><br><span class="line">2732</span><br><span class="line">2733</span><br><span class="line">2734</span><br><span class="line">2735</span><br><span class="line">2736</span><br><span class="line">2737</span><br><span class="line">2738</span><br><span class="line">2739</span><br><span class="line">2740</span><br><span class="line">2741</span><br><span class="line">2742</span><br><span class="line">2743</span><br><span class="line">2744</span><br><span class="line">2745</span><br><span class="line">2746</span><br><span class="line">2747</span><br><span class="line">2748</span><br><span class="line">2749</span><br><span class="line">2750</span><br><span class="line">2751</span><br><span class="line">2752</span><br><span class="line">2753</span><br><span class="line">2754</span><br><span class="line">2755</span><br><span class="line">2756</span><br><span class="line">2757</span><br><span class="line">2758</span><br><span class="line">2759</span><br><span class="line">2760</span><br><span class="line">2761</span><br><span class="line">2762</span><br><span class="line">2763</span><br><span class="line">2764</span><br><span class="line">2765</span><br><span class="line">2766</span><br><span class="line">2767</span><br><span class="line">2768</span><br><span class="line">2769</span><br><span class="line">2770</span><br><span class="line">2771</span><br><span class="line">2772</span><br><span class="line">2773</span><br><span class="line">2774</span><br><span class="line">2775</span><br><span class="line">2776</span><br><span class="line">2777</span><br><span class="line">2778</span><br><span class="line">2779</span><br><span class="line">2780</span><br><span class="line">2781</span><br><span class="line">2782</span><br><span class="line">2783</span><br><span class="line">2784</span><br><span class="line">2785</span><br><span class="line">2786</span><br><span class="line">2787</span><br><span class="line">2788</span><br><span class="line">2789</span><br><span class="line">2790</span><br><span class="line">2791</span><br><span class="line">2792</span><br><span class="line">2793</span><br><span class="line">2794</span><br><span class="line">2795</span><br><span class="line">2796</span><br><span class="line">2797</span><br><span class="line">2798</span><br><span class="line">2799</span><br><span class="line">2800</span><br><span class="line">2801</span><br><span class="line">2802</span><br><span class="line">2803</span><br><span class="line">2804</span><br><span class="line">2805</span><br><span class="line">2806</span><br><span class="line">2807</span><br><span class="line">2808</span><br><span class="line">2809</span><br><span class="line">2810</span><br><span class="line">2811</span><br><span class="line">2812</span><br><span class="line">2813</span><br><span class="line">2814</span><br><span class="line">2815</span><br><span class="line">2816</span><br><span class="line">2817</span><br><span class="line">2818</span><br><span class="line">2819</span><br><span class="line">2820</span><br><span class="line">2821</span><br><span class="line">2822</span><br><span class="line">2823</span><br><span class="line">2824</span><br><span class="line">2825</span><br><span class="line">2826</span><br><span class="line">2827</span><br><span class="line">2828</span><br><span class="line">2829</span><br><span class="line">2830</span><br><span class="line">2831</span><br><span class="line">2832</span><br><span class="line">2833</span><br><span class="line">2834</span><br><span class="line">2835</span><br><span class="line">2836</span><br><span class="line">2837</span><br><span class="line">2838</span><br><span class="line">2839</span><br><span class="line">2840</span><br><span class="line">2841</span><br><span class="line">2842</span><br><span class="line">2843</span><br><span class="line">2844</span><br><span class="line">2845</span><br><span class="line">2846</span><br><span class="line">2847</span><br><span class="line">2848</span><br><span class="line">2849</span><br><span class="line">2850</span><br><span class="line">2851</span><br><span class="line">2852</span><br><span class="line">2853</span><br><span class="line">2854</span><br><span class="line">2855</span><br><span class="line">2856</span><br><span class="line">2857</span><br><span class="line">2858</span><br><span class="line">2859</span><br><span class="line">2860</span><br><span class="line">2861</span><br><span class="line">2862</span><br><span class="line">2863</span><br><span class="line">2864</span><br><span class="line">2865</span><br><span class="line">2866</span><br><span class="line">2867</span><br><span class="line">2868</span><br><span class="line">2869</span><br><span class="line">2870</span><br><span class="line">2871</span><br><span class="line">2872</span><br><span class="line">2873</span><br><span class="line">2874</span><br><span class="line">2875</span><br><span class="line">2876</span><br><span class="line">2877</span><br><span class="line">2878</span><br><span class="line">2879</span><br><span class="line">2880</span><br><span class="line">2881</span><br><span class="line">2882</span><br><span class="line">2883</span><br><span class="line">2884</span><br><span class="line">2885</span><br><span class="line">2886</span><br><span class="line">2887</span><br><span class="line">2888</span><br><span class="line">2889</span><br><span class="line">2890</span><br><span class="line">2891</span><br><span class="line">2892</span><br><span class="line">2893</span><br><span class="line">2894</span><br><span class="line">2895</span><br><span class="line">2896</span><br><span class="line">2897</span><br><span class="line">2898</span><br><span class="line">2899</span><br><span class="line">2900</span><br><span class="line">2901</span><br><span class="line">2902</span><br><span class="line">2903</span><br><span class="line">2904</span><br><span class="line">2905</span><br><span class="line">2906</span><br><span class="line">2907</span><br><span class="line">2908</span><br><span class="line">2909</span><br><span class="line">2910</span><br><span class="line">2911</span><br><span class="line">2912</span><br><span class="line">2913</span><br><span class="line">2914</span><br><span class="line">2915</span><br><span class="line">2916</span><br><span class="line">2917</span><br><span class="line">2918</span><br><span class="line">2919</span><br><span class="line">2920</span><br><span class="line">2921</span><br><span class="line">2922</span><br><span class="line">2923</span><br><span class="line">2924</span><br><span class="line">2925</span><br><span class="line">2926</span><br><span class="line">2927</span><br><span class="line">2928</span><br><span class="line">2929</span><br><span class="line">2930</span><br><span class="line">2931</span><br><span class="line">2932</span><br><span class="line">2933</span><br><span class="line">2934</span><br><span class="line">2935</span><br><span class="line">2936</span><br><span class="line">2937</span><br><span class="line">2938</span><br><span class="line">2939</span><br><span class="line">2940</span><br><span class="line">2941</span><br><span class="line">2942</span><br><span class="line">2943</span><br><span class="line">2944</span><br><span class="line">2945</span><br><span class="line">2946</span><br><span class="line">2947</span><br><span class="line">2948</span><br><span class="line">2949</span><br><span class="line">2950</span><br><span class="line">2951</span><br><span class="line">2952</span><br><span class="line">2953</span><br><span class="line">2954</span><br><span class="line">2955</span><br><span class="line">2956</span><br><span class="line">2957</span><br><span class="line">2958</span><br><span class="line">2959</span><br><span class="line">2960</span><br><span class="line">2961</span><br><span class="line">2962</span><br><span class="line">2963</span><br><span class="line">2964</span><br><span class="line">2965</span><br><span class="line">2966</span><br><span class="line">2967</span><br><span class="line">2968</span><br><span class="line">2969</span><br><span class="line">2970</span><br><span class="line">2971</span><br><span class="line">2972</span><br><span class="line">2973</span><br><span class="line">2974</span><br><span class="line">2975</span><br><span class="line">2976</span><br><span class="line">2977</span><br><span class="line">2978</span><br><span class="line">2979</span><br><span class="line">2980</span><br><span class="line">2981</span><br><span class="line">2982</span><br><span class="line">2983</span><br><span class="line">2984</span><br><span class="line">2985</span><br><span class="line">2986</span><br><span class="line">2987</span><br><span class="line">2988</span><br><span class="line">2989</span><br><span class="line">2990</span><br><span class="line">2991</span><br><span class="line">2992</span><br><span class="line">2993</span><br><span class="line">2994</span><br><span class="line">2995</span><br><span class="line">2996</span><br><span class="line">2997</span><br><span class="line">2998</span><br><span class="line">2999</span><br><span class="line">3000</span><br><span class="line">3001</span><br><span class="line">3002</span><br><span class="line">3003</span><br><span class="line">3004</span><br><span class="line">3005</span><br><span class="line">3006</span><br><span class="line">3007</span><br><span class="line">3008</span><br><span class="line">3009</span><br><span class="line">3010</span><br><span class="line">3011</span><br><span class="line">3012</span><br><span class="line">3013</span><br><span class="line">3014</span><br><span class="line">3015</span><br><span class="line">3016</span><br><span class="line">3017</span><br><span class="line">3018</span><br><span class="line">3019</span><br><span class="line">3020</span><br><span class="line">3021</span><br><span class="line">3022</span><br><span class="line">3023</span><br><span class="line">3024</span><br><span class="line">3025</span><br><span class="line">3026</span><br><span class="line">3027</span><br><span class="line">3028</span><br><span class="line">3029</span><br><span class="line">3030</span><br><span class="line">3031</span><br><span class="line">3032</span><br><span class="line">3033</span><br><span class="line">3034</span><br><span class="line">3035</span><br><span class="line">3036</span><br><span class="line">3037</span><br><span class="line">3038</span><br><span class="line">3039</span><br><span class="line">3040</span><br><span class="line">3041</span><br><span class="line">3042</span><br><span class="line">3043</span><br><span class="line">3044</span><br><span class="line">3045</span><br><span class="line">3046</span><br><span class="line">3047</span><br><span class="line">3048</span><br><span class="line">3049</span><br><span class="line">3050</span><br><span class="line">3051</span><br><span class="line">3052</span><br><span class="line">3053</span><br><span class="line">3054</span><br><span class="line">3055</span><br><span class="line">3056</span><br><span class="line">3057</span><br><span class="line">3058</span><br><span class="line">3059</span><br><span class="line">3060</span><br><span class="line">3061</span><br><span class="line">3062</span><br><span class="line">3063</span><br><span class="line">3064</span><br><span class="line">3065</span><br><span class="line">3066</span><br><span class="line">3067</span><br><span class="line">3068</span><br><span class="line">3069</span><br><span class="line">3070</span><br><span class="line">3071</span><br><span class="line">3072</span><br><span class="line">3073</span><br><span class="line">3074</span><br><span class="line">3075</span><br><span class="line">3076</span><br><span class="line">3077</span><br><span class="line">3078</span><br><span class="line">3079</span><br><span class="line">3080</span><br><span class="line">3081</span><br><span class="line">3082</span><br><span class="line">3083</span><br><span class="line">3084</span><br><span class="line">3085</span><br><span class="line">3086</span><br><span class="line">3087</span><br><span class="line">3088</span><br><span class="line">3089</span><br><span class="line">3090</span><br><span class="line">3091</span><br><span class="line">3092</span><br><span class="line">3093</span><br><span class="line">3094</span><br><span class="line">3095</span><br><span class="line">3096</span><br><span class="line">3097</span><br><span class="line">3098</span><br><span class="line">3099</span><br><span class="line">3100</span><br><span class="line">3101</span><br><span class="line">3102</span><br><span class="line">3103</span><br><span class="line">3104</span><br><span class="line">3105</span><br><span class="line">3106</span><br><span class="line">3107</span><br><span class="line">3108</span><br><span class="line">3109</span><br><span class="line">3110</span><br><span class="line">3111</span><br><span class="line">3112</span><br><span class="line">3113</span><br><span class="line">3114</span><br><span class="line">3115</span><br><span class="line">3116</span><br><span class="line">3117</span><br><span class="line">3118</span><br><span class="line">3119</span><br><span class="line">3120</span><br><span class="line">3121</span><br><span class="line">3122</span><br><span class="line">3123</span><br><span class="line">3124</span><br><span class="line">3125</span><br><span class="line">3126</span><br><span class="line">3127</span><br><span class="line">3128</span><br><span class="line">3129</span><br><span class="line">3130</span><br><span class="line">3131</span><br><span class="line">3132</span><br><span class="line">3133</span><br><span class="line">3134</span><br><span class="line">3135</span><br><span class="line">3136</span><br><span class="line">3137</span><br><span class="line">3138</span><br><span class="line">3139</span><br><span class="line">3140</span><br><span class="line">3141</span><br><span class="line">3142</span><br><span class="line">3143</span><br><span class="line">3144</span><br><span class="line">3145</span><br><span class="line">3146</span><br><span class="line">3147</span><br><span class="line">3148</span><br><span class="line">3149</span><br><span class="line">3150</span><br><span class="line">3151</span><br><span class="line">3152</span><br><span class="line">3153</span><br><span class="line">3154</span><br><span class="line">3155</span><br><span class="line">3156</span><br><span class="line">3157</span><br><span class="line">3158</span><br><span class="line">3159</span><br><span class="line">3160</span><br><span class="line">3161</span><br><span class="line">3162</span><br><span class="line">3163</span><br><span class="line">3164</span><br><span class="line">3165</span><br><span class="line">3166</span><br><span class="line">3167</span><br><span class="line">3168</span><br><span class="line">3169</span><br><span class="line">3170</span><br><span class="line">3171</span><br><span class="line">3172</span><br><span class="line">3173</span><br><span class="line">3174</span><br><span class="line">3175</span><br><span class="line">3176</span><br><span class="line">3177</span><br><span class="line">3178</span><br><span class="line">3179</span><br><span class="line">3180</span><br><span class="line">3181</span><br><span class="line">3182</span><br><span class="line">3183</span><br><span class="line">3184</span><br><span class="line">3185</span><br><span class="line">3186</span><br><span class="line">3187</span><br><span class="line">3188</span><br><span class="line">3189</span><br><span class="line">3190</span><br><span class="line">3191</span><br><span class="line">3192</span><br><span class="line">3193</span><br><span class="line">3194</span><br><span class="line">3195</span><br><span class="line">3196</span><br><span class="line">3197</span><br><span class="line">3198</span><br><span class="line">3199</span><br><span class="line">3200</span><br><span class="line">3201</span><br><span class="line">3202</span><br><span class="line">3203</span><br><span class="line">3204</span><br><span class="line">3205</span><br><span class="line">3206</span><br><span class="line">3207</span><br><span class="line">3208</span><br><span class="line">3209</span><br><span class="line">3210</span><br><span class="line">3211</span><br><span class="line">3212</span><br><span class="line">3213</span><br><span class="line">3214</span><br><span class="line">3215</span><br><span class="line">3216</span><br><span class="line">3217</span><br><span class="line">3218</span><br><span class="line">3219</span><br><span class="line">3220</span><br><span class="line">3221</span><br><span class="line">3222</span><br><span class="line">3223</span><br><span class="line">3224</span><br><span class="line">3225</span><br><span class="line">3226</span><br><span class="line">3227</span><br><span class="line">3228</span><br><span class="line">3229</span><br><span class="line">3230</span><br><span class="line">3231</span><br><span class="line">3232</span><br><span class="line">3233</span><br><span class="line">3234</span><br><span class="line">3235</span><br><span class="line">3236</span><br><span class="line">3237</span><br><span class="line">3238</span><br><span class="line">3239</span><br><span class="line">3240</span><br><span class="line">3241</span><br><span class="line">3242</span><br><span class="line">3243</span><br><span class="line">3244</span><br><span class="line">3245</span><br><span class="line">3246</span><br><span class="line">3247</span><br><span class="line">3248</span><br><span class="line">3249</span><br><span class="line">3250</span><br><span class="line">3251</span><br><span class="line">3252</span><br><span class="line">3253</span><br><span class="line">3254</span><br><span class="line">3255</span><br><span class="line">3256</span><br><span class="line">3257</span><br><span class="line">3258</span><br><span class="line">3259</span><br><span class="line">3260</span><br><span class="line">3261</span><br><span class="line">3262</span><br><span class="line">3263</span><br><span class="line">3264</span><br><span class="line">3265</span><br><span class="line">3266</span><br><span class="line">3267</span><br><span class="line">3268</span><br><span class="line">3269</span><br><span class="line">3270</span><br><span class="line">3271</span><br><span class="line">3272</span><br><span class="line">3273</span><br><span class="line">3274</span><br><span class="line">3275</span><br><span class="line">3276</span><br><span class="line">3277</span><br><span class="line">3278</span><br><span class="line">3279</span><br><span class="line">3280</span><br><span class="line">3281</span><br><span class="line">3282</span><br><span class="line">3283</span><br><span class="line">3284</span><br><span class="line">3285</span><br><span class="line">3286</span><br><span class="line">3287</span><br><span class="line">3288</span><br><span class="line">3289</span><br><span class="line">3290</span><br><span class="line">3291</span><br><span class="line">3292</span><br><span class="line">3293</span><br><span class="line">3294</span><br><span class="line">3295</span><br><span class="line">3296</span><br><span class="line">3297</span><br><span class="line">3298</span><br><span class="line">3299</span><br><span class="line">3300</span><br><span class="line">3301</span><br><span class="line">3302</span><br><span class="line">3303</span><br><span class="line">3304</span><br><span class="line">3305</span><br><span class="line">3306</span><br><span class="line">3307</span><br><span class="line">3308</span><br><span class="line">3309</span><br><span class="line">3310</span><br><span class="line">3311</span><br><span class="line">3312</span><br><span class="line">3313</span><br><span class="line">3314</span><br><span class="line">3315</span><br><span class="line">3316</span><br><span class="line">3317</span><br><span class="line">3318</span><br><span class="line">3319</span><br><span class="line">3320</span><br><span class="line">3321</span><br><span class="line">3322</span><br><span class="line">3323</span><br><span class="line">3324</span><br><span class="line">3325</span><br><span class="line">3326</span><br><span class="line">3327</span><br><span class="line">3328</span><br><span class="line">3329</span><br><span class="line">3330</span><br><span class="line">3331</span><br><span class="line">3332</span><br><span class="line">3333</span><br><span class="line">3334</span><br><span class="line">3335</span><br><span class="line">3336</span><br><span class="line">3337</span><br><span class="line">3338</span><br><span class="line">3339</span><br><span class="line">3340</span><br><span class="line">3341</span><br><span class="line">3342</span><br><span class="line">3343</span><br><span class="line">3344</span><br><span class="line">3345</span><br><span class="line">3346</span><br><span class="line">3347</span><br><span class="line">3348</span><br><span class="line">3349</span><br><span class="line">3350</span><br><span class="line">3351</span><br><span class="line">3352</span><br><span class="line">3353</span><br><span class="line">3354</span><br><span class="line">3355</span><br><span class="line">3356</span><br><span class="line">3357</span><br><span class="line">3358</span><br><span class="line">3359</span><br><span class="line">3360</span><br><span class="line">3361</span><br><span class="line">3362</span><br><span class="line">3363</span><br><span class="line">3364</span><br><span class="line">3365</span><br><span class="line">3366</span><br><span class="line">3367</span><br><span class="line">3368</span><br><span class="line">3369</span><br><span class="line">3370</span><br><span class="line">3371</span><br><span class="line">3372</span><br><span class="line">3373</span><br><span class="line">3374</span><br><span class="line">3375</span><br><span class="line">3376</span><br><span class="line">3377</span><br><span class="line">3378</span><br><span class="line">3379</span><br><span class="line">3380</span><br><span class="line">3381</span><br><span class="line">3382</span><br><span class="line">3383</span><br><span class="line">3384</span><br><span class="line">3385</span><br><span class="line">3386</span><br><span class="line">3387</span><br><span class="line">3388</span><br><span class="line">3389</span><br><span class="line">3390</span><br><span class="line">3391</span><br><span class="line">3392</span><br><span class="line">3393</span><br><span class="line">3394</span><br><span class="line">3395</span><br><span class="line">3396</span><br><span class="line">3397</span><br><span class="line">3398</span><br><span class="line">3399</span><br><span class="line">3400</span><br><span class="line">3401</span><br><span class="line">3402</span><br><span class="line">3403</span><br><span class="line">3404</span><br><span class="line">3405</span><br><span class="line">3406</span><br><span class="line">3407</span><br><span class="line">3408</span><br><span class="line">3409</span><br><span class="line">3410</span><br><span class="line">3411</span><br><span class="line">3412</span><br><span class="line">3413</span><br><span class="line">3414</span><br><span class="line">3415</span><br><span class="line">3416</span><br><span class="line">3417</span><br><span class="line">3418</span><br><span class="line">3419</span><br><span class="line">3420</span><br><span class="line">3421</span><br><span class="line">3422</span><br><span class="line">3423</span><br><span class="line">3424</span><br><span class="line">3425</span><br><span class="line">3426</span><br><span class="line">3427</span><br><span class="line">3428</span><br><span class="line">3429</span><br><span class="line">3430</span><br><span class="line">3431</span><br><span class="line">3432</span><br><span class="line">3433</span><br><span class="line">3434</span><br><span class="line">3435</span><br><span class="line">3436</span><br><span class="line">3437</span><br><span class="line">3438</span><br><span class="line">3439</span><br><span class="line">3440</span><br><span class="line">3441</span><br><span class="line">3442</span><br><span class="line">3443</span><br><span class="line">3444</span><br><span class="line">3445</span><br><span class="line">3446</span><br><span class="line">3447</span><br><span class="line">3448</span><br><span class="line">3449</span><br><span class="line">3450</span><br><span class="line">3451</span><br><span class="line">3452</span><br><span class="line">3453</span><br><span class="line">3454</span><br><span class="line">3455</span><br><span class="line">3456</span><br><span class="line">3457</span><br><span class="line">3458</span><br><span class="line">3459</span><br><span class="line">3460</span><br><span class="line">3461</span><br><span class="line">3462</span><br><span class="line">3463</span><br><span class="line">3464</span><br><span class="line">3465</span><br><span class="line">3466</span><br><span class="line">3467</span><br><span class="line">3468</span><br><span class="line">3469</span><br><span class="line">3470</span><br><span class="line">3471</span><br><span class="line">3472</span><br><span class="line">3473</span><br><span class="line">3474</span><br><span class="line">3475</span><br><span class="line">3476</span><br><span class="line">3477</span><br><span class="line">3478</span><br><span class="line">3479</span><br><span class="line">3480</span><br><span class="line">3481</span><br><span class="line">3482</span><br><span class="line">3483</span><br><span class="line">3484</span><br><span class="line">3485</span><br><span class="line">3486</span><br><span class="line">3487</span><br><span class="line">3488</span><br><span class="line">3489</span><br><span class="line">3490</span><br><span class="line">3491</span><br><span class="line">3492</span><br><span class="line">3493</span><br><span class="line">3494</span><br><span class="line">3495</span><br><span class="line">3496</span><br><span class="line">3497</span><br><span class="line">3498</span><br><span class="line">3499</span><br><span class="line">3500</span><br><span class="line">3501</span><br><span class="line">3502</span><br><span class="line">3503</span><br><span class="line">3504</span><br><span class="line">3505</span><br><span class="line">3506</span><br><span class="line">3507</span><br><span class="line">3508</span><br><span class="line">3509</span><br><span class="line">3510</span><br><span class="line">3511</span><br><span class="line">3512</span><br><span class="line">3513</span><br><span class="line">3514</span><br><span class="line">3515</span><br><span class="line">3516</span><br><span class="line">3517</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;  包含                ZHLT_MMC_MARA02_02</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">FORM</span> get_data .</span><br><span class="line">  <span class="keyword">CLEAR</span> it_mara[].</span><br><span class="line">  DATA lv_lines <span class="keyword">TYPE</span> i.</span><br><span class="line">  DATA lv_index <span class="keyword">TYPE</span> i.</span><br><span class="line">  DATA lv_row_tmp <span class="keyword">TYPE</span> numc4.</span><br><span class="line">  DATA ls_line LIKE <span class="keyword">LINE</span> OF gt_lines.</span><br><span class="line">  DATA lt_line LIKE gt_lines.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  FIELD-SYMBOLS: &lt;ls_field&gt; <span class="keyword">TYPE</span> any.</span><br><span class="line"></span><br><span class="line"><span class="comment">* 获取模板数据</span></span><br><span class="line">  <span class="keyword">CLEAR</span> gt_lines.</span><br><span class="line"></span><br><span class="line">  CALL FUNCTION 'ZALSM_EXCEL_TO_INTERNAL_TABLE1'</span><br><span class="line">    EXPORTING</span><br><span class="line">      filename    = p_file</span><br><span class="line">      i_begin_col = 1</span><br><span class="line">      i_begin_row = 6</span><br><span class="line">      i_end_col   = 81</span><br><span class="line">      i_end_row   = 70000</span><br><span class="line"><span class="comment">*     sheet_name  =</span></span><br><span class="line">    TABLES</span><br><span class="line">      intern      = gt_lines[].</span><br><span class="line"></span><br><span class="line">  lt_line[] = gt_lines[].</span><br><span class="line"></span><br><span class="line">  LOOP AT lt_line INTO  ls_line.</span><br><span class="line">    AT NEW row.</span><br><span class="line">    ENDAT.</span><br><span class="line">    CASE ls_line-col.</span><br><span class="line"><span class="comment">* Header</span></span><br><span class="line"></span><br><span class="line">      WHEN 1.</span><br><span class="line">        it_mara-rowid = ls_line-value.</span><br><span class="line">      WHEN 2.</span><br><span class="line">        it_mara-matnr = ls_line-value.</span><br><span class="line">      WHEN 3.</span><br><span class="line">        it_mara-maktx = ls_line-value.</span><br><span class="line">      WHEN 4.</span><br><span class="line">        it_mara-mbrsh = ls_line-value.</span><br><span class="line">      WHEN 5.</span><br><span class="line">        it_mara-mtart = ls_line-value.</span><br><span class="line">      WHEN 6.</span><br><span class="line">        it_mara-meins = ls_line-value.</span><br><span class="line">      WHEN 7.</span><br><span class="line">        it_mara-matkl = ls_line-value.</span><br><span class="line">      WHEN 8.</span><br><span class="line">        it_mara-bismt = ls_line-value.</span><br><span class="line">      WHEN 9.</span><br><span class="line">        it_mara-extwg = ls_line-value.</span><br><span class="line">      WHEN 10.</span><br><span class="line">        it_mara-spart = ls_line-value.</span><br><span class="line">      WHEN 11.</span><br><span class="line">        it_mara-mstae = ls_line-value.</span><br><span class="line">      WHEN 12.</span><br><span class="line">        it_mara-brgew = ls_line-value.</span><br><span class="line">      WHEN 13.</span><br><span class="line">        it_mara-ntgew = ls_line-value.</span><br><span class="line">      WHEN 14.</span><br><span class="line">        it_mara-gewei = ls_line-value.</span><br><span class="line">      WHEN 15.</span><br><span class="line">        it_mara-groes = ls_line-value.</span><br><span class="line">      WHEN 16.</span><br><span class="line">        it_mara-labor = ls_line-value.</span><br><span class="line">      WHEN 17.</span><br><span class="line">        it_mara-ean11 = ls_line-value.</span><br><span class="line">      WHEN 18.</span><br><span class="line">        it_mara-meinh = ls_line-value.</span><br><span class="line">      WHEN 19.</span><br><span class="line">        it_mara-umren1 = ls_line-value.</span><br><span class="line">      WHEN 20.</span><br><span class="line">        it_mara-umrez1 = ls_line-value.</span><br><span class="line">      WHEN 21.</span><br><span class="line">        it_mara-zzxh = ls_line-value.</span><br><span class="line">      WHEN 22.</span><br><span class="line">        it_mara-zzys = ls_line-value.</span><br><span class="line">      WHEN 23.</span><br><span class="line">        it_mara-zzmc = ls_line-value.</span><br><span class="line">      WHEN 24.</span><br><span class="line">        it_mara-zzdcrl = ls_line-value.</span><br><span class="line">      WHEN 25.</span><br><span class="line">        it_mara-vkorg = ls_line-value.</span><br><span class="line">      WHEN 26.</span><br><span class="line">        it_mara-vtweg = ls_line-value.</span><br><span class="line">      WHEN 27.</span><br><span class="line">        it_mara-vrkme = ls_line-value.</span><br><span class="line">      WHEN 28.</span><br><span class="line">        it_mara-umren2 = ls_line-value.</span><br><span class="line">      WHEN 29.</span><br><span class="line">        it_mara-umrez2 = ls_line-value.</span><br><span class="line">      WHEN 30.</span><br><span class="line">        it_mara-dwerk = ls_line-value.</span><br><span class="line">      WHEN 31.</span><br><span class="line">        it_mara-taxkm = ls_line-value.</span><br><span class="line">      WHEN 32.</span><br><span class="line">        it_mara-aumng = ls_line-value.</span><br><span class="line">      WHEN 33.</span><br><span class="line">        it_mara-ktgrm = ls_line-value.</span><br><span class="line">      WHEN 34.</span><br><span class="line">        it_mara-mtpos = ls_line-value.</span><br><span class="line">      WHEN 35.</span><br><span class="line">        it_mara-werks = ls_line-value.</span><br><span class="line">      WHEN 36.</span><br><span class="line">        it_mara-mtvfp = ls_line-value.</span><br><span class="line">      WHEN 37.</span><br><span class="line">        it_mara-tragr = ls_line-value.</span><br><span class="line">      WHEN 38.</span><br><span class="line">        it_mara-ladgr = ls_line-value.</span><br><span class="line">      WHEN 39.</span><br><span class="line">        it_mara-ekorg = ls_line-value.</span><br><span class="line">      WHEN 40.</span><br><span class="line">        it_mara-ekgrp = ls_line-value.</span><br><span class="line">      WHEN 41.</span><br><span class="line">        it_mara-bstme = ls_line-value.</span><br><span class="line">      WHEN 42.</span><br><span class="line">        it_mara-umren3 = ls_line-value.</span><br><span class="line">      WHEN 43.</span><br><span class="line">        it_mara-umrez3 = ls_line-value.</span><br><span class="line">      WHEN 44.</span><br><span class="line">        it_mara-xchar = ls_line-value.</span><br><span class="line">      WHEN 45.</span><br><span class="line">        it_mara-kautb = ls_line-value.</span><br><span class="line">      WHEN 46.</span><br><span class="line">        it_mara-dismm = ls_line-value.</span><br><span class="line">      WHEN 47.</span><br><span class="line">        it_mara-dispo = ls_line-value.</span><br><span class="line">      WHEN 48.</span><br><span class="line">        it_mara-disls = ls_line-value.</span><br><span class="line">      WHEN 49.</span><br><span class="line">        it_mara-bstmi = ls_line-value.</span><br><span class="line">      WHEN 50.</span><br><span class="line">        it_mara-bstrf = ls_line-value.</span><br><span class="line">      WHEN 51.</span><br><span class="line">        it_mara-ausss = ls_line-value.</span><br><span class="line">      WHEN 52.</span><br><span class="line">        it_mara-beskz = ls_line-value.</span><br><span class="line">      WHEN 53.</span><br><span class="line">        it_mara-sobsl = ls_line-value.</span><br><span class="line">      WHEN 54.</span><br><span class="line">        it_mara-schgt = ls_line-value.</span><br><span class="line">      WHEN 55.</span><br><span class="line">        it_mara-rgekz = ls_line-value.</span><br><span class="line">      WHEN 56.</span><br><span class="line">        it_mara-lgpro = ls_line-value.</span><br><span class="line">      WHEN 57.</span><br><span class="line">        it_mara-lgfsb = ls_line-value.</span><br><span class="line">      WHEN 58.</span><br><span class="line">        it_mara-plifz = ls_line-value.</span><br><span class="line">      WHEN 59.</span><br><span class="line">        it_mara-fhori = ls_line-value.</span><br><span class="line">      WHEN 60.</span><br><span class="line">        it_mara-eisbe = ls_line-value.</span><br><span class="line">      WHEN 61.</span><br><span class="line">        it_mara-strgr = ls_line-value.</span><br><span class="line">      WHEN 62.</span><br><span class="line">        it_mara-vrmod = ls_line-value.</span><br><span class="line">      WHEN 63.</span><br><span class="line">        it_mara-vint1 = ls_line-value.</span><br><span class="line">      WHEN 64.</span><br><span class="line">        it_mara-vint2 = ls_line-value.</span><br><span class="line">      WHEN 65.</span><br><span class="line">        it_mara-miskz = ls_line-value.</span><br><span class="line">      WHEN 66.</span><br><span class="line">        it_mara-kausf = ls_line-value.</span><br><span class="line">      WHEN 67.</span><br><span class="line">        it_mara-sbdkz = ls_line-value.</span><br><span class="line">      WHEN 68.</span><br><span class="line">        it_mara-fevor = ls_line-value.</span><br><span class="line">      WHEN 69.</span><br><span class="line">        it_mara-ueetk = ls_line-value.</span><br><span class="line">      WHEN 70.</span><br><span class="line">        it_mara-ueeto = ls_line-value.</span><br><span class="line">      WHEN 71.</span><br><span class="line">        it_mara-mhdhb = ls_line-value.</span><br><span class="line">      WHEN 72.</span><br><span class="line">        it_mara-mhdrz = ls_line-value.</span><br><span class="line">      WHEN 73.</span><br><span class="line">        it_mara-bwkey = ls_line-value.</span><br><span class="line">      WHEN 74.</span><br><span class="line">        it_mara-bklas = ls_line-value.</span><br><span class="line">      WHEN 75.</span><br><span class="line">        it_mara-vprsv = ls_line-value.</span><br><span class="line">      WHEN 76.</span><br><span class="line">        it_mara-peinh = ls_line-value.</span><br><span class="line">      WHEN 77.</span><br><span class="line">        it_mara-ncost = ls_line-value.</span><br><span class="line">      WHEN 78.</span><br><span class="line">        it_mara-ekalr = ls_line-value.</span><br><span class="line">      WHEN 79.</span><br><span class="line">        it_mara-hkmat = ls_line-value.</span><br><span class="line">      WHEN 80.</span><br><span class="line">        it_mara-awsls = ls_line-value.</span><br><span class="line">      WHEN 81.</span><br><span class="line">        it_mara-losgr = ls_line-value.</span><br><span class="line">    ENDCASE.</span><br><span class="line">    AT END OF row.</span><br><span class="line">      <span class="keyword">APPEND</span> it_mara.</span><br><span class="line">      <span class="keyword">CLEAR</span>:it_mara,ls_line.</span><br><span class="line">    ENDAT.</span><br><span class="line">  ENDLOOP.</span><br><span class="line">  <span class="keyword">CLEAR</span>:lt_line[],gt_lines[].</span><br><span class="line">ENDFORM.</span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  SET_ALV</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*  --&gt;  p1        text</span></span><br><span class="line"><span class="comment">*  &lt;--  p2        text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="keyword">FORM</span> set_alv .</span><br><span class="line">  <span class="keyword">CLEAR</span>:ls_layout,gt_field_cat[].</span><br><span class="line">  ls_layout-cwidth_opt = 'A'.</span><br><span class="line">  ls_layout-zebra = 'X'.</span><br><span class="line">  DATA <span class="keyword">line</span> <span class="keyword">TYPE</span> i VALUE 0.</span><br><span class="line">  DEFINE dingyi.</span><br><span class="line">    <span class="keyword">LINE</span> = <span class="keyword">LINE</span> + 1.</span><br><span class="line">    gs_field_cat-col_pos = <span class="keyword">LINE</span>.</span><br><span class="line">    gs_field_cat-fieldname = &amp;1.</span><br><span class="line">    gs_field_cat-scrtext_m = &amp;2.</span><br><span class="line"><span class="comment">*    gs_field_cat-edit = 'x'.</span></span><br><span class="line">    <span class="keyword">APPEND</span> gs_field_cat TO gt_field_cat.</span><br><span class="line">    <span class="keyword">CLEAR</span> gs_field_cat.</span><br><span class="line">  END-OF-DEFINITION.</span><br><span class="line"></span><br><span class="line">  dingyi   'ROWID'  '行号'.</span><br><span class="line">  dingyi   '<span class="keyword">TYPE</span>'       '消息类型'.</span><br><span class="line">  dingyi   'MESSAGE '  '消息文本'.</span><br><span class="line">  dingyi   'MATNR'  '物料号'.</span><br><span class="line">  dingyi   'MAKTX'   '物料描述'.</span><br><span class="line">  dingyi   'MBRSH'   '行业领域'.</span><br><span class="line">  dingyi   'MTART'   '物料类型'.</span><br><span class="line">  dingyi   'MEINS'   '基本计量单位'.</span><br><span class="line">  dingyi   'MATKL'   '物料组'.</span><br><span class="line">  dingyi   'BISMT'   '旧物料号'.</span><br><span class="line">  dingyi   'EXTWG'   '旧物料组'.</span><br><span class="line">  dingyi   'BRGEW'   '毛重'.</span><br><span class="line">  dingyi   'NTGEW'   '净重'.</span><br><span class="line">  dingyi   'GEWEI'   '重量单位'.</span><br><span class="line">  dingyi   'GROES'   '大小/量纲'.</span><br><span class="line">  dingyi   'LABOR'   '实验室/设计室'.</span><br><span class="line">  dingyi   'EAN11'   '国际文件号'.</span><br><span class="line">  dingyi   'WERKS'   '工厂'.</span><br><span class="line">  dingyi   'VKORG'   '销售组织'.</span><br><span class="line">  dingyi   'VTWEG'   '分销渠道'.</span><br><span class="line">  dingyi   'SPART'   '产品组'.</span><br><span class="line">  dingyi   'TAXKM'   '物料的税分类'.</span><br><span class="line">  dingyi   'KTGRM'   '该物料的科目设置组'.</span><br><span class="line">  dingyi   'MTPOS'   '来自物料主文件的项目类别组'.</span><br><span class="line">  dingyi   'MTVFP'   '可用性检查的检查组'.</span><br><span class="line">  dingyi   'TRAGR'   '运输组'.</span><br><span class="line">  dingyi   'LADGR'   '装载组'.</span><br><span class="line">  dingyi   'EKGRP'   '采购组'.</span><br><span class="line">  dingyi   'XCHAR'   '批量管理标识'.</span><br><span class="line">  dingyi   'KAUTB'  '标识: <span class="string">"允许自动采购订单"</span>'.</span><br><span class="line">  dingyi   'INSMK'  '过帐到检验库存' .</span><br><span class="line">  dingyi   'DISMM'   '物料需求计划类型'.</span><br><span class="line">  dingyi   'DISPO'   'MRP 控制者'.</span><br><span class="line">  dingyi   'DISLS'   '批量'.</span><br><span class="line">  dingyi   'BSTMI'   '最小批量'.</span><br><span class="line">  dingyi   'BSTRF'     '采购订单数量的舍入值'.</span><br><span class="line">  dingyi   'AUSSS'    '装配报废百分比'.</span><br><span class="line">  dingyi   'MABST'  '最大库存水平'.</span><br><span class="line">  dingyi   'BESKZ'     '采购类型'.</span><br><span class="line">  dingyi   'SOBSL'     '特殊采购类型'.</span><br><span class="line">  dingyi   'SCHGT'   '散装物料'.</span><br><span class="line">  dingyi   'DZEIT'   '自制生产时间'.</span><br><span class="line">  dingyi   'RGEKZ'  '标识：反冲'.</span><br><span class="line">  dingyi   'LGPRO'     '发货库存地点'.</span><br><span class="line">  dingyi   'LGFSB'     '外部采购的缺省仓储位置'.</span><br><span class="line">  dingyi   'PLIFZ'     '计划的天数内交货'.</span><br><span class="line">  dingyi   'FHORI'     '浮动的计划边际码'.</span><br><span class="line">  dingyi   'EISBE'     '安全库存'.</span><br><span class="line">  dingyi   'STRGR'     '计划策略组'.</span><br><span class="line">  dingyi   'VRMOD'     '消耗模式'.</span><br><span class="line">  dingyi   'VINT1'     '消耗期间:逆向'.</span><br><span class="line">  dingyi   'VINT2'     '消耗时期-向前'.</span><br><span class="line">  dingyi   'MISKZ'     '综合MRP'.</span><br><span class="line">  dingyi   'PRGRP'     '计划物料'.</span><br><span class="line">  dingyi   'PRWRK'     '计划工厂'.</span><br><span class="line">  dingyi   'UMREF'     '转换因子'.</span><br><span class="line">  dingyi   'KAUSF'     '部件废品百分数'.</span><br><span class="line">  dingyi   'SBDKZ'     '对于独立和集中需求的相关需求标识'.</span><br><span class="line">  dingyi   'FEVOR'     '生产管理员'.</span><br><span class="line">  dingyi   'BEARZ'     '处理时间'.</span><br><span class="line">  dingyi   'BASMG'     '基准数量'.</span><br><span class="line">  dingyi   'UEETK'     '标识：允许未限制的过量交货'.</span><br><span class="line">  dingyi   'UEETO'     '超量交货容差限制'.</span><br><span class="line">  dingyi   'MHDHB'     '总货架寿命'.</span><br><span class="line">  dingyi   'MHDRZ'     '最短剩余货架寿命'.</span><br><span class="line">  dingyi   'BKLAS'     '评估类'.</span><br><span class="line">  dingyi   'VPRSV'     '价格控制指示符'.</span><br><span class="line">  dingyi   'STPRS'     '价格'.</span><br><span class="line">  dingyi   'PEINH'     '价格单位'.</span><br><span class="line">  dingyi   'NCOST'  '无成本核算'.</span><br><span class="line">  dingyi   'EKALR'  '物料根据数量结构进行成本核算'.</span><br><span class="line">  dingyi   'LOSGR'  '批量产品成本核算'.</span><br><span class="line">  dingyi   'AWSLS'  '差异码'.</span><br><span class="line">  dingyi   'HKMAT'  '物料来源'.</span><br><span class="line">  dingyi   'PRCTR'     '利润中心'.</span><br><span class="line">  dingyi   'ERSDA'     '创建日期'.</span><br><span class="line"></span><br><span class="line">ENDFORM.</span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  SHOW_ALV</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*  --&gt;  p1        text</span></span><br><span class="line"><span class="comment">*  &lt;--  p2        text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="keyword">FORM</span> show_alv .</span><br><span class="line">  CALL FUNCTION 'REUSE_ALV_GRID_DISPLAY_LVC'</span><br><span class="line">    EXPORTING</span><br><span class="line"><span class="comment">*     I_INTERFACE_CHECK        = ' '</span></span><br><span class="line"><span class="comment">*     I_BYPASSING_BUFFER       =</span></span><br><span class="line"><span class="comment">*     I_BUFFER_ACTIVE          =</span></span><br><span class="line">      i_callback_program       = sy-repid</span><br><span class="line">      i_callback_pf_status_set = 'STATUS'</span><br><span class="line">      i_callback_user_command  = 'USER_COMMAND_01'</span><br><span class="line"><span class="comment">*     I_CALLBACK_TOP_OF_PAGE   = ' '</span></span><br><span class="line"><span class="comment">*     I_CALLBACK_HTML_TOP_OF_PAGE       = ' '</span></span><br><span class="line"><span class="comment">*     I_CALLBACK_HTML_END_OF_LIST       = ' '</span></span><br><span class="line"><span class="comment">*     I_STRUCTURE_NAME         =</span></span><br><span class="line"><span class="comment">*     I_BACKGROUND_ID          = ' '</span></span><br><span class="line"><span class="comment">*     I_GRID_TITLE             =</span></span><br><span class="line"><span class="comment">*     I_GRID_SETTINGS          =</span></span><br><span class="line">      is_layout_lvc            = ls_layout</span><br><span class="line">      it_fieldcat_lvc          = gt_field_cat[]</span><br><span class="line"><span class="comment">*     IT_EXCLUDING             =</span></span><br><span class="line"><span class="comment">*     IT_SPECIAL_GROUPS_LVC    =</span></span><br><span class="line"><span class="comment">*     IT_SORT_LVC              =</span></span><br><span class="line"><span class="comment">*     IT_FILTER_LVC            =</span></span><br><span class="line"><span class="comment">*     IT_HYPERLINK             =</span></span><br><span class="line"><span class="comment">*     IS_SEL_HIDE              =</span></span><br><span class="line"><span class="comment">*     I_DEFAULT                = 'X'</span></span><br><span class="line"><span class="comment">*     I_SAVE                   = ' '</span></span><br><span class="line"><span class="comment">*     IS_VARIANT               =</span></span><br><span class="line"><span class="comment">*     it_events                = ltd_event</span></span><br><span class="line"><span class="comment">*     IT_EVENT_EXIT            =</span></span><br><span class="line"><span class="comment">*     IS_PRINT_LVC             =</span></span><br><span class="line"><span class="comment">*     IS_REPREP_ID_LVC         =</span></span><br><span class="line"><span class="comment">*     I_SCREEN_START_COLUMN    = 0</span></span><br><span class="line"><span class="comment">*     I_SCREEN_START_LINE      = 0</span></span><br><span class="line"><span class="comment">*     I_SCREEN_END_COLUMN      = 0</span></span><br><span class="line"><span class="comment">*     I_SCREEN_END_LINE        = 0</span></span><br><span class="line"><span class="comment">*     I_HTML_HEIGHT_TOP        =</span></span><br><span class="line"><span class="comment">*     I_HTML_HEIGHT_END        =</span></span><br><span class="line"><span class="comment">*     IT_ALV_GRAPHICS          =</span></span><br><span class="line"><span class="comment">*     IT_EXCEPT_QINFO_LVC      =</span></span><br><span class="line"><span class="comment">*     IR_SALV_FULLSCREEN_ADAPTER        =</span></span><br><span class="line"><span class="comment">*   IMPORTING</span></span><br><span class="line"><span class="comment">*     E_EXIT_CAUSED_BY_CALLER  =</span></span><br><span class="line"><span class="comment">*     ES_EXIT_CAUSED_BY_USER   =</span></span><br><span class="line">    TABLES</span><br><span class="line">      t_outtab                 = it_mara[]</span><br><span class="line"><span class="comment">*   EXCEPTIONS</span></span><br><span class="line"><span class="comment">*     PROGRAM_ERROR            = 1</span></span><br><span class="line"><span class="comment">*     OTHERS                   = 2</span></span><br><span class="line">    .</span><br><span class="line">  <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line"><span class="comment">* Implement suitable error handling here</span></span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">FORM</span> status USING it_extab <span class="keyword">TYPE</span> slis_t_extab.</span><br><span class="line">  <span class="keyword">SET</span> PF-STATUS 'XRSJK'.</span><br><span class="line"><span class="comment">*  set TITLEBAR ''.</span></span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"><span class="comment">*usercommand</span></span><br><span class="line"><span class="keyword">FORM</span> user_command_01 USING uc <span class="keyword">TYPE</span> sy-ucomm</span><br><span class="line">      rs <span class="keyword">TYPE</span> slis_selfield.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  rs-refresh = 'X'.</span><br><span class="line">  CASE uc.</span><br><span class="line">    WHEN 'BACK'.</span><br><span class="line">      LEAVE TO SCREEN 0.</span><br><span class="line">      <span class="keyword">CLEAR</span>:it_mara[].</span><br><span class="line">    WHEN 'CHARK'.</span><br><span class="line">      PERFORM chark_data.</span><br><span class="line">      rs-refresh = 'X'.</span><br><span class="line">    WHEN '&amp;FOUN'.</span><br><span class="line">      <span class="keyword">READ</span> <span class="keyword">TABLE</span> it_mara WITH KEY <span class="keyword">type</span> = ''.</span><br><span class="line">      <span class="keyword">IF</span>  sy-subrc = 0.</span><br><span class="line">        MESSAGE '请先检查数据！' <span class="keyword">TYPE</span> '<span class="keyword">E</span>'.</span><br><span class="line">      ENDIF.</span><br><span class="line">      <span class="keyword">READ</span> <span class="keyword">TABLE</span> it_mara WITH KEY <span class="keyword">type</span> = '<span class="keyword">E</span>'.</span><br><span class="line">      <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line">        MESSAGE '有错误数据！' <span class="keyword">TYPE</span> '<span class="keyword">E</span>'.</span><br><span class="line">      ENDIF.</span><br><span class="line"><span class="comment">*      READ TABLE it_mara WITH KEY matnr = ''.</span></span><br><span class="line"><span class="comment">*      IF sy-subrc &lt;&gt;  0.</span></span><br><span class="line"><span class="comment">*        MESSAGE '已经创建！' TYPE 'E'.</span></span><br><span class="line"><span class="comment">*      ENDIF.</span></span><br><span class="line">      PERFORM bapa_mara.</span><br><span class="line">      rs-refresh = 'X'.</span><br><span class="line">  ENDCASE.</span><br><span class="line">ENDFORM.</span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  BAPA_MARA</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*  --&gt;  p1        text</span></span><br><span class="line"><span class="comment">*  &lt;--  p2        text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="keyword">FORM</span> bapa_mara .</span><br><span class="line">  <span class="keyword">IF</span> p1 = 'X'.</span><br><span class="line">    LOOP AT it_mara.</span><br><span class="line">      <span class="keyword">CLEAR</span> headdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> clientdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> clientdatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> plantdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> plantdatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> planningdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> planningdatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> storagelocationdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> storagelocationdatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> valuetiondata.</span><br><span class="line">      <span class="keyword">CLEAR</span> valuetiondatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> salesdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> salesdatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> materialdescription[].</span><br><span class="line">      <span class="keyword">CLEAR</span> unitsofmeasure[].</span><br><span class="line">      <span class="keyword">CLEAR</span> unitsofmeasurex[].</span><br><span class="line">      <span class="keyword">CLEAR</span> taxclassifications[].</span><br><span class="line">      <span class="keyword">CLEAR</span> pr_unit.</span><br><span class="line">      <span class="keyword">CLEAR</span> pr_unit2.</span><br><span class="line"><span class="comment">*自定义字段</span></span><br><span class="line">      <span class="keyword">CLEAR</span> w_extensionin.</span><br><span class="line">      REFRESH w_extensionin.</span><br><span class="line">      <span class="keyword">CLEAR</span> w_extensioninx.</span><br><span class="line">      REFRESH w_extensioninx.</span><br><span class="line">      <span class="keyword">CLEAR</span> zzbapi_te_mara.</span><br><span class="line">      <span class="keyword">CLEAR</span> zzbapi_te_marax.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      CALL FUNCTION 'CONVERSION_EXIT_CUNIT_INPUT'</span><br><span class="line">        EXPORTING</span><br><span class="line">          <span class="keyword">input</span>    = it_mara-meins</span><br><span class="line">          language = sy-langu</span><br><span class="line">        IMPORTING</span><br><span class="line"><span class="comment">*         LONG_TEXT      =</span></span><br><span class="line">          output   = pr_unit.</span><br><span class="line"></span><br><span class="line">      CALL FUNCTION 'CONVERSION_EXIT_CUNIT_INPUT'</span><br><span class="line">        EXPORTING</span><br><span class="line">          <span class="keyword">input</span>    = it_mara-gewei</span><br><span class="line">          language = sy-langu</span><br><span class="line">        IMPORTING</span><br><span class="line"><span class="comment">*         LONG_TEXT      =</span></span><br><span class="line">          output   = pr_unit2.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">IF</span> it_mara-matnr IS INITIAL.</span><br><span class="line">        <span class="keyword">CLEAR</span>:bapimatinr[],bapimatinr.</span><br><span class="line">        <span class="keyword">DO</span>.</span><br><span class="line">          CALL FUNCTION 'BAPI_STDMATERIAL_GETINTNUMBER'</span><br><span class="line">            EXPORTING</span><br><span class="line">              material_type    = it_mara-mtart</span><br><span class="line">              industry_sector  = ''</span><br><span class="line">              required_numbers = 1</span><br><span class="line">            IMPORTING</span><br><span class="line">              <span class="keyword">return</span>           = bapireturn1</span><br><span class="line">            TABLES</span><br><span class="line">              material_number  = bapimatinr[].</span><br><span class="line">          <span class="keyword">READ</span> <span class="keyword">TABLE</span> bapimatinr INDEX 1.</span><br><span class="line">          it_mara-matnr = bapimatinr-material.</span><br><span class="line">          <span class="keyword">IF</span> it_mara-matnr IS INITIAL .</span><br><span class="line">            <span class="keyword">CONTINUE</span>.</span><br><span class="line">          <span class="keyword">ELSE</span>.</span><br><span class="line">            <span class="keyword">EXIT</span>.</span><br><span class="line">          ENDIF.</span><br><span class="line">        ENDDO.</span><br><span class="line">        <span class="keyword">DO</span>.</span><br><span class="line">          "判断是否存在该物料</span><br><span class="line">          CALL FUNCTION 'BAPI_MATERIAL_EXISTENCECHECK'</span><br><span class="line">            EXPORTING</span><br><span class="line">              material = it_mara-matnr</span><br><span class="line"><span class="comment">*             MATERIAL_EVG        =</span></span><br><span class="line">            IMPORTING</span><br><span class="line"><span class="comment">*             DELETION_FLAG       =</span></span><br><span class="line">              <span class="keyword">return</span>   = return1.</span><br><span class="line">          <span class="keyword">IF</span> return1-<span class="keyword">type</span> <span class="keyword">EQ</span> 'S'.</span><br><span class="line">            it_mara-matnr = it_mara-matnr + 1.</span><br><span class="line">            <span class="keyword">CONTINUE</span>.</span><br><span class="line">          <span class="keyword">ELSE</span>.</span><br><span class="line">            <span class="keyword">EXIT</span>.</span><br><span class="line">          ENDIF.</span><br><span class="line">        ENDDO.</span><br><span class="line">        CALL FUNCTION 'CONVERSION_EXIT_ALPHA_INPUT'</span><br><span class="line">          EXPORTING</span><br><span class="line">            <span class="keyword">input</span>  = it_mara-matnr</span><br><span class="line">          IMPORTING</span><br><span class="line">            output = it_mara-matnr.</span><br><span class="line">      ENDIF.</span><br><span class="line">      <span class="keyword">IF</span> it_mara-matnr IS NOT INITIAL.</span><br><span class="line">        CALL FUNCTION 'CONVERSION_EXIT_ALPHA_INPUT'</span><br><span class="line">          EXPORTING</span><br><span class="line">            <span class="keyword">input</span>  = it_mara-matnr</span><br><span class="line">          IMPORTING</span><br><span class="line">            output = it_mara-matnr.</span><br><span class="line">      ENDIF.</span><br><span class="line">      "表头数据</span><br><span class="line">      headdata-material = it_mara-matnr.</span><br><span class="line">      headdata-ind_sector = it_mara-mbrsh."行业领域</span><br><span class="line">      headdata-matl_type = it_mara-mtart."物料类型</span><br><span class="line"></span><br><span class="line">      "基本数据视图</span><br><span class="line">      headdata-basic_view     = 'X'."基本数据视图</span><br><span class="line">      <span class="keyword">IF</span> it_mara-mtart = 'Z002' OR it_mara-mtart = 'Z004' OR it_mara-mtart = 'Z006'.</span><br><span class="line">        headdata-sales_view     = ''."销售视图</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line">        headdata-sales_view     = 'X'."销售视图</span><br><span class="line">      ENDIF.</span><br><span class="line">      headdata-purchase_view  = 'X'."采购视图</span><br><span class="line">      headdata-mrp_view       = 'X'."物料需求计划(MRP)视图</span><br><span class="line">      headdata-storage_view = 'X'."存储视图</span><br><span class="line">      headdata-warehouse_view = 'X'."存储视图</span><br><span class="line">      headdata-prt_view = 'X'."生产资源/工具(PRT)视图</span><br><span class="line">      headdata-account_view   = 'X'."会计视图</span><br><span class="line">      headdata-cost_view      = 'X'."成本视图</span><br><span class="line">      headdata-work_sched_view = 'X'."工作计划视图</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      "基本数据</span><br><span class="line">      clientdata-base_uom = pr_unit. "基本单位</span><br><span class="line">      clientdata-matl_group = it_mara-matkl."物料组</span><br><span class="line">      clientdata-old_mat_no = it_mara-bismt."旧物料编码</span><br><span class="line">      clientdata-extmatlgrp = it_mara-extwg."外部物料组</span><br><span class="line">      clientdata-net_weight = it_mara-ntgew."净重</span><br><span class="line">      clientdata-unit_of_wt = pr_unit2."重量单位</span><br><span class="line">      clientdata-size_dim = it_mara-groes."大小/量纲</span><br><span class="line">      clientdata-dsn_office = it_mara-labor."实验室/办公室</span><br><span class="line">      clientdata-division = it_mara-spart."产品组</span><br><span class="line">      clientdata-item_cat = it_mara-mtpos."项目类别组</span><br><span class="line">      clientdata-trans_grp = it_mara-tragr."运输组</span><br><span class="line">      clientdata-shelf_life = it_mara-mhdhb."总货架寿命</span><br><span class="line">      clientdata-minremlife = it_mara-mhdrz."最小剩余寿命</span><br><span class="line">      clientdata-batch_mgmt = it_mara-xchar."批量管理标识</span><br><span class="line"><span class="comment">**********************************************************************----</span></span><br><span class="line">      clientdata-pur_status = it_mara-mstae."跨工厂物料状态</span><br><span class="line"><span class="comment">**********************************************************************</span></span><br><span class="line"></span><br><span class="line">      clientdatax-base_uom = 'X'.</span><br><span class="line">      clientdatax-matl_group = 'X'.</span><br><span class="line">      clientdatax-old_mat_no = 'X'.</span><br><span class="line">      clientdatax-net_weight = 'X'.</span><br><span class="line">      clientdatax-unit_of_wt = 'X'.</span><br><span class="line">      clientdatax-size_dim = 'X'.</span><br><span class="line">      clientdatax-dsn_office = 'X'.</span><br><span class="line">      clientdatax-division = 'X'.</span><br><span class="line">      clientdatax-item_cat = 'X'.</span><br><span class="line">      clientdatax-trans_grp = 'X'.</span><br><span class="line">      clientdatax-shelf_life = 'X'.</span><br><span class="line">      clientdatax-minremlife = 'X'.</span><br><span class="line">      clientdatax-batch_mgmt = 'X'.</span><br><span class="line"><span class="comment">**********************************************************************----</span></span><br><span class="line">      clientdatax-pur_status = 'X'.</span><br><span class="line"><span class="comment">**********************************************************************</span></span><br><span class="line"></span><br><span class="line">      "工厂数据</span><br><span class="line">      plantdata-plant = it_mara-werks."工厂</span><br><span class="line">      plantdata-availcheck = it_mara-mtvfp."可用性检查</span><br><span class="line">      plantdata-loadinggrp = it_mara-ladgr."装载组</span><br><span class="line">      plantdata-pur_group = it_mara-ekgrp."采购组</span><br><span class="line">      plantdata-batch_mgmt = it_mara-xchar."批量管理标识</span><br><span class="line">      plantdata-auto_p_ord = it_mara-kautb.<span class="string">"标识: "</span>允许自动采购订单"</span><br><span class="line">      <span class="string">"plantdata-ind_post_to_insp_stock = it_mara-insmk."</span>过帐到检验库存</span><br><span class="line">      plantdata-mrp_type = it_mara-dismm."MRP类型</span><br><span class="line">      plantdata-mrp_ctrler = it_mara-dispo."MRP控制者</span><br><span class="line">      plantdata-lotsizekey = it_mara-disls."批量</span><br><span class="line">      plantdata-minlotsize = it_mara-bstmi."最小批量</span><br><span class="line">      plantdata-assy_scrap = it_mara-ausss."装配报废</span><br><span class="line">      plantdata-round_val = it_mara-bstrf."采购订单舍入值</span><br><span class="line">      plantdata-proc_type = it_mara-beskz."采购类型</span><br><span class="line">      plantdata-spproctype = it_mara-sobsl."特殊采购类型</span><br><span class="line">      plantdata-backflush = it_mara-rgekz."反冲</span><br><span class="line">      plantdata-iss_st_loc = it_mara-lgpro."生产仓储地点</span><br><span class="line">      plantdata-sloc_exprc = it_mara-lgfsb."外部采购仓储地点</span><br><span class="line">      plantdata-plnd_delry = it_mara-plifz."计划交货日期</span><br><span class="line">      plantdata-sm_key = it_mara-fhori."计划边际码</span><br><span class="line">      plantdata-safety_stk = it_mara-eisbe."安全库存</span><br><span class="line">      plantdata-plan_strgp = it_mara-strgr."计划策略组</span><br><span class="line">      plantdata-consummode = it_mara-vrmod."消耗模式</span><br><span class="line">      plantdata-bwd_cons = it_mara-vint1."逆向消耗期间</span><br><span class="line">      plantdata-fwd_cons = it_mara-vint2."前向消耗期间</span><br><span class="line">      plantdata-mixed_mrp = it_mara-miskz."综合mrp</span><br><span class="line">      plantdata-comp_scrap = it_mara-kausf."部件废品</span><br><span class="line">      plantdata-dep_req_id = it_mara-sbdkz."单独/集中</span><br><span class="line">      plantdata-production_scheduler = it_mara-fevor."生产管理员</span><br><span class="line">      plantdata-unlimited = it_mara-ueetk."允许未限制的过量交货</span><br><span class="line">      plantdata-over_tol = it_mara-ueeto."超量交货容差限制</span><br><span class="line">      plantdata-no_costing = it_mara-ncost."无成本核算</span><br><span class="line">      plantdata-lot_size = it_mara-losgr. "批量产品成本核算</span><br><span class="line">      plantdata-variance_key = it_mara-awsls."差异码</span><br><span class="line">      <span class="string">"plantdata-profit_ctr = it_mara-prctr."</span>利润中心</span><br><span class="line">      plantdata-bulk_mat = it_mara-schgt."散装物料</span><br><span class="line">      <span class="string">"plantdata-proc_time = it_mara-bearz."</span>处理时间</span><br><span class="line">      <span class="string">"plantdata-base_qty = it_mara-basmg."</span>基准数量</span><br><span class="line">      <span class="string">"plantdata-inhseprodt = it_mara-dzeit."</span>厂内生产时间</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      plantdatax-plant = it_mara-werks.</span><br><span class="line">      plantdatax-availcheck = 'X'.</span><br><span class="line">      plantdatax-loadinggrp = 'X'.</span><br><span class="line">      plantdatax-pur_group = 'X'.</span><br><span class="line">      plantdatax-batch_mgmt = 'X'.</span><br><span class="line">      plantdatax-auto_p_ord = 'X'.</span><br><span class="line">      "plantdatax-ind_post_to_insp_stock = 'X'.</span><br><span class="line">      plantdatax-mrp_type = 'X'.</span><br><span class="line">      plantdatax-mrp_ctrler = 'X'.</span><br><span class="line">      plantdatax-lotsizekey = 'X'.</span><br><span class="line">      plantdatax-minlotsize = 'X'.</span><br><span class="line">      plantdatax-assy_scrap = 'X'.</span><br><span class="line">      plantdatax-round_val = 'X'.</span><br><span class="line">      plantdatax-proc_type = 'X'.</span><br><span class="line">      plantdatax-spproctype = 'X'.</span><br><span class="line">      plantdatax-backflush = 'X'.</span><br><span class="line">      plantdatax-iss_st_loc = 'X'.</span><br><span class="line">      plantdatax-sloc_exprc = 'X'.</span><br><span class="line">      plantdatax-plnd_delry = 'X'.</span><br><span class="line">      plantdatax-sm_key = 'X'.</span><br><span class="line">      plantdatax-safety_stk = 'X'.</span><br><span class="line">      plantdatax-plan_strgp = 'X'.</span><br><span class="line">      plantdatax-consummode = 'X'.</span><br><span class="line">      plantdatax-bwd_cons = 'X'.</span><br><span class="line">      plantdatax-fwd_cons = 'X'.</span><br><span class="line">      plantdatax-mixed_mrp = 'X'.</span><br><span class="line">      plantdatax-comp_scrap = 'X'.</span><br><span class="line">      plantdatax-dep_req_id = 'X'.</span><br><span class="line">      plantdatax-production_scheduler = 'X'.</span><br><span class="line">      plantdatax-unlimited = 'X'.</span><br><span class="line">      plantdatax-over_tol = 'X'.</span><br><span class="line">      plantdatax-no_costing = 'X'.</span><br><span class="line">      plantdatax-lot_size = 'X'.</span><br><span class="line">      plantdatax-variance_key = 'X'.</span><br><span class="line">      plantdatax-profit_ctr = 'X'.</span><br><span class="line">      plantdatax-bulk_mat = 'X'.</span><br><span class="line">      plantdatax-<span class="keyword">proc_time</span> = 'X'.</span><br><span class="line">      plantdatax-base_qty = 'X'.</span><br><span class="line">      plantdatax-inhseprodt = 'X'.</span><br><span class="line"></span><br><span class="line">      "计划数据</span><br><span class="line">      planningdata-plant = it_mara-werks.</span><br><span class="line">      <span class="string">"planningdata-plng_matl = it_mara-prgrp."</span>计划物料</span><br><span class="line">      <span class="string">"planningdata-plng_plant = it_mara-prwrk."</span>计划工厂</span><br><span class="line">      <span class="string">"planningdata-convfactor = it_mara-umref."</span>计划转换因子</span><br><span class="line"></span><br><span class="line">      planningdatax-plant = it_mara-werks.</span><br><span class="line"><span class="comment">*      planningdatax-plng_matl = 'X'.</span></span><br><span class="line"><span class="comment">*      planningdatax-plng_plant = 'X'.</span></span><br><span class="line"><span class="comment">*      planningdatax-convfactor = 'X'.</span></span><br><span class="line"></span><br><span class="line">      "评估数据</span><br><span class="line">      valuetiondata-val_area = it_mara-bwkey."评估范围</span><br><span class="line"><span class="comment">*valuetiondata-val_cat = IT_MARA-bwtty."评估类别</span></span><br><span class="line">      valuetiondata-val_class = it_mara-bklas."评估类</span><br><span class="line">      valuetiondata-price_ctrl = it_mara-vprsv."价格控制</span><br><span class="line">      <span class="keyword">IF</span> it_mara-vprsv = 'V'.</span><br><span class="line"><span class="comment">*        valuetiondata-moving_pr = it_mara-stprs."移动平均价</span></span><br><span class="line"><span class="comment">*        valuetiondata-std_price = 0.</span></span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line"><span class="comment">*        valuetiondata-moving_pr = 0.</span></span><br><span class="line"><span class="comment">*        valuetiondata-std_price = it_mara-stprs."标准价格</span></span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*    valuetiondata-price_unit = IT_MARA-stprs."价格单位 PEINH</span></span><br><span class="line">      valuetiondata-price_unit = it_mara-peinh."价格单位</span><br><span class="line">      valuetiondata-qty_struct = it_mara-ekalr."物料根据数量结构进行成本核算</span><br><span class="line">      valuetiondata-orig_mat = it_mara-hkmat."物料来源</span><br><span class="line">      <span class="keyword">IF</span> it_mara-mtart = 'Z003'</span><br><span class="line">      OR it_mara-mtart = 'Z004'</span><br><span class="line">      OR it_mara-mtart = 'Z005'</span><br><span class="line">      OR it_mara-mtart = 'Z006'</span><br><span class="line">      OR it_mara-mtart = 'Z007'.</span><br><span class="line">        valuetiondata-ml_settle = '2'. "价格确定为2，价格控制为V</span><br><span class="line">        valuetiondata-price_ctrl = 'V'.</span><br><span class="line"></span><br><span class="line">      ENDIF.</span><br><span class="line">      valuetiondatax-val_area = it_mara-bwkey.</span><br><span class="line">      valuetiondatax-val_cat = 'X'."评估类别</span><br><span class="line">      valuetiondatax-val_class = 'X'.</span><br><span class="line">      valuetiondatax-price_ctrl = 'X'.</span><br><span class="line">      valuetiondatax-ml_settle = 'X'.</span><br><span class="line"><span class="comment">*    IF IT_MARA-vprsv = 'V'.</span></span><br><span class="line">      valuetiondatax-moving_pr = 'X'.</span><br><span class="line"><span class="comment">*    ELSE.</span></span><br><span class="line">      valuetiondatax-std_price = 'X'.</span><br><span class="line"><span class="comment">*    ENDIF.</span></span><br><span class="line">      valuetiondatax-price_unit = 'X'.</span><br><span class="line">      valuetiondatax-orig_mat = 'X'."物料来源</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      "销售数据</span><br><span class="line">      salesdata-sales_org = it_mara-vkorg."销售组织</span><br><span class="line">      salesdata-distr_chan = it_mara-vtweg."分销渠道</span><br><span class="line">      salesdata-acct_assgt = it_mara-ktgrm."科目设置组</span><br><span class="line">      salesdata-item_cat = it_mara-mtpos."项目类别组</span><br><span class="line"><span class="comment">**********************************************************************</span></span><br><span class="line">      salesdata-sales_unit = it_mara-vrkme. "销售单位</span><br><span class="line">      salesdata-delyg_plnt = it_mara-dwerk. "交货工厂</span><br><span class="line"><span class="comment">**********************************************************************</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      salesdatax-sales_org = it_mara-vkorg."销售组织</span><br><span class="line">      salesdatax-distr_chan = it_mara-vtweg."分销渠道</span><br><span class="line">      salesdatax-acct_assgt = 'X'.</span><br><span class="line">      salesdatax-item_cat = 'X'.</span><br><span class="line"><span class="comment">**********************************************************************</span></span><br><span class="line">      salesdatax-sales_unit = 'X'.</span><br><span class="line">      salesdatax-delyg_plnt = 'X'.</span><br><span class="line"><span class="comment">**********************************************************************</span></span><br><span class="line"></span><br><span class="line">      "税分类</span><br><span class="line">      taxclassifications-depcountry = 'CN'.</span><br><span class="line">      taxclassifications-tax_type_1 = 'MWST'.</span><br><span class="line">      taxclassifications-taxclass_1 = it_mara-taxkm. " 物料的税分类</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      <span class="keyword">APPEND</span> taxclassifications.</span><br><span class="line">      <span class="keyword">CLEAR</span> taxclassifications.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      "计量单位</span><br><span class="line">      unitsofmeasure-alt_unit = pr_unit.</span><br><span class="line">      "替换单位(必须为基本计量单位,否则会报错,说没有转换因子什么的)</span><br><span class="line">      unitsofmeasure-numerator = 1.    "分子</span><br><span class="line">      unitsofmeasure-denominatr = 1.    "分母</span><br><span class="line">      unitsofmeasure-gross_wt = it_mara-brgew."毛重</span><br><span class="line">      unitsofmeasure-ean_upc = it_mara-ean11."国际文件号</span><br><span class="line">      unitsofmeasure-unit_of_wt = pr_unit2.   "重量单位</span><br><span class="line">      "需要填充毛重的话,注意此处需要添加重量单位,否则会一直提示你没有指定单位</span><br><span class="line">      <span class="keyword">APPEND</span> unitsofmeasure.</span><br><span class="line">      <span class="keyword">CLEAR</span> unitsofmeasure.</span><br><span class="line"></span><br><span class="line">      unitsofmeasurex-alt_unit = pr_unit."注意此处不是填充'X'</span><br><span class="line">      unitsofmeasurex-numerator = 'X'.</span><br><span class="line">      unitsofmeasurex-denominatr = 'X'.</span><br><span class="line">      unitsofmeasurex-gross_wt = 'X'.</span><br><span class="line">      unitsofmeasurex-ean_upc = 'X'.</span><br><span class="line">      unitsofmeasurex-unit_of_wt = 'X'."此处填充'X'</span><br><span class="line">      <span class="keyword">IF</span> unitsofmeasurex-alt_unit</span><br><span class="line">      IS NOT INITIAL AND unitsofmeasurex-numerator</span><br><span class="line">      IS NOT INITIAL AND unitsofmeasurex-denominatr</span><br><span class="line">      IS NOT INITIAL.</span><br><span class="line">        <span class="keyword">APPEND</span> unitsofmeasurex.</span><br><span class="line">      ENDIF.</span><br><span class="line">      <span class="keyword">CLEAR</span> unitsofmeasurex.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      "物料描述</span><br><span class="line">      materialdescription-langu_iso = 'ZH'.</span><br><span class="line">      materialdescription-matl_desc = it_mara-maktx.</span><br><span class="line">      <span class="keyword">APPEND</span> materialdescription.</span><br><span class="line">      <span class="keyword">CLEAR</span> materialdescription.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">IF</span> it_mara-maktg IS NOT INITIAL.</span><br><span class="line">        materialdescription-langu_iso = 'ZH'.</span><br><span class="line">        materialdescription-matl_desc = it_mara-maktg.</span><br><span class="line">        <span class="keyword">APPEND</span> materialdescription.</span><br><span class="line">        <span class="keyword">CLEAR</span> materialdescription.</span><br><span class="line">      ENDIF.</span><br><span class="line">      "自定义扩展字段</span><br><span class="line">      zzbapi_te_mara-material = it_mara-matnr.</span><br><span class="line">      zzbapi_te_mara-zzmc = it_mara-zzmc.</span><br><span class="line">      zzbapi_te_mara-zzxh = it_mara-zzxh.</span><br><span class="line">      zzbapi_te_mara-zzys = it_mara-zzys.</span><br><span class="line">      zzbapi_te_mara-zzdcrl = it_mara-zzdcrl.</span><br><span class="line"></span><br><span class="line">      zzbapi_te_marax-material = it_mara-matnr.</span><br><span class="line">      zzbapi_te_marax-zzmc = 'X'.</span><br><span class="line">      zzbapi_te_marax-zzxh = 'X'.</span><br><span class="line">      zzbapi_te_marax-zzys = 'X'.</span><br><span class="line">      zzbapi_te_marax-zzdcrl = 'X'.</span><br><span class="line"></span><br><span class="line">      w_extensionin-structure = 'BAPI_TE_MARA'.</span><br><span class="line">      w_extensionin-valuepart1 = zzbapi_te_mara.</span><br><span class="line">      <span class="keyword">APPEND</span> w_extensionin.</span><br><span class="line">      w_extensioninx-structure = 'BAPI_TE_MARAX'.</span><br><span class="line">      w_extensioninx-valuepart1 = zzbapi_te_marax.</span><br><span class="line">      <span class="keyword">APPEND</span> w_extensioninx.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      <span class="keyword">IF</span> it_mara-mtart = 'Z002' OR it_mara-mtart = 'Z004' OR it_mara-mtart = 'Z006'.</span><br><span class="line">        <span class="keyword">CLEAR</span>: salesdata,salesdatax."Z002,Z004,Z006不维护销售视图</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line">      "调用BAPI</span><br><span class="line">      CALL FUNCTION 'BAPI_MATERIAL_SAVEDATA'</span><br><span class="line">        EXPORTING</span><br><span class="line">          headdata            = headdata</span><br><span class="line">          clientdata          = clientdata</span><br><span class="line">          clientdatax         = clientdatax</span><br><span class="line">          plantdata           = plantdata</span><br><span class="line">          plantdatax          = plantdatax</span><br><span class="line">          valuationdata       = valuetiondata</span><br><span class="line">          valuationdatax      = valuetiondatax</span><br><span class="line">          salesdata           = salesdata</span><br><span class="line">          salesdatax          = salesdatax</span><br><span class="line">        IMPORTING</span><br><span class="line">          <span class="keyword">return</span>              = <span class="literal">return</span></span><br><span class="line">        TABLES</span><br><span class="line">          materialdescription = materialdescription[]</span><br><span class="line">          unitsofmeasure      = unitsofmeasure[]</span><br><span class="line">          unitsofmeasurex     = unitsofmeasurex[]</span><br><span class="line">          taxclassifications  = taxclassifications[]</span><br><span class="line">          extensionin         = w_extensionin</span><br><span class="line">          extensioninx        = w_extensioninx.</span><br><span class="line">      <span class="keyword">IF</span> <span class="keyword">return</span>-<span class="keyword">type</span> = '<span class="keyword">E</span>'.</span><br><span class="line">        CALL FUNCTION 'BAPI_TRANSACTION_ROLLBACK'.</span><br><span class="line">        it_mara-<span class="keyword">type</span> = '<span class="keyword">E</span>'.</span><br><span class="line">        it_mara-message = <span class="keyword">return</span>-message.</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line">        CALL FUNCTION 'BAPI_TRANSACTION_COMMIT'</span><br><span class="line">          EXPORTING</span><br><span class="line">            wait = 'X'.</span><br><span class="line">        it_mara-<span class="keyword">type</span> = 'S'.</span><br><span class="line">        it_mara-message = '创建成功！'.</span><br><span class="line">        it_mara-ersda = sy-datum.</span><br><span class="line">        <span class="keyword">IF</span> it_mara-zeinr IS NOT INITIAL.</span><br><span class="line">          <span class="keyword">CLEAR</span> headdata.</span><br><span class="line">          <span class="keyword">CLEAR</span> clientdata.</span><br><span class="line">          <span class="keyword">CLEAR</span> clientdatax.</span><br><span class="line">          <span class="keyword">CLEAR</span> plantdata.</span><br><span class="line">          <span class="keyword">CLEAR</span> plantdatax.</span><br><span class="line">          <span class="keyword">CLEAR</span> planningdata.</span><br><span class="line">          <span class="keyword">CLEAR</span> planningdatax.</span><br><span class="line">          <span class="keyword">CLEAR</span> storagelocationdata.</span><br><span class="line">          <span class="keyword">CLEAR</span> storagelocationdatax.</span><br><span class="line">          <span class="keyword">CLEAR</span> valuetiondata.</span><br><span class="line">          <span class="keyword">CLEAR</span> valuetiondatax.</span><br><span class="line">          <span class="keyword">CLEAR</span> salesdata.</span><br><span class="line">          <span class="keyword">CLEAR</span> salesdatax.</span><br><span class="line">          <span class="keyword">CLEAR</span> materialdescription[].</span><br><span class="line">          <span class="keyword">CLEAR</span> unitsofmeasure[].</span><br><span class="line">          <span class="keyword">CLEAR</span> unitsofmeasurex[].</span><br><span class="line">          <span class="keyword">CLEAR</span> taxclassifications[].</span><br><span class="line">          <span class="keyword">CLEAR</span> pr_unit.</span><br><span class="line">          <span class="keyword">CLEAR</span> pr_unit2.</span><br><span class="line">          "表头数据</span><br><span class="line">          <span class="keyword">CLEAR</span>: n_matnr,o_matnr.</span><br><span class="line"></span><br><span class="line">          CALL FUNCTION 'CONVERSION_EXIT_ALPHA_INPUT'</span><br><span class="line">            EXPORTING</span><br><span class="line">              <span class="keyword">input</span>  = it_mara-zeinr</span><br><span class="line">            IMPORTING</span><br><span class="line">              output = n_matnr.</span><br><span class="line">          CALL FUNCTION 'CONVERSION_EXIT_ALPHA_INPUT'</span><br><span class="line">            EXPORTING</span><br><span class="line">              <span class="keyword">input</span>  = it_mara-matnr</span><br><span class="line">            IMPORTING</span><br><span class="line">              output = o_matnr.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">          headdata-material = n_matnr.</span><br><span class="line"></span><br><span class="line">          "基本数据视图</span><br><span class="line">          headdata-basic_view     = 'X'."基本数据视图</span><br><span class="line"></span><br><span class="line">          clientdata-document = o_matnr.</span><br><span class="line">          clientdatax-document = 'X'.</span><br><span class="line">          "调用BAPI</span><br><span class="line">          CALL FUNCTION 'BAPI_MATERIAL_SAVEDATA'</span><br><span class="line">            EXPORTING</span><br><span class="line">              headdata    = headdata</span><br><span class="line">              clientdata  = clientdata</span><br><span class="line">              clientdatax = clientdatax</span><br><span class="line">            IMPORTING</span><br><span class="line">              <span class="keyword">return</span>      = <span class="keyword">return</span>.</span><br><span class="line">          <span class="keyword">IF</span> <span class="keyword">return</span>-<span class="keyword">type</span> = '<span class="keyword">E</span>'.</span><br><span class="line">            CALL FUNCTION 'BAPI_TRANSACTION_ROLLBACK'.</span><br><span class="line"><span class="comment">*          write :/ return-type,return-message.</span></span><br><span class="line">          <span class="keyword">ELSE</span>.</span><br><span class="line">            CALL FUNCTION 'BAPI_TRANSACTION_COMMIT'</span><br><span class="line">              EXPORTING</span><br><span class="line">                wait = 'X'.</span><br><span class="line">          ENDIF.</span><br><span class="line">        ENDIF.</span><br><span class="line">      ENDIF.</span><br><span class="line">      MODIFY it_mara TRANSPORTING matnr <span class="keyword">type</span> message ersda.</span><br><span class="line">    ENDLOOP.</span><br><span class="line">  ELSEIF p2 = 'X'.</span><br><span class="line">    LOOP AT it_mara.</span><br><span class="line">      <span class="keyword">CLEAR</span> headdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> clientdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> clientdatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> plantdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> plantdatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> planningdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> planningdatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> storagelocationdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> storagelocationdatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> valuetiondata.</span><br><span class="line">      <span class="keyword">CLEAR</span> valuetiondatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> salesdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> salesdatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> materialdescription[].</span><br><span class="line">      <span class="keyword">CLEAR</span> unitsofmeasure[].</span><br><span class="line">      <span class="keyword">CLEAR</span> unitsofmeasurex[].</span><br><span class="line">      <span class="keyword">CLEAR</span> taxclassifications[].</span><br><span class="line">      <span class="keyword">CLEAR</span> pr_unit.</span><br><span class="line">      <span class="keyword">CLEAR</span> pr_unit2.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      CALL FUNCTION 'CONVERSION_EXIT_CUNIT_INPUT'</span><br><span class="line">        EXPORTING</span><br><span class="line">          <span class="keyword">input</span>    = it_mara-meins</span><br><span class="line">          language = sy-langu</span><br><span class="line">        IMPORTING</span><br><span class="line"><span class="comment">*         LONG_TEXT      =</span></span><br><span class="line">          output   = pr_unit.</span><br><span class="line"></span><br><span class="line">      CALL FUNCTION 'CONVERSION_EXIT_CUNIT_INPUT'</span><br><span class="line">        EXPORTING</span><br><span class="line">          <span class="keyword">input</span>    = it_mara-gewei</span><br><span class="line">          language = sy-langu</span><br><span class="line">        IMPORTING</span><br><span class="line"><span class="comment">*         LONG_TEXT      =</span></span><br><span class="line">          output   = pr_unit2.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">IF</span> it_mara-matnr IS INITIAL.</span><br><span class="line">        <span class="keyword">CLEAR</span>:bapimatinr[],bapimatinr.</span><br><span class="line">        <span class="keyword">DO</span>.</span><br><span class="line">          CALL FUNCTION 'BAPI_STDMATERIAL_GETINTNUMBER'</span><br><span class="line">            EXPORTING</span><br><span class="line">              material_type    = it_mara-mtart</span><br><span class="line">              industry_sector  = ''</span><br><span class="line">              required_numbers = 1</span><br><span class="line">            IMPORTING</span><br><span class="line">              <span class="keyword">return</span>           = bapireturn1</span><br><span class="line">            TABLES</span><br><span class="line">              material_number  = bapimatinr[].</span><br><span class="line">          <span class="keyword">READ</span> <span class="keyword">TABLE</span> bapimatinr INDEX 1.</span><br><span class="line">          it_mara-matnr = bapimatinr-material.</span><br><span class="line">          <span class="keyword">IF</span> it_mara-matnr IS INITIAL .</span><br><span class="line">            <span class="keyword">CONTINUE</span>.</span><br><span class="line">          <span class="keyword">ELSE</span>.</span><br><span class="line">            <span class="keyword">EXIT</span>.</span><br><span class="line">          ENDIF.</span><br><span class="line">        ENDDO.</span><br><span class="line">        <span class="keyword">DO</span>.</span><br><span class="line">          "判断是否存在该物料</span><br><span class="line">          CALL FUNCTION 'BAPI_MATERIAL_EXISTENCECHECK'</span><br><span class="line">            EXPORTING</span><br><span class="line">              material = it_mara-matnr</span><br><span class="line"><span class="comment">*             MATERIAL_EVG        =</span></span><br><span class="line">            IMPORTING</span><br><span class="line"><span class="comment">*             DELETION_FLAG       =</span></span><br><span class="line">              <span class="keyword">return</span>   = return1.</span><br><span class="line">          <span class="keyword">IF</span> return1-<span class="keyword">type</span> <span class="keyword">EQ</span> 'S'.</span><br><span class="line">            it_mara-matnr = it_mara-matnr + 1.</span><br><span class="line">            <span class="keyword">CONTINUE</span>.</span><br><span class="line">          <span class="keyword">ELSE</span>.</span><br><span class="line">            <span class="keyword">EXIT</span>.</span><br><span class="line">          ENDIF.</span><br><span class="line">        ENDDO.</span><br><span class="line">        CALL FUNCTION 'CONVERSION_EXIT_ALPHA_INPUT'</span><br><span class="line">          EXPORTING</span><br><span class="line">            <span class="keyword">input</span>  = it_mara-matnr</span><br><span class="line">          IMPORTING</span><br><span class="line">            output = it_mara-matnr.</span><br><span class="line">      ENDIF.</span><br><span class="line">      "表头数据</span><br><span class="line">      headdata-material = it_mara-matnr.</span><br><span class="line">      headdata-ind_sector = it_mara-mbrsh."行业领域</span><br><span class="line">      headdata-matl_type = it_mara-mtart."物料类型</span><br><span class="line"></span><br><span class="line">      "基本数据视图</span><br><span class="line">      headdata-basic_view     = 'X'."基本数据视图</span><br><span class="line"><span class="comment">*    headdata-sales_view     = 'X'."销售视图</span></span><br><span class="line"><span class="comment">*      headdata-purchase_view  = 'X'."采购视图</span></span><br><span class="line"><span class="comment">*    headdata-mrp_view       = 'X'."物料需求计划(MRP)视图</span></span><br><span class="line"><span class="comment">*    headdata-storage_view = 'X'."存储视图</span></span><br><span class="line"><span class="comment">*    headdata-warehouse_view = 'X'."存储视图</span></span><br><span class="line"><span class="comment">*    headdata-prt_view = 'X'."生产资源/工具(PRT)视图</span></span><br><span class="line"><span class="comment">*    headdata-account_view   = 'X'."会计视图</span></span><br><span class="line"><span class="comment">*    headdata-cost_view      = 'X'."成本视图</span></span><br><span class="line"><span class="comment">*    headdata-work_sched_view = 'X'."工作计划视图</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      "基本数据</span><br><span class="line">      clientdata-base_uom = pr_unit. "基本单位</span><br><span class="line">      clientdata-matl_group = it_mara-matkl."物料组</span><br><span class="line">      clientdata-old_mat_no = it_mara-bismt."旧物料编码</span><br><span class="line">      clientdata-net_weight = it_mara-ntgew."净重</span><br><span class="line">      clientdata-unit_of_wt = pr_unit2."重量单位</span><br><span class="line">      clientdata-size_dim = it_mara-groes."大小/量纲</span><br><span class="line">      clientdata-dsn_office = it_mara-labor."实验室/办公室</span><br><span class="line">      <span class="keyword">IF</span> it_mara-mtart <span class="keyword">EQ</span> 'Z009'..</span><br><span class="line">        clientdata-division = it_mara-spart."产品组</span><br><span class="line">      ENDIF.</span><br><span class="line"><span class="comment">*      clientdata-item_cat = it_mara-mtpos."项目类别组</span></span><br><span class="line"><span class="comment">*      clientdata-trans_grp = it_mara-tragr."运输组</span></span><br><span class="line"><span class="comment">*      clientdata-shelf_life = it_mara-mhdhb."总货架寿命</span></span><br><span class="line"><span class="comment">*      clientdata-minremlife = it_mara-mhdrz."最小剩余寿命</span></span><br><span class="line"><span class="comment">*      clientdata-batch_mgmt = it_mara-xchar."批量管理标识</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      clientdatax-base_uom = 'X'.</span><br><span class="line">      clientdatax-matl_group = 'X'.</span><br><span class="line">      clientdatax-old_mat_no = 'X'.</span><br><span class="line">      clientdatax-net_weight = 'X'.</span><br><span class="line">      clientdatax-unit_of_wt = 'X'.</span><br><span class="line">      clientdatax-size_dim = 'X'.</span><br><span class="line">      clientdatax-dsn_office = 'X'.</span><br><span class="line">      <span class="keyword">IF</span> it_mara-mtart <span class="keyword">EQ</span> 'Z009'..</span><br><span class="line">        clientdatax-division = 'X'.</span><br><span class="line">      ENDIF.</span><br><span class="line"><span class="comment">*      clientdatax-item_cat = 'X'.</span></span><br><span class="line"><span class="comment">*      clientdatax-trans_grp = 'X'.</span></span><br><span class="line"><span class="comment">*      clientdatax-shelf_life = 'X'.</span></span><br><span class="line"><span class="comment">*      clientdatax-minremlife = 'X'.</span></span><br><span class="line"><span class="comment">*      clientdatax-batch_mgmt = 'X'.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      "工厂数据</span><br><span class="line"><span class="comment">*      plantdata-plant = it_mara-werks."工厂</span></span><br><span class="line"><span class="comment">*      plantdata-availcheck = it_mara-mtvfp."可用性检查</span></span><br><span class="line"><span class="comment">*      plantdata-loadinggrp = it_mara-ladgr."装载组</span></span><br><span class="line"><span class="comment">*      plantdata-pur_group = it_mara-ekgrp."采购组</span></span><br><span class="line"><span class="comment">*      plantdata-batch_mgmt = it_mara-xchar."批量管理标识</span></span><br><span class="line"><span class="comment">*      plantdata-auto_p_ord = it_mara-kautb."标识: "允许自动采购订单"</span></span><br><span class="line"><span class="comment">*      plantdata-ind_post_to_insp_stock = it_mara-insmk."过帐到检验库存</span></span><br><span class="line"><span class="comment">*      plantdata-mrp_type = it_mara-dismm."MRP类型</span></span><br><span class="line"><span class="comment">*      plantdata-mrp_ctrler = it_mara-dispo."MRP控制者</span></span><br><span class="line"><span class="comment">*      plantdata-lotsizekey = it_mara-disls."批量</span></span><br><span class="line"><span class="comment">*      plantdata-minlotsize = it_mara-bstmi."最小批量</span></span><br><span class="line"><span class="comment">*      plantdata-assy_scrap = it_mara-ausss."装配报废</span></span><br><span class="line"><span class="comment">*      plantdata-round_val = it_mara-bstrf."采购订单舍入值</span></span><br><span class="line"><span class="comment">*      plantdata-proc_type = it_mara-beskz."采购类型</span></span><br><span class="line"><span class="comment">*      plantdata-spproctype = it_mara-sobsl."特殊采购类型</span></span><br><span class="line"><span class="comment">*      plantdata-backflush = it_mara-rgekz."反冲</span></span><br><span class="line"><span class="comment">*      plantdata-iss_st_loc = it_mara-lgpro."生产仓储地点</span></span><br><span class="line"><span class="comment">*      plantdata-sloc_exprc = it_mara-lgfsb."外部采购仓储地点</span></span><br><span class="line"><span class="comment">*      plantdata-plnd_delry = it_mara-plifz."计划交货日期</span></span><br><span class="line"><span class="comment">*      plantdata-sm_key = it_mara-fhori."计划边际码</span></span><br><span class="line"><span class="comment">*      plantdata-safety_stk = it_mara-eisbe."安全库存</span></span><br><span class="line"><span class="comment">*      plantdata-plan_strgp = it_mara-strgr."计划策略组</span></span><br><span class="line"><span class="comment">*      plantdata-consummode = it_mara-vrmod."消耗模式</span></span><br><span class="line"><span class="comment">*      plantdata-bwd_cons = it_mara-vint1."逆向消耗期间</span></span><br><span class="line"><span class="comment">*      plantdata-fwd_cons = it_mara-vint2."前向消耗期间</span></span><br><span class="line"><span class="comment">*      plantdata-comp_scrap = it_mara-kausf."部件废品</span></span><br><span class="line"><span class="comment">*      plantdata-dep_req_id = it_mara-sbdkz."单独/集中</span></span><br><span class="line"><span class="comment">*      plantdata-production_scheduler = it_mara-fevor."生产管理员</span></span><br><span class="line"><span class="comment">*      plantdata-unlimited = it_mara-ueetk."允许未限制的过量交货</span></span><br><span class="line"><span class="comment">*      plantdata-over_tol = it_mara-ueeto."超量交货容差限制</span></span><br><span class="line"><span class="comment">*      plantdata-no_costing = it_mara-ncost."无成本核算</span></span><br><span class="line"><span class="comment">*      plantdata-lot_size = it_mara-losgr. "批量产品成本核算</span></span><br><span class="line"><span class="comment">*      plantdata-variance_key = it_mara-awsls."差异码</span></span><br><span class="line"><span class="comment">*      plantdata-profit_ctr = it_mara-prctr."利润中心</span></span><br><span class="line"><span class="comment">*      plantdata-lot_size = it_mara-peinh."价格单位</span></span><br><span class="line"><span class="comment">*      plantdata-bulk_mat = it_mara-schgt."散装物料</span></span><br><span class="line"><span class="comment">*      plantdata-proc_time = it_mara-bearz."处理时间</span></span><br><span class="line"><span class="comment">*      plantdata-base_qty = it_mara-basmg."基准数量</span></span><br><span class="line"><span class="comment">*      plantdata-inhseprodt = it_matnr-dzeit."厂内生产时间</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*      plantdatax-plant = it_mara-werks.</span></span><br><span class="line"><span class="comment">*      plantdatax-availcheck = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-loadinggrp = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-pur_group = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-batch_mgmt = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-auto_p_ord = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-ind_post_to_insp_stock = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-mrp_type = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-mrp_ctrler = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-lotsizekey = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-minlotsize = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-assy_scrap = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-round_val = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-proc_type = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-spproctype = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-backflush = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-iss_st_loc = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-sloc_exprc = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-plnd_delry = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-sm_key = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-safety_stk = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-plan_strgp = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-consummode = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-bwd_cons = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-fwd_cons = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-comp_scrap = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-dep_req_id = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-production_scheduler = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-unlimited = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-over_tol = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-no_costing = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-lot_size = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-variance_key = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-profit_ctr = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-lot_size = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-bulk_mat = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-proc_time = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-base_qty = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdata-inhseprodt = 'X'.</span></span><br><span class="line"></span><br><span class="line">      "计划数据</span><br><span class="line"><span class="comment">*      planningdata-plant = it_mara-werks.</span></span><br><span class="line"><span class="comment">*      planningdata-plng_matl = it_mara-prgrp."计划物料</span></span><br><span class="line"><span class="comment">*      planningdata-plng_plant = it_mara-prwrk."计划工厂</span></span><br><span class="line"><span class="comment">*      planningdata-convfactor = it_mara-umref."计划转换因子</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*      planningdatax-plant = it_mara-werks.</span></span><br><span class="line"><span class="comment">*      planningdatax-plng_matl = 'X'.</span></span><br><span class="line"><span class="comment">*      planningdatax-plng_plant = 'X'.</span></span><br><span class="line"><span class="comment">*      planningdatax-convfactor = 'X'.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*      "评估数据</span></span><br><span class="line"><span class="comment">*      valuetiondata-val_area = it_mara-werks."评估范围</span></span><br><span class="line"><span class="comment">**    valuetiondata-val_cat = IT_MARA-bwtty."评估类别</span></span><br><span class="line"><span class="comment">*      valuetiondata-val_class = it_mara-bklas."评估类</span></span><br><span class="line"><span class="comment">*      valuetiondata-price_ctrl = it_mara-vprsv."价格控制</span></span><br><span class="line"><span class="comment">*      IF it_mara-vprsv = 'V'.</span></span><br><span class="line"><span class="comment">*        valuetiondata-moving_pr = it_mara-stprs."移动平均价</span></span><br><span class="line"><span class="comment">*        valuetiondata-std_price = 0.</span></span><br><span class="line"><span class="comment">*      ELSE.</span></span><br><span class="line"><span class="comment">*        valuetiondata-moving_pr = 0.</span></span><br><span class="line"><span class="comment">*        valuetiondata-std_price = it_mara-stprs."标准价格</span></span><br><span class="line"><span class="comment">*      ENDIF.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">**    valuetiondata-price_unit = IT_MARA-stprs."价格单位 PEINH</span></span><br><span class="line"><span class="comment">*      valuetiondata-price_unit = it_mara-peinh.</span></span><br><span class="line"><span class="comment">*      valuetiondata-qty_struct = it_mara-ekalr."物料根据数量结构进行成本核算</span></span><br><span class="line"><span class="comment">*      valuetiondata-orig_mat = it_mara-hkmat."物料来源</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*      valuetiondatax-val_area = it_mara-werks.</span></span><br><span class="line"><span class="comment">**    valuetiondatax-val_cat = 'X'."评估类别</span></span><br><span class="line"><span class="comment">*      valuetiondatax-val_class = 'X'.</span></span><br><span class="line"><span class="comment">*      valuetiondatax-price_ctrl = 'X'.</span></span><br><span class="line"><span class="comment">**    IF IT_MARA-vprsv = 'V'.</span></span><br><span class="line"><span class="comment">*      valuetiondatax-moving_pr = 'X'.</span></span><br><span class="line"><span class="comment">**    ELSE.</span></span><br><span class="line"><span class="comment">*      valuetiondatax-std_price = 'X'.</span></span><br><span class="line"><span class="comment">**    ENDIF.</span></span><br><span class="line"><span class="comment">*      valuetiondatax-price_unit = 'X'.</span></span><br><span class="line"><span class="comment">*      valuetiondatax-orig_mat = 'X'."物料来源</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*      "销售数据</span></span><br><span class="line"><span class="comment">*      salesdata-sales_org = it_mara-vkorg."销售组织</span></span><br><span class="line"><span class="comment">*      salesdata-distr_chan = it_mara-vtweg."分销渠道</span></span><br><span class="line"><span class="comment">*      salesdata-acct_assgt = it_mara-ktgrm."科目设置组</span></span><br><span class="line"><span class="comment">*      salesdata-item_cat = it_mara-mtpos.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*      salesdatax-sales_org = it_mara-vkorg."销售组织</span></span><br><span class="line"><span class="comment">*      salesdatax-distr_chan = it_mara-vtweg."分销渠道</span></span><br><span class="line"><span class="comment">*      salesdatax-acct_assgt = 'X'.</span></span><br><span class="line"><span class="comment">*      salesdatax-item_cat = 'X'.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*      "税分类</span></span><br><span class="line"><span class="comment">*      taxclassifications-depcountry = 'CN'.</span></span><br><span class="line"><span class="comment">*      taxclassifications-tax_type_1 = 'MWST'.</span></span><br><span class="line"><span class="comment">*      taxclassifications-taxclass_1 = it_mara-taxkm.</span></span><br><span class="line"><span class="comment">*      APPEND taxclassifications.</span></span><br><span class="line"><span class="comment">*      CLEAR taxclassifications.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      "计量单位</span><br><span class="line">      unitsofmeasure-alt_unit = pr_unit.</span><br><span class="line">      "替换单位(必须为基本计量单位,否则会报错,说没有转换因子什么的)</span><br><span class="line">      unitsofmeasure-numerator = 1.    "分子</span><br><span class="line">      unitsofmeasure-denominatr = 1.    "分母</span><br><span class="line">      unitsofmeasure-gross_wt = it_mara-brgew."毛重</span><br><span class="line">      unitsofmeasure-ean_upc = it_mara-ean11."国际文件号</span><br><span class="line">      unitsofmeasure-unit_of_wt = pr_unit2.   "重量单位</span><br><span class="line">      "需要填充毛重的话,注意此处需要添加重量单位,否则会一直提示你没有指定单位</span><br><span class="line">      <span class="keyword">APPEND</span> unitsofmeasure.</span><br><span class="line">      <span class="keyword">CLEAR</span> unitsofmeasure.</span><br><span class="line"></span><br><span class="line">      unitsofmeasurex-alt_unit = pr_unit."注意此处不是填充'X'</span><br><span class="line">      unitsofmeasurex-numerator = 'X'.</span><br><span class="line">      unitsofmeasurex-denominatr = 'X'.</span><br><span class="line">      unitsofmeasurex-gross_wt = 'X'.</span><br><span class="line">      unitsofmeasurex-ean_upc = 'X'.</span><br><span class="line">      unitsofmeasurex-unit_of_wt = 'X'."此处填充'X'</span><br><span class="line">      <span class="keyword">IF</span> unitsofmeasurex-alt_unit</span><br><span class="line">      IS NOT INITIAL AND unitsofmeasurex-numerator</span><br><span class="line">      IS NOT INITIAL AND unitsofmeasurex-denominatr</span><br><span class="line">      IS NOT INITIAL.</span><br><span class="line">        <span class="keyword">APPEND</span> unitsofmeasurex.</span><br><span class="line">      ENDIF.</span><br><span class="line">      <span class="keyword">CLEAR</span> unitsofmeasurex.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      "物料描述</span><br><span class="line">      materialdescription-langu_iso = 'ZH'.</span><br><span class="line">      materialdescription-matl_desc = it_mara-maktx.</span><br><span class="line">      <span class="keyword">APPEND</span> materialdescription.</span><br><span class="line">      <span class="keyword">CLEAR</span> materialdescription.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">IF</span> it_mara-maktg IS NOT INITIAL.</span><br><span class="line">        materialdescription-langu_iso = 'ZH'.</span><br><span class="line">        materialdescription-matl_desc = it_mara-maktg.</span><br><span class="line">        <span class="keyword">APPEND</span> materialdescription.</span><br><span class="line">        <span class="keyword">CLEAR</span> materialdescription.</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line">      "调用BAPI</span><br><span class="line">      CALL FUNCTION 'BAPI_MATERIAL_SAVEDATA'</span><br><span class="line">        EXPORTING</span><br><span class="line">          headdata            = headdata</span><br><span class="line">          clientdata          = clientdata</span><br><span class="line">          clientdatax         = clientdatax</span><br><span class="line">          plantdata           = plantdata</span><br><span class="line">          plantdatax          = plantdatax</span><br><span class="line">          valuationdata       = valuetiondata</span><br><span class="line">          valuationdatax      = valuetiondatax</span><br><span class="line">          salesdata           = salesdata</span><br><span class="line">          salesdatax          = salesdatax</span><br><span class="line">        IMPORTING</span><br><span class="line">          <span class="keyword">return</span>              = <span class="literal">return</span></span><br><span class="line">        TABLES</span><br><span class="line">          materialdescription = materialdescription[]</span><br><span class="line">          unitsofmeasure      = unitsofmeasure[]</span><br><span class="line">          unitsofmeasurex     = unitsofmeasurex[]</span><br><span class="line">          taxclassifications  = taxclassifications[].</span><br><span class="line">      <span class="keyword">IF</span> <span class="keyword">return</span>-<span class="keyword">type</span> = '<span class="keyword">E</span>'.</span><br><span class="line">        CALL FUNCTION 'BAPI_TRANSACTION_ROLLBACK'.</span><br><span class="line">        it_mara-<span class="keyword">type</span> = '<span class="keyword">E</span>'.</span><br><span class="line">        it_mara-message = <span class="keyword">return</span>-message.</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line">        CALL FUNCTION 'BAPI_TRANSACTION_COMMIT'</span><br><span class="line">          EXPORTING</span><br><span class="line">            wait = 'X'.</span><br><span class="line">        it_mara-<span class="keyword">type</span> = 'S'.</span><br><span class="line">        it_mara-message = '创建成功！'.</span><br><span class="line">        it_mara-ersda = sy-datum.</span><br><span class="line">        <span class="keyword">IF</span> it_mara-zeinr IS NOT INITIAL.</span><br><span class="line">          <span class="keyword">CLEAR</span> headdata.</span><br><span class="line">          <span class="keyword">CLEAR</span> clientdata.</span><br><span class="line">          <span class="keyword">CLEAR</span> clientdatax.</span><br><span class="line">          <span class="keyword">CLEAR</span> plantdata.</span><br><span class="line">          <span class="keyword">CLEAR</span> plantdatax.</span><br><span class="line">          <span class="keyword">CLEAR</span> planningdata.</span><br><span class="line">          <span class="keyword">CLEAR</span> planningdatax.</span><br><span class="line">          <span class="keyword">CLEAR</span> storagelocationdata.</span><br><span class="line">          <span class="keyword">CLEAR</span> storagelocationdatax.</span><br><span class="line">          <span class="keyword">CLEAR</span> valuetiondata.</span><br><span class="line">          <span class="keyword">CLEAR</span> valuetiondatax.</span><br><span class="line">          <span class="keyword">CLEAR</span> salesdata.</span><br><span class="line">          <span class="keyword">CLEAR</span> salesdatax.</span><br><span class="line">          <span class="keyword">CLEAR</span> materialdescription[].</span><br><span class="line">          <span class="keyword">CLEAR</span> unitsofmeasure[].</span><br><span class="line">          <span class="keyword">CLEAR</span> unitsofmeasurex[].</span><br><span class="line">          <span class="keyword">CLEAR</span> taxclassifications[].</span><br><span class="line">          <span class="keyword">CLEAR</span> pr_unit.</span><br><span class="line">          <span class="keyword">CLEAR</span> pr_unit2.</span><br><span class="line">          "表头数据</span><br><span class="line">          <span class="keyword">CLEAR</span>: n_matnr,o_matnr.</span><br><span class="line"></span><br><span class="line">          CALL FUNCTION 'CONVERSION_EXIT_ALPHA_INPUT'</span><br><span class="line">            EXPORTING</span><br><span class="line">              <span class="keyword">input</span>  = it_mara-zeinr</span><br><span class="line">            IMPORTING</span><br><span class="line">              output = n_matnr.</span><br><span class="line">          CALL FUNCTION 'CONVERSION_EXIT_ALPHA_INPUT'</span><br><span class="line">            EXPORTING</span><br><span class="line">              <span class="keyword">input</span>  = it_mara-matnr</span><br><span class="line">            IMPORTING</span><br><span class="line">              output = o_matnr.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">          headdata-material = n_matnr.</span><br><span class="line"></span><br><span class="line">          "基本数据视图</span><br><span class="line">          headdata-basic_view     = 'X'."基本数据视图</span><br><span class="line"></span><br><span class="line">          clientdata-document = o_matnr.</span><br><span class="line">          clientdatax-document = 'X'.</span><br><span class="line">          "调用BAPI</span><br><span class="line">          CALL FUNCTION 'BAPI_MATERIAL_SAVEDATA'</span><br><span class="line">            EXPORTING</span><br><span class="line">              headdata    = headdata</span><br><span class="line">              clientdata  = clientdata</span><br><span class="line">              clientdatax = clientdatax</span><br><span class="line">            IMPORTING</span><br><span class="line">              <span class="keyword">return</span>      = <span class="keyword">return</span>.</span><br><span class="line">          <span class="keyword">IF</span> <span class="keyword">return</span>-<span class="keyword">type</span> = '<span class="keyword">E</span>'.</span><br><span class="line">            CALL FUNCTION 'BAPI_TRANSACTION_ROLLBACK'.</span><br><span class="line"><span class="comment">*          write :/ return-type,return-message.</span></span><br><span class="line">          <span class="keyword">ELSE</span>.</span><br><span class="line">            CALL FUNCTION 'BAPI_TRANSACTION_COMMIT'</span><br><span class="line">              EXPORTING</span><br><span class="line">                wait = 'X'.</span><br><span class="line">          ENDIF.</span><br><span class="line">        ENDIF.</span><br><span class="line">      ENDIF.</span><br><span class="line">      MODIFY it_mara TRANSPORTING matnr <span class="keyword">type</span> message ersda.</span><br><span class="line">    ENDLOOP.</span><br><span class="line">  ELSEIF p3 = 'X'.</span><br><span class="line">    LOOP AT it_mara.</span><br><span class="line">      <span class="keyword">CLEAR</span> headdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> clientdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> clientdatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> plantdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> plantdatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> planningdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> planningdatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> storagelocationdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> storagelocationdatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> valuetiondata.</span><br><span class="line">      <span class="keyword">CLEAR</span> valuetiondatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> salesdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> salesdatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> materialdescription[].</span><br><span class="line">      <span class="keyword">CLEAR</span> unitsofmeasure[].</span><br><span class="line">      <span class="keyword">CLEAR</span> unitsofmeasurex[].</span><br><span class="line">      <span class="keyword">CLEAR</span> taxclassifications[].</span><br><span class="line">      <span class="keyword">CLEAR</span> pr_unit.</span><br><span class="line">      <span class="keyword">CLEAR</span> pr_unit2.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      CALL FUNCTION 'CONVERSION_EXIT_CUNIT_INPUT'</span><br><span class="line">        EXPORTING</span><br><span class="line">          <span class="keyword">input</span>    = it_mara-meins</span><br><span class="line">          language = sy-langu</span><br><span class="line">        IMPORTING</span><br><span class="line"><span class="comment">*         LONG_TEXT      =</span></span><br><span class="line">          output   = pr_unit.</span><br><span class="line"></span><br><span class="line">      CALL FUNCTION 'CONVERSION_EXIT_CUNIT_INPUT'</span><br><span class="line">        EXPORTING</span><br><span class="line">          <span class="keyword">input</span>    = it_mara-gewei</span><br><span class="line">          language = sy-langu</span><br><span class="line">        IMPORTING</span><br><span class="line"><span class="comment">*         LONG_TEXT      =</span></span><br><span class="line">          output   = pr_unit2.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">IF</span> it_mara-matnr IS INITIAL.</span><br><span class="line">        <span class="keyword">CLEAR</span>:bapimatinr[],bapimatinr.</span><br><span class="line">        <span class="keyword">DO</span>.</span><br><span class="line">          CALL FUNCTION 'BAPI_STDMATERIAL_GETINTNUMBER'</span><br><span class="line">            EXPORTING</span><br><span class="line">              material_type    = it_mara-mtart</span><br><span class="line">              industry_sector  = ''</span><br><span class="line">              required_numbers = 1</span><br><span class="line">            IMPORTING</span><br><span class="line">              <span class="keyword">return</span>           = bapireturn1</span><br><span class="line">            TABLES</span><br><span class="line">              material_number  = bapimatinr[].</span><br><span class="line">          <span class="keyword">READ</span> <span class="keyword">TABLE</span> bapimatinr INDEX 1.</span><br><span class="line">          it_mara-matnr = bapimatinr-material.</span><br><span class="line">          <span class="keyword">IF</span> it_mara-matnr IS INITIAL .</span><br><span class="line">            <span class="keyword">CONTINUE</span>.</span><br><span class="line">          <span class="keyword">ELSE</span>.</span><br><span class="line">            <span class="keyword">EXIT</span>.</span><br><span class="line">          ENDIF.</span><br><span class="line">        ENDDO.</span><br><span class="line">        <span class="keyword">DO</span>.</span><br><span class="line">          "判断是否存在该物料</span><br><span class="line">          CALL FUNCTION 'BAPI_MATERIAL_EXISTENCECHECK'</span><br><span class="line">            EXPORTING</span><br><span class="line">              material = it_mara-matnr</span><br><span class="line"><span class="comment">*             MATERIAL_EVG        =</span></span><br><span class="line">            IMPORTING</span><br><span class="line"><span class="comment">*             DELETION_FLAG       =</span></span><br><span class="line">              <span class="keyword">return</span>   = return1.</span><br><span class="line">          <span class="keyword">IF</span> return1-<span class="keyword">type</span> <span class="keyword">EQ</span> 'S'.</span><br><span class="line">            it_mara-matnr = it_mara-matnr + 1.</span><br><span class="line">            <span class="keyword">CONTINUE</span>.</span><br><span class="line">          <span class="keyword">ELSE</span>.</span><br><span class="line">            <span class="keyword">EXIT</span>.</span><br><span class="line">          ENDIF.</span><br><span class="line">        ENDDO.</span><br><span class="line">        CALL FUNCTION 'CONVERSION_EXIT_ALPHA_INPUT'</span><br><span class="line">          EXPORTING</span><br><span class="line">            <span class="keyword">input</span>  = it_mara-matnr</span><br><span class="line">          IMPORTING</span><br><span class="line">            output = it_mara-matnr.</span><br><span class="line">      ENDIF.</span><br><span class="line">      "表头数据</span><br><span class="line">      headdata-material = it_mara-matnr.</span><br><span class="line">      headdata-ind_sector = it_mara-mbrsh."行业领域</span><br><span class="line">      headdata-matl_type = it_mara-mtart."物料类型</span><br><span class="line"></span><br><span class="line">      "基本数据视图</span><br><span class="line"><span class="comment">*      headdata-basic_view     = 'X'."基本数据视图</span></span><br><span class="line">      headdata-sales_view     = 'X'."销售视图</span><br><span class="line">      headdata-purchase_view  = 'X'."采购视图</span><br><span class="line">      headdata-mrp_view       = 'X'."物料需求计划(MRP)视图</span><br><span class="line">      headdata-storage_view = 'X'."存储视图</span><br><span class="line">      headdata-warehouse_view = 'X'."存储视图</span><br><span class="line">      headdata-prt_view = 'X'."生产资源/工具(PRT)视图</span><br><span class="line"><span class="comment">*    headdata-account_view   = 'X'."会计视图</span></span><br><span class="line"><span class="comment">*    headdata-cost_view      = 'X'."成本视图</span></span><br><span class="line">      headdata-work_sched_view = 'X'."工作计划视图</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      "基本数据</span><br><span class="line">      clientdata-base_uom = pr_unit. "基本单位</span><br><span class="line">      clientdata-matl_group = it_mara-matkl."物料组</span><br><span class="line"><span class="comment">*      clientdata-old_mat_no = it_mara-bismt."旧物料编码</span></span><br><span class="line"><span class="comment">*      clientdata-net_weight = it_mara-ntgew."净重</span></span><br><span class="line">      clientdata-unit_of_wt = pr_unit2."重量单位</span><br><span class="line"><span class="comment">*      clientdata-size_dim = it_mara-groes."大小/量纲</span></span><br><span class="line"><span class="comment">*      clientdata-dsn_office = it_mara-labor."实验室/办公室</span></span><br><span class="line">      clientdata-division = it_mara-spart."产品组</span><br><span class="line">      clientdata-item_cat = it_mara-mtpos."项目类别组</span><br><span class="line">      clientdata-trans_grp = it_mara-tragr."运输组</span><br><span class="line">      clientdata-shelf_life = it_mara-mhdhb."总货架寿命</span><br><span class="line">      clientdata-minremlife = it_mara-mhdrz."最小剩余寿命</span><br><span class="line">      clientdata-batch_mgmt = it_mara-xchar."批量管理标识</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      clientdatax-base_uom = 'X'.</span><br><span class="line">      clientdatax-matl_group = 'X'.</span><br><span class="line"><span class="comment">*      clientdatax-old_mat_no = 'X'.</span></span><br><span class="line"><span class="comment">*      clientdatax-net_weight = 'X'.</span></span><br><span class="line">      clientdatax-unit_of_wt = 'X'.</span><br><span class="line"><span class="comment">*      clientdatax-size_dim = 'X'.</span></span><br><span class="line"><span class="comment">*      clientdatax-dsn_office = 'X'.</span></span><br><span class="line">      clientdatax-division = 'X'.</span><br><span class="line">      clientdatax-item_cat = 'X'.</span><br><span class="line">      clientdatax-trans_grp = 'X'.</span><br><span class="line">      clientdatax-shelf_life = 'X'.</span><br><span class="line">      clientdatax-minremlife = 'X'.</span><br><span class="line">      clientdatax-batch_mgmt = 'X'.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*      工厂数据</span></span><br><span class="line">      plantdata-plant = it_mara-werks."工厂</span><br><span class="line">      plantdata-availcheck = it_mara-mtvfp."可用性检查</span><br><span class="line">      plantdata-loadinggrp = it_mara-ladgr."装载组</span><br><span class="line">      plantdata-pur_group = it_mara-ekgrp."采购组</span><br><span class="line">      plantdata-batch_mgmt = it_mara-xchar."批量管理标识</span><br><span class="line">      plantdata-auto_p_ord = it_mara-kautb.<span class="string">"标识: "</span>允许自动采购订单"</span><br><span class="line">      <span class="string">"plantdata-ind_post_to_insp_stock = it_mara-insmk."</span>过帐到检验库存</span><br><span class="line">      plantdata-mrp_type = it_mara-dismm."MRP类型</span><br><span class="line">      plantdata-mrp_ctrler = it_mara-dispo."MRP控制者</span><br><span class="line">      plantdata-lotsizekey = it_mara-disls."批量</span><br><span class="line">      plantdata-minlotsize = it_mara-bstmi."最小批量</span><br><span class="line">      plantdata-assy_scrap = it_mara-ausss."装配报废</span><br><span class="line">      plantdata-round_val = it_mara-bstrf."采购订单舍入值</span><br><span class="line">      plantdata-proc_type = it_mara-beskz."采购类型</span><br><span class="line">      plantdata-spproctype = it_mara-sobsl."特殊采购类型</span><br><span class="line">      plantdata-backflush = it_mara-rgekz."反冲</span><br><span class="line">      plantdata-iss_st_loc = it_mara-lgpro."生产仓储地点</span><br><span class="line">      plantdata-sloc_exprc = it_mara-lgfsb."外部采购仓储地点</span><br><span class="line">      plantdata-plnd_delry = it_mara-plifz."计划交货日期</span><br><span class="line">      plantdata-sm_key = it_mara-fhori."计划边际码</span><br><span class="line">      plantdata-safety_stk = it_mara-eisbe."安全库存</span><br><span class="line">      plantdata-plan_strgp = it_mara-strgr."计划策略组</span><br><span class="line">      plantdata-consummode = it_mara-vrmod."消耗模式</span><br><span class="line">      plantdata-bwd_cons = it_mara-vint1."逆向消耗期间</span><br><span class="line">      plantdata-fwd_cons = it_mara-vint2."前向消耗期间</span><br><span class="line">      plantdata-comp_scrap = it_mara-kausf."部件废品</span><br><span class="line">      plantdata-dep_req_id = it_mara-sbdkz."单独/集中</span><br><span class="line">      plantdata-production_scheduler = it_mara-fevor."生产管理员</span><br><span class="line">      plantdata-unlimited = it_mara-ueetk."允许未限制的过量交货</span><br><span class="line">      plantdata-over_tol = it_mara-ueeto."超量交货容差限制</span><br><span class="line"><span class="comment">*      plantdata-no_costing = it_mara-ncost."无成本核算</span></span><br><span class="line"><span class="comment">*      plantdata-lot_size = it_mara-losgr. "批量产品成本核算</span></span><br><span class="line"><span class="comment">*      plantdata-variance_key = it_mara-awsls."差异码</span></span><br><span class="line">      <span class="string">"plantdata-profit_ctr = it_mara-prctr."</span>利润中心</span><br><span class="line"><span class="comment">*      plantdata-lot_size = it_mara-peinh."价格单位</span></span><br><span class="line">      plantdata-bulk_mat = it_mara-schgt."散装物料</span><br><span class="line">      <span class="string">"plantdata-proc_time = it_mara-bearz."</span>处理时间</span><br><span class="line">      <span class="string">"plantdata-base_qty = it_mara-basmg."</span>基准数量</span><br><span class="line">      <span class="string">"plantdata-inhseprodt = it_mara-dzeit."</span>厂内生产时间</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      plantdatax-plant = it_mara-werks.</span><br><span class="line">      plantdatax-availcheck = 'X'.</span><br><span class="line">      plantdatax-loadinggrp = 'X'.</span><br><span class="line">      plantdatax-pur_group = 'X'.</span><br><span class="line">      plantdatax-batch_mgmt = 'X'.</span><br><span class="line">      plantdatax-auto_p_ord = 'X'.</span><br><span class="line">      plantdatax-ind_post_to_insp_stock = 'X'.</span><br><span class="line">      plantdatax-mrp_type = 'X'.</span><br><span class="line">      plantdatax-mrp_ctrler = 'X'.</span><br><span class="line">      plantdatax-lotsizekey = 'X'.</span><br><span class="line">      plantdatax-minlotsize = 'X'.</span><br><span class="line">      plantdatax-assy_scrap = 'X'.</span><br><span class="line">      plantdatax-round_val = 'X'.</span><br><span class="line">      plantdatax-proc_type = 'X'.</span><br><span class="line">      plantdatax-spproctype = 'X'.</span><br><span class="line">      plantdatax-backflush = 'X'.</span><br><span class="line">      plantdatax-iss_st_loc = 'X'.</span><br><span class="line">      plantdatax-sloc_exprc = 'X'.</span><br><span class="line">      plantdatax-plnd_delry = 'X'.</span><br><span class="line">      plantdatax-sm_key = 'X'.</span><br><span class="line">      plantdatax-safety_stk = 'X'.</span><br><span class="line">      plantdatax-plan_strgp = 'X'.</span><br><span class="line">      plantdatax-consummode = 'X'.</span><br><span class="line">      plantdatax-bwd_cons = 'X'.</span><br><span class="line">      plantdatax-fwd_cons = 'X'.</span><br><span class="line">      plantdatax-comp_scrap = 'X'.</span><br><span class="line">      plantdatax-dep_req_id = 'X'.</span><br><span class="line">      plantdatax-production_scheduler = 'X'.</span><br><span class="line">      plantdatax-unlimited = 'X'.</span><br><span class="line">      plantdatax-over_tol = 'X'.</span><br><span class="line"><span class="comment">*      plantdatax-no_costing = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-lot_size = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-variance_key = 'X'.</span></span><br><span class="line">      plantdatax-profit_ctr = 'X'.</span><br><span class="line"><span class="comment">*      plantdatax-lot_size = 'X'.</span></span><br><span class="line">      plantdatax-bulk_mat = 'X'.</span><br><span class="line">      plantdatax-<span class="keyword">proc_time</span> = 'X'.</span><br><span class="line">      plantdatax-base_qty = 'X'.</span><br><span class="line">      plantdatax-inhseprodt = 'X'.</span><br><span class="line"></span><br><span class="line"><span class="comment">*      计划数据</span></span><br><span class="line">      planningdata-plant = it_mara-werks.</span><br><span class="line"><span class="comment">*      planningdata-plng_matl = it_mara-prgrp."计划物料</span></span><br><span class="line"><span class="comment">*      planningdata-plng_plant = it_mara-prwrk."计划工厂</span></span><br><span class="line"><span class="comment">*      planningdata-convfactor = it_mara-umref."计划转换因子</span></span><br><span class="line"></span><br><span class="line">      planningdatax-plant = it_mara-werks.</span><br><span class="line">      planningdatax-plng_matl = 'X'.</span><br><span class="line">      planningdatax-plng_plant = 'X'.</span><br><span class="line">      planningdatax-convfactor = 'X'.</span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*      "评估数据</span></span><br><span class="line"><span class="comment">*      valuetiondata-val_area = it_mara-werks."评估范围</span></span><br><span class="line"><span class="comment">**    valuetiondata-val_cat = IT_MARA-bwtty."评估类别</span></span><br><span class="line"><span class="comment">*      valuetiondata-val_class = it_mara-bklas."评估类</span></span><br><span class="line"><span class="comment">*      valuetiondata-price_ctrl = it_mara-vprsv."价格控制</span></span><br><span class="line"><span class="comment">*      IF it_mara-vprsv = 'V'.</span></span><br><span class="line"><span class="comment">*        valuetiondata-moving_pr = it_mara-stprs."移动平均价</span></span><br><span class="line"><span class="comment">*        valuetiondata-std_price = 0.</span></span><br><span class="line"><span class="comment">*      ELSE.</span></span><br><span class="line"><span class="comment">*        valuetiondata-moving_pr = 0.</span></span><br><span class="line"><span class="comment">*        valuetiondata-std_price = it_mara-stprs."标准价格</span></span><br><span class="line"><span class="comment">*      ENDIF.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">**    valuetiondata-price_unit = IT_MARA-stprs."价格单位 PEINH</span></span><br><span class="line"><span class="comment">*      valuetiondata-price_unit = it_mara-peinh.</span></span><br><span class="line"><span class="comment">*      valuetiondata-qty_struct = it_mara-ekalr."物料根据数量结构进行成本核算</span></span><br><span class="line"><span class="comment">*      valuetiondata-orig_mat = it_mara-hkmat."物料来源</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*      valuetiondatax-val_area = it_mara-werks.</span></span><br><span class="line"><span class="comment">**    valuetiondatax-val_cat = 'X'."评估类别</span></span><br><span class="line"><span class="comment">*      valuetiondatax-val_class = 'X'.</span></span><br><span class="line"><span class="comment">*      valuetiondatax-price_ctrl = 'X'.</span></span><br><span class="line"><span class="comment">**    IF IT_MARA-vprsv = 'V'.</span></span><br><span class="line"><span class="comment">*      valuetiondatax-moving_pr = 'X'.</span></span><br><span class="line"><span class="comment">**    ELSE.</span></span><br><span class="line"><span class="comment">*      valuetiondatax-std_price = 'X'.</span></span><br><span class="line"><span class="comment">**    ENDIF.</span></span><br><span class="line"><span class="comment">*      valuetiondatax-price_unit = 'X'.</span></span><br><span class="line"><span class="comment">*      valuetiondatax-orig_mat = 'X'."物料来源</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line">      "销售数据</span><br><span class="line">      salesdata-sales_org = it_mara-vkorg."销售组织</span><br><span class="line">      salesdata-distr_chan = it_mara-vtweg."分销渠道</span><br><span class="line">      salesdata-acct_assgt = it_mara-ktgrm."科目设置组</span><br><span class="line">      salesdata-item_cat = it_mara-mtpos.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      salesdatax-sales_org = it_mara-vkorg."销售组织</span><br><span class="line">      salesdatax-distr_chan = it_mara-vtweg."分销渠道</span><br><span class="line">      salesdatax-acct_assgt = 'X'.</span><br><span class="line">      salesdatax-item_cat = 'X'.</span><br><span class="line"></span><br><span class="line">      "税分类</span><br><span class="line">      taxclassifications-depcountry = 'CN'.</span><br><span class="line">      taxclassifications-tax_type_1 = 'MWST'.</span><br><span class="line">      taxclassifications-taxclass_1 = it_mara-taxkm.</span><br><span class="line">      <span class="keyword">APPEND</span> taxclassifications.</span><br><span class="line">      <span class="keyword">CLEAR</span> taxclassifications.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*      "计量单位</span></span><br><span class="line"><span class="comment">*      unitsofmeasure-alt_unit = pr_unit.</span></span><br><span class="line"><span class="comment">*      "替换单位(必须为基本计量单位,否则会报错,说没有转换因子什么的)</span></span><br><span class="line"><span class="comment">*      unitsofmeasure-numerator = 1.    "分子</span></span><br><span class="line"><span class="comment">*      unitsofmeasure-denominatr = 1.    "分母</span></span><br><span class="line"><span class="comment">*      unitsofmeasure-gross_wt = it_mara-brgew."毛重</span></span><br><span class="line"><span class="comment">*      unitsofmeasure-ean_upc = it_mara-ean11."国际文件号</span></span><br><span class="line"><span class="comment">*      unitsofmeasure-unit_of_wt = pr_unit2.   "重量单位</span></span><br><span class="line"><span class="comment">*      "需要填充毛重的话,注意此处需要添加重量单位,否则会一直提示你没有指定单位</span></span><br><span class="line"><span class="comment">*      APPEND unitsofmeasure.</span></span><br><span class="line"><span class="comment">*      CLEAR unitsofmeasure.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*      unitsofmeasurex-alt_unit = pr_unit."注意此处不是填充'X'</span></span><br><span class="line"><span class="comment">*      unitsofmeasurex-numerator = 'X'.</span></span><br><span class="line"><span class="comment">*      unitsofmeasurex-denominatr = 'X'.</span></span><br><span class="line"><span class="comment">*      unitsofmeasurex-gross_wt = 'X'.</span></span><br><span class="line"><span class="comment">*      unitsofmeasurex-ean_upc = 'X'.</span></span><br><span class="line"><span class="comment">*      unitsofmeasurex-unit_of_wt = 'X'."此处填充'X'</span></span><br><span class="line"><span class="comment">*      IF unitsofmeasurex-alt_unit</span></span><br><span class="line"><span class="comment">*        IS NOT INITIAL AND unitsofmeasurex-numerator</span></span><br><span class="line"><span class="comment">*        IS NOT INITIAL AND unitsofmeasurex-denominatr</span></span><br><span class="line"><span class="comment">*        IS NOT INITIAL.</span></span><br><span class="line"><span class="comment">*        APPEND unitsofmeasurex.</span></span><br><span class="line"><span class="comment">*      ENDIF.</span></span><br><span class="line"><span class="comment">*      CLEAR unitsofmeasurex.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*      "物料描述</span></span><br><span class="line"><span class="comment">*      materialdescription-langu_iso = 'ZH'.</span></span><br><span class="line"><span class="comment">*      materialdescription-matl_desc = it_mara-maktx.</span></span><br><span class="line"><span class="comment">*      APPEND materialdescription.</span></span><br><span class="line"><span class="comment">*      CLEAR materialdescription.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*      IF it_mara-maktg IS NOT INITIAL.</span></span><br><span class="line"><span class="comment">*        materialdescription-langu_iso = 'ZH'.</span></span><br><span class="line"><span class="comment">*        materialdescription-matl_desc = it_mara-maktg.</span></span><br><span class="line"><span class="comment">*        APPEND materialdescription.</span></span><br><span class="line"><span class="comment">*        CLEAR materialdescription.</span></span><br><span class="line"><span class="comment">*      ENDIF.</span></span><br><span class="line"></span><br><span class="line">      "调用BAPI</span><br><span class="line">      CALL FUNCTION 'BAPI_MATERIAL_SAVEDATA'</span><br><span class="line">        EXPORTING</span><br><span class="line">          headdata            = headdata</span><br><span class="line">          clientdata          = clientdata</span><br><span class="line">          clientdatax         = clientdatax</span><br><span class="line">          plantdata           = plantdata</span><br><span class="line">          plantdatax          = plantdatax</span><br><span class="line">          valuationdata       = valuetiondata</span><br><span class="line">          valuationdatax      = valuetiondatax</span><br><span class="line">          salesdata           = salesdata</span><br><span class="line">          salesdatax          = salesdatax</span><br><span class="line">        IMPORTING</span><br><span class="line">          <span class="keyword">return</span>              = <span class="literal">return</span></span><br><span class="line">        TABLES</span><br><span class="line">          materialdescription = materialdescription[]</span><br><span class="line">          unitsofmeasure      = unitsofmeasure[]</span><br><span class="line">          unitsofmeasurex     = unitsofmeasurex[]</span><br><span class="line">          taxclassifications  = taxclassifications[].</span><br><span class="line">      <span class="keyword">IF</span> <span class="keyword">return</span>-<span class="keyword">type</span> = '<span class="keyword">E</span>'.</span><br><span class="line">        CALL FUNCTION 'BAPI_TRANSACTION_ROLLBACK'.</span><br><span class="line">        it_mara-<span class="keyword">type</span> = '<span class="keyword">E</span>'.</span><br><span class="line">        it_mara-message = <span class="keyword">return</span>-message.</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line">        CALL FUNCTION 'BAPI_TRANSACTION_COMMIT'</span><br><span class="line">          EXPORTING</span><br><span class="line">            wait = 'X'.</span><br><span class="line">        it_mara-<span class="keyword">type</span> = 'S'.</span><br><span class="line">        it_mara-message = '创建成功！'.</span><br><span class="line">        it_mara-ersda = sy-datum.</span><br><span class="line">        <span class="keyword">IF</span> it_mara-zeinr IS NOT INITIAL.</span><br><span class="line">          <span class="keyword">CLEAR</span> headdata.</span><br><span class="line">          <span class="keyword">CLEAR</span> clientdata.</span><br><span class="line">          <span class="keyword">CLEAR</span> clientdatax.</span><br><span class="line">          <span class="keyword">CLEAR</span> plantdata.</span><br><span class="line">          <span class="keyword">CLEAR</span> plantdatax.</span><br><span class="line">          <span class="keyword">CLEAR</span> planningdata.</span><br><span class="line">          <span class="keyword">CLEAR</span> planningdatax.</span><br><span class="line">          <span class="keyword">CLEAR</span> storagelocationdata.</span><br><span class="line">          <span class="keyword">CLEAR</span> storagelocationdatax.</span><br><span class="line">          <span class="keyword">CLEAR</span> valuetiondata.</span><br><span class="line">          <span class="keyword">CLEAR</span> valuetiondatax.</span><br><span class="line">          <span class="keyword">CLEAR</span> salesdata.</span><br><span class="line">          <span class="keyword">CLEAR</span> salesdatax.</span><br><span class="line">          <span class="keyword">CLEAR</span> materialdescription[].</span><br><span class="line">          <span class="keyword">CLEAR</span> unitsofmeasure[].</span><br><span class="line">          <span class="keyword">CLEAR</span> unitsofmeasurex[].</span><br><span class="line">          <span class="keyword">CLEAR</span> taxclassifications[].</span><br><span class="line">          <span class="keyword">CLEAR</span> pr_unit.</span><br><span class="line">          <span class="keyword">CLEAR</span> pr_unit2.</span><br><span class="line">          "表头数据</span><br><span class="line">          <span class="keyword">CLEAR</span>: n_matnr,o_matnr.</span><br><span class="line"></span><br><span class="line">          CALL FUNCTION 'CONVERSION_EXIT_ALPHA_INPUT'</span><br><span class="line">            EXPORTING</span><br><span class="line">              <span class="keyword">input</span>  = it_mara-zeinr</span><br><span class="line">            IMPORTING</span><br><span class="line">              output = n_matnr.</span><br><span class="line">          CALL FUNCTION 'CONVERSION_EXIT_ALPHA_INPUT'</span><br><span class="line">            EXPORTING</span><br><span class="line">              <span class="keyword">input</span>  = it_mara-matnr</span><br><span class="line">            IMPORTING</span><br><span class="line">              output = o_matnr.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">          headdata-material = n_matnr.</span><br><span class="line"></span><br><span class="line">          "基本数据视图</span><br><span class="line">          headdata-basic_view     = 'X'."基本数据视图</span><br><span class="line"></span><br><span class="line">          clientdata-document = o_matnr.</span><br><span class="line">          clientdatax-document = 'X'.</span><br><span class="line">          "调用BAPI</span><br><span class="line">          CALL FUNCTION 'BAPI_MATERIAL_SAVEDATA'</span><br><span class="line">            EXPORTING</span><br><span class="line">              headdata    = headdata</span><br><span class="line">              clientdata  = clientdata</span><br><span class="line">              clientdatax = clientdatax</span><br><span class="line">            IMPORTING</span><br><span class="line">              <span class="keyword">return</span>      = <span class="keyword">return</span>.</span><br><span class="line">          <span class="keyword">IF</span> <span class="keyword">return</span>-<span class="keyword">type</span> = '<span class="keyword">E</span>'.</span><br><span class="line">            CALL FUNCTION 'BAPI_TRANSACTION_ROLLBACK'.</span><br><span class="line"><span class="comment">*          write :/ return-type,return-message.</span></span><br><span class="line">          <span class="keyword">ELSE</span>.</span><br><span class="line">            CALL FUNCTION 'BAPI_TRANSACTION_COMMIT'</span><br><span class="line">              EXPORTING</span><br><span class="line">                wait = 'X'.</span><br><span class="line">          ENDIF.</span><br><span class="line">        ENDIF.</span><br><span class="line">      ENDIF.</span><br><span class="line">      MODIFY it_mara TRANSPORTING matnr <span class="keyword">type</span> message ersda.</span><br><span class="line">    ENDLOOP.</span><br><span class="line">  ELSEIF p4 = 'X'.</span><br><span class="line">    LOOP AT it_mara.</span><br><span class="line">      <span class="keyword">CLEAR</span> headdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> clientdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> clientdatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> plantdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> plantdatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> planningdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> planningdatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> storagelocationdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> storagelocationdatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> valuetiondata.</span><br><span class="line">      <span class="keyword">CLEAR</span> valuetiondatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> salesdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> salesdatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> materialdescription[].</span><br><span class="line">      <span class="keyword">CLEAR</span> unitsofmeasure[].</span><br><span class="line">      <span class="keyword">CLEAR</span> unitsofmeasurex[].</span><br><span class="line">      <span class="keyword">CLEAR</span> taxclassifications[].</span><br><span class="line">      <span class="keyword">CLEAR</span> pr_unit.</span><br><span class="line">      <span class="keyword">CLEAR</span> pr_unit2.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      CALL FUNCTION 'CONVERSION_EXIT_CUNIT_INPUT'</span><br><span class="line">        EXPORTING</span><br><span class="line">          <span class="keyword">input</span>    = it_mara-meins</span><br><span class="line">          language = sy-langu</span><br><span class="line">        IMPORTING</span><br><span class="line"><span class="comment">*         LONG_TEXT      =</span></span><br><span class="line">          output   = pr_unit.</span><br><span class="line"></span><br><span class="line">      CALL FUNCTION 'CONVERSION_EXIT_CUNIT_INPUT'</span><br><span class="line">        EXPORTING</span><br><span class="line">          <span class="keyword">input</span>    = it_mara-gewei</span><br><span class="line">          language = sy-langu</span><br><span class="line">        IMPORTING</span><br><span class="line"><span class="comment">*         LONG_TEXT      =</span></span><br><span class="line">          output   = pr_unit2.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">IF</span> it_mara-matnr IS INITIAL.</span><br><span class="line">        <span class="keyword">CLEAR</span>:bapimatinr[],bapimatinr.</span><br><span class="line">        <span class="keyword">DO</span>.</span><br><span class="line">          CALL FUNCTION 'BAPI_STDMATERIAL_GETINTNUMBER'</span><br><span class="line">            EXPORTING</span><br><span class="line">              material_type    = it_mara-mtart</span><br><span class="line">              industry_sector  = ''</span><br><span class="line">              required_numbers = 1</span><br><span class="line">            IMPORTING</span><br><span class="line">              <span class="keyword">return</span>           = bapireturn1</span><br><span class="line">            TABLES</span><br><span class="line">              material_number  = bapimatinr[].</span><br><span class="line">          <span class="keyword">READ</span> <span class="keyword">TABLE</span> bapimatinr INDEX 1.</span><br><span class="line">          it_mara-matnr = bapimatinr-material.</span><br><span class="line">          <span class="keyword">IF</span> it_mara-matnr IS INITIAL .</span><br><span class="line">            <span class="keyword">CONTINUE</span>.</span><br><span class="line">          <span class="keyword">ELSE</span>.</span><br><span class="line">            <span class="keyword">EXIT</span>.</span><br><span class="line">          ENDIF.</span><br><span class="line">        ENDDO.</span><br><span class="line">        <span class="keyword">DO</span>.</span><br><span class="line">          "判断是否存在该物料</span><br><span class="line">          CALL FUNCTION 'BAPI_MATERIAL_EXISTENCECHECK'</span><br><span class="line">            EXPORTING</span><br><span class="line">              material = it_mara-matnr</span><br><span class="line"><span class="comment">*             MATERIAL_EVG        =</span></span><br><span class="line">            IMPORTING</span><br><span class="line"><span class="comment">*             DELETION_FLAG       =</span></span><br><span class="line">              <span class="keyword">return</span>   = return1.</span><br><span class="line">          <span class="keyword">IF</span> return1-<span class="keyword">type</span> <span class="keyword">EQ</span> 'S'.</span><br><span class="line">            it_mara-matnr = it_mara-matnr + 1.</span><br><span class="line">            <span class="keyword">CONTINUE</span>.</span><br><span class="line">          <span class="keyword">ELSE</span>.</span><br><span class="line">            <span class="keyword">EXIT</span>.</span><br><span class="line">          ENDIF.</span><br><span class="line">        ENDDO.</span><br><span class="line">        CALL FUNCTION 'CONVERSION_EXIT_ALPHA_INPUT'</span><br><span class="line">          EXPORTING</span><br><span class="line">            <span class="keyword">input</span>  = it_mara-matnr</span><br><span class="line">          IMPORTING</span><br><span class="line">            output = it_mara-matnr.</span><br><span class="line">      ENDIF.</span><br><span class="line">      "表头数据</span><br><span class="line">      headdata-material = it_mara-matnr.</span><br><span class="line">      headdata-ind_sector = it_mara-mbrsh."行业领域</span><br><span class="line">      headdata-matl_type = it_mara-mtart."物料类型</span><br><span class="line"></span><br><span class="line">      "基本数据视图</span><br><span class="line"><span class="comment">*      headdata-basic_view     = 'X'."基本数据视图</span></span><br><span class="line"><span class="comment">*      headdata-sales_view     = 'X'."销售视图</span></span><br><span class="line"><span class="comment">*      headdata-purchase_view  = 'X'."采购视图</span></span><br><span class="line"><span class="comment">*      headdata-mrp_view       = 'X'."物料需求计划(MRP)视图</span></span><br><span class="line"><span class="comment">*      headdata-storage_view = 'X'."存储视图</span></span><br><span class="line"><span class="comment">*      headdata-warehouse_view = 'X'."存储视图</span></span><br><span class="line"><span class="comment">*      headdata-prt_view = 'X'."生产资源/工具(PRT)视图</span></span><br><span class="line">      headdata-account_view   = 'X'."会计视图</span><br><span class="line">      headdata-cost_view      = 'X'."成本视图</span><br><span class="line"><span class="comment">*      headdata-work_sched_view = 'X'."工作计划视图</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      "基本数据</span><br><span class="line"><span class="comment">*      clientdata-base_uom = pr_unit. "基本单位</span></span><br><span class="line"><span class="comment">*      clientdata-matl_group = it_mara-matkl."物料组</span></span><br><span class="line"><span class="comment">*      clientdata-old_mat_no = it_mara-bismt."旧物料编码</span></span><br><span class="line"><span class="comment">*      clientdata-net_weight = it_mara-ntgew."净重</span></span><br><span class="line"><span class="comment">*      clientdata-unit_of_wt = pr_unit2."重量单位</span></span><br><span class="line"><span class="comment">*      clientdata-size_dim = it_mara-groes."大小/量纲</span></span><br><span class="line"><span class="comment">*      clientdata-dsn_office = it_mara-labor."实验室/办公室</span></span><br><span class="line"><span class="comment">*      clientdata-division = it_mara-spart."产品组</span></span><br><span class="line"><span class="comment">*      clientdata-item_cat = it_mara-mtpos."项目类别组</span></span><br><span class="line"><span class="comment">*      clientdata-trans_grp = it_mara-tragr."运输组</span></span><br><span class="line"><span class="comment">*      clientdata-shelf_life = it_mara-mhdhb."总货架寿命</span></span><br><span class="line"><span class="comment">*      clientdata-minremlife = it_mara-mhdrz."最小剩余寿命</span></span><br><span class="line"><span class="comment">*      clientdata-batch_mgmt = it_mara-xchar."批量管理标识</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*      clientdatax-base_uom = 'X'.</span></span><br><span class="line"><span class="comment">*      clientdatax-matl_group = 'X'.</span></span><br><span class="line"><span class="comment">*      clientdatax-old_mat_no = 'X'.</span></span><br><span class="line"><span class="comment">*      clientdatax-net_weight = 'X'.</span></span><br><span class="line"><span class="comment">*      clientdatax-unit_of_wt = 'X'.</span></span><br><span class="line"><span class="comment">*      clientdatax-size_dim = 'X'.</span></span><br><span class="line"><span class="comment">*      clientdatax-dsn_office = 'X'.</span></span><br><span class="line"><span class="comment">*      clientdatax-division = 'X'.</span></span><br><span class="line"><span class="comment">*      clientdatax-item_cat = 'X'.</span></span><br><span class="line"><span class="comment">*      clientdatax-trans_grp = 'X'.</span></span><br><span class="line"><span class="comment">*      clientdatax-shelf_life = 'X'.</span></span><br><span class="line"><span class="comment">*      clientdatax-minremlife = 'X'.</span></span><br><span class="line"><span class="comment">*      clientdatax-batch_mgmt = 'X'.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*      工厂数据</span></span><br><span class="line">      plantdata-plant = it_mara-werks."工厂</span><br><span class="line"><span class="comment">*      plantdata-availcheck = it_mara-mtvfp."可用性检查</span></span><br><span class="line"><span class="comment">*      plantdata-loadinggrp = it_mara-ladgr."装载组</span></span><br><span class="line"><span class="comment">*      plantdata-pur_group = it_mara-ekgrp."采购组</span></span><br><span class="line"><span class="comment">*      plantdata-batch_mgmt = it_mara-xchar."批量管理标识</span></span><br><span class="line"><span class="comment">*      plantdata-auto_p_ord = it_mara-kautb."标识: "允许自动采购订单"</span></span><br><span class="line"><span class="comment">*      plantdata-ind_post_to_insp_stock = it_mara-insmk."过帐到检验库存</span></span><br><span class="line"><span class="comment">*      plantdata-mrp_type = it_mara-dismm."MRP类型</span></span><br><span class="line"><span class="comment">*      plantdata-mrp_ctrler = it_mara-dispo."MRP控制者</span></span><br><span class="line"><span class="comment">*      plantdata-lotsizekey = it_mara-disls."批量</span></span><br><span class="line"><span class="comment">*      plantdata-minlotsize = it_mara-bstmi."最小批量</span></span><br><span class="line"><span class="comment">*      plantdata-assy_scrap = it_mara-ausss."装配报废</span></span><br><span class="line"><span class="comment">*      plantdata-round_val = it_mara-bstrf."采购订单舍入值</span></span><br><span class="line"><span class="comment">*      plantdata-proc_type = it_mara-beskz."采购类型</span></span><br><span class="line"><span class="comment">*      plantdata-spproctype = it_mara-sobsl."特殊采购类型</span></span><br><span class="line"><span class="comment">*      plantdata-backflush = it_mara-rgekz."反冲</span></span><br><span class="line"><span class="comment">*      plantdata-iss_st_loc = it_mara-lgpro."生产仓储地点</span></span><br><span class="line"><span class="comment">*      plantdata-sloc_exprc = it_mara-lgfsb."外部采购仓储地点</span></span><br><span class="line"><span class="comment">*      plantdata-plnd_delry = it_mara-plifz."计划交货日期</span></span><br><span class="line"><span class="comment">*      plantdata-sm_key = it_mara-fhori."计划边际码</span></span><br><span class="line"><span class="comment">*      plantdata-safety_stk = it_mara-eisbe."安全库存</span></span><br><span class="line"><span class="comment">*      plantdata-plan_strgp = it_mara-strgr."计划策略组</span></span><br><span class="line"><span class="comment">*      plantdata-consummode = it_mara-vrmod."消耗模式</span></span><br><span class="line"><span class="comment">*      plantdata-bwd_cons = it_mara-vint1."逆向消耗期间</span></span><br><span class="line"><span class="comment">*      plantdata-fwd_cons = it_mara-vint2."前向消耗期间</span></span><br><span class="line"><span class="comment">*      plantdata-comp_scrap = it_mara-kausf."部件废品</span></span><br><span class="line"><span class="comment">*      plantdata-dep_req_id = it_mara-sbdkz."单独/集中</span></span><br><span class="line"><span class="comment">*      plantdata-production_scheduler = it_mara-fevor."生产管理员</span></span><br><span class="line"><span class="comment">*      plantdata-unlimited = it_mara-ueetk."允许未限制的过量交货</span></span><br><span class="line"><span class="comment">*      plantdata-over_tol = it_mara-ueeto."超量交货容差限制</span></span><br><span class="line">      plantdata-no_costing = it_mara-ncost."无成本核算</span><br><span class="line">      plantdata-lot_size = it_mara-losgr. "批量产品成本核算</span><br><span class="line">      plantdata-variance_key = it_mara-awsls."差异码</span><br><span class="line">      <span class="string">"plantdata-profit_ctr = it_mara-prctr."</span>利润中心</span><br><span class="line">      plantdata-lot_size = it_mara-peinh."价格单位</span><br><span class="line"><span class="comment">*      plantdata-bulk_mat = it_mara-schgt."散装物料</span></span><br><span class="line"><span class="comment">*      plantdata-proc_time = it_mara-bearz."处理时间</span></span><br><span class="line"><span class="comment">*      plantdata-base_qty = it_mara-basmg."基准数量</span></span><br><span class="line"><span class="comment">*      plantdata-inhseprodt = it_matnr-dzeit."厂内生产时间</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      plantdatax-plant = it_mara-werks.</span><br><span class="line"><span class="comment">*      plantdatax-availcheck = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-loadinggrp = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-pur_group = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-batch_mgmt = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-auto_p_ord = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-ind_post_to_insp_stock = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-mrp_type = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-mrp_ctrler = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-lotsizekey = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-minlotsize = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-assy_scrap = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-round_val = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-proc_type = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-spproctype = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-backflush = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-iss_st_loc = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-sloc_exprc = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-plnd_delry = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-sm_key = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-safety_stk = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-plan_strgp = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-consummode = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-bwd_cons = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-fwd_cons = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-comp_scrap = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-dep_req_id = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-production_scheduler = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-unlimited = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-over_tol = 'X'.</span></span><br><span class="line">      plantdatax-no_costing = 'X'.</span><br><span class="line">      plantdatax-lot_size = 'X'.</span><br><span class="line">      plantdatax-variance_key = 'X'.</span><br><span class="line">      plantdatax-profit_ctr = 'X'.</span><br><span class="line">      plantdatax-lot_size = 'X'.</span><br><span class="line"><span class="comment">*      plantdatax-bulk_mat = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-proc_time = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-base_qty = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-inhseprodt = 'X'.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">*      计划数据</span></span><br><span class="line"><span class="comment">*      planningdata-plant = it_mara-werks.</span></span><br><span class="line"><span class="comment">*      planningdata-plng_matl = it_mara-prgrp."计划物料</span></span><br><span class="line"><span class="comment">*      planningdata-plng_plant = it_mara-prwrk."计划工厂</span></span><br><span class="line"><span class="comment">*      planningdata-convfactor = it_mara-umref."计划转换因子</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*      planningdatax-plant = it_mara-werks.</span></span><br><span class="line"><span class="comment">*      planningdatax-plng_matl = 'X'.</span></span><br><span class="line"><span class="comment">*      planningdatax-plng_plant = 'X'.</span></span><br><span class="line"><span class="comment">*      planningdatax-convfactor = 'X'.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line">      "评估数据</span><br><span class="line">      valuetiondata-val_area = it_mara-werks."评估范围</span><br><span class="line"><span class="comment">*    valuetiondata-val_cat = IT_MARA-bwtty."评估类别</span></span><br><span class="line">      valuetiondata-val_class = it_mara-bklas."评估类</span><br><span class="line">      valuetiondata-price_ctrl = it_mara-vprsv."价格控制</span><br><span class="line">      <span class="keyword">IF</span> it_mara-vprsv = 'V'.</span><br><span class="line"><span class="comment">*        valuetiondata-moving_pr = it_mara-stprs."移动平均价</span></span><br><span class="line"><span class="comment">*        valuetiondata-std_price = 0.</span></span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line"><span class="comment">*        valuetiondata-moving_pr = 0.</span></span><br><span class="line"><span class="comment">*        valuetiondata-std_price = it_mara-stprs."标准价格</span></span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*    valuetiondata-price_unit = IT_MARA-stprs."价格单位 PEINH</span></span><br><span class="line">      valuetiondata-price_unit = it_mara-peinh.</span><br><span class="line">      valuetiondata-qty_struct = it_mara-ekalr."物料根据数量结构进行成本核算</span><br><span class="line">      <span class="string">"valuetiondata-orig_mat = it_mara-hkmat."</span>物料来源</span><br><span class="line"></span><br><span class="line">      valuetiondatax-val_area = it_mara-werks.</span><br><span class="line"><span class="comment">*    valuetiondatax-val_cat = 'X'."评估类别</span></span><br><span class="line">      valuetiondatax-val_class = 'X'.</span><br><span class="line">      valuetiondatax-price_ctrl = 'X'.</span><br><span class="line"><span class="comment">*    IF IT_MARA-vprsv = 'V'.</span></span><br><span class="line">      valuetiondatax-moving_pr = 'X'.</span><br><span class="line"><span class="comment">*    ELSE.</span></span><br><span class="line">      valuetiondatax-std_price = 'X'.</span><br><span class="line"><span class="comment">*    ENDIF.</span></span><br><span class="line">      valuetiondatax-price_unit = 'X'.</span><br><span class="line">      valuetiondatax-orig_mat = 'X'."物料来源</span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line">      "销售数据</span><br><span class="line">      salesdata-sales_org = it_mara-vkorg."销售组织</span><br><span class="line">      salesdata-distr_chan = it_mara-vtweg."分销渠道</span><br><span class="line">      salesdata-acct_assgt = it_mara-ktgrm."科目设置组</span><br><span class="line">      salesdata-item_cat = it_mara-mtpos.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      salesdatax-sales_org = it_mara-vkorg."销售组织</span><br><span class="line">      salesdatax-distr_chan = it_mara-vtweg."分销渠道</span><br><span class="line">      salesdatax-acct_assgt = 'X'.</span><br><span class="line">      salesdatax-item_cat = 'X'.</span><br><span class="line"></span><br><span class="line">      "税分类</span><br><span class="line">      taxclassifications-depcountry = 'CN'.</span><br><span class="line">      taxclassifications-tax_type_1 = 'MWST'.</span><br><span class="line">      taxclassifications-taxclass_1 = it_mara-taxkm.</span><br><span class="line">      <span class="keyword">APPEND</span> taxclassifications.</span><br><span class="line">      <span class="keyword">CLEAR</span> taxclassifications.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*      "计量单位</span></span><br><span class="line"><span class="comment">*      unitsofmeasure-alt_unit = pr_unit.</span></span><br><span class="line"><span class="comment">*      "替换单位(必须为基本计量单位,否则会报错,说没有转换因子什么的)</span></span><br><span class="line"><span class="comment">*      unitsofmeasure-numerator = 1.    "分子</span></span><br><span class="line"><span class="comment">*      unitsofmeasure-denominatr = 1.    "分母</span></span><br><span class="line"><span class="comment">*      unitsofmeasure-gross_wt = it_mara-brgew."毛重</span></span><br><span class="line"><span class="comment">*      unitsofmeasure-ean_upc = it_mara-ean11."国际文件号</span></span><br><span class="line"><span class="comment">*      unitsofmeasure-unit_of_wt = pr_unit2.   "重量单位</span></span><br><span class="line"><span class="comment">*      "需要填充毛重的话,注意此处需要添加重量单位,否则会一直提示你没有指定单位</span></span><br><span class="line"><span class="comment">*      APPEND unitsofmeasure.</span></span><br><span class="line"><span class="comment">*      CLEAR unitsofmeasure.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*      unitsofmeasurex-alt_unit = pr_unit."注意此处不是填充'X'</span></span><br><span class="line"><span class="comment">*      unitsofmeasurex-numerator = 'X'.</span></span><br><span class="line"><span class="comment">*      unitsofmeasurex-denominatr = 'X'.</span></span><br><span class="line"><span class="comment">*      unitsofmeasurex-gross_wt = 'X'.</span></span><br><span class="line"><span class="comment">*      unitsofmeasurex-ean_upc = 'X'.</span></span><br><span class="line"><span class="comment">*      unitsofmeasurex-unit_of_wt = 'X'."此处填充'X'</span></span><br><span class="line"><span class="comment">*      IF unitsofmeasurex-alt_unit</span></span><br><span class="line"><span class="comment">*        IS NOT INITIAL AND unitsofmeasurex-numerator</span></span><br><span class="line"><span class="comment">*        IS NOT INITIAL AND unitsofmeasurex-denominatr</span></span><br><span class="line"><span class="comment">*        IS NOT INITIAL.</span></span><br><span class="line"><span class="comment">*        APPEND unitsofmeasurex.</span></span><br><span class="line"><span class="comment">*      ENDIF.</span></span><br><span class="line"><span class="comment">*      CLEAR unitsofmeasurex.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*      "物料描述</span></span><br><span class="line"><span class="comment">*      materialdescription-langu_iso = 'ZH'.</span></span><br><span class="line"><span class="comment">*      materialdescription-matl_desc = it_mara-maktx.</span></span><br><span class="line"><span class="comment">*      APPEND materialdescription.</span></span><br><span class="line"><span class="comment">*      CLEAR materialdescription.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*      IF it_mara-maktg IS NOT INITIAL.</span></span><br><span class="line"><span class="comment">*        materialdescription-langu_iso = 'ZH'.</span></span><br><span class="line"><span class="comment">*        materialdescription-matl_desc = it_mara-maktg.</span></span><br><span class="line"><span class="comment">*        APPEND materialdescription.</span></span><br><span class="line"><span class="comment">*        CLEAR materialdescription.</span></span><br><span class="line"><span class="comment">*      ENDIF.</span></span><br><span class="line"></span><br><span class="line">      "调用BAPI</span><br><span class="line">      CALL FUNCTION 'BAPI_MATERIAL_SAVEDATA'</span><br><span class="line">        EXPORTING</span><br><span class="line">          headdata            = headdata</span><br><span class="line">          clientdata          = clientdata</span><br><span class="line">          clientdatax         = clientdatax</span><br><span class="line">          plantdata           = plantdata</span><br><span class="line">          plantdatax          = plantdatax</span><br><span class="line">          valuationdata       = valuetiondata</span><br><span class="line">          valuationdatax      = valuetiondatax</span><br><span class="line">          salesdata           = salesdata</span><br><span class="line">          salesdatax          = salesdatax</span><br><span class="line">        IMPORTING</span><br><span class="line">          <span class="keyword">return</span>              = <span class="literal">return</span></span><br><span class="line">        TABLES</span><br><span class="line">          materialdescription = materialdescription[]</span><br><span class="line">          unitsofmeasure      = unitsofmeasure[]</span><br><span class="line">          unitsofmeasurex     = unitsofmeasurex[]</span><br><span class="line">          taxclassifications  = taxclassifications[].</span><br><span class="line">      <span class="keyword">IF</span> <span class="keyword">return</span>-<span class="keyword">type</span> = '<span class="keyword">E</span>'.</span><br><span class="line">        CALL FUNCTION 'BAPI_TRANSACTION_ROLLBACK'.</span><br><span class="line">        it_mara-<span class="keyword">type</span> = '<span class="keyword">E</span>'.</span><br><span class="line">        it_mara-message = <span class="keyword">return</span>-message.</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line">        CALL FUNCTION 'BAPI_TRANSACTION_COMMIT'</span><br><span class="line">          EXPORTING</span><br><span class="line">            wait = 'X'.</span><br><span class="line">        it_mara-<span class="keyword">type</span> = 'S'.</span><br><span class="line">        it_mara-message = '创建成功！'.</span><br><span class="line">        it_mara-ersda = sy-datum.</span><br><span class="line">        <span class="keyword">IF</span> it_mara-zeinr IS NOT INITIAL.</span><br><span class="line">          <span class="keyword">CLEAR</span> headdata.</span><br><span class="line">          <span class="keyword">CLEAR</span> clientdata.</span><br><span class="line">          <span class="keyword">CLEAR</span> clientdatax.</span><br><span class="line">          <span class="keyword">CLEAR</span> plantdata.</span><br><span class="line">          <span class="keyword">CLEAR</span> plantdatax.</span><br><span class="line">          <span class="keyword">CLEAR</span> planningdata.</span><br><span class="line">          <span class="keyword">CLEAR</span> planningdatax.</span><br><span class="line">          <span class="keyword">CLEAR</span> storagelocationdata.</span><br><span class="line">          <span class="keyword">CLEAR</span> storagelocationdatax.</span><br><span class="line">          <span class="keyword">CLEAR</span> valuetiondata.</span><br><span class="line">          <span class="keyword">CLEAR</span> valuetiondatax.</span><br><span class="line">          <span class="keyword">CLEAR</span> salesdata.</span><br><span class="line">          <span class="keyword">CLEAR</span> salesdatax.</span><br><span class="line">          <span class="keyword">CLEAR</span> materialdescription[].</span><br><span class="line">          <span class="keyword">CLEAR</span> unitsofmeasure[].</span><br><span class="line">          <span class="keyword">CLEAR</span> unitsofmeasurex[].</span><br><span class="line">          <span class="keyword">CLEAR</span> taxclassifications[].</span><br><span class="line">          <span class="keyword">CLEAR</span> pr_unit.</span><br><span class="line">          <span class="keyword">CLEAR</span> pr_unit2.</span><br><span class="line">          "表头数据</span><br><span class="line">          <span class="keyword">CLEAR</span>: n_matnr,o_matnr.</span><br><span class="line"></span><br><span class="line">          CALL FUNCTION 'CONVERSION_EXIT_ALPHA_INPUT'</span><br><span class="line">            EXPORTING</span><br><span class="line">              <span class="keyword">input</span>  = it_mara-zeinr</span><br><span class="line">            IMPORTING</span><br><span class="line">              output = n_matnr.</span><br><span class="line">          CALL FUNCTION 'CONVERSION_EXIT_ALPHA_INPUT'</span><br><span class="line">            EXPORTING</span><br><span class="line">              <span class="keyword">input</span>  = it_mara-matnr</span><br><span class="line">            IMPORTING</span><br><span class="line">              output = o_matnr.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">          headdata-material = n_matnr.</span><br><span class="line"></span><br><span class="line">          "基本数据视图</span><br><span class="line">          headdata-basic_view     = 'X'."基本数据视图</span><br><span class="line"></span><br><span class="line">          clientdata-document = o_matnr.</span><br><span class="line">          clientdatax-document = 'X'.</span><br><span class="line">          "调用BAPI</span><br><span class="line">          CALL FUNCTION 'BAPI_MATERIAL_SAVEDATA'</span><br><span class="line">            EXPORTING</span><br><span class="line">              headdata    = headdata</span><br><span class="line">              clientdata  = clientdata</span><br><span class="line">              clientdatax = clientdatax</span><br><span class="line">            IMPORTING</span><br><span class="line">              <span class="keyword">return</span>      = <span class="keyword">return</span>.</span><br><span class="line">          <span class="keyword">IF</span> <span class="keyword">return</span>-<span class="keyword">type</span> = '<span class="keyword">E</span>'.</span><br><span class="line">            CALL FUNCTION 'BAPI_TRANSACTION_ROLLBACK'.</span><br><span class="line"><span class="comment">*          write :/ return-type,return-message.</span></span><br><span class="line">          <span class="keyword">ELSE</span>.</span><br><span class="line">            CALL FUNCTION 'BAPI_TRANSACTION_COMMIT'</span><br><span class="line">              EXPORTING</span><br><span class="line">                wait = 'X'.</span><br><span class="line">          ENDIF.</span><br><span class="line">        ENDIF.</span><br><span class="line">      ENDIF.</span><br><span class="line">      MODIFY it_mara TRANSPORTING matnr <span class="keyword">type</span> message ersda.</span><br><span class="line">    ENDLOOP.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">ENDFORM.</span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*&amp;      Form  CHARK_DATA</span></span><br><span class="line"><span class="comment">*&amp;---------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*       text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="comment">*  --&gt;  p1        text</span></span><br><span class="line"><span class="comment">*  &lt;--  p2        text</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------*</span></span><br><span class="line"><span class="keyword">FORM</span> chark_data .</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> p1 = 'X'.</span><br><span class="line">    LOOP AT it_mara.</span><br><span class="line">      <span class="keyword">CLEAR</span> headdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> clientdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> clientdatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> plantdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> plantdatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> planningdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> planningdatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> storagelocationdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> storagelocationdatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> valuetiondata.</span><br><span class="line">      <span class="keyword">CLEAR</span> valuetiondatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> salesdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> salesdatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> materialdescription[].</span><br><span class="line">      <span class="keyword">CLEAR</span> unitsofmeasure[].</span><br><span class="line">      <span class="keyword">CLEAR</span> unitsofmeasurex[].</span><br><span class="line">      <span class="keyword">CLEAR</span> taxclassifications[].</span><br><span class="line">      <span class="keyword">CLEAR</span> pr_unit.</span><br><span class="line">      <span class="keyword">CLEAR</span> pr_unit2.</span><br><span class="line"><span class="comment">*自定义字段</span></span><br><span class="line">      <span class="keyword">CLEAR</span> w_extensionin.</span><br><span class="line">      REFRESH w_extensionin.</span><br><span class="line">      <span class="keyword">CLEAR</span> w_extensioninx.</span><br><span class="line">      REFRESH w_extensioninx.</span><br><span class="line">      <span class="keyword">CLEAR</span> zzbapi_te_mara.</span><br><span class="line">      <span class="keyword">CLEAR</span> zzbapi_te_marax.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      CALL FUNCTION 'CONVERSION_EXIT_CUNIT_INPUT'</span><br><span class="line">        EXPORTING</span><br><span class="line">          <span class="keyword">input</span>    = it_mara-meins</span><br><span class="line">          language = sy-langu</span><br><span class="line">        IMPORTING</span><br><span class="line"><span class="comment">*         LONG_TEXT      =</span></span><br><span class="line">          output   = pr_unit.</span><br><span class="line"></span><br><span class="line">      CALL FUNCTION 'CONVERSION_EXIT_CUNIT_INPUT'</span><br><span class="line">        EXPORTING</span><br><span class="line">          <span class="keyword">input</span>    = it_mara-gewei</span><br><span class="line">          language = sy-langu</span><br><span class="line">        IMPORTING</span><br><span class="line"><span class="comment">*         LONG_TEXT      =</span></span><br><span class="line">          output   = pr_unit2.</span><br><span class="line"></span><br><span class="line">      CALL FUNCTION 'CONVERSION_EXIT_ALPHA_INPUT'</span><br><span class="line">        EXPORTING</span><br><span class="line">          <span class="keyword">input</span>  = it_mara-matnr</span><br><span class="line">        IMPORTING</span><br><span class="line">          output = it_mara-matnr.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      <span class="keyword">IF</span> it_mara-matnr IS INITIAL.</span><br><span class="line">        <span class="keyword">CLEAR</span>:ran_int,ran_cahr.</span><br><span class="line">        "获取随机编号进行试运行</span><br><span class="line">        CALL FUNCTION 'QF05_RANDOM_INTEGER'</span><br><span class="line">          EXPORTING</span><br><span class="line">            ran_int_max = 1999999999</span><br><span class="line">            ran_int_min = 1099999999</span><br><span class="line">          IMPORTING</span><br><span class="line">            ran_int     = ran_int.</span><br><span class="line">        <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line"><span class="comment">* Implement suitable error handling here</span></span><br><span class="line">        ENDIF.</span><br><span class="line">        ran_cahr = ran_int.</span><br><span class="line">        CALL FUNCTION 'CONVERSION_EXIT_ALPHA_INPUT'</span><br><span class="line">          EXPORTING</span><br><span class="line">            <span class="keyword">input</span>  = ran_cahr</span><br><span class="line">          IMPORTING</span><br><span class="line">            output = it_mara-matnr.</span><br><span class="line">      ENDIF.</span><br><span class="line">      "表头数据</span><br><span class="line">      headdata-material = it_mara-matnr.</span><br><span class="line">      headdata-ind_sector = it_mara-mbrsh."行业领域</span><br><span class="line">      headdata-matl_type = it_mara-mtart."物料类型</span><br><span class="line"></span><br><span class="line">      "基本数据视图</span><br><span class="line">      headdata-basic_view     = 'X'."基本数据视图</span><br><span class="line">      <span class="keyword">IF</span> it_mara-mtart = 'Z002' OR it_mara-mtart = 'Z004' OR it_mara-mtart = 'Z006'.</span><br><span class="line">        headdata-sales_view     = ''."销售视图</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line">        headdata-sales_view     = 'X'."销售视图</span><br><span class="line">      ENDIF.</span><br><span class="line">      headdata-purchase_view  = 'X'."采购视图</span><br><span class="line">      headdata-mrp_view       = 'X'."物料需求计划(MRP)视图</span><br><span class="line">      headdata-storage_view = 'X'."存储视图</span><br><span class="line">      headdata-warehouse_view = 'X'."存储视图</span><br><span class="line">      headdata-prt_view = 'X'."生产资源/工具(PRT)视图</span><br><span class="line">      headdata-account_view   = 'X'."会计视图</span><br><span class="line">      headdata-cost_view      = 'X'."成本视图</span><br><span class="line">      headdata-work_sched_view = 'X'."工作计划视图</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      "基本数据</span><br><span class="line">      clientdata-base_uom = pr_unit. "基本单位</span><br><span class="line">      clientdata-matl_group = it_mara-matkl."物料组</span><br><span class="line">      clientdata-old_mat_no = it_mara-bismt."旧物料编码</span><br><span class="line">      clientdata-extmatlgrp = it_mara-extwg."外部物料组</span><br><span class="line">      clientdata-net_weight = it_mara-ntgew."净重</span><br><span class="line">      clientdata-unit_of_wt = pr_unit2."重量单位</span><br><span class="line">      clientdata-size_dim = it_mara-groes."大小/量纲</span><br><span class="line">      clientdata-dsn_office = it_mara-labor."实验室/办公室</span><br><span class="line">      clientdata-division = it_mara-spart."产品组</span><br><span class="line">      clientdata-item_cat = it_mara-mtpos."项目类别组</span><br><span class="line">      clientdata-trans_grp = it_mara-tragr."运输组</span><br><span class="line">      clientdata-shelf_life = it_mara-mhdhb."总货架寿命</span><br><span class="line">      clientdata-minremlife = it_mara-mhdrz."最小剩余寿命</span><br><span class="line">      clientdata-batch_mgmt = it_mara-xchar."批量管理标识</span><br><span class="line"></span><br><span class="line"><span class="comment">**********************************************************************----</span></span><br><span class="line">      clientdata-pur_status = it_mara-mstae."跨工厂物料状态</span><br><span class="line"><span class="comment">**********************************************************************</span></span><br><span class="line"></span><br><span class="line">      clientdatax-base_uom = 'X'.</span><br><span class="line">      clientdatax-matl_group = 'X'.</span><br><span class="line">      clientdatax-old_mat_no = 'X'.</span><br><span class="line">      clientdatax-net_weight = 'X'.</span><br><span class="line">      clientdatax-unit_of_wt = 'X'.</span><br><span class="line">      clientdatax-size_dim = 'X'.</span><br><span class="line">      clientdatax-dsn_office = 'X'.</span><br><span class="line">      clientdatax-division = 'X'.</span><br><span class="line">      clientdatax-item_cat = 'X'.</span><br><span class="line">      clientdatax-trans_grp = 'X'.</span><br><span class="line">      clientdatax-shelf_life = 'X'.</span><br><span class="line">      clientdatax-minremlife = 'X'.</span><br><span class="line">      clientdatax-batch_mgmt = 'X'.</span><br><span class="line"></span><br><span class="line"><span class="comment">**********************************************************************----</span></span><br><span class="line">      clientdatax-pur_status = 'X'.</span><br><span class="line"><span class="comment">**********************************************************************</span></span><br><span class="line"></span><br><span class="line">      "工厂数据</span><br><span class="line">      plantdata-plant = it_mara-werks."工厂</span><br><span class="line">      plantdata-availcheck = it_mara-mtvfp."可用性检查</span><br><span class="line">      plantdata-loadinggrp = it_mara-ladgr."装载组</span><br><span class="line">      plantdata-pur_group = it_mara-ekgrp."采购组</span><br><span class="line">      plantdata-batch_mgmt = it_mara-xchar."批量管理标识</span><br><span class="line">      plantdata-auto_p_ord = it_mara-kautb.<span class="string">"标识: "</span>允许自动采购订单"</span><br><span class="line">      <span class="string">"plantdata-ind_post_to_insp_stock = it_mara-insmk."</span>过帐到检验库存</span><br><span class="line">      plantdata-mrp_type = it_mara-dismm."MRP类型</span><br><span class="line">      plantdata-mrp_ctrler = it_mara-dispo."MRP控制者</span><br><span class="line">      plantdata-lotsizekey = it_mara-disls."批量</span><br><span class="line">      plantdata-minlotsize = it_mara-bstmi."最小批量</span><br><span class="line">      plantdata-assy_scrap = it_mara-ausss."装配报废</span><br><span class="line">      plantdata-round_val = it_mara-bstrf."采购订单舍入值</span><br><span class="line">      plantdata-proc_type = it_mara-beskz."采购类型</span><br><span class="line">      plantdata-spproctype = it_mara-sobsl."特殊采购类型</span><br><span class="line">      plantdata-backflush = it_mara-rgekz."反冲</span><br><span class="line">      plantdata-iss_st_loc = it_mara-lgpro."生产仓储地点</span><br><span class="line">      plantdata-sloc_exprc = it_mara-lgfsb."外部采购仓储地点</span><br><span class="line">      plantdata-plnd_delry = it_mara-plifz."计划交货日期</span><br><span class="line">      plantdata-sm_key = it_mara-fhori."计划边际码</span><br><span class="line">      plantdata-safety_stk = it_mara-eisbe."安全库存</span><br><span class="line">      plantdata-plan_strgp = it_mara-strgr."计划策略组</span><br><span class="line">      plantdata-consummode = it_mara-vrmod."消耗模式</span><br><span class="line">      plantdata-bwd_cons = it_mara-vint1."逆向消耗期间</span><br><span class="line">      plantdata-fwd_cons = it_mara-vint2."前向消耗期间</span><br><span class="line">      plantdata-mixed_mrp = it_mara-miskz."综合mrp</span><br><span class="line">      plantdata-comp_scrap = it_mara-kausf."部件废品</span><br><span class="line">      plantdata-dep_req_id = it_mara-sbdkz."单独/集中</span><br><span class="line">      plantdata-production_scheduler = it_mara-fevor."生产管理员</span><br><span class="line">      plantdata-unlimited = it_mara-ueetk."允许未限制的过量交货</span><br><span class="line">      plantdata-over_tol = it_mara-ueeto."超量交货容差限制</span><br><span class="line">      plantdata-no_costing = it_mara-ncost."无成本核算</span><br><span class="line">      plantdata-lot_size = it_mara-losgr. "批量产品成本核算</span><br><span class="line">      plantdata-variance_key = it_mara-awsls."差异码</span><br><span class="line">      <span class="string">"plantdata-profit_ctr = it_mara-prctr."</span>利润中心</span><br><span class="line">      plantdata-bulk_mat = it_mara-schgt."散装物料</span><br><span class="line">      <span class="string">"plantdata-proc_time = it_mara-bearz."</span>处理时间</span><br><span class="line">      <span class="string">"plantdata-base_qty = it_mara-basmg."</span>基准数量</span><br><span class="line">      <span class="string">"plantdata-inhseprodt = it_mara-dzeit."</span>厂内生产时间</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      plantdatax-plant = it_mara-werks.</span><br><span class="line">      plantdatax-availcheck = 'X'.</span><br><span class="line">      plantdatax-loadinggrp = 'X'.</span><br><span class="line">      plantdatax-pur_group = 'X'.</span><br><span class="line">      plantdatax-batch_mgmt = 'X'.</span><br><span class="line">      plantdatax-auto_p_ord = 'X'.</span><br><span class="line">      "plantdatax-ind_post_to_insp_stock = 'X'.</span><br><span class="line">      plantdatax-mrp_type = 'X'.</span><br><span class="line">      plantdatax-mrp_ctrler = 'X'.</span><br><span class="line">      plantdatax-lotsizekey = 'X'.</span><br><span class="line">      plantdatax-minlotsize = 'X'.</span><br><span class="line">      plantdatax-assy_scrap = 'X'.</span><br><span class="line">      plantdatax-round_val = 'X'.</span><br><span class="line">      plantdatax-proc_type = 'X'.</span><br><span class="line">      plantdatax-spproctype = 'X'.</span><br><span class="line">      plantdatax-backflush = 'X'.</span><br><span class="line">      plantdatax-iss_st_loc = 'X'.</span><br><span class="line">      plantdatax-sloc_exprc = 'X'.</span><br><span class="line">      plantdatax-plnd_delry = 'X'.</span><br><span class="line">      plantdatax-sm_key = 'X'.</span><br><span class="line">      plantdatax-safety_stk = 'X'.</span><br><span class="line">      plantdatax-plan_strgp = 'X'.</span><br><span class="line">      plantdatax-consummode = 'X'.</span><br><span class="line">      plantdatax-bwd_cons = 'X'.</span><br><span class="line">      plantdatax-fwd_cons = 'X'.</span><br><span class="line">      plantdatax-mixed_mrp = 'X'.</span><br><span class="line">      plantdatax-comp_scrap = 'X'.</span><br><span class="line">      plantdatax-dep_req_id = 'X'.</span><br><span class="line">      plantdatax-production_scheduler = 'X'.</span><br><span class="line">      plantdatax-unlimited = 'X'.</span><br><span class="line">      plantdatax-over_tol = 'X'.</span><br><span class="line">      plantdatax-no_costing = 'X'.</span><br><span class="line">      plantdatax-lot_size = 'X'.</span><br><span class="line">      plantdatax-variance_key = 'X'.</span><br><span class="line">      plantdatax-profit_ctr = 'X'.</span><br><span class="line">      plantdatax-bulk_mat = 'X'.</span><br><span class="line">      plantdatax-<span class="keyword">proc_time</span> = 'X'.</span><br><span class="line">      plantdatax-base_qty = 'X'.</span><br><span class="line">      plantdatax-inhseprodt = 'X'.</span><br><span class="line"></span><br><span class="line">      "计划数据</span><br><span class="line">      planningdata-plant = it_mara-werks.</span><br><span class="line"><span class="comment">*      planningdata-plng_matl = it_mara-prgrp."计划物料</span></span><br><span class="line"><span class="comment">*      planningdata-plng_plant = it_mara-prwrk."计划工厂</span></span><br><span class="line"><span class="comment">*      planningdata-convfactor = it_mara-umref."计划转换因子</span></span><br><span class="line"></span><br><span class="line">      planningdatax-plant = it_mara-werks.</span><br><span class="line"><span class="comment">*      planningdatax-plng_matl = 'X'.</span></span><br><span class="line"><span class="comment">*      planningdatax-plng_plant = 'X'.</span></span><br><span class="line"><span class="comment">*      planningdatax-convfactor = 'X'.</span></span><br><span class="line"></span><br><span class="line">      "评估数据</span><br><span class="line">      valuetiondata-val_area = it_mara-bwkey."评估范围</span><br><span class="line"><span class="comment">*    valuetiondata-val_cat = IT_MARA-bwtty."评估类别</span></span><br><span class="line">      valuetiondata-val_class = it_mara-bklas."评估类</span><br><span class="line">      valuetiondata-price_ctrl = it_mara-vprsv."价格控制</span><br><span class="line">      <span class="keyword">IF</span> it_mara-vprsv = 'V'.</span><br><span class="line"><span class="comment">*        valuetiondata-moving_pr = it_mara-stprs."移动平均价</span></span><br><span class="line"><span class="comment">*        valuetiondata-std_price = 0.</span></span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line"><span class="comment">*        valuetiondata-moving_pr = 0.</span></span><br><span class="line"><span class="comment">*        valuetiondata-std_price = it_mara-stprs."标准价格</span></span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*    valuetiondata-price_unit = IT_MARA-stprs."价格单位 PEINH</span></span><br><span class="line">      valuetiondata-price_unit = it_mara-peinh. "价格单位</span><br><span class="line">      valuetiondata-qty_struct = it_mara-ekalr."物料根据数量结构进行成本核算</span><br><span class="line">      valuetiondata-orig_mat = it_mara-hkmat."物料来源</span><br><span class="line">      <span class="keyword">IF</span> it_mara-mtart = 'Z003'</span><br><span class="line">        OR it_mara-mtart = 'Z004'</span><br><span class="line">        OR it_mara-mtart = 'Z005'</span><br><span class="line">        OR it_mara-mtart = 'Z006'</span><br><span class="line">        OR it_mara-mtart = 'Z007'.</span><br><span class="line">        valuetiondata-ml_settle = '2'. "价格确定为2，价格控制为V</span><br><span class="line">        valuetiondata-price_ctrl = 'V'.</span><br><span class="line"></span><br><span class="line">      ENDIF.</span><br><span class="line">      valuetiondatax-val_area = it_mara-bwkey.</span><br><span class="line"><span class="comment">*    valuetiondatax-val_cat = 'X'."评估类别</span></span><br><span class="line">      valuetiondatax-val_class = 'X'.</span><br><span class="line">      valuetiondatax-price_ctrl = 'X'.</span><br><span class="line">      valuetiondatax-ml_settle = 'X'.</span><br><span class="line"><span class="comment">*    IF IT_MARA-vprsv = 'V'.</span></span><br><span class="line">      valuetiondatax-moving_pr = 'X'.</span><br><span class="line"><span class="comment">*    ELSE.</span></span><br><span class="line">      valuetiondatax-std_price = 'X'.</span><br><span class="line"><span class="comment">*    ENDIF.</span></span><br><span class="line">      valuetiondatax-price_unit = 'X'.</span><br><span class="line">      valuetiondatax-orig_mat = 'X'."物料来源</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      "销售数据</span><br><span class="line">      salesdata-sales_org = it_mara-vkorg."销售组织</span><br><span class="line">      salesdata-distr_chan = it_mara-vtweg."分销渠道</span><br><span class="line">      salesdata-acct_assgt = it_mara-ktgrm."科目设置组</span><br><span class="line">      salesdata-item_cat = it_mara-mtpos."项目类别组</span><br><span class="line"><span class="comment">**********************************************************************</span></span><br><span class="line">      salesdata-sales_unit = it_mara-vrkme. "销售单位</span><br><span class="line">      salesdata-delyg_plnt = it_mara-dwerk. "交货工厂</span><br><span class="line"><span class="comment">**********************************************************************</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      salesdatax-sales_org = it_mara-vkorg."销售组织</span><br><span class="line">      salesdatax-distr_chan = it_mara-vtweg."分销渠道</span><br><span class="line">      salesdatax-acct_assgt = 'X'.</span><br><span class="line">      salesdatax-item_cat = 'X'.</span><br><span class="line"><span class="comment">**********************************************************************</span></span><br><span class="line">      salesdatax-sales_unit = 'X'.</span><br><span class="line">      salesdatax-delyg_plnt = 'X'.</span><br><span class="line"><span class="comment">**********************************************************************</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      "税分类</span><br><span class="line">      taxclassifications-depcountry = 'CN'.</span><br><span class="line">      taxclassifications-tax_type_1 = 'MWST'.</span><br><span class="line">      taxclassifications-taxclass_1 = it_mara-taxkm." 物料的税分类</span><br><span class="line">      <span class="keyword">APPEND</span> taxclassifications.</span><br><span class="line">      <span class="keyword">CLEAR</span> taxclassifications.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      "计量单位</span><br><span class="line">      unitsofmeasure-alt_unit = pr_unit.</span><br><span class="line">      "替换单位(必须为基本计量单位,否则会报错,说没有转换因子什么的)</span><br><span class="line">      unitsofmeasure-numerator = 1.    "分子</span><br><span class="line">      unitsofmeasure-denominatr = 1.    "分母</span><br><span class="line">      unitsofmeasure-gross_wt = it_mara-brgew."毛重</span><br><span class="line">      unitsofmeasure-ean_upc = it_mara-ean11."国际文件号</span><br><span class="line">      unitsofmeasure-unit_of_wt = pr_unit2.   "重量单位</span><br><span class="line">      "需要填充毛重的话,注意此处需要添加重量单位,否则会一直提示你没有指定单位</span><br><span class="line">      <span class="keyword">APPEND</span> unitsofmeasure.</span><br><span class="line">      <span class="keyword">CLEAR</span> unitsofmeasure.</span><br><span class="line"></span><br><span class="line">      unitsofmeasurex-alt_unit = pr_unit."注意此处不是填充'X'</span><br><span class="line">      unitsofmeasurex-numerator = 'X'.</span><br><span class="line">      unitsofmeasurex-denominatr = 'X'.</span><br><span class="line">      unitsofmeasurex-gross_wt = 'X'.</span><br><span class="line">      unitsofmeasurex-ean_upc = 'X'.</span><br><span class="line">      unitsofmeasurex-unit_of_wt = 'X'."此处填充'X'</span><br><span class="line">      <span class="keyword">IF</span> unitsofmeasurex-alt_unit</span><br><span class="line">      IS NOT INITIAL AND unitsofmeasurex-numerator</span><br><span class="line">      IS NOT INITIAL AND unitsofmeasurex-denominatr</span><br><span class="line">      IS NOT INITIAL.</span><br><span class="line">        <span class="keyword">APPEND</span> unitsofmeasurex.</span><br><span class="line">      ENDIF.</span><br><span class="line">      <span class="keyword">CLEAR</span> unitsofmeasurex.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      "物料描述</span><br><span class="line">      materialdescription-langu_iso = 'ZH'.</span><br><span class="line">      materialdescription-matl_desc = it_mara-maktx.</span><br><span class="line">      <span class="keyword">APPEND</span> materialdescription.</span><br><span class="line">      <span class="keyword">CLEAR</span> materialdescription.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">IF</span> it_mara-maktg IS NOT INITIAL.</span><br><span class="line">        materialdescription-langu_iso = 'ZH'.</span><br><span class="line">        materialdescription-matl_desc = it_mara-maktg.</span><br><span class="line">        <span class="keyword">APPEND</span> materialdescription.</span><br><span class="line">        <span class="keyword">CLEAR</span> materialdescription.</span><br><span class="line">      ENDIF.</span><br><span class="line">      "自定义扩展字段</span><br><span class="line">      zzbapi_te_mara-material = it_mara-matnr.</span><br><span class="line">      zzbapi_te_mara-zzmc = it_mara-zzmc.</span><br><span class="line">      zzbapi_te_mara-zzxh = it_mara-zzxh.</span><br><span class="line">      zzbapi_te_mara-zzys = it_mara-zzys.</span><br><span class="line">      zzbapi_te_mara-zzdcrl = it_mara-zzdcrl.</span><br><span class="line"></span><br><span class="line">      zzbapi_te_marax-material = it_mara-matnr.</span><br><span class="line">      zzbapi_te_marax-zzmc = 'X'.</span><br><span class="line">      zzbapi_te_marax-zzxh = 'X'.</span><br><span class="line">      zzbapi_te_marax-zzys = 'X'.</span><br><span class="line">      zzbapi_te_marax-zzdcrl = 'X'.</span><br><span class="line"></span><br><span class="line">      w_extensionin-structure = 'BAPI_TE_MARA'.</span><br><span class="line">      w_extensionin-valuepart1 = zzbapi_te_mara.</span><br><span class="line">      <span class="keyword">APPEND</span> w_extensionin.</span><br><span class="line">      w_extensioninx-structure = 'BAPI_TE_MARAX'.</span><br><span class="line">      w_extensioninx-valuepart1 = zzbapi_te_marax.</span><br><span class="line">      <span class="keyword">APPEND</span> w_extensioninx.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">IF</span> it_mara-mtart = 'Z002' OR it_mara-mtart = 'Z004' OR it_mara-mtart = 'Z006'.</span><br><span class="line">        <span class="keyword">CLEAR</span>: salesdata,salesdatax.</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line">      "调用BAPI</span><br><span class="line">      CALL FUNCTION 'BAPI_MATERIAL_SAVEDATA'</span><br><span class="line">        EXPORTING</span><br><span class="line">          headdata            = headdata</span><br><span class="line">          clientdata          = clientdata</span><br><span class="line">          clientdatax         = clientdatax</span><br><span class="line">          plantdata           = plantdata</span><br><span class="line">          plantdatax          = plantdatax</span><br><span class="line">          valuationdata       = valuetiondata</span><br><span class="line">          valuationdatax      = valuetiondatax</span><br><span class="line">          salesdata           = salesdata</span><br><span class="line">          salesdatax          = salesdatax</span><br><span class="line">        IMPORTING</span><br><span class="line">          <span class="keyword">return</span>              = <span class="literal">return</span></span><br><span class="line">        TABLES</span><br><span class="line">          extensionin         = w_extensionin</span><br><span class="line">          extensioninx        = w_extensioninx</span><br><span class="line">          materialdescription = materialdescription[]</span><br><span class="line">          unitsofmeasure      = unitsofmeasure[]</span><br><span class="line">          unitsofmeasurex     = unitsofmeasurex[]</span><br><span class="line">          taxclassifications  = taxclassifications[].</span><br><span class="line">      CALL FUNCTION 'BAPI_TRANSACTION_ROLLBACK'.</span><br><span class="line">      <span class="keyword">IF</span> <span class="keyword">return</span>-<span class="keyword">type</span> = '<span class="keyword">E</span>'.</span><br><span class="line">        it_mara-<span class="keyword">type</span> = '<span class="keyword">E</span>'.</span><br><span class="line">        it_mara-message = <span class="keyword">return</span>-message.</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line">        it_mara-<span class="keyword">type</span> = 'S'.</span><br><span class="line">        it_mara-message = '检查无误！'.</span><br><span class="line">      ENDIF.</span><br><span class="line">      MODIFY it_mara TRANSPORTING <span class="keyword">type</span> message ersda.</span><br><span class="line">    ENDLOOP.</span><br><span class="line"></span><br><span class="line">  ELSEIF p2 = 'X'.</span><br><span class="line">    LOOP AT it_mara.</span><br><span class="line">      <span class="keyword">CLEAR</span> headdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> clientdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> clientdatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> plantdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> plantdatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> planningdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> planningdatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> storagelocationdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> storagelocationdatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> valuetiondata.</span><br><span class="line">      <span class="keyword">CLEAR</span> valuetiondatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> salesdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> salesdatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> materialdescription[].</span><br><span class="line">      <span class="keyword">CLEAR</span> unitsofmeasure[].</span><br><span class="line">      <span class="keyword">CLEAR</span> unitsofmeasurex[].</span><br><span class="line">      <span class="keyword">CLEAR</span> taxclassifications[].</span><br><span class="line">      <span class="keyword">CLEAR</span> pr_unit.</span><br><span class="line">      <span class="keyword">CLEAR</span> pr_unit2.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      CALL FUNCTION 'CONVERSION_EXIT_CUNIT_INPUT'</span><br><span class="line">        EXPORTING</span><br><span class="line">          <span class="keyword">input</span>    = it_mara-meins</span><br><span class="line">          language = sy-langu</span><br><span class="line">        IMPORTING</span><br><span class="line"><span class="comment">*         LONG_TEXT      =</span></span><br><span class="line">          output   = pr_unit.</span><br><span class="line"></span><br><span class="line">      CALL FUNCTION 'CONVERSION_EXIT_CUNIT_INPUT'</span><br><span class="line">        EXPORTING</span><br><span class="line">          <span class="keyword">input</span>    = it_mara-gewei</span><br><span class="line">          language = sy-langu</span><br><span class="line">        IMPORTING</span><br><span class="line"><span class="comment">*         LONG_TEXT      =</span></span><br><span class="line">          output   = pr_unit2.</span><br><span class="line"></span><br><span class="line">      CALL FUNCTION 'CONVERSION_EXIT_ALPHA_INPUT'</span><br><span class="line">        EXPORTING</span><br><span class="line">          <span class="keyword">input</span>  = it_mara-matnr</span><br><span class="line">        IMPORTING</span><br><span class="line">          output = it_mara-matnr.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">IF</span> it_mara-matnr IS INITIAL.</span><br><span class="line">        <span class="keyword">CLEAR</span>:ran_int,ran_cahr.</span><br><span class="line">        "获取随机编号进行试运行</span><br><span class="line">        CALL FUNCTION 'QF05_RANDOM_INTEGER'</span><br><span class="line">          EXPORTING</span><br><span class="line">            ran_int_max = 1999999999</span><br><span class="line">            ran_int_min = 1099999999</span><br><span class="line">          IMPORTING</span><br><span class="line">            ran_int     = ran_int.</span><br><span class="line">        <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line"><span class="comment">* Implement suitable error handling here</span></span><br><span class="line">        ENDIF.</span><br><span class="line">        ran_cahr = ran_int.</span><br><span class="line">        CALL FUNCTION 'CONVERSION_EXIT_ALPHA_INPUT'</span><br><span class="line">          EXPORTING</span><br><span class="line">            <span class="keyword">input</span>  = ran_cahr</span><br><span class="line">          IMPORTING</span><br><span class="line">            output = it_mara-matnr.</span><br><span class="line">      ENDIF.</span><br><span class="line">      "表头数据</span><br><span class="line">      headdata-material = it_mara-matnr.</span><br><span class="line">      headdata-ind_sector = it_mara-mbrsh."行业领域</span><br><span class="line">      headdata-matl_type = it_mara-mtart."物料类型</span><br><span class="line"></span><br><span class="line">      "基本数据视图</span><br><span class="line">      headdata-basic_view     = 'X'."基本数据视图</span><br><span class="line"><span class="comment">*    headdata-sales_view     = 'X'."销售视图</span></span><br><span class="line"><span class="comment">*      headdata-purchase_view  = 'X'."采购视图</span></span><br><span class="line"><span class="comment">*    headdata-mrp_view       = 'X'."物料需求计划(MRP)视图</span></span><br><span class="line"><span class="comment">*    headdata-storage_view = 'X'."存储视图</span></span><br><span class="line"><span class="comment">*    headdata-warehouse_view = 'X'."存储视图</span></span><br><span class="line"><span class="comment">*    headdata-prt_view = 'X'."生产资源/工具(PRT)视图</span></span><br><span class="line"><span class="comment">*    headdata-account_view   = 'X'."会计视图</span></span><br><span class="line"><span class="comment">*    headdata-cost_view      = 'X'."成本视图</span></span><br><span class="line"><span class="comment">*    headdata-work_sched_view = 'X'."工作计划视图</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      "基本数据</span><br><span class="line">      clientdata-base_uom = pr_unit. "基本单位</span><br><span class="line">      clientdata-matl_group = it_mara-matkl."物料组</span><br><span class="line">      clientdata-old_mat_no = it_mara-bismt."旧物料编码</span><br><span class="line">      clientdata-net_weight = it_mara-ntgew."净重</span><br><span class="line">      clientdata-unit_of_wt = pr_unit2."重量单位</span><br><span class="line">      clientdata-size_dim = it_mara-groes."大小/量纲</span><br><span class="line">      clientdata-dsn_office = it_mara-labor."实验室/办公室</span><br><span class="line">      <span class="keyword">IF</span> it_mara-mtart <span class="keyword">EQ</span> 'Z009'.</span><br><span class="line">        clientdata-division = it_mara-spart."产品组</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*      clientdata-item_cat = it_mara-mtpos."项目类别组</span></span><br><span class="line"><span class="comment">*      clientdata-trans_grp = it_mara-tragr."运输组</span></span><br><span class="line"><span class="comment">*      clientdata-shelf_life = it_mara-mhdhb."总货架寿命</span></span><br><span class="line"><span class="comment">*      clientdata-minremlife = it_mara-mhdrz."最小剩余寿命</span></span><br><span class="line"><span class="comment">*      clientdata-batch_mgmt = it_mara-xchar."批量管理标识</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      clientdatax-base_uom = 'X'.</span><br><span class="line">      clientdatax-matl_group = 'X'.</span><br><span class="line">      clientdatax-old_mat_no = 'X'.</span><br><span class="line">      clientdatax-net_weight = 'X'.</span><br><span class="line">      clientdatax-unit_of_wt = 'X'.</span><br><span class="line">      clientdatax-size_dim = 'X'.</span><br><span class="line">      clientdatax-dsn_office = 'X'.</span><br><span class="line">      <span class="keyword">IF</span> it_mara-mtart <span class="keyword">EQ</span> 'Z009'.</span><br><span class="line">        clientdatax-division = 'X'.</span><br><span class="line">      ENDIF.</span><br><span class="line"><span class="comment">*      clientdatax-item_cat = 'X'.</span></span><br><span class="line"><span class="comment">*      clientdatax-trans_grp = 'X'.</span></span><br><span class="line"><span class="comment">*      clientdatax-shelf_life = 'X'.</span></span><br><span class="line"><span class="comment">*      clientdatax-minremlife = 'X'.</span></span><br><span class="line"><span class="comment">*      clientdatax-batch_mgmt = 'X'.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      "工厂数据</span><br><span class="line"><span class="comment">*      plantdata-plant = it_mara-werks."工厂</span></span><br><span class="line"><span class="comment">*      plantdata-availcheck = it_mara-mtvfp."可用性检查</span></span><br><span class="line"><span class="comment">*      plantdata-loadinggrp = it_mara-ladgr."装载组</span></span><br><span class="line"><span class="comment">*      plantdata-pur_group = it_mara-ekgrp."采购组</span></span><br><span class="line"><span class="comment">*      plantdata-batch_mgmt = it_mara-xchar."批量管理标识</span></span><br><span class="line"><span class="comment">*      plantdata-auto_p_ord = it_mara-kautb."标识: "允许自动采购订单"</span></span><br><span class="line"><span class="comment">*      plantdata-ind_post_to_insp_stock = it_mara-insmk."过帐到检验库存</span></span><br><span class="line"><span class="comment">*      plantdata-mrp_type = it_mara-dismm."MRP类型</span></span><br><span class="line"><span class="comment">*      plantdata-mrp_ctrler = it_mara-dispo."MRP控制者</span></span><br><span class="line"><span class="comment">*      plantdata-lotsizekey = it_mara-disls."批量</span></span><br><span class="line"><span class="comment">*      plantdata-minlotsize = it_mara-bstmi."最小批量</span></span><br><span class="line"><span class="comment">*      plantdata-assy_scrap = it_mara-ausss."装配报废</span></span><br><span class="line"><span class="comment">*      plantdata-round_val = it_mara-bstrf."采购订单舍入值</span></span><br><span class="line"><span class="comment">*      plantdata-proc_type = it_mara-beskz."采购类型</span></span><br><span class="line"><span class="comment">*      plantdata-spproctype = it_mara-sobsl."特殊采购类型</span></span><br><span class="line"><span class="comment">*      plantdata-backflush = it_mara-rgekz."反冲</span></span><br><span class="line"><span class="comment">*      plantdata-iss_st_loc = it_mara-lgpro."生产仓储地点</span></span><br><span class="line"><span class="comment">*      plantdata-sloc_exprc = it_mara-lgfsb."外部采购仓储地点</span></span><br><span class="line"><span class="comment">*      plantdata-plnd_delry = it_mara-plifz."计划交货日期</span></span><br><span class="line"><span class="comment">*      plantdata-sm_key = it_mara-fhori."计划边际码</span></span><br><span class="line"><span class="comment">*      plantdata-safety_stk = it_mara-eisbe."安全库存</span></span><br><span class="line"><span class="comment">*      plantdata-plan_strgp = it_mara-strgr."计划策略组</span></span><br><span class="line"><span class="comment">*      plantdata-consummode = it_mara-vrmod."消耗模式</span></span><br><span class="line"><span class="comment">*      plantdata-bwd_cons = it_mara-vint1."逆向消耗期间</span></span><br><span class="line"><span class="comment">*      plantdata-fwd_cons = it_mara-vint2."前向消耗期间</span></span><br><span class="line"><span class="comment">*      plantdata-comp_scrap = it_mara-kausf."部件废品</span></span><br><span class="line"><span class="comment">*      plantdata-dep_req_id = it_mara-sbdkz."单独/集中</span></span><br><span class="line"><span class="comment">*      plantdata-production_scheduler = it_mara-fevor."生产管理员</span></span><br><span class="line"><span class="comment">*      plantdata-unlimited = it_mara-ueetk."允许未限制的过量交货</span></span><br><span class="line"><span class="comment">*      plantdata-over_tol = it_mara-ueeto."超量交货容差限制</span></span><br><span class="line"><span class="comment">*      plantdata-no_costing = it_mara-ncost."无成本核算</span></span><br><span class="line"><span class="comment">*      plantdata-lot_size = it_mara-losgr. "批量产品成本核算</span></span><br><span class="line"><span class="comment">*      plantdata-variance_key = it_mara-awsls."差异码</span></span><br><span class="line"><span class="comment">*      plantdata-profit_ctr = it_mara-prctr."利润中心</span></span><br><span class="line"><span class="comment">*      plantdata-lot_size = it_mara-peinh."价格单位</span></span><br><span class="line"><span class="comment">*      plantdata-bulk_mat = it_mara-schgt."散装物料</span></span><br><span class="line"><span class="comment">*      plantdata-proc_time = it_mara-bearz."处理时间</span></span><br><span class="line"><span class="comment">*      plantdata-base_qty = it_mara-basmg."基准数量</span></span><br><span class="line"><span class="comment">*      plantdata-inhseprodt = it_matnr-dzeit."厂内生产时间</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*      plantdatax-plant = it_mara-werks.</span></span><br><span class="line"><span class="comment">*      plantdatax-availcheck = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-loadinggrp = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-pur_group = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-batch_mgmt = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-auto_p_ord = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-ind_post_to_insp_stock = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-mrp_type = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-mrp_ctrler = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-lotsizekey = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-minlotsize = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-assy_scrap = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-round_val = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-proc_type = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-spproctype = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-backflush = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-iss_st_loc = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-sloc_exprc = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-plnd_delry = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-sm_key = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-safety_stk = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-plan_strgp = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-consummode = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-bwd_cons = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-fwd_cons = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-comp_scrap = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-dep_req_id = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-production_scheduler = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-unlimited = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-over_tol = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-no_costing = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-lot_size = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-variance_key = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-profit_ctr = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-lot_size = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-bulk_mat = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-proc_time = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-base_qty = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-inhseprodt = 'X'.</span></span><br><span class="line"></span><br><span class="line">      "计划数据</span><br><span class="line"><span class="comment">*      planningdata-plant = it_mara-werks.</span></span><br><span class="line"><span class="comment">*      planningdata-plng_matl = it_mara-prgrp."计划物料</span></span><br><span class="line"><span class="comment">*      planningdata-plng_plant = it_mara-prwrk."计划工厂</span></span><br><span class="line"><span class="comment">*      planningdata-convfactor = it_mara-umref."计划转换因子</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*      planningdatax-plant = it_mara-werks.</span></span><br><span class="line"><span class="comment">*      planningdatax-plng_matl = 'X'.</span></span><br><span class="line"><span class="comment">*      planningdatax-plng_plant = 'X'.</span></span><br><span class="line"><span class="comment">*      planningdatax-convfactor = 'X'.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*      "评估数据</span></span><br><span class="line"><span class="comment">*      valuetiondata-val_area = it_mara-werks."评估范围</span></span><br><span class="line"><span class="comment">**    valuetiondata-val_cat = IT_MARA-bwtty."评估类别</span></span><br><span class="line"><span class="comment">*      valuetiondata-val_class = it_mara-bklas."评估类</span></span><br><span class="line"><span class="comment">*      valuetiondata-price_ctrl = it_mara-vprsv."价格控制</span></span><br><span class="line"><span class="comment">*      IF it_mara-vprsv = 'V'.</span></span><br><span class="line"><span class="comment">*        valuetiondata-moving_pr = it_mara-stprs."移动平均价</span></span><br><span class="line"><span class="comment">*        valuetiondata-std_price = 0.</span></span><br><span class="line"><span class="comment">*      ELSE.</span></span><br><span class="line"><span class="comment">*        valuetiondata-moving_pr = 0.</span></span><br><span class="line"><span class="comment">*        valuetiondata-std_price = it_mara-stprs."标准价格</span></span><br><span class="line"><span class="comment">*      ENDIF.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">**    valuetiondata-price_unit = IT_MARA-stprs."价格单位 PEINH</span></span><br><span class="line"><span class="comment">*      valuetiondata-price_unit = it_mara-peinh.</span></span><br><span class="line"><span class="comment">*      valuetiondata-qty_struct = it_mara-ekalr."物料根据数量结构进行成本核算</span></span><br><span class="line"><span class="comment">*      valuetiondata-orig_mat = it_mara-hkmat."物料来源</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*      valuetiondatax-val_area = it_mara-werks.</span></span><br><span class="line"><span class="comment">**    valuetiondatax-val_cat = 'X'."评估类别</span></span><br><span class="line"><span class="comment">*      valuetiondatax-val_class = 'X'.</span></span><br><span class="line"><span class="comment">*      valuetiondatax-price_ctrl = 'X'.</span></span><br><span class="line"><span class="comment">**    IF IT_MARA-vprsv = 'V'.</span></span><br><span class="line"><span class="comment">*      valuetiondatax-moving_pr = 'X'.</span></span><br><span class="line"><span class="comment">**    ELSE.</span></span><br><span class="line"><span class="comment">*      valuetiondatax-std_price = 'X'.</span></span><br><span class="line"><span class="comment">**    ENDIF.</span></span><br><span class="line"><span class="comment">*      valuetiondatax-price_unit = 'X'.</span></span><br><span class="line"><span class="comment">*      valuetiondatax-orig_mat = 'X'."物料来源</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*      "销售数据</span></span><br><span class="line"><span class="comment">*      salesdata-sales_org = it_mara-vkorg."销售组织</span></span><br><span class="line"><span class="comment">*      salesdata-distr_chan = it_mara-vtweg."分销渠道</span></span><br><span class="line"><span class="comment">*      salesdata-acct_assgt = it_mara-ktgrm."科目设置组</span></span><br><span class="line"><span class="comment">*      salesdata-item_cat = it_mara-mtpos.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*      salesdatax-sales_org = it_mara-vkorg."销售组织</span></span><br><span class="line"><span class="comment">*      salesdatax-distr_chan = it_mara-vtweg."分销渠道</span></span><br><span class="line"><span class="comment">*      salesdatax-acct_assgt = 'X'.</span></span><br><span class="line"><span class="comment">*      salesdatax-item_cat = 'X'.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*      "税分类</span></span><br><span class="line"><span class="comment">*      taxclassifications-depcountry = 'CN'.</span></span><br><span class="line"><span class="comment">*      taxclassifications-tax_type_1 = 'MWST'.</span></span><br><span class="line"><span class="comment">*      taxclassifications-taxclass_1 = it_mara-taxkm.</span></span><br><span class="line"><span class="comment">*      APPEND taxclassifications.</span></span><br><span class="line"><span class="comment">*      CLEAR taxclassifications.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      "计量单位</span><br><span class="line">      unitsofmeasure-alt_unit = pr_unit.</span><br><span class="line">      "替换单位(必须为基本计量单位,否则会报错,说没有转换因子什么的)</span><br><span class="line">      unitsofmeasure-numerator = 1.    "分子</span><br><span class="line">      unitsofmeasure-denominatr = 1.    "分母</span><br><span class="line">      unitsofmeasure-gross_wt = it_mara-brgew."毛重</span><br><span class="line">      unitsofmeasure-ean_upc = it_mara-ean11."国际文件号</span><br><span class="line">      unitsofmeasure-unit_of_wt = pr_unit2.   "重量单位</span><br><span class="line">      "需要填充毛重的话,注意此处需要添加重量单位,否则会一直提示你没有指定单位</span><br><span class="line">      <span class="keyword">APPEND</span> unitsofmeasure.</span><br><span class="line">      <span class="keyword">CLEAR</span> unitsofmeasure.</span><br><span class="line"></span><br><span class="line">      unitsofmeasurex-alt_unit = pr_unit."注意此处不是填充'X'</span><br><span class="line">      unitsofmeasurex-numerator = 'X'.</span><br><span class="line">      unitsofmeasurex-denominatr = 'X'.</span><br><span class="line">      unitsofmeasurex-gross_wt = 'X'.</span><br><span class="line">      unitsofmeasurex-ean_upc = 'X'.</span><br><span class="line">      unitsofmeasurex-unit_of_wt = 'X'."此处填充'X'</span><br><span class="line">      <span class="keyword">IF</span> unitsofmeasurex-alt_unit</span><br><span class="line">      IS NOT INITIAL AND unitsofmeasurex-numerator</span><br><span class="line">      IS NOT INITIAL AND unitsofmeasurex-denominatr</span><br><span class="line">      IS NOT INITIAL.</span><br><span class="line">        <span class="keyword">APPEND</span> unitsofmeasurex.</span><br><span class="line">      ENDIF.</span><br><span class="line">      <span class="keyword">CLEAR</span> unitsofmeasurex.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      "物料描述</span><br><span class="line">      materialdescription-langu_iso = 'ZH'.</span><br><span class="line">      materialdescription-matl_desc = it_mara-maktx.</span><br><span class="line">      <span class="keyword">APPEND</span> materialdescription.</span><br><span class="line">      <span class="keyword">CLEAR</span> materialdescription.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">IF</span> it_mara-maktg IS NOT INITIAL.</span><br><span class="line">        materialdescription-langu_iso = 'ZH'.</span><br><span class="line">        materialdescription-matl_desc = it_mara-maktg.</span><br><span class="line">        <span class="keyword">APPEND</span> materialdescription.</span><br><span class="line">        <span class="keyword">CLEAR</span> materialdescription.</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line">      "调用BAPI</span><br><span class="line">      CALL FUNCTION 'BAPI_MATERIAL_SAVEDATA'</span><br><span class="line">        EXPORTING</span><br><span class="line">          headdata            = headdata</span><br><span class="line">          clientdata          = clientdata</span><br><span class="line">          clientdatax         = clientdatax</span><br><span class="line">          plantdata           = plantdata</span><br><span class="line">          plantdatax          = plantdatax</span><br><span class="line">          valuationdata       = valuetiondata</span><br><span class="line">          valuationdatax      = valuetiondatax</span><br><span class="line">          salesdata           = salesdata</span><br><span class="line">          salesdatax          = salesdatax</span><br><span class="line">        IMPORTING</span><br><span class="line">          <span class="keyword">return</span>              = <span class="literal">return</span></span><br><span class="line">        TABLES</span><br><span class="line">          materialdescription = materialdescription[]</span><br><span class="line">          unitsofmeasure      = unitsofmeasure[]</span><br><span class="line">          unitsofmeasurex     = unitsofmeasurex[]</span><br><span class="line">          taxclassifications  = taxclassifications[].</span><br><span class="line">      CALL FUNCTION 'BAPI_TRANSACTION_ROLLBACK'.</span><br><span class="line">      <span class="keyword">IF</span> <span class="keyword">return</span>-<span class="keyword">type</span> = '<span class="keyword">E</span>'.</span><br><span class="line">        it_mara-<span class="keyword">type</span> = '<span class="keyword">E</span>'.</span><br><span class="line">        it_mara-message = <span class="keyword">return</span>-message.</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line">        it_mara-<span class="keyword">type</span> = 'S'.</span><br><span class="line">        it_mara-message = '检查无误！'.</span><br><span class="line">      ENDIF.</span><br><span class="line">      MODIFY it_mara TRANSPORTING <span class="keyword">type</span> message ersda.</span><br><span class="line">    ENDLOOP.</span><br><span class="line"></span><br><span class="line">  ELSEIF p3 = 'X'.</span><br><span class="line">    LOOP AT it_mara.</span><br><span class="line">      <span class="keyword">CLEAR</span> headdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> clientdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> clientdatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> plantdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> plantdatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> planningdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> planningdatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> storagelocationdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> storagelocationdatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> valuetiondata.</span><br><span class="line">      <span class="keyword">CLEAR</span> valuetiondatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> salesdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> salesdatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> materialdescription[].</span><br><span class="line">      <span class="keyword">CLEAR</span> unitsofmeasure[].</span><br><span class="line">      <span class="keyword">CLEAR</span> unitsofmeasurex[].</span><br><span class="line">      <span class="keyword">CLEAR</span> taxclassifications[].</span><br><span class="line">      <span class="keyword">CLEAR</span> pr_unit.</span><br><span class="line">      <span class="keyword">CLEAR</span> pr_unit2.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      CALL FUNCTION 'CONVERSION_EXIT_CUNIT_INPUT'</span><br><span class="line">        EXPORTING</span><br><span class="line">          <span class="keyword">input</span>    = it_mara-meins</span><br><span class="line">          language = sy-langu</span><br><span class="line">        IMPORTING</span><br><span class="line"><span class="comment">*         LONG_TEXT      =</span></span><br><span class="line">          output   = pr_unit.</span><br><span class="line"></span><br><span class="line">      CALL FUNCTION 'CONVERSION_EXIT_CUNIT_INPUT'</span><br><span class="line">        EXPORTING</span><br><span class="line">          <span class="keyword">input</span>    = it_mara-gewei</span><br><span class="line">          language = sy-langu</span><br><span class="line">        IMPORTING</span><br><span class="line"><span class="comment">*         LONG_TEXT      =</span></span><br><span class="line">          output   = pr_unit2.</span><br><span class="line"></span><br><span class="line">      CALL FUNCTION 'CONVERSION_EXIT_ALPHA_INPUT'</span><br><span class="line">        EXPORTING</span><br><span class="line">          <span class="keyword">input</span>  = it_mara-matnr</span><br><span class="line">        IMPORTING</span><br><span class="line">          output = it_mara-matnr.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">IF</span> it_mara-matnr IS INITIAL.</span><br><span class="line">        <span class="keyword">CLEAR</span>:ran_int,ran_cahr.</span><br><span class="line">        "获取随机编号进行试运行</span><br><span class="line">        CALL FUNCTION 'QF05_RANDOM_INTEGER'</span><br><span class="line">          EXPORTING</span><br><span class="line">            ran_int_max = 1999999999</span><br><span class="line">            ran_int_min = 1099999999</span><br><span class="line">          IMPORTING</span><br><span class="line">            ran_int     = ran_int.</span><br><span class="line">        <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line"><span class="comment">* Implement suitable error handling here</span></span><br><span class="line">        ENDIF.</span><br><span class="line">        ran_cahr = ran_int.</span><br><span class="line">        CALL FUNCTION 'CONVERSION_EXIT_ALPHA_INPUT'</span><br><span class="line">          EXPORTING</span><br><span class="line">            <span class="keyword">input</span>  = ran_cahr</span><br><span class="line">          IMPORTING</span><br><span class="line">            output = it_mara-matnr.</span><br><span class="line">      ENDIF.</span><br><span class="line">      "表头数据</span><br><span class="line">      headdata-material = it_mara-matnr.</span><br><span class="line">      headdata-ind_sector = it_mara-mbrsh."行业领域</span><br><span class="line">      headdata-matl_type = it_mara-mtart."物料类型</span><br><span class="line"></span><br><span class="line">      "基本数据视图</span><br><span class="line"><span class="comment">*      headdata-basic_view     = 'X'."基本数据视图</span></span><br><span class="line">      headdata-sales_view     = 'X'."销售视图</span><br><span class="line">      headdata-purchase_view  = 'X'."采购视图</span><br><span class="line">      headdata-mrp_view       = 'X'."物料需求计划(MRP)视图</span><br><span class="line">      headdata-storage_view = 'X'."存储视图</span><br><span class="line">      headdata-warehouse_view = 'X'."存储视图</span><br><span class="line">      headdata-prt_view = 'X'."生产资源/工具(PRT)视图</span><br><span class="line"><span class="comment">*    headdata-account_view   = 'X'."会计视图</span></span><br><span class="line"><span class="comment">*    headdata-cost_view      = 'X'."成本视图</span></span><br><span class="line">      headdata-work_sched_view = 'X'."工作计划视图</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      "基本数据</span><br><span class="line">      clientdata-base_uom = pr_unit. "基本单位</span><br><span class="line">      clientdata-matl_group = it_mara-matkl."物料组</span><br><span class="line"><span class="comment">*      clientdata-old_mat_no = it_mara-bismt."旧物料编码</span></span><br><span class="line"><span class="comment">*      clientdata-net_weight = it_mara-ntgew."净重</span></span><br><span class="line">      clientdata-unit_of_wt = pr_unit2."重量单位</span><br><span class="line"><span class="comment">*      clientdata-size_dim = it_mara-groes."大小/量纲</span></span><br><span class="line"><span class="comment">*      clientdata-dsn_office = it_mara-labor."实验室/办公室</span></span><br><span class="line">      clientdata-division = it_mara-spart."产品组</span><br><span class="line">      clientdata-item_cat = it_mara-mtpos."项目类别组</span><br><span class="line">      clientdata-trans_grp = it_mara-tragr."运输组</span><br><span class="line">      clientdata-shelf_life = it_mara-mhdhb."总货架寿命</span><br><span class="line">      clientdata-minremlife = it_mara-mhdrz."最小剩余寿命</span><br><span class="line">      clientdata-batch_mgmt = it_mara-xchar."批量管理标识</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      clientdatax-base_uom = 'X'.</span><br><span class="line">      clientdatax-matl_group = 'X'.</span><br><span class="line"><span class="comment">*      clientdatax-old_mat_no = 'X'.</span></span><br><span class="line"><span class="comment">*      clientdatax-net_weight = 'X'.</span></span><br><span class="line">      clientdatax-unit_of_wt = 'X'.</span><br><span class="line"><span class="comment">*      clientdatax-size_dim = 'X'.</span></span><br><span class="line"><span class="comment">*      clientdatax-dsn_office = 'X'.</span></span><br><span class="line">      clientdatax-division = 'X'.</span><br><span class="line">      clientdatax-item_cat = 'X'.</span><br><span class="line">      clientdatax-trans_grp = 'X'.</span><br><span class="line">      clientdatax-shelf_life = 'X'.</span><br><span class="line">      clientdatax-minremlife = 'X'.</span><br><span class="line">      clientdatax-batch_mgmt = 'X'.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*      工厂数据</span></span><br><span class="line">      plantdata-plant = it_mara-werks."工厂</span><br><span class="line">      plantdata-availcheck = it_mara-mtvfp."可用性检查</span><br><span class="line">      plantdata-loadinggrp = it_mara-ladgr."装载组</span><br><span class="line">      plantdata-pur_group = it_mara-ekgrp."采购组</span><br><span class="line">      plantdata-batch_mgmt = it_mara-xchar."批量管理标识</span><br><span class="line">      plantdata-auto_p_ord = it_mara-kautb.<span class="string">"标识: "</span>允许自动采购订单"</span><br><span class="line">      <span class="string">"plantdata-ind_post_to_insp_stock = it_mara-insmk."</span>过帐到检验库存</span><br><span class="line">      plantdata-mrp_type = it_mara-dismm."MRP类型</span><br><span class="line">      plantdata-mrp_ctrler = it_mara-dispo."MRP控制者</span><br><span class="line">      plantdata-lotsizekey = it_mara-disls."批量</span><br><span class="line">      plantdata-minlotsize = it_mara-bstmi."最小批量</span><br><span class="line">      plantdata-assy_scrap = it_mara-ausss."装配报废</span><br><span class="line">      plantdata-round_val = it_mara-bstrf."采购订单舍入值</span><br><span class="line">      plantdata-proc_type = it_mara-beskz."采购类型</span><br><span class="line">      plantdata-spproctype = it_mara-sobsl."特殊采购类型</span><br><span class="line">      plantdata-backflush = it_mara-rgekz."反冲</span><br><span class="line">      plantdata-iss_st_loc = it_mara-lgpro."生产仓储地点</span><br><span class="line">      plantdata-sloc_exprc = it_mara-lgfsb."外部采购仓储地点</span><br><span class="line">      plantdata-plnd_delry = it_mara-plifz."计划交货日期</span><br><span class="line">      plantdata-sm_key = it_mara-fhori."计划边际码</span><br><span class="line">      plantdata-safety_stk = it_mara-eisbe."安全库存</span><br><span class="line">      plantdata-plan_strgp = it_mara-strgr."计划策略组</span><br><span class="line">      plantdata-consummode = it_mara-vrmod."消耗模式</span><br><span class="line">      plantdata-bwd_cons = it_mara-vint1."逆向消耗期间</span><br><span class="line">      plantdata-fwd_cons = it_mara-vint2."前向消耗期间</span><br><span class="line">      plantdata-comp_scrap = it_mara-kausf."部件废品</span><br><span class="line">      plantdata-dep_req_id = it_mara-sbdkz."单独/集中</span><br><span class="line">      plantdata-production_scheduler = it_mara-fevor."生产管理员</span><br><span class="line">      plantdata-unlimited = it_mara-ueetk."允许未限制的过量交货</span><br><span class="line">      plantdata-over_tol = it_mara-ueeto."超量交货容差限制</span><br><span class="line"><span class="comment">*      plantdata-no_costing = it_mara-ncost."无成本核算</span></span><br><span class="line"><span class="comment">*      plantdata-lot_size = it_mara-losgr. "批量产品成本核算</span></span><br><span class="line"><span class="comment">*      plantdata-variance_key = it_mara-awsls."差异码</span></span><br><span class="line">      <span class="string">"plantdata-profit_ctr = it_mara-prctr."</span>利润中心</span><br><span class="line"><span class="comment">*      plantdata-lot_size = it_mara-peinh."价格单位</span></span><br><span class="line">      plantdata-bulk_mat = it_mara-schgt."散装物料</span><br><span class="line"><span class="comment">*      plantdata-proc_time = it_mara-bearz."处理时间</span></span><br><span class="line"><span class="comment">*      plantdata-base_qty = it_mara-basmg."基准数量</span></span><br><span class="line"><span class="comment">*      plantdata-inhseprodt = it_mara-dzeit."厂内生产时间</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      plantdatax-plant = it_mara-werks.</span><br><span class="line">      plantdatax-availcheck = 'X'.</span><br><span class="line">      plantdatax-loadinggrp = 'X'.</span><br><span class="line">      plantdatax-pur_group = 'X'.</span><br><span class="line">      plantdatax-batch_mgmt = 'X'.</span><br><span class="line">      plantdatax-auto_p_ord = 'X'.</span><br><span class="line">      plantdatax-ind_post_to_insp_stock = 'X'.</span><br><span class="line">      plantdatax-mrp_type = 'X'.</span><br><span class="line">      plantdatax-mrp_ctrler = 'X'.</span><br><span class="line">      plantdatax-lotsizekey = 'X'.</span><br><span class="line">      plantdatax-minlotsize = 'X'.</span><br><span class="line">      plantdatax-assy_scrap = 'X'.</span><br><span class="line">      plantdatax-round_val = 'X'.</span><br><span class="line">      plantdatax-proc_type = 'X'.</span><br><span class="line">      plantdatax-spproctype = 'X'.</span><br><span class="line">      plantdatax-backflush = 'X'.</span><br><span class="line">      plantdatax-iss_st_loc = 'X'.</span><br><span class="line">      plantdatax-sloc_exprc = 'X'.</span><br><span class="line">      plantdatax-plnd_delry = 'X'.</span><br><span class="line">      plantdatax-sm_key = 'X'.</span><br><span class="line">      plantdatax-safety_stk = 'X'.</span><br><span class="line">      plantdatax-plan_strgp = 'X'.</span><br><span class="line">      plantdatax-consummode = 'X'.</span><br><span class="line">      plantdatax-bwd_cons = 'X'.</span><br><span class="line">      plantdatax-fwd_cons = 'X'.</span><br><span class="line">      plantdatax-comp_scrap = 'X'.</span><br><span class="line">      plantdatax-dep_req_id = 'X'.</span><br><span class="line">      plantdatax-production_scheduler = 'X'.</span><br><span class="line">      plantdatax-unlimited = 'X'.</span><br><span class="line">      plantdatax-over_tol = 'X'.</span><br><span class="line"><span class="comment">*      plantdatax-no_costing = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-lot_size = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-variance_key = 'X'.</span></span><br><span class="line">      plantdatax-profit_ctr = 'X'.</span><br><span class="line"><span class="comment">*      plantdatax-lot_size = 'X'.</span></span><br><span class="line">      plantdatax-bulk_mat = 'X'.</span><br><span class="line">      plantdatax-<span class="keyword">proc_time</span> = 'X'.</span><br><span class="line">      plantdatax-base_qty = 'X'.</span><br><span class="line">      plantdatax-inhseprodt = 'X'.</span><br><span class="line"></span><br><span class="line"><span class="comment">*      计划数据</span></span><br><span class="line">      planningdata-plant = it_mara-werks.</span><br><span class="line"><span class="comment">*      planningdata-plng_matl = it_mara-prgrp."计划物料</span></span><br><span class="line"><span class="comment">*      planningdata-plng_plant = it_mara-prwrk."计划工厂</span></span><br><span class="line"><span class="comment">*      planningdata-convfactor = it_mara-umref."计划转换因子</span></span><br><span class="line"></span><br><span class="line">      planningdatax-plant = it_mara-werks.</span><br><span class="line">      planningdatax-plng_matl = 'X'.</span><br><span class="line">      planningdatax-plng_plant = 'X'.</span><br><span class="line">      planningdatax-convfactor = 'X'.</span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*      "评估数据</span></span><br><span class="line"><span class="comment">*      valuetiondata-val_area = it_mara-werks."评估范围</span></span><br><span class="line"><span class="comment">**    valuetiondata-val_cat = IT_MARA-bwtty."评估类别</span></span><br><span class="line"><span class="comment">*      valuetiondata-val_class = it_mara-bklas."评估类</span></span><br><span class="line"><span class="comment">*      valuetiondata-price_ctrl = it_mara-vprsv."价格控制</span></span><br><span class="line"><span class="comment">*      IF it_mara-vprsv = 'V'.</span></span><br><span class="line"><span class="comment">*        valuetiondata-moving_pr = it_mara-stprs."移动平均价</span></span><br><span class="line"><span class="comment">*        valuetiondata-std_price = 0.</span></span><br><span class="line"><span class="comment">*      ELSE.</span></span><br><span class="line"><span class="comment">*        valuetiondata-moving_pr = 0.</span></span><br><span class="line"><span class="comment">*        valuetiondata-std_price = it_mara-stprs."标准价格</span></span><br><span class="line"><span class="comment">*      ENDIF.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">**    valuetiondata-price_unit = IT_MARA-stprs."价格单位 PEINH</span></span><br><span class="line"><span class="comment">*      valuetiondata-price_unit = it_mara-peinh.</span></span><br><span class="line"><span class="comment">*      valuetiondata-qty_struct = it_mara-ekalr."物料根据数量结构进行成本核算</span></span><br><span class="line"><span class="comment">*      valuetiondata-orig_mat = it_mara-hkmat."物料来源</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*      valuetiondatax-val_area = it_mara-werks.</span></span><br><span class="line"><span class="comment">**    valuetiondatax-val_cat = 'X'."评估类别</span></span><br><span class="line"><span class="comment">*      valuetiondatax-val_class = 'X'.</span></span><br><span class="line"><span class="comment">*      valuetiondatax-price_ctrl = 'X'.</span></span><br><span class="line"><span class="comment">**    IF IT_MARA-vprsv = 'V'.</span></span><br><span class="line"><span class="comment">*      valuetiondatax-moving_pr = 'X'.</span></span><br><span class="line"><span class="comment">**    ELSE.</span></span><br><span class="line"><span class="comment">*      valuetiondatax-std_price = 'X'.</span></span><br><span class="line"><span class="comment">**    ENDIF.</span></span><br><span class="line"><span class="comment">*      valuetiondatax-price_unit = 'X'.</span></span><br><span class="line"><span class="comment">*      valuetiondatax-orig_mat = 'X'."物料来源</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line">      "销售数据</span><br><span class="line">      salesdata-sales_org = it_mara-vkorg."销售组织</span><br><span class="line">      salesdata-distr_chan = it_mara-vtweg."分销渠道</span><br><span class="line">      salesdata-acct_assgt = it_mara-ktgrm."科目设置组</span><br><span class="line">      salesdata-item_cat = it_mara-mtpos.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      salesdatax-sales_org = it_mara-vkorg."销售组织</span><br><span class="line">      salesdatax-distr_chan = it_mara-vtweg."分销渠道</span><br><span class="line">      salesdatax-acct_assgt = 'X'.</span><br><span class="line">      salesdatax-item_cat = 'X'.</span><br><span class="line"></span><br><span class="line">      "税分类</span><br><span class="line">      taxclassifications-depcountry = 'CN'.</span><br><span class="line">      taxclassifications-tax_type_1 = 'MWST'.</span><br><span class="line">      taxclassifications-taxclass_1 = it_mara-taxkm.</span><br><span class="line">      <span class="keyword">APPEND</span> taxclassifications.</span><br><span class="line">      <span class="keyword">CLEAR</span> taxclassifications.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*      "计量单位</span></span><br><span class="line"><span class="comment">*      unitsofmeasure-alt_unit = pr_unit.</span></span><br><span class="line"><span class="comment">*      "替换单位(必须为基本计量单位,否则会报错,说没有转换因子什么的)</span></span><br><span class="line"><span class="comment">*      unitsofmeasure-numerator = 1.    "分子</span></span><br><span class="line"><span class="comment">*      unitsofmeasure-denominatr = 1.    "分母</span></span><br><span class="line"><span class="comment">*      unitsofmeasure-gross_wt = it_mara-brgew."毛重</span></span><br><span class="line"><span class="comment">*      unitsofmeasure-ean_upc = it_mara-ean11."国际文件号</span></span><br><span class="line"><span class="comment">*      unitsofmeasure-unit_of_wt = pr_unit2.   "重量单位</span></span><br><span class="line"><span class="comment">*      "需要填充毛重的话,注意此处需要添加重量单位,否则会一直提示你没有指定单位</span></span><br><span class="line"><span class="comment">*      APPEND unitsofmeasure.</span></span><br><span class="line"><span class="comment">*      CLEAR unitsofmeasure.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*      unitsofmeasurex-alt_unit = pr_unit."注意此处不是填充'X'</span></span><br><span class="line"><span class="comment">*      unitsofmeasurex-numerator = 'X'.</span></span><br><span class="line"><span class="comment">*      unitsofmeasurex-denominatr = 'X'.</span></span><br><span class="line"><span class="comment">*      unitsofmeasurex-gross_wt = 'X'.</span></span><br><span class="line"><span class="comment">*      unitsofmeasurex-ean_upc = 'X'.</span></span><br><span class="line"><span class="comment">*      unitsofmeasurex-unit_of_wt = 'X'."此处填充'X'</span></span><br><span class="line"><span class="comment">*      IF unitsofmeasurex-alt_unit</span></span><br><span class="line"><span class="comment">*        IS NOT INITIAL AND unitsofmeasurex-numerator</span></span><br><span class="line"><span class="comment">*        IS NOT INITIAL AND unitsofmeasurex-denominatr</span></span><br><span class="line"><span class="comment">*        IS NOT INITIAL.</span></span><br><span class="line"><span class="comment">*        APPEND unitsofmeasurex.</span></span><br><span class="line"><span class="comment">*      ENDIF.</span></span><br><span class="line"><span class="comment">*      CLEAR unitsofmeasurex.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*      "物料描述</span></span><br><span class="line"><span class="comment">*      materialdescription-langu_iso = 'ZH'.</span></span><br><span class="line"><span class="comment">*      materialdescription-matl_desc = it_mara-maktx.</span></span><br><span class="line"><span class="comment">*      APPEND materialdescription.</span></span><br><span class="line"><span class="comment">*      CLEAR materialdescription.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*      IF it_mara-maktg IS NOT INITIAL.</span></span><br><span class="line"><span class="comment">*        materialdescription-langu_iso = 'ZH'.</span></span><br><span class="line"><span class="comment">*        materialdescription-matl_desc = it_mara-maktg.</span></span><br><span class="line"><span class="comment">*        APPEND materialdescription.</span></span><br><span class="line"><span class="comment">*        CLEAR materialdescription.</span></span><br><span class="line"><span class="comment">*      ENDIF.</span></span><br><span class="line"></span><br><span class="line">      "调用BAPI</span><br><span class="line">      CALL FUNCTION 'BAPI_MATERIAL_SAVEDATA'</span><br><span class="line">        EXPORTING</span><br><span class="line">          headdata            = headdata</span><br><span class="line">          clientdata          = clientdata</span><br><span class="line">          clientdatax         = clientdatax</span><br><span class="line">          plantdata           = plantdata</span><br><span class="line">          plantdatax          = plantdatax</span><br><span class="line">          valuationdata       = valuetiondata</span><br><span class="line">          valuationdatax      = valuetiondatax</span><br><span class="line">          salesdata           = salesdata</span><br><span class="line">          salesdatax          = salesdatax</span><br><span class="line">        IMPORTING</span><br><span class="line">          <span class="keyword">return</span>              = <span class="literal">return</span></span><br><span class="line">        TABLES</span><br><span class="line">          materialdescription = materialdescription[]</span><br><span class="line">          unitsofmeasure      = unitsofmeasure[]</span><br><span class="line">          unitsofmeasurex     = unitsofmeasurex[]</span><br><span class="line">          taxclassifications  = taxclassifications[].</span><br><span class="line">      CALL FUNCTION 'BAPI_TRANSACTION_ROLLBACK'.</span><br><span class="line">      <span class="keyword">IF</span> <span class="keyword">return</span>-<span class="keyword">type</span> = '<span class="keyword">E</span>'.</span><br><span class="line">        it_mara-<span class="keyword">type</span> = '<span class="keyword">E</span>'.</span><br><span class="line">        it_mara-message = <span class="keyword">return</span>-message.</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line">        it_mara-<span class="keyword">type</span> = 'S'.</span><br><span class="line">        it_mara-message = '检查无误！'.</span><br><span class="line">      ENDIF.</span><br><span class="line">      MODIFY it_mara TRANSPORTING <span class="keyword">type</span> message ersda.</span><br><span class="line">    ENDLOOP.</span><br><span class="line"></span><br><span class="line">  ELSEIF p4 = 'X'.</span><br><span class="line">    LOOP AT it_mara.</span><br><span class="line">      <span class="keyword">CLEAR</span> headdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> clientdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> clientdatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> plantdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> plantdatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> planningdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> planningdatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> storagelocationdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> storagelocationdatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> valuetiondata.</span><br><span class="line">      <span class="keyword">CLEAR</span> valuetiondatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> salesdata.</span><br><span class="line">      <span class="keyword">CLEAR</span> salesdatax.</span><br><span class="line">      <span class="keyword">CLEAR</span> materialdescription[].</span><br><span class="line">      <span class="keyword">CLEAR</span> unitsofmeasure[].</span><br><span class="line">      <span class="keyword">CLEAR</span> unitsofmeasurex[].</span><br><span class="line">      <span class="keyword">CLEAR</span> taxclassifications[].</span><br><span class="line">      <span class="keyword">CLEAR</span> pr_unit.</span><br><span class="line">      <span class="keyword">CLEAR</span> pr_unit2.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      CALL FUNCTION 'CONVERSION_EXIT_CUNIT_INPUT'</span><br><span class="line">        EXPORTING</span><br><span class="line">          <span class="keyword">input</span>    = it_mara-meins</span><br><span class="line">          language = sy-langu</span><br><span class="line">        IMPORTING</span><br><span class="line"><span class="comment">*         LONG_TEXT      =</span></span><br><span class="line">          output   = pr_unit.</span><br><span class="line"></span><br><span class="line">      CALL FUNCTION 'CONVERSION_EXIT_CUNIT_INPUT'</span><br><span class="line">        EXPORTING</span><br><span class="line">          <span class="keyword">input</span>    = it_mara-gewei</span><br><span class="line">          language = sy-langu</span><br><span class="line">        IMPORTING</span><br><span class="line"><span class="comment">*         LONG_TEXT      =</span></span><br><span class="line">          output   = pr_unit2.</span><br><span class="line"></span><br><span class="line">      CALL FUNCTION 'CONVERSION_EXIT_ALPHA_INPUT'</span><br><span class="line">        EXPORTING</span><br><span class="line">          <span class="keyword">input</span>  = it_mara-matnr</span><br><span class="line">        IMPORTING</span><br><span class="line">          output = it_mara-matnr.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">IF</span> it_mara-matnr IS INITIAL.</span><br><span class="line">        <span class="keyword">CLEAR</span>:ran_int,ran_cahr.</span><br><span class="line">        "获取随机编号进行试运行</span><br><span class="line">        CALL FUNCTION 'QF05_RANDOM_INTEGER'</span><br><span class="line">          EXPORTING</span><br><span class="line">            ran_int_max = 1999999999</span><br><span class="line">            ran_int_min = 1099999999</span><br><span class="line">          IMPORTING</span><br><span class="line">            ran_int     = ran_int.</span><br><span class="line">        <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line"><span class="comment">* Implement suitable error handling here</span></span><br><span class="line">        ENDIF.</span><br><span class="line">        ran_cahr = ran_int.</span><br><span class="line">        CALL FUNCTION 'CONVERSION_EXIT_ALPHA_INPUT'</span><br><span class="line">          EXPORTING</span><br><span class="line">            <span class="keyword">input</span>  = ran_cahr</span><br><span class="line">          IMPORTING</span><br><span class="line">            output = it_mara-matnr.</span><br><span class="line">      ENDIF.</span><br><span class="line">      "表头数据</span><br><span class="line">      headdata-material = it_mara-matnr.</span><br><span class="line">      headdata-ind_sector = it_mara-mbrsh."行业领域</span><br><span class="line">      headdata-matl_type = it_mara-mtart."物料类型</span><br><span class="line"></span><br><span class="line">      "基本数据视图</span><br><span class="line"><span class="comment">*      headdata-basic_view     = 'X'."基本数据视图</span></span><br><span class="line"><span class="comment">*      headdata-sales_view     = 'X'."销售视图</span></span><br><span class="line"><span class="comment">*      headdata-purchase_view  = 'X'."采购视图</span></span><br><span class="line"><span class="comment">*      headdata-mrp_view       = 'X'."物料需求计划(MRP)视图</span></span><br><span class="line"><span class="comment">*      headdata-storage_view = 'X'."存储视图</span></span><br><span class="line"><span class="comment">*      headdata-warehouse_view = 'X'."存储视图</span></span><br><span class="line"><span class="comment">*      headdata-prt_view = 'X'."生产资源/工具(PRT)视图</span></span><br><span class="line">      headdata-account_view   = 'X'."会计视图</span><br><span class="line">      headdata-cost_view      = 'X'."成本视图</span><br><span class="line"><span class="comment">*      headdata-work_sched_view = 'X'."工作计划视图</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      "基本数据</span><br><span class="line"><span class="comment">*      clientdata-base_uom = pr_unit. "基本单位</span></span><br><span class="line"><span class="comment">*      clientdata-matl_group = it_mara-matkl."物料组</span></span><br><span class="line"><span class="comment">*      clientdata-old_mat_no = it_mara-bismt."旧物料编码</span></span><br><span class="line"><span class="comment">*      clientdata-net_weight = it_mara-ntgew."净重</span></span><br><span class="line"><span class="comment">*      clientdata-unit_of_wt = pr_unit2."重量单位</span></span><br><span class="line"><span class="comment">*      clientdata-size_dim = it_mara-groes."大小/量纲</span></span><br><span class="line"><span class="comment">*      clientdata-dsn_office = it_mara-labor."实验室/办公室</span></span><br><span class="line"><span class="comment">*      clientdata-division = it_mara-spart."产品组</span></span><br><span class="line"><span class="comment">*      clientdata-item_cat = it_mara-mtpos."项目类别组</span></span><br><span class="line"><span class="comment">*      clientdata-trans_grp = it_mara-tragr."运输组</span></span><br><span class="line"><span class="comment">*      clientdata-shelf_life = it_mara-mhdhb."总货架寿命</span></span><br><span class="line"><span class="comment">*      clientdata-minremlife = it_mara-mhdrz."最小剩余寿命</span></span><br><span class="line"><span class="comment">*      clientdata-batch_mgmt = it_mara-xchar."批量管理标识</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*      clientdatax-base_uom = 'X'.</span></span><br><span class="line"><span class="comment">*      clientdatax-matl_group = 'X'.</span></span><br><span class="line"><span class="comment">*      clientdatax-old_mat_no = 'X'.</span></span><br><span class="line"><span class="comment">*      clientdatax-net_weight = 'X'.</span></span><br><span class="line"><span class="comment">*      clientdatax-unit_of_wt = 'X'.</span></span><br><span class="line"><span class="comment">*      clientdatax-size_dim = 'X'.</span></span><br><span class="line"><span class="comment">*      clientdatax-dsn_office = 'X'.</span></span><br><span class="line"><span class="comment">*      clientdatax-division = 'X'.</span></span><br><span class="line"><span class="comment">*      clientdatax-item_cat = 'X'.</span></span><br><span class="line"><span class="comment">*      clientdatax-trans_grp = 'X'.</span></span><br><span class="line"><span class="comment">*      clientdatax-shelf_life = 'X'.</span></span><br><span class="line"><span class="comment">*      clientdatax-minremlife = 'X'.</span></span><br><span class="line"><span class="comment">*      clientdatax-batch_mgmt = 'X'.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*      工厂数据</span></span><br><span class="line">      plantdata-plant = it_mara-werks."工厂</span><br><span class="line"><span class="comment">*      plantdata-availcheck = it_mara-mtvfp."可用性检查</span></span><br><span class="line"><span class="comment">*      plantdata-loadinggrp = it_mara-ladgr."装载组</span></span><br><span class="line"><span class="comment">*      plantdata-pur_group = it_mara-ekgrp."采购组</span></span><br><span class="line"><span class="comment">*      plantdata-batch_mgmt = it_mara-xchar."批量管理标识</span></span><br><span class="line"><span class="comment">*      plantdata-auto_p_ord = it_mara-kautb."标识: "允许自动采购订单"</span></span><br><span class="line"><span class="comment">*      plantdata-ind_post_to_insp_stock = it_mara-insmk."过帐到检验库存</span></span><br><span class="line"><span class="comment">*      plantdata-mrp_type = it_mara-dismm."MRP类型</span></span><br><span class="line"><span class="comment">*      plantdata-mrp_ctrler = it_mara-dispo."MRP控制者</span></span><br><span class="line"><span class="comment">*      plantdata-lotsizekey = it_mara-disls."批量</span></span><br><span class="line"><span class="comment">*      plantdata-minlotsize = it_mara-bstmi."最小批量</span></span><br><span class="line"><span class="comment">*      plantdata-assy_scrap = it_mara-ausss."装配报废</span></span><br><span class="line"><span class="comment">*      plantdata-round_val = it_mara-bstrf."采购订单舍入值</span></span><br><span class="line"><span class="comment">*      plantdata-proc_type = it_mara-beskz."采购类型</span></span><br><span class="line"><span class="comment">*      plantdata-spproctype = it_mara-sobsl."特殊采购类型</span></span><br><span class="line"><span class="comment">*      plantdata-backflush = it_mara-rgekz."反冲</span></span><br><span class="line"><span class="comment">*      plantdata-iss_st_loc = it_mara-lgpro."生产仓储地点</span></span><br><span class="line"><span class="comment">*      plantdata-sloc_exprc = it_mara-lgfsb."外部采购仓储地点</span></span><br><span class="line"><span class="comment">*      plantdata-plnd_delry = it_mara-plifz."计划交货日期</span></span><br><span class="line"><span class="comment">*      plantdata-sm_key = it_mara-fhori."计划边际码</span></span><br><span class="line"><span class="comment">*      plantdata-safety_stk = it_mara-eisbe."安全库存</span></span><br><span class="line"><span class="comment">*      plantdata-plan_strgp = it_mara-strgr."计划策略组</span></span><br><span class="line"><span class="comment">*      plantdata-consummode = it_mara-vrmod."消耗模式</span></span><br><span class="line"><span class="comment">*      plantdata-bwd_cons = it_mara-vint1."逆向消耗期间</span></span><br><span class="line"><span class="comment">*      plantdata-fwd_cons = it_mara-vint2."前向消耗期间</span></span><br><span class="line"><span class="comment">*      plantdata-comp_scrap = it_mara-kausf."部件废品</span></span><br><span class="line"><span class="comment">*      plantdata-dep_req_id = it_mara-sbdkz."单独/集中</span></span><br><span class="line"><span class="comment">*      plantdata-production_scheduler = it_mara-fevor."生产管理员</span></span><br><span class="line"><span class="comment">*      plantdata-unlimited = it_mara-ueetk."允许未限制的过量交货</span></span><br><span class="line"><span class="comment">*      plantdata-over_tol = it_mara-ueeto."超量交货容差限制</span></span><br><span class="line">      plantdata-no_costing = it_mara-ncost."无成本核算</span><br><span class="line">      plantdata-lot_size = it_mara-losgr. "批量产品成本核算</span><br><span class="line">      plantdata-variance_key = it_mara-awsls."差异码</span><br><span class="line">      <span class="string">"plantdata-profit_ctr = it_mara-prctr."</span>利润中心</span><br><span class="line">      plantdata-lot_size = it_mara-peinh."价格单位</span><br><span class="line"><span class="comment">*      plantdata-bulk_mat = it_mara-schgt."散装物料</span></span><br><span class="line"><span class="comment">*      plantdata-proc_time = it_mara-bearz."处理时间</span></span><br><span class="line"><span class="comment">*      plantdata-base_qty = it_mara-basmg."基准数量</span></span><br><span class="line"><span class="comment">*      plantdata-inhseprodt = it_matnr-dzeit."厂内生产时间</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      plantdatax-plant = it_mara-werks.</span><br><span class="line"><span class="comment">*      plantdatax-availcheck = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-loadinggrp = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-pur_group = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-batch_mgmt = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-auto_p_ord = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-ind_post_to_insp_stock = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-mrp_type = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-mrp_ctrler = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-lotsizekey = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-minlotsize = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-assy_scrap = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-round_val = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-proc_type = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-spproctype = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-backflush = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-iss_st_loc = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-sloc_exprc = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-plnd_delry = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-sm_key = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-safety_stk = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-plan_strgp = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-consummode = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-bwd_cons = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-fwd_cons = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-comp_scrap = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-dep_req_id = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-production_scheduler = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-unlimited = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-over_tol = 'X'.</span></span><br><span class="line">      plantdatax-no_costing = 'X'.</span><br><span class="line">      plantdatax-lot_size = 'X'.</span><br><span class="line">      plantdatax-variance_key = 'X'.</span><br><span class="line">      plantdatax-profit_ctr = 'X'.</span><br><span class="line">      plantdatax-lot_size = 'X'.</span><br><span class="line"><span class="comment">*      plantdatax-bulk_mat = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-proc_time = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-base_qty = 'X'.</span></span><br><span class="line"><span class="comment">*      plantdatax-inhseprodt = 'X'.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">*      计划数据</span></span><br><span class="line"><span class="comment">*      planningdata-plant = it_mara-werks.</span></span><br><span class="line"><span class="comment">*      planningdata-plng_matl = it_mara-prgrp."计划物料</span></span><br><span class="line"><span class="comment">*      planningdata-plng_plant = it_mara-prwrk."计划工厂</span></span><br><span class="line"><span class="comment">*      planningdata-convfactor = it_mara-umref."计划转换因子</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*      planningdatax-plant = it_mara-werks.</span></span><br><span class="line"><span class="comment">*      planningdatax-plng_matl = 'X'.</span></span><br><span class="line"><span class="comment">*      planningdatax-plng_plant = 'X'.</span></span><br><span class="line"><span class="comment">*      planningdatax-convfactor = 'X'.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line">      "评估数据</span><br><span class="line">      valuetiondata-val_area = it_mara-werks."评估范围</span><br><span class="line"><span class="comment">*    valuetiondata-val_cat = IT_MARA-bwtty."评估类别</span></span><br><span class="line">      valuetiondata-val_class = it_mara-bklas."评估类</span><br><span class="line">      valuetiondata-price_ctrl = it_mara-vprsv."价格控制</span><br><span class="line">      <span class="keyword">IF</span> it_mara-vprsv = 'V'.</span><br><span class="line"><span class="comment">*        valuetiondata-moving_pr = it_mara-stprs."移动平均价</span></span><br><span class="line"><span class="comment">*        valuetiondata-std_price = 0.</span></span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line"><span class="comment">*        valuetiondata-moving_pr = 0.</span></span><br><span class="line"><span class="comment">*        valuetiondata-std_price = it_mara-stprs."标准价格</span></span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*    valuetiondata-price_unit = IT_MARA-stprs."价格单位 PEINH</span></span><br><span class="line">      valuetiondata-price_unit = it_mara-peinh.</span><br><span class="line">      valuetiondata-qty_struct = it_mara-ekalr."物料根据数量结构进行成本核算</span><br><span class="line">      <span class="string">"valuetiondata-orig_mat = it_mara-hkmat."</span>物料来源</span><br><span class="line"></span><br><span class="line">      valuetiondatax-val_area = it_mara-werks.</span><br><span class="line"><span class="comment">*    valuetiondatax-val_cat = 'X'."评估类别</span></span><br><span class="line">      valuetiondatax-val_class = 'X'.</span><br><span class="line">      valuetiondatax-price_ctrl = 'X'.</span><br><span class="line"><span class="comment">*    IF IT_MARA-vprsv = 'V'.</span></span><br><span class="line">      valuetiondatax-moving_pr = 'X'.</span><br><span class="line"><span class="comment">*    ELSE.</span></span><br><span class="line">      valuetiondatax-std_price = 'X'.</span><br><span class="line"><span class="comment">*    ENDIF.</span></span><br><span class="line">      valuetiondatax-price_unit = 'X'.</span><br><span class="line">      valuetiondatax-orig_mat = 'X'."物料来源</span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line">      "销售数据</span><br><span class="line">      salesdata-sales_org = it_mara-vkorg."销售组织</span><br><span class="line">      salesdata-distr_chan = it_mara-vtweg."分销渠道</span><br><span class="line">      salesdata-acct_assgt = it_mara-ktgrm."科目设置组</span><br><span class="line">      salesdata-item_cat = it_mara-mtpos.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      salesdatax-sales_org = it_mara-vkorg."销售组织</span><br><span class="line">      salesdatax-distr_chan = it_mara-vtweg."分销渠道</span><br><span class="line">      salesdatax-acct_assgt = 'X'.</span><br><span class="line">      salesdatax-item_cat = 'X'.</span><br><span class="line"></span><br><span class="line">      "税分类</span><br><span class="line">      taxclassifications-depcountry = 'CN'.</span><br><span class="line">      taxclassifications-tax_type_1 = 'MWST'.</span><br><span class="line">      taxclassifications-taxclass_1 = it_mara-taxkm.</span><br><span class="line">      <span class="keyword">APPEND</span> taxclassifications.</span><br><span class="line">      <span class="keyword">CLEAR</span> taxclassifications.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*      "计量单位</span></span><br><span class="line"><span class="comment">*      unitsofmeasure-alt_unit = pr_unit.</span></span><br><span class="line"><span class="comment">*      "替换单位(必须为基本计量单位,否则会报错,说没有转换因子什么的)</span></span><br><span class="line"><span class="comment">*      unitsofmeasure-numerator = 1.    "分子</span></span><br><span class="line"><span class="comment">*      unitsofmeasure-denominatr = 1.    "分母</span></span><br><span class="line"><span class="comment">*      unitsofmeasure-gross_wt = it_mara-brgew."毛重</span></span><br><span class="line"><span class="comment">*      unitsofmeasure-ean_upc = it_mara-ean11."国际文件号</span></span><br><span class="line"><span class="comment">*      unitsofmeasure-unit_of_wt = pr_unit2.   "重量单位</span></span><br><span class="line"><span class="comment">*      "需要填充毛重的话,注意此处需要添加重量单位,否则会一直提示你没有指定单位</span></span><br><span class="line"><span class="comment">*      APPEND unitsofmeasure.</span></span><br><span class="line"><span class="comment">*      CLEAR unitsofmeasure.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*      unitsofmeasurex-alt_unit = pr_unit."注意此处不是填充'X'</span></span><br><span class="line"><span class="comment">*      unitsofmeasurex-numerator = 'X'.</span></span><br><span class="line"><span class="comment">*      unitsofmeasurex-denominatr = 'X'.</span></span><br><span class="line"><span class="comment">*      unitsofmeasurex-gross_wt = 'X'.</span></span><br><span class="line"><span class="comment">*      unitsofmeasurex-ean_upc = 'X'.</span></span><br><span class="line"><span class="comment">*      unitsofmeasurex-unit_of_wt = 'X'."此处填充'X'</span></span><br><span class="line"><span class="comment">*      IF unitsofmeasurex-alt_unit</span></span><br><span class="line"><span class="comment">*        IS NOT INITIAL AND unitsofmeasurex-numerator</span></span><br><span class="line"><span class="comment">*        IS NOT INITIAL AND unitsofmeasurex-denominatr</span></span><br><span class="line"><span class="comment">*        IS NOT INITIAL.</span></span><br><span class="line"><span class="comment">*        APPEND unitsofmeasurex.</span></span><br><span class="line"><span class="comment">*      ENDIF.</span></span><br><span class="line"><span class="comment">*      CLEAR unitsofmeasurex.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*      "物料描述</span></span><br><span class="line"><span class="comment">*      materialdescription-langu_iso = 'ZH'.</span></span><br><span class="line"><span class="comment">*      materialdescription-matl_desc = it_mara-maktx.</span></span><br><span class="line"><span class="comment">*      APPEND materialdescription.</span></span><br><span class="line"><span class="comment">*      CLEAR materialdescription.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*      IF it_mara-maktg IS NOT INITIAL.</span></span><br><span class="line"><span class="comment">*        materialdescription-langu_iso = 'ZH'.</span></span><br><span class="line"><span class="comment">*        materialdescription-matl_desc = it_mara-maktg.</span></span><br><span class="line"><span class="comment">*        APPEND materialdescription.</span></span><br><span class="line"><span class="comment">*        CLEAR materialdescription.</span></span><br><span class="line"><span class="comment">*      ENDIF.</span></span><br><span class="line"></span><br><span class="line">      "调用BAPI</span><br><span class="line">      CALL FUNCTION 'BAPI_MATERIAL_SAVEDATA'</span><br><span class="line">        EXPORTING</span><br><span class="line">          headdata            = headdata</span><br><span class="line">          clientdata          = clientdata</span><br><span class="line">          clientdatax         = clientdatax</span><br><span class="line">          plantdata           = plantdata</span><br><span class="line">          plantdatax          = plantdatax</span><br><span class="line">          valuationdata       = valuetiondata</span><br><span class="line">          valuationdatax      = valuetiondatax</span><br><span class="line">          salesdata           = salesdata</span><br><span class="line">          salesdatax          = salesdatax</span><br><span class="line">        IMPORTING</span><br><span class="line">          <span class="keyword">return</span>              = <span class="literal">return</span></span><br><span class="line">        TABLES</span><br><span class="line">          materialdescription = materialdescription[]</span><br><span class="line">          unitsofmeasure      = unitsofmeasure[]</span><br><span class="line">          unitsofmeasurex     = unitsofmeasurex[]</span><br><span class="line">          taxclassifications  = taxclassifications[].</span><br><span class="line">      CALL FUNCTION 'BAPI_TRANSACTION_ROLLBACK'.</span><br><span class="line">      <span class="keyword">IF</span> <span class="keyword">return</span>-<span class="keyword">type</span> = '<span class="keyword">E</span>'.</span><br><span class="line">        it_mara-<span class="keyword">type</span> = '<span class="keyword">E</span>'.</span><br><span class="line">        it_mara-message = <span class="keyword">return</span>-message.</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line">        it_mara-<span class="keyword">type</span> = 'S'.</span><br><span class="line">        it_mara-message = '检查无误！'.</span><br><span class="line">      ENDIF.</span><br><span class="line">      MODIFY it_mara TRANSPORTING <span class="keyword">type</span> message ersda.</span><br><span class="line">    ENDLOOP.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.</span><br></pre></td></tr></table></figure>
<h2 id="BASIS">BASIS</h2><h3 id="代码批量下载">代码批量下载</h3><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br><span class="line">1073</span><br><span class="line">1074</span><br><span class="line">1075</span><br><span class="line">1076</span><br><span class="line">1077</span><br><span class="line">1078</span><br><span class="line">1079</span><br><span class="line">1080</span><br><span class="line">1081</span><br><span class="line">1082</span><br><span class="line">1083</span><br><span class="line">1084</span><br><span class="line">1085</span><br><span class="line">1086</span><br><span class="line">1087</span><br><span class="line">1088</span><br><span class="line">1089</span><br><span class="line">1090</span><br><span class="line">1091</span><br><span class="line">1092</span><br><span class="line">1093</span><br><span class="line">1094</span><br><span class="line">1095</span><br><span class="line">1096</span><br><span class="line">1097</span><br><span class="line">1098</span><br><span class="line">1099</span><br><span class="line">1100</span><br><span class="line">1101</span><br><span class="line">1102</span><br><span class="line">1103</span><br><span class="line">1104</span><br><span class="line">1105</span><br><span class="line">1106</span><br><span class="line">1107</span><br><span class="line">1108</span><br><span class="line">1109</span><br><span class="line">1110</span><br><span class="line">1111</span><br><span class="line">1112</span><br><span class="line">1113</span><br><span class="line">1114</span><br><span class="line">1115</span><br><span class="line">1116</span><br><span class="line">1117</span><br><span class="line">1118</span><br><span class="line">1119</span><br><span class="line">1120</span><br><span class="line">1121</span><br><span class="line">1122</span><br><span class="line">1123</span><br><span class="line">1124</span><br><span class="line">1125</span><br><span class="line">1126</span><br><span class="line">1127</span><br><span class="line">1128</span><br><span class="line">1129</span><br><span class="line">1130</span><br><span class="line">1131</span><br><span class="line">1132</span><br><span class="line">1133</span><br><span class="line">1134</span><br><span class="line">1135</span><br><span class="line">1136</span><br><span class="line">1137</span><br><span class="line">1138</span><br><span class="line">1139</span><br><span class="line">1140</span><br><span class="line">1141</span><br><span class="line">1142</span><br><span class="line">1143</span><br><span class="line">1144</span><br><span class="line">1145</span><br><span class="line">1146</span><br><span class="line">1147</span><br><span class="line">1148</span><br><span class="line">1149</span><br><span class="line">1150</span><br><span class="line">1151</span><br><span class="line">1152</span><br><span class="line">1153</span><br><span class="line">1154</span><br><span class="line">1155</span><br><span class="line">1156</span><br><span class="line">1157</span><br><span class="line">1158</span><br><span class="line">1159</span><br><span class="line">1160</span><br><span class="line">1161</span><br><span class="line">1162</span><br><span class="line">1163</span><br><span class="line">1164</span><br><span class="line">1165</span><br><span class="line">1166</span><br><span class="line">1167</span><br><span class="line">1168</span><br><span class="line">1169</span><br><span class="line">1170</span><br><span class="line">1171</span><br><span class="line">1172</span><br><span class="line">1173</span><br><span class="line">1174</span><br><span class="line">1175</span><br><span class="line">1176</span><br><span class="line">1177</span><br><span class="line">1178</span><br><span class="line">1179</span><br><span class="line">1180</span><br><span class="line">1181</span><br><span class="line">1182</span><br><span class="line">1183</span><br><span class="line">1184</span><br><span class="line">1185</span><br><span class="line">1186</span><br><span class="line">1187</span><br><span class="line">1188</span><br><span class="line">1189</span><br><span class="line">1190</span><br><span class="line">1191</span><br><span class="line">1192</span><br><span class="line">1193</span><br><span class="line">1194</span><br><span class="line">1195</span><br><span class="line">1196</span><br><span class="line">1197</span><br><span class="line">1198</span><br><span class="line">1199</span><br><span class="line">1200</span><br><span class="line">1201</span><br><span class="line">1202</span><br><span class="line">1203</span><br><span class="line">1204</span><br><span class="line">1205</span><br><span class="line">1206</span><br><span class="line">1207</span><br><span class="line">1208</span><br><span class="line">1209</span><br><span class="line">1210</span><br><span class="line">1211</span><br><span class="line">1212</span><br><span class="line">1213</span><br><span class="line">1214</span><br><span class="line">1215</span><br><span class="line">1216</span><br><span class="line">1217</span><br><span class="line">1218</span><br><span class="line">1219</span><br><span class="line">1220</span><br><span class="line">1221</span><br><span class="line">1222</span><br><span class="line">1223</span><br><span class="line">1224</span><br><span class="line">1225</span><br><span class="line">1226</span><br><span class="line">1227</span><br><span class="line">1228</span><br><span class="line">1229</span><br><span class="line">1230</span><br><span class="line">1231</span><br><span class="line">1232</span><br><span class="line">1233</span><br><span class="line">1234</span><br><span class="line">1235</span><br><span class="line">1236</span><br><span class="line">1237</span><br><span class="line">1238</span><br><span class="line">1239</span><br><span class="line">1240</span><br><span class="line">1241</span><br><span class="line">1242</span><br><span class="line">1243</span><br><span class="line">1244</span><br><span class="line">1245</span><br><span class="line">1246</span><br><span class="line">1247</span><br><span class="line">1248</span><br><span class="line">1249</span><br><span class="line">1250</span><br><span class="line">1251</span><br><span class="line">1252</span><br><span class="line">1253</span><br><span class="line">1254</span><br><span class="line">1255</span><br><span class="line">1256</span><br><span class="line">1257</span><br><span class="line">1258</span><br><span class="line">1259</span><br><span class="line">1260</span><br><span class="line">1261</span><br><span class="line">1262</span><br><span class="line">1263</span><br><span class="line">1264</span><br><span class="line">1265</span><br><span class="line">1266</span><br><span class="line">1267</span><br><span class="line">1268</span><br><span class="line">1269</span><br><span class="line">1270</span><br><span class="line">1271</span><br><span class="line">1272</span><br><span class="line">1273</span><br><span class="line">1274</span><br><span class="line">1275</span><br><span class="line">1276</span><br><span class="line">1277</span><br><span class="line">1278</span><br><span class="line">1279</span><br><span class="line">1280</span><br><span class="line">1281</span><br><span class="line">1282</span><br><span class="line">1283</span><br><span class="line">1284</span><br><span class="line">1285</span><br><span class="line">1286</span><br><span class="line">1287</span><br><span class="line">1288</span><br><span class="line">1289</span><br><span class="line">1290</span><br><span class="line">1291</span><br><span class="line">1292</span><br><span class="line">1293</span><br><span class="line">1294</span><br><span class="line">1295</span><br><span class="line">1296</span><br><span class="line">1297</span><br><span class="line">1298</span><br><span class="line">1299</span><br><span class="line">1300</span><br><span class="line">1301</span><br><span class="line">1302</span><br><span class="line">1303</span><br><span class="line">1304</span><br><span class="line">1305</span><br><span class="line">1306</span><br><span class="line">1307</span><br><span class="line">1308</span><br><span class="line">1309</span><br><span class="line">1310</span><br><span class="line">1311</span><br><span class="line">1312</span><br><span class="line">1313</span><br><span class="line">1314</span><br><span class="line">1315</span><br><span class="line">1316</span><br><span class="line">1317</span><br><span class="line">1318</span><br><span class="line">1319</span><br><span class="line">1320</span><br><span class="line">1321</span><br><span class="line">1322</span><br><span class="line">1323</span><br><span class="line">1324</span><br><span class="line">1325</span><br><span class="line">1326</span><br><span class="line">1327</span><br><span class="line">1328</span><br><span class="line">1329</span><br><span class="line">1330</span><br><span class="line">1331</span><br><span class="line">1332</span><br><span class="line">1333</span><br><span class="line">1334</span><br><span class="line">1335</span><br><span class="line">1336</span><br><span class="line">1337</span><br><span class="line">1338</span><br><span class="line">1339</span><br><span class="line">1340</span><br><span class="line">1341</span><br><span class="line">1342</span><br><span class="line">1343</span><br><span class="line">1344</span><br><span class="line">1345</span><br><span class="line">1346</span><br><span class="line">1347</span><br><span class="line">1348</span><br><span class="line">1349</span><br><span class="line">1350</span><br><span class="line">1351</span><br><span class="line">1352</span><br><span class="line">1353</span><br><span class="line">1354</span><br><span class="line">1355</span><br><span class="line">1356</span><br><span class="line">1357</span><br><span class="line">1358</span><br><span class="line">1359</span><br><span class="line">1360</span><br><span class="line">1361</span><br><span class="line">1362</span><br><span class="line">1363</span><br><span class="line">1364</span><br><span class="line">1365</span><br><span class="line">1366</span><br><span class="line">1367</span><br><span class="line">1368</span><br><span class="line">1369</span><br><span class="line">1370</span><br><span class="line">1371</span><br><span class="line">1372</span><br><span class="line">1373</span><br><span class="line">1374</span><br><span class="line">1375</span><br><span class="line">1376</span><br><span class="line">1377</span><br><span class="line">1378</span><br><span class="line">1379</span><br><span class="line">1380</span><br><span class="line">1381</span><br><span class="line">1382</span><br><span class="line">1383</span><br><span class="line">1384</span><br><span class="line">1385</span><br><span class="line">1386</span><br><span class="line">1387</span><br><span class="line">1388</span><br><span class="line">1389</span><br><span class="line">1390</span><br><span class="line">1391</span><br><span class="line">1392</span><br><span class="line">1393</span><br><span class="line">1394</span><br><span class="line">1395</span><br><span class="line">1396</span><br><span class="line">1397</span><br><span class="line">1398</span><br><span class="line">1399</span><br><span class="line">1400</span><br><span class="line">1401</span><br><span class="line">1402</span><br><span class="line">1403</span><br><span class="line">1404</span><br><span class="line">1405</span><br><span class="line">1406</span><br><span class="line">1407</span><br><span class="line">1408</span><br><span class="line">1409</span><br><span class="line">1410</span><br><span class="line">1411</span><br><span class="line">1412</span><br><span class="line">1413</span><br><span class="line">1414</span><br><span class="line">1415</span><br><span class="line">1416</span><br><span class="line">1417</span><br><span class="line">1418</span><br><span class="line">1419</span><br><span class="line">1420</span><br><span class="line">1421</span><br><span class="line">1422</span><br><span class="line">1423</span><br><span class="line">1424</span><br><span class="line">1425</span><br><span class="line">1426</span><br><span class="line">1427</span><br><span class="line">1428</span><br><span class="line">1429</span><br><span class="line">1430</span><br><span class="line">1431</span><br><span class="line">1432</span><br><span class="line">1433</span><br><span class="line">1434</span><br><span class="line">1435</span><br><span class="line">1436</span><br><span class="line">1437</span><br><span class="line">1438</span><br><span class="line">1439</span><br><span class="line">1440</span><br><span class="line">1441</span><br><span class="line">1442</span><br><span class="line">1443</span><br><span class="line">1444</span><br><span class="line">1445</span><br><span class="line">1446</span><br><span class="line">1447</span><br><span class="line">1448</span><br><span class="line">1449</span><br><span class="line">1450</span><br><span class="line">1451</span><br><span class="line">1452</span><br><span class="line">1453</span><br><span class="line">1454</span><br><span class="line">1455</span><br><span class="line">1456</span><br><span class="line">1457</span><br><span class="line">1458</span><br><span class="line">1459</span><br><span class="line">1460</span><br><span class="line">1461</span><br><span class="line">1462</span><br><span class="line">1463</span><br><span class="line">1464</span><br><span class="line">1465</span><br><span class="line">1466</span><br><span class="line">1467</span><br><span class="line">1468</span><br><span class="line">1469</span><br><span class="line">1470</span><br><span class="line">1471</span><br><span class="line">1472</span><br><span class="line">1473</span><br><span class="line">1474</span><br><span class="line">1475</span><br><span class="line">1476</span><br><span class="line">1477</span><br><span class="line">1478</span><br><span class="line">1479</span><br><span class="line">1480</span><br><span class="line">1481</span><br><span class="line">1482</span><br><span class="line">1483</span><br><span class="line">1484</span><br><span class="line">1485</span><br><span class="line">1486</span><br><span class="line">1487</span><br><span class="line">1488</span><br><span class="line">1489</span><br><span class="line">1490</span><br><span class="line">1491</span><br><span class="line">1492</span><br><span class="line">1493</span><br><span class="line">1494</span><br><span class="line">1495</span><br><span class="line">1496</span><br><span class="line">1497</span><br><span class="line">1498</span><br><span class="line">1499</span><br><span class="line">1500</span><br><span class="line">1501</span><br><span class="line">1502</span><br><span class="line">1503</span><br><span class="line">1504</span><br><span class="line">1505</span><br><span class="line">1506</span><br><span class="line">1507</span><br><span class="line">1508</span><br><span class="line">1509</span><br><span class="line">1510</span><br><span class="line">1511</span><br><span class="line">1512</span><br><span class="line">1513</span><br><span class="line">1514</span><br><span class="line">1515</span><br><span class="line">1516</span><br><span class="line">1517</span><br><span class="line">1518</span><br><span class="line">1519</span><br><span class="line">1520</span><br><span class="line">1521</span><br><span class="line">1522</span><br><span class="line">1523</span><br><span class="line">1524</span><br><span class="line">1525</span><br><span class="line">1526</span><br><span class="line">1527</span><br><span class="line">1528</span><br><span class="line">1529</span><br><span class="line">1530</span><br><span class="line">1531</span><br><span class="line">1532</span><br><span class="line">1533</span><br><span class="line">1534</span><br><span class="line">1535</span><br><span class="line">1536</span><br><span class="line">1537</span><br><span class="line">1538</span><br><span class="line">1539</span><br><span class="line">1540</span><br><span class="line">1541</span><br><span class="line">1542</span><br><span class="line">1543</span><br><span class="line">1544</span><br><span class="line">1545</span><br><span class="line">1546</span><br><span class="line">1547</span><br><span class="line">1548</span><br><span class="line">1549</span><br><span class="line">1550</span><br><span class="line">1551</span><br><span class="line">1552</span><br><span class="line">1553</span><br><span class="line">1554</span><br><span class="line">1555</span><br><span class="line">1556</span><br><span class="line">1557</span><br><span class="line">1558</span><br><span class="line">1559</span><br><span class="line">1560</span><br><span class="line">1561</span><br><span class="line">1562</span><br><span class="line">1563</span><br><span class="line">1564</span><br><span class="line">1565</span><br><span class="line">1566</span><br><span class="line">1567</span><br><span class="line">1568</span><br><span class="line">1569</span><br><span class="line">1570</span><br><span class="line">1571</span><br><span class="line">1572</span><br><span class="line">1573</span><br><span class="line">1574</span><br><span class="line">1575</span><br><span class="line">1576</span><br><span class="line">1577</span><br><span class="line">1578</span><br><span class="line">1579</span><br><span class="line">1580</span><br><span class="line">1581</span><br><span class="line">1582</span><br><span class="line">1583</span><br><span class="line">1584</span><br><span class="line">1585</span><br><span class="line">1586</span><br><span class="line">1587</span><br><span class="line">1588</span><br><span class="line">1589</span><br><span class="line">1590</span><br><span class="line">1591</span><br><span class="line">1592</span><br><span class="line">1593</span><br><span class="line">1594</span><br><span class="line">1595</span><br><span class="line">1596</span><br><span class="line">1597</span><br><span class="line">1598</span><br><span class="line">1599</span><br><span class="line">1600</span><br><span class="line">1601</span><br><span class="line">1602</span><br><span class="line">1603</span><br><span class="line">1604</span><br><span class="line">1605</span><br><span class="line">1606</span><br><span class="line">1607</span><br><span class="line">1608</span><br><span class="line">1609</span><br><span class="line">1610</span><br><span class="line">1611</span><br><span class="line">1612</span><br><span class="line">1613</span><br><span class="line">1614</span><br><span class="line">1615</span><br><span class="line">1616</span><br><span class="line">1617</span><br><span class="line">1618</span><br><span class="line">1619</span><br><span class="line">1620</span><br><span class="line">1621</span><br><span class="line">1622</span><br><span class="line">1623</span><br><span class="line">1624</span><br><span class="line">1625</span><br><span class="line">1626</span><br><span class="line">1627</span><br><span class="line">1628</span><br><span class="line">1629</span><br><span class="line">1630</span><br><span class="line">1631</span><br><span class="line">1632</span><br><span class="line">1633</span><br><span class="line">1634</span><br><span class="line">1635</span><br><span class="line">1636</span><br><span class="line">1637</span><br><span class="line">1638</span><br><span class="line">1639</span><br><span class="line">1640</span><br><span class="line">1641</span><br><span class="line">1642</span><br><span class="line">1643</span><br><span class="line">1644</span><br><span class="line">1645</span><br><span class="line">1646</span><br><span class="line">1647</span><br><span class="line">1648</span><br><span class="line">1649</span><br><span class="line">1650</span><br><span class="line">1651</span><br><span class="line">1652</span><br><span class="line">1653</span><br><span class="line">1654</span><br><span class="line">1655</span><br><span class="line">1656</span><br><span class="line">1657</span><br><span class="line">1658</span><br><span class="line">1659</span><br><span class="line">1660</span><br><span class="line">1661</span><br><span class="line">1662</span><br><span class="line">1663</span><br><span class="line">1664</span><br><span class="line">1665</span><br><span class="line">1666</span><br><span class="line">1667</span><br><span class="line">1668</span><br><span class="line">1669</span><br><span class="line">1670</span><br><span class="line">1671</span><br><span class="line">1672</span><br><span class="line">1673</span><br><span class="line">1674</span><br><span class="line">1675</span><br><span class="line">1676</span><br><span class="line">1677</span><br><span class="line">1678</span><br><span class="line">1679</span><br><span class="line">1680</span><br><span class="line">1681</span><br><span class="line">1682</span><br><span class="line">1683</span><br><span class="line">1684</span><br><span class="line">1685</span><br><span class="line">1686</span><br><span class="line">1687</span><br><span class="line">1688</span><br><span class="line">1689</span><br><span class="line">1690</span><br><span class="line">1691</span><br><span class="line">1692</span><br><span class="line">1693</span><br><span class="line">1694</span><br><span class="line">1695</span><br><span class="line">1696</span><br><span class="line">1697</span><br><span class="line">1698</span><br><span class="line">1699</span><br><span class="line">1700</span><br><span class="line">1701</span><br><span class="line">1702</span><br><span class="line">1703</span><br><span class="line">1704</span><br><span class="line">1705</span><br><span class="line">1706</span><br><span class="line">1707</span><br><span class="line">1708</span><br><span class="line">1709</span><br><span class="line">1710</span><br><span class="line">1711</span><br><span class="line">1712</span><br><span class="line">1713</span><br><span class="line">1714</span><br><span class="line">1715</span><br><span class="line">1716</span><br><span class="line">1717</span><br><span class="line">1718</span><br><span class="line">1719</span><br><span class="line">1720</span><br><span class="line">1721</span><br><span class="line">1722</span><br><span class="line">1723</span><br><span class="line">1724</span><br><span class="line">1725</span><br><span class="line">1726</span><br><span class="line">1727</span><br><span class="line">1728</span><br><span class="line">1729</span><br><span class="line">1730</span><br><span class="line">1731</span><br><span class="line">1732</span><br><span class="line">1733</span><br><span class="line">1734</span><br><span class="line">1735</span><br><span class="line">1736</span><br><span class="line">1737</span><br><span class="line">1738</span><br><span class="line">1739</span><br><span class="line">1740</span><br><span class="line">1741</span><br><span class="line">1742</span><br><span class="line">1743</span><br><span class="line">1744</span><br><span class="line">1745</span><br><span class="line">1746</span><br><span class="line">1747</span><br><span class="line">1748</span><br><span class="line">1749</span><br><span class="line">1750</span><br><span class="line">1751</span><br><span class="line">1752</span><br><span class="line">1753</span><br><span class="line">1754</span><br><span class="line">1755</span><br><span class="line">1756</span><br><span class="line">1757</span><br><span class="line">1758</span><br><span class="line">1759</span><br><span class="line">1760</span><br><span class="line">1761</span><br><span class="line">1762</span><br><span class="line">1763</span><br><span class="line">1764</span><br><span class="line">1765</span><br><span class="line">1766</span><br><span class="line">1767</span><br><span class="line">1768</span><br><span class="line">1769</span><br><span class="line">1770</span><br><span class="line">1771</span><br><span class="line">1772</span><br><span class="line">1773</span><br><span class="line">1774</span><br><span class="line">1775</span><br><span class="line">1776</span><br><span class="line">1777</span><br><span class="line">1778</span><br><span class="line">1779</span><br><span class="line">1780</span><br><span class="line">1781</span><br><span class="line">1782</span><br><span class="line">1783</span><br><span class="line">1784</span><br><span class="line">1785</span><br><span class="line">1786</span><br><span class="line">1787</span><br><span class="line">1788</span><br><span class="line">1789</span><br><span class="line">1790</span><br><span class="line">1791</span><br><span class="line">1792</span><br><span class="line">1793</span><br><span class="line">1794</span><br><span class="line">1795</span><br><span class="line">1796</span><br><span class="line">1797</span><br><span class="line">1798</span><br><span class="line">1799</span><br><span class="line">1800</span><br><span class="line">1801</span><br><span class="line">1802</span><br><span class="line">1803</span><br><span class="line">1804</span><br><span class="line">1805</span><br><span class="line">1806</span><br><span class="line">1807</span><br><span class="line">1808</span><br><span class="line">1809</span><br><span class="line">1810</span><br><span class="line">1811</span><br><span class="line">1812</span><br><span class="line">1813</span><br><span class="line">1814</span><br><span class="line">1815</span><br><span class="line">1816</span><br><span class="line">1817</span><br><span class="line">1818</span><br><span class="line">1819</span><br><span class="line">1820</span><br><span class="line">1821</span><br><span class="line">1822</span><br><span class="line">1823</span><br><span class="line">1824</span><br><span class="line">1825</span><br><span class="line">1826</span><br><span class="line">1827</span><br><span class="line">1828</span><br><span class="line">1829</span><br><span class="line">1830</span><br><span class="line">1831</span><br><span class="line">1832</span><br><span class="line">1833</span><br><span class="line">1834</span><br><span class="line">1835</span><br><span class="line">1836</span><br><span class="line">1837</span><br><span class="line">1838</span><br><span class="line">1839</span><br><span class="line">1840</span><br><span class="line">1841</span><br><span class="line">1842</span><br><span class="line">1843</span><br><span class="line">1844</span><br><span class="line">1845</span><br><span class="line">1846</span><br><span class="line">1847</span><br><span class="line">1848</span><br><span class="line">1849</span><br><span class="line">1850</span><br><span class="line">1851</span><br><span class="line">1852</span><br><span class="line">1853</span><br><span class="line">1854</span><br><span class="line">1855</span><br><span class="line">1856</span><br><span class="line">1857</span><br><span class="line">1858</span><br><span class="line">1859</span><br><span class="line">1860</span><br><span class="line">1861</span><br><span class="line">1862</span><br><span class="line">1863</span><br><span class="line">1864</span><br><span class="line">1865</span><br><span class="line">1866</span><br><span class="line">1867</span><br><span class="line">1868</span><br><span class="line">1869</span><br><span class="line">1870</span><br><span class="line">1871</span><br><span class="line">1872</span><br><span class="line">1873</span><br><span class="line">1874</span><br><span class="line">1875</span><br><span class="line">1876</span><br><span class="line">1877</span><br><span class="line">1878</span><br><span class="line">1879</span><br><span class="line">1880</span><br><span class="line">1881</span><br><span class="line">1882</span><br><span class="line">1883</span><br><span class="line">1884</span><br><span class="line">1885</span><br><span class="line">1886</span><br><span class="line">1887</span><br><span class="line">1888</span><br><span class="line">1889</span><br><span class="line">1890</span><br><span class="line">1891</span><br><span class="line">1892</span><br><span class="line">1893</span><br><span class="line">1894</span><br><span class="line">1895</span><br><span class="line">1896</span><br><span class="line">1897</span><br><span class="line">1898</span><br><span class="line">1899</span><br><span class="line">1900</span><br><span class="line">1901</span><br><span class="line">1902</span><br><span class="line">1903</span><br><span class="line">1904</span><br><span class="line">1905</span><br><span class="line">1906</span><br><span class="line">1907</span><br><span class="line">1908</span><br><span class="line">1909</span><br><span class="line">1910</span><br><span class="line">1911</span><br><span class="line">1912</span><br><span class="line">1913</span><br><span class="line">1914</span><br><span class="line">1915</span><br><span class="line">1916</span><br><span class="line">1917</span><br><span class="line">1918</span><br><span class="line">1919</span><br><span class="line">1920</span><br><span class="line">1921</span><br><span class="line">1922</span><br><span class="line">1923</span><br><span class="line">1924</span><br><span class="line">1925</span><br><span class="line">1926</span><br><span class="line">1927</span><br><span class="line">1928</span><br><span class="line">1929</span><br><span class="line">1930</span><br><span class="line">1931</span><br><span class="line">1932</span><br><span class="line">1933</span><br><span class="line">1934</span><br><span class="line">1935</span><br><span class="line">1936</span><br><span class="line">1937</span><br><span class="line">1938</span><br><span class="line">1939</span><br><span class="line">1940</span><br><span class="line">1941</span><br><span class="line">1942</span><br><span class="line">1943</span><br><span class="line">1944</span><br><span class="line">1945</span><br><span class="line">1946</span><br><span class="line">1947</span><br><span class="line">1948</span><br><span class="line">1949</span><br><span class="line">1950</span><br><span class="line">1951</span><br><span class="line">1952</span><br><span class="line">1953</span><br><span class="line">1954</span><br><span class="line">1955</span><br><span class="line">1956</span><br><span class="line">1957</span><br><span class="line">1958</span><br><span class="line">1959</span><br><span class="line">1960</span><br><span class="line">1961</span><br><span class="line">1962</span><br><span class="line">1963</span><br><span class="line">1964</span><br><span class="line">1965</span><br><span class="line">1966</span><br><span class="line">1967</span><br><span class="line">1968</span><br><span class="line">1969</span><br><span class="line">1970</span><br><span class="line">1971</span><br><span class="line">1972</span><br><span class="line">1973</span><br><span class="line">1974</span><br><span class="line">1975</span><br><span class="line">1976</span><br><span class="line">1977</span><br><span class="line">1978</span><br><span class="line">1979</span><br><span class="line">1980</span><br><span class="line">1981</span><br><span class="line">1982</span><br><span class="line">1983</span><br><span class="line">1984</span><br><span class="line">1985</span><br><span class="line">1986</span><br><span class="line">1987</span><br><span class="line">1988</span><br><span class="line">1989</span><br><span class="line">1990</span><br><span class="line">1991</span><br><span class="line">1992</span><br><span class="line">1993</span><br><span class="line">1994</span><br><span class="line">1995</span><br><span class="line">1996</span><br><span class="line">1997</span><br><span class="line">1998</span><br><span class="line">1999</span><br><span class="line">2000</span><br><span class="line">2001</span><br><span class="line">2002</span><br><span class="line">2003</span><br><span class="line">2004</span><br><span class="line">2005</span><br><span class="line">2006</span><br><span class="line">2007</span><br><span class="line">2008</span><br><span class="line">2009</span><br><span class="line">2010</span><br><span class="line">2011</span><br><span class="line">2012</span><br><span class="line">2013</span><br><span class="line">2014</span><br><span class="line">2015</span><br><span class="line">2016</span><br><span class="line">2017</span><br><span class="line">2018</span><br><span class="line">2019</span><br><span class="line">2020</span><br><span class="line">2021</span><br><span class="line">2022</span><br><span class="line">2023</span><br><span class="line">2024</span><br><span class="line">2025</span><br><span class="line">2026</span><br><span class="line">2027</span><br><span class="line">2028</span><br><span class="line">2029</span><br><span class="line">2030</span><br><span class="line">2031</span><br><span class="line">2032</span><br><span class="line">2033</span><br><span class="line">2034</span><br><span class="line">2035</span><br><span class="line">2036</span><br><span class="line">2037</span><br><span class="line">2038</span><br><span class="line">2039</span><br><span class="line">2040</span><br><span class="line">2041</span><br><span class="line">2042</span><br><span class="line">2043</span><br><span class="line">2044</span><br><span class="line">2045</span><br><span class="line">2046</span><br><span class="line">2047</span><br><span class="line">2048</span><br><span class="line">2049</span><br><span class="line">2050</span><br><span class="line">2051</span><br><span class="line">2052</span><br><span class="line">2053</span><br><span class="line">2054</span><br><span class="line">2055</span><br><span class="line">2056</span><br><span class="line">2057</span><br><span class="line">2058</span><br><span class="line">2059</span><br><span class="line">2060</span><br><span class="line">2061</span><br><span class="line">2062</span><br><span class="line">2063</span><br><span class="line">2064</span><br><span class="line">2065</span><br><span class="line">2066</span><br><span class="line">2067</span><br><span class="line">2068</span><br><span class="line">2069</span><br><span class="line">2070</span><br><span class="line">2071</span><br><span class="line">2072</span><br><span class="line">2073</span><br><span class="line">2074</span><br><span class="line">2075</span><br><span class="line">2076</span><br><span class="line">2077</span><br><span class="line">2078</span><br><span class="line">2079</span><br><span class="line">2080</span><br><span class="line">2081</span><br><span class="line">2082</span><br><span class="line">2083</span><br><span class="line">2084</span><br><span class="line">2085</span><br><span class="line">2086</span><br><span class="line">2087</span><br><span class="line">2088</span><br><span class="line">2089</span><br><span class="line">2090</span><br><span class="line">2091</span><br><span class="line">2092</span><br><span class="line">2093</span><br><span class="line">2094</span><br><span class="line">2095</span><br><span class="line">2096</span><br><span class="line">2097</span><br><span class="line">2098</span><br><span class="line">2099</span><br><span class="line">2100</span><br><span class="line">2101</span><br><span class="line">2102</span><br><span class="line">2103</span><br><span class="line">2104</span><br><span class="line">2105</span><br><span class="line">2106</span><br><span class="line">2107</span><br><span class="line">2108</span><br><span class="line">2109</span><br><span class="line">2110</span><br><span class="line">2111</span><br><span class="line">2112</span><br><span class="line">2113</span><br><span class="line">2114</span><br><span class="line">2115</span><br><span class="line">2116</span><br><span class="line">2117</span><br><span class="line">2118</span><br><span class="line">2119</span><br><span class="line">2120</span><br><span class="line">2121</span><br><span class="line">2122</span><br><span class="line">2123</span><br><span class="line">2124</span><br><span class="line">2125</span><br><span class="line">2126</span><br><span class="line">2127</span><br><span class="line">2128</span><br><span class="line">2129</span><br><span class="line">2130</span><br><span class="line">2131</span><br><span class="line">2132</span><br><span class="line">2133</span><br><span class="line">2134</span><br><span class="line">2135</span><br><span class="line">2136</span><br><span class="line">2137</span><br><span class="line">2138</span><br><span class="line">2139</span><br><span class="line">2140</span><br><span class="line">2141</span><br><span class="line">2142</span><br><span class="line">2143</span><br><span class="line">2144</span><br><span class="line">2145</span><br><span class="line">2146</span><br><span class="line">2147</span><br><span class="line">2148</span><br><span class="line">2149</span><br><span class="line">2150</span><br><span class="line">2151</span><br><span class="line">2152</span><br><span class="line">2153</span><br><span class="line">2154</span><br><span class="line">2155</span><br><span class="line">2156</span><br><span class="line">2157</span><br><span class="line">2158</span><br><span class="line">2159</span><br><span class="line">2160</span><br><span class="line">2161</span><br><span class="line">2162</span><br><span class="line">2163</span><br><span class="line">2164</span><br><span class="line">2165</span><br><span class="line">2166</span><br><span class="line">2167</span><br><span class="line">2168</span><br><span class="line">2169</span><br><span class="line">2170</span><br><span class="line">2171</span><br><span class="line">2172</span><br><span class="line">2173</span><br><span class="line">2174</span><br><span class="line">2175</span><br><span class="line">2176</span><br><span class="line">2177</span><br><span class="line">2178</span><br><span class="line">2179</span><br><span class="line">2180</span><br><span class="line">2181</span><br><span class="line">2182</span><br><span class="line">2183</span><br><span class="line">2184</span><br><span class="line">2185</span><br><span class="line">2186</span><br><span class="line">2187</span><br><span class="line">2188</span><br><span class="line">2189</span><br><span class="line">2190</span><br><span class="line">2191</span><br><span class="line">2192</span><br><span class="line">2193</span><br><span class="line">2194</span><br><span class="line">2195</span><br><span class="line">2196</span><br><span class="line">2197</span><br><span class="line">2198</span><br><span class="line">2199</span><br><span class="line">2200</span><br><span class="line">2201</span><br><span class="line">2202</span><br><span class="line">2203</span><br><span class="line">2204</span><br><span class="line">2205</span><br><span class="line">2206</span><br><span class="line">2207</span><br><span class="line">2208</span><br><span class="line">2209</span><br><span class="line">2210</span><br><span class="line">2211</span><br><span class="line">2212</span><br><span class="line">2213</span><br><span class="line">2214</span><br><span class="line">2215</span><br><span class="line">2216</span><br><span class="line">2217</span><br><span class="line">2218</span><br><span class="line">2219</span><br><span class="line">2220</span><br><span class="line">2221</span><br><span class="line">2222</span><br><span class="line">2223</span><br><span class="line">2224</span><br><span class="line">2225</span><br><span class="line">2226</span><br><span class="line">2227</span><br><span class="line">2228</span><br><span class="line">2229</span><br><span class="line">2230</span><br><span class="line">2231</span><br><span class="line">2232</span><br><span class="line">2233</span><br><span class="line">2234</span><br><span class="line">2235</span><br><span class="line">2236</span><br><span class="line">2237</span><br><span class="line">2238</span><br><span class="line">2239</span><br><span class="line">2240</span><br><span class="line">2241</span><br><span class="line">2242</span><br><span class="line">2243</span><br><span class="line">2244</span><br><span class="line">2245</span><br><span class="line">2246</span><br><span class="line">2247</span><br><span class="line">2248</span><br><span class="line">2249</span><br><span class="line">2250</span><br><span class="line">2251</span><br><span class="line">2252</span><br><span class="line">2253</span><br><span class="line">2254</span><br><span class="line">2255</span><br><span class="line">2256</span><br><span class="line">2257</span><br><span class="line">2258</span><br><span class="line">2259</span><br><span class="line">2260</span><br><span class="line">2261</span><br><span class="line">2262</span><br><span class="line">2263</span><br><span class="line">2264</span><br><span class="line">2265</span><br><span class="line">2266</span><br><span class="line">2267</span><br><span class="line">2268</span><br><span class="line">2269</span><br><span class="line">2270</span><br><span class="line">2271</span><br><span class="line">2272</span><br><span class="line">2273</span><br><span class="line">2274</span><br><span class="line">2275</span><br><span class="line">2276</span><br><span class="line">2277</span><br><span class="line">2278</span><br><span class="line">2279</span><br><span class="line">2280</span><br><span class="line">2281</span><br><span class="line">2282</span><br><span class="line">2283</span><br><span class="line">2284</span><br><span class="line">2285</span><br><span class="line">2286</span><br><span class="line">2287</span><br><span class="line">2288</span><br><span class="line">2289</span><br><span class="line">2290</span><br><span class="line">2291</span><br><span class="line">2292</span><br><span class="line">2293</span><br><span class="line">2294</span><br><span class="line">2295</span><br><span class="line">2296</span><br><span class="line">2297</span><br><span class="line">2298</span><br><span class="line">2299</span><br><span class="line">2300</span><br><span class="line">2301</span><br><span class="line">2302</span><br><span class="line">2303</span><br><span class="line">2304</span><br><span class="line">2305</span><br><span class="line">2306</span><br><span class="line">2307</span><br><span class="line">2308</span><br><span class="line">2309</span><br><span class="line">2310</span><br><span class="line">2311</span><br><span class="line">2312</span><br><span class="line">2313</span><br><span class="line">2314</span><br><span class="line">2315</span><br><span class="line">2316</span><br><span class="line">2317</span><br><span class="line">2318</span><br><span class="line">2319</span><br><span class="line">2320</span><br><span class="line">2321</span><br><span class="line">2322</span><br><span class="line">2323</span><br><span class="line">2324</span><br><span class="line">2325</span><br><span class="line">2326</span><br><span class="line">2327</span><br><span class="line">2328</span><br><span class="line">2329</span><br><span class="line">2330</span><br><span class="line">2331</span><br><span class="line">2332</span><br><span class="line">2333</span><br><span class="line">2334</span><br><span class="line">2335</span><br><span class="line">2336</span><br><span class="line">2337</span><br><span class="line">2338</span><br><span class="line">2339</span><br><span class="line">2340</span><br><span class="line">2341</span><br><span class="line">2342</span><br><span class="line">2343</span><br><span class="line">2344</span><br><span class="line">2345</span><br><span class="line">2346</span><br><span class="line">2347</span><br><span class="line">2348</span><br><span class="line">2349</span><br><span class="line">2350</span><br><span class="line">2351</span><br><span class="line">2352</span><br><span class="line">2353</span><br><span class="line">2354</span><br><span class="line">2355</span><br><span class="line">2356</span><br><span class="line">2357</span><br><span class="line">2358</span><br><span class="line">2359</span><br><span class="line">2360</span><br><span class="line">2361</span><br><span class="line">2362</span><br><span class="line">2363</span><br><span class="line">2364</span><br><span class="line">2365</span><br><span class="line">2366</span><br><span class="line">2367</span><br><span class="line">2368</span><br><span class="line">2369</span><br><span class="line">2370</span><br><span class="line">2371</span><br><span class="line">2372</span><br><span class="line">2373</span><br><span class="line">2374</span><br><span class="line">2375</span><br><span class="line">2376</span><br><span class="line">2377</span><br><span class="line">2378</span><br><span class="line">2379</span><br><span class="line">2380</span><br><span class="line">2381</span><br><span class="line">2382</span><br><span class="line">2383</span><br><span class="line">2384</span><br><span class="line">2385</span><br><span class="line">2386</span><br><span class="line">2387</span><br><span class="line">2388</span><br><span class="line">2389</span><br><span class="line">2390</span><br><span class="line">2391</span><br><span class="line">2392</span><br><span class="line">2393</span><br><span class="line">2394</span><br><span class="line">2395</span><br><span class="line">2396</span><br><span class="line">2397</span><br><span class="line">2398</span><br><span class="line">2399</span><br><span class="line">2400</span><br><span class="line">2401</span><br><span class="line">2402</span><br><span class="line">2403</span><br><span class="line">2404</span><br><span class="line">2405</span><br><span class="line">2406</span><br><span class="line">2407</span><br><span class="line">2408</span><br><span class="line">2409</span><br><span class="line">2410</span><br><span class="line">2411</span><br><span class="line">2412</span><br><span class="line">2413</span><br><span class="line">2414</span><br><span class="line">2415</span><br><span class="line">2416</span><br><span class="line">2417</span><br><span class="line">2418</span><br><span class="line">2419</span><br><span class="line">2420</span><br><span class="line">2421</span><br><span class="line">2422</span><br><span class="line">2423</span><br><span class="line">2424</span><br><span class="line">2425</span><br><span class="line">2426</span><br><span class="line">2427</span><br><span class="line">2428</span><br><span class="line">2429</span><br><span class="line">2430</span><br><span class="line">2431</span><br><span class="line">2432</span><br><span class="line">2433</span><br><span class="line">2434</span><br><span class="line">2435</span><br><span class="line">2436</span><br><span class="line">2437</span><br><span class="line">2438</span><br><span class="line">2439</span><br><span class="line">2440</span><br><span class="line">2441</span><br><span class="line">2442</span><br><span class="line">2443</span><br><span class="line">2444</span><br><span class="line">2445</span><br><span class="line">2446</span><br><span class="line">2447</span><br><span class="line">2448</span><br><span class="line">2449</span><br><span class="line">2450</span><br><span class="line">2451</span><br><span class="line">2452</span><br><span class="line">2453</span><br><span class="line">2454</span><br><span class="line">2455</span><br><span class="line">2456</span><br><span class="line">2457</span><br><span class="line">2458</span><br><span class="line">2459</span><br><span class="line">2460</span><br><span class="line">2461</span><br><span class="line">2462</span><br><span class="line">2463</span><br><span class="line">2464</span><br><span class="line">2465</span><br><span class="line">2466</span><br><span class="line">2467</span><br><span class="line">2468</span><br><span class="line">2469</span><br><span class="line">2470</span><br><span class="line">2471</span><br><span class="line">2472</span><br><span class="line">2473</span><br><span class="line">2474</span><br><span class="line">2475</span><br><span class="line">2476</span><br><span class="line">2477</span><br><span class="line">2478</span><br><span class="line">2479</span><br><span class="line">2480</span><br><span class="line">2481</span><br><span class="line">2482</span><br><span class="line">2483</span><br><span class="line">2484</span><br><span class="line">2485</span><br><span class="line">2486</span><br><span class="line">2487</span><br><span class="line">2488</span><br><span class="line">2489</span><br><span class="line">2490</span><br><span class="line">2491</span><br><span class="line">2492</span><br><span class="line">2493</span><br><span class="line">2494</span><br><span class="line">2495</span><br><span class="line">2496</span><br><span class="line">2497</span><br><span class="line">2498</span><br><span class="line">2499</span><br><span class="line">2500</span><br><span class="line">2501</span><br><span class="line">2502</span><br><span class="line">2503</span><br><span class="line">2504</span><br><span class="line">2505</span><br><span class="line">2506</span><br><span class="line">2507</span><br><span class="line">2508</span><br><span class="line">2509</span><br><span class="line">2510</span><br><span class="line">2511</span><br><span class="line">2512</span><br><span class="line">2513</span><br><span class="line">2514</span><br><span class="line">2515</span><br><span class="line">2516</span><br><span class="line">2517</span><br><span class="line">2518</span><br><span class="line">2519</span><br><span class="line">2520</span><br><span class="line">2521</span><br><span class="line">2522</span><br><span class="line">2523</span><br><span class="line">2524</span><br><span class="line">2525</span><br><span class="line">2526</span><br><span class="line">2527</span><br><span class="line">2528</span><br><span class="line">2529</span><br><span class="line">2530</span><br><span class="line">2531</span><br><span class="line">2532</span><br><span class="line">2533</span><br><span class="line">2534</span><br><span class="line">2535</span><br><span class="line">2536</span><br><span class="line">2537</span><br><span class="line">2538</span><br><span class="line">2539</span><br><span class="line">2540</span><br><span class="line">2541</span><br><span class="line">2542</span><br><span class="line">2543</span><br><span class="line">2544</span><br><span class="line">2545</span><br><span class="line">2546</span><br><span class="line">2547</span><br><span class="line">2548</span><br><span class="line">2549</span><br><span class="line">2550</span><br><span class="line">2551</span><br><span class="line">2552</span><br><span class="line">2553</span><br><span class="line">2554</span><br><span class="line">2555</span><br><span class="line">2556</span><br><span class="line">2557</span><br><span class="line">2558</span><br><span class="line">2559</span><br><span class="line">2560</span><br><span class="line">2561</span><br><span class="line">2562</span><br><span class="line">2563</span><br><span class="line">2564</span><br><span class="line">2565</span><br><span class="line">2566</span><br><span class="line">2567</span><br><span class="line">2568</span><br><span class="line">2569</span><br><span class="line">2570</span><br><span class="line">2571</span><br><span class="line">2572</span><br><span class="line">2573</span><br><span class="line">2574</span><br><span class="line">2575</span><br><span class="line">2576</span><br><span class="line">2577</span><br><span class="line">2578</span><br><span class="line">2579</span><br><span class="line">2580</span><br><span class="line">2581</span><br><span class="line">2582</span><br><span class="line">2583</span><br><span class="line">2584</span><br><span class="line">2585</span><br><span class="line">2586</span><br><span class="line">2587</span><br><span class="line">2588</span><br><span class="line">2589</span><br><span class="line">2590</span><br><span class="line">2591</span><br><span class="line">2592</span><br><span class="line">2593</span><br><span class="line">2594</span><br><span class="line">2595</span><br><span class="line">2596</span><br><span class="line">2597</span><br><span class="line">2598</span><br><span class="line">2599</span><br><span class="line">2600</span><br><span class="line">2601</span><br><span class="line">2602</span><br><span class="line">2603</span><br><span class="line">2604</span><br><span class="line">2605</span><br><span class="line">2606</span><br><span class="line">2607</span><br><span class="line">2608</span><br><span class="line">2609</span><br><span class="line">2610</span><br><span class="line">2611</span><br><span class="line">2612</span><br><span class="line">2613</span><br><span class="line">2614</span><br><span class="line">2615</span><br><span class="line">2616</span><br><span class="line">2617</span><br><span class="line">2618</span><br><span class="line">2619</span><br><span class="line">2620</span><br><span class="line">2621</span><br><span class="line">2622</span><br><span class="line">2623</span><br><span class="line">2624</span><br><span class="line">2625</span><br><span class="line">2626</span><br><span class="line">2627</span><br><span class="line">2628</span><br><span class="line">2629</span><br><span class="line">2630</span><br><span class="line">2631</span><br><span class="line">2632</span><br><span class="line">2633</span><br><span class="line">2634</span><br><span class="line">2635</span><br><span class="line">2636</span><br><span class="line">2637</span><br><span class="line">2638</span><br><span class="line">2639</span><br><span class="line">2640</span><br><span class="line">2641</span><br><span class="line">2642</span><br><span class="line">2643</span><br><span class="line">2644</span><br><span class="line">2645</span><br><span class="line">2646</span><br><span class="line">2647</span><br><span class="line">2648</span><br><span class="line">2649</span><br><span class="line">2650</span><br><span class="line">2651</span><br><span class="line">2652</span><br><span class="line">2653</span><br><span class="line">2654</span><br><span class="line">2655</span><br><span class="line">2656</span><br><span class="line">2657</span><br><span class="line">2658</span><br><span class="line">2659</span><br><span class="line">2660</span><br><span class="line">2661</span><br><span class="line">2662</span><br><span class="line">2663</span><br><span class="line">2664</span><br><span class="line">2665</span><br><span class="line">2666</span><br><span class="line">2667</span><br><span class="line">2668</span><br><span class="line">2669</span><br><span class="line">2670</span><br><span class="line">2671</span><br><span class="line">2672</span><br><span class="line">2673</span><br><span class="line">2674</span><br><span class="line">2675</span><br><span class="line">2676</span><br><span class="line">2677</span><br><span class="line">2678</span><br><span class="line">2679</span><br><span class="line">2680</span><br><span class="line">2681</span><br><span class="line">2682</span><br><span class="line">2683</span><br><span class="line">2684</span><br><span class="line">2685</span><br><span class="line">2686</span><br><span class="line">2687</span><br><span class="line">2688</span><br><span class="line">2689</span><br><span class="line">2690</span><br><span class="line">2691</span><br><span class="line">2692</span><br><span class="line">2693</span><br><span class="line">2694</span><br><span class="line">2695</span><br><span class="line">2696</span><br><span class="line">2697</span><br><span class="line">2698</span><br><span class="line">2699</span><br><span class="line">2700</span><br><span class="line">2701</span><br><span class="line">2702</span><br><span class="line">2703</span><br><span class="line">2704</span><br><span class="line">2705</span><br><span class="line">2706</span><br><span class="line">2707</span><br><span class="line">2708</span><br><span class="line">2709</span><br><span class="line">2710</span><br><span class="line">2711</span><br><span class="line">2712</span><br><span class="line">2713</span><br><span class="line">2714</span><br><span class="line">2715</span><br><span class="line">2716</span><br><span class="line">2717</span><br><span class="line">2718</span><br><span class="line">2719</span><br><span class="line">2720</span><br><span class="line">2721</span><br><span class="line">2722</span><br><span class="line">2723</span><br><span class="line">2724</span><br><span class="line">2725</span><br><span class="line">2726</span><br><span class="line">2727</span><br><span class="line">2728</span><br><span class="line">2729</span><br><span class="line">2730</span><br><span class="line">2731</span><br><span class="line">2732</span><br><span class="line">2733</span><br><span class="line">2734</span><br><span class="line">2735</span><br><span class="line">2736</span><br><span class="line">2737</span><br><span class="line">2738</span><br><span class="line">2739</span><br><span class="line">2740</span><br><span class="line">2741</span><br><span class="line">2742</span><br><span class="line">2743</span><br><span class="line">2744</span><br><span class="line">2745</span><br><span class="line">2746</span><br><span class="line">2747</span><br><span class="line">2748</span><br><span class="line">2749</span><br><span class="line">2750</span><br><span class="line">2751</span><br><span class="line">2752</span><br><span class="line">2753</span><br><span class="line">2754</span><br><span class="line">2755</span><br><span class="line">2756</span><br><span class="line">2757</span><br><span class="line">2758</span><br><span class="line">2759</span><br><span class="line">2760</span><br><span class="line">2761</span><br><span class="line">2762</span><br><span class="line">2763</span><br><span class="line">2764</span><br><span class="line">2765</span><br><span class="line">2766</span><br><span class="line">2767</span><br><span class="line">2768</span><br><span class="line">2769</span><br><span class="line">2770</span><br><span class="line">2771</span><br><span class="line">2772</span><br><span class="line">2773</span><br><span class="line">2774</span><br><span class="line">2775</span><br><span class="line">2776</span><br><span class="line">2777</span><br><span class="line">2778</span><br><span class="line">2779</span><br><span class="line">2780</span><br><span class="line">2781</span><br><span class="line">2782</span><br><span class="line">2783</span><br><span class="line">2784</span><br><span class="line">2785</span><br><span class="line">2786</span><br><span class="line">2787</span><br><span class="line">2788</span><br><span class="line">2789</span><br><span class="line">2790</span><br><span class="line">2791</span><br><span class="line">2792</span><br><span class="line">2793</span><br><span class="line">2794</span><br><span class="line">2795</span><br><span class="line">2796</span><br><span class="line">2797</span><br><span class="line">2798</span><br><span class="line">2799</span><br><span class="line">2800</span><br><span class="line">2801</span><br><span class="line">2802</span><br><span class="line">2803</span><br><span class="line">2804</span><br><span class="line">2805</span><br><span class="line">2806</span><br><span class="line">2807</span><br><span class="line">2808</span><br><span class="line">2809</span><br><span class="line">2810</span><br><span class="line">2811</span><br><span class="line">2812</span><br><span class="line">2813</span><br><span class="line">2814</span><br><span class="line">2815</span><br><span class="line">2816</span><br><span class="line">2817</span><br><span class="line">2818</span><br><span class="line">2819</span><br><span class="line">2820</span><br><span class="line">2821</span><br><span class="line">2822</span><br><span class="line">2823</span><br><span class="line">2824</span><br><span class="line">2825</span><br><span class="line">2826</span><br><span class="line">2827</span><br><span class="line">2828</span><br><span class="line">2829</span><br><span class="line">2830</span><br><span class="line">2831</span><br><span class="line">2832</span><br><span class="line">2833</span><br><span class="line">2834</span><br><span class="line">2835</span><br><span class="line">2836</span><br><span class="line">2837</span><br><span class="line">2838</span><br><span class="line">2839</span><br><span class="line">2840</span><br><span class="line">2841</span><br><span class="line">2842</span><br><span class="line">2843</span><br><span class="line">2844</span><br><span class="line">2845</span><br><span class="line">2846</span><br><span class="line">2847</span><br><span class="line">2848</span><br><span class="line">2849</span><br><span class="line">2850</span><br><span class="line">2851</span><br><span class="line">2852</span><br><span class="line">2853</span><br><span class="line">2854</span><br><span class="line">2855</span><br><span class="line">2856</span><br><span class="line">2857</span><br><span class="line">2858</span><br><span class="line">2859</span><br><span class="line">2860</span><br><span class="line">2861</span><br><span class="line">2862</span><br><span class="line">2863</span><br><span class="line">2864</span><br><span class="line">2865</span><br><span class="line">2866</span><br><span class="line">2867</span><br><span class="line">2868</span><br><span class="line">2869</span><br><span class="line">2870</span><br><span class="line">2871</span><br><span class="line">2872</span><br><span class="line">2873</span><br><span class="line">2874</span><br><span class="line">2875</span><br><span class="line">2876</span><br><span class="line">2877</span><br><span class="line">2878</span><br><span class="line">2879</span><br><span class="line">2880</span><br><span class="line">2881</span><br><span class="line">2882</span><br><span class="line">2883</span><br><span class="line">2884</span><br><span class="line">2885</span><br><span class="line">2886</span><br><span class="line">2887</span><br><span class="line">2888</span><br><span class="line">2889</span><br><span class="line">2890</span><br><span class="line">2891</span><br><span class="line">2892</span><br><span class="line">2893</span><br><span class="line">2894</span><br><span class="line">2895</span><br><span class="line">2896</span><br><span class="line">2897</span><br><span class="line">2898</span><br><span class="line">2899</span><br><span class="line">2900</span><br><span class="line">2901</span><br><span class="line">2902</span><br><span class="line">2903</span><br><span class="line">2904</span><br><span class="line">2905</span><br><span class="line">2906</span><br><span class="line">2907</span><br><span class="line">2908</span><br><span class="line">2909</span><br><span class="line">2910</span><br><span class="line">2911</span><br><span class="line">2912</span><br><span class="line">2913</span><br><span class="line">2914</span><br><span class="line">2915</span><br><span class="line">2916</span><br><span class="line">2917</span><br><span class="line">2918</span><br><span class="line">2919</span><br><span class="line">2920</span><br><span class="line">2921</span><br><span class="line">2922</span><br><span class="line">2923</span><br><span class="line">2924</span><br><span class="line">2925</span><br><span class="line">2926</span><br><span class="line">2927</span><br><span class="line">2928</span><br><span class="line">2929</span><br><span class="line">2930</span><br><span class="line">2931</span><br><span class="line">2932</span><br><span class="line">2933</span><br><span class="line">2934</span><br><span class="line">2935</span><br><span class="line">2936</span><br><span class="line">2937</span><br><span class="line">2938</span><br><span class="line">2939</span><br><span class="line">2940</span><br><span class="line">2941</span><br><span class="line">2942</span><br><span class="line">2943</span><br><span class="line">2944</span><br><span class="line">2945</span><br><span class="line">2946</span><br><span class="line">2947</span><br><span class="line">2948</span><br><span class="line">2949</span><br><span class="line">2950</span><br><span class="line">2951</span><br><span class="line">2952</span><br><span class="line">2953</span><br><span class="line">2954</span><br><span class="line">2955</span><br><span class="line">2956</span><br><span class="line">2957</span><br><span class="line">2958</span><br><span class="line">2959</span><br><span class="line">2960</span><br><span class="line">2961</span><br><span class="line">2962</span><br><span class="line">2963</span><br><span class="line">2964</span><br><span class="line">2965</span><br><span class="line">2966</span><br><span class="line">2967</span><br><span class="line">2968</span><br><span class="line">2969</span><br><span class="line">2970</span><br><span class="line">2971</span><br><span class="line">2972</span><br><span class="line">2973</span><br><span class="line">2974</span><br><span class="line">2975</span><br><span class="line">2976</span><br><span class="line">2977</span><br><span class="line">2978</span><br><span class="line">2979</span><br><span class="line">2980</span><br><span class="line">2981</span><br><span class="line">2982</span><br><span class="line">2983</span><br><span class="line">2984</span><br><span class="line">2985</span><br><span class="line">2986</span><br><span class="line">2987</span><br><span class="line">2988</span><br><span class="line">2989</span><br><span class="line">2990</span><br><span class="line">2991</span><br><span class="line">2992</span><br><span class="line">2993</span><br><span class="line">2994</span><br><span class="line">2995</span><br><span class="line">2996</span><br><span class="line">2997</span><br><span class="line">2998</span><br><span class="line">2999</span><br><span class="line">3000</span><br><span class="line">3001</span><br><span class="line">3002</span><br><span class="line">3003</span><br><span class="line">3004</span><br><span class="line">3005</span><br><span class="line">3006</span><br><span class="line">3007</span><br><span class="line">3008</span><br><span class="line">3009</span><br><span class="line">3010</span><br><span class="line">3011</span><br><span class="line">3012</span><br><span class="line">3013</span><br><span class="line">3014</span><br><span class="line">3015</span><br><span class="line">3016</span><br><span class="line">3017</span><br><span class="line">3018</span><br><span class="line">3019</span><br><span class="line">3020</span><br><span class="line">3021</span><br><span class="line">3022</span><br><span class="line">3023</span><br><span class="line">3024</span><br><span class="line">3025</span><br><span class="line">3026</span><br><span class="line">3027</span><br><span class="line">3028</span><br><span class="line">3029</span><br><span class="line">3030</span><br><span class="line">3031</span><br><span class="line">3032</span><br><span class="line">3033</span><br><span class="line">3034</span><br><span class="line">3035</span><br><span class="line">3036</span><br><span class="line">3037</span><br><span class="line">3038</span><br><span class="line">3039</span><br><span class="line">3040</span><br><span class="line">3041</span><br><span class="line">3042</span><br><span class="line">3043</span><br><span class="line">3044</span><br><span class="line">3045</span><br><span class="line">3046</span><br><span class="line">3047</span><br><span class="line">3048</span><br><span class="line">3049</span><br><span class="line">3050</span><br><span class="line">3051</span><br><span class="line">3052</span><br><span class="line">3053</span><br><span class="line">3054</span><br><span class="line">3055</span><br><span class="line">3056</span><br><span class="line">3057</span><br><span class="line">3058</span><br><span class="line">3059</span><br><span class="line">3060</span><br><span class="line">3061</span><br><span class="line">3062</span><br><span class="line">3063</span><br><span class="line">3064</span><br><span class="line">3065</span><br><span class="line">3066</span><br><span class="line">3067</span><br><span class="line">3068</span><br><span class="line">3069</span><br><span class="line">3070</span><br><span class="line">3071</span><br><span class="line">3072</span><br><span class="line">3073</span><br><span class="line">3074</span><br><span class="line">3075</span><br><span class="line">3076</span><br><span class="line">3077</span><br><span class="line">3078</span><br><span class="line">3079</span><br><span class="line">3080</span><br><span class="line">3081</span><br><span class="line">3082</span><br><span class="line">3083</span><br><span class="line">3084</span><br><span class="line">3085</span><br><span class="line">3086</span><br><span class="line">3087</span><br><span class="line">3088</span><br><span class="line">3089</span><br><span class="line">3090</span><br><span class="line">3091</span><br><span class="line">3092</span><br><span class="line">3093</span><br><span class="line">3094</span><br><span class="line">3095</span><br><span class="line">3096</span><br><span class="line">3097</span><br><span class="line">3098</span><br><span class="line">3099</span><br><span class="line">3100</span><br><span class="line">3101</span><br><span class="line">3102</span><br><span class="line">3103</span><br><span class="line">3104</span><br><span class="line">3105</span><br><span class="line">3106</span><br><span class="line">3107</span><br><span class="line">3108</span><br><span class="line">3109</span><br><span class="line">3110</span><br><span class="line">3111</span><br><span class="line">3112</span><br><span class="line">3113</span><br><span class="line">3114</span><br><span class="line">3115</span><br><span class="line">3116</span><br><span class="line">3117</span><br><span class="line">3118</span><br><span class="line">3119</span><br><span class="line">3120</span><br><span class="line">3121</span><br><span class="line">3122</span><br><span class="line">3123</span><br><span class="line">3124</span><br><span class="line">3125</span><br><span class="line">3126</span><br><span class="line">3127</span><br><span class="line">3128</span><br><span class="line">3129</span><br><span class="line">3130</span><br><span class="line">3131</span><br><span class="line">3132</span><br><span class="line">3133</span><br><span class="line">3134</span><br><span class="line">3135</span><br><span class="line">3136</span><br><span class="line">3137</span><br><span class="line">3138</span><br><span class="line">3139</span><br><span class="line">3140</span><br><span class="line">3141</span><br><span class="line">3142</span><br><span class="line">3143</span><br><span class="line">3144</span><br><span class="line">3145</span><br><span class="line">3146</span><br><span class="line">3147</span><br><span class="line">3148</span><br><span class="line">3149</span><br><span class="line">3150</span><br><span class="line">3151</span><br><span class="line">3152</span><br><span class="line">3153</span><br><span class="line">3154</span><br><span class="line">3155</span><br><span class="line">3156</span><br><span class="line">3157</span><br><span class="line">3158</span><br><span class="line">3159</span><br><span class="line">3160</span><br><span class="line">3161</span><br><span class="line">3162</span><br><span class="line">3163</span><br><span class="line">3164</span><br><span class="line">3165</span><br><span class="line">3166</span><br><span class="line">3167</span><br><span class="line">3168</span><br><span class="line">3169</span><br><span class="line">3170</span><br><span class="line">3171</span><br><span class="line">3172</span><br><span class="line">3173</span><br><span class="line">3174</span><br><span class="line">3175</span><br><span class="line">3176</span><br><span class="line">3177</span><br><span class="line">3178</span><br><span class="line">3179</span><br><span class="line">3180</span><br><span class="line">3181</span><br><span class="line">3182</span><br><span class="line">3183</span><br><span class="line">3184</span><br><span class="line">3185</span><br><span class="line">3186</span><br><span class="line">3187</span><br><span class="line">3188</span><br><span class="line">3189</span><br><span class="line">3190</span><br><span class="line">3191</span><br><span class="line">3192</span><br><span class="line">3193</span><br><span class="line">3194</span><br><span class="line">3195</span><br><span class="line">3196</span><br><span class="line">3197</span><br><span class="line">3198</span><br><span class="line">3199</span><br><span class="line">3200</span><br><span class="line">3201</span><br><span class="line">3202</span><br><span class="line">3203</span><br><span class="line">3204</span><br><span class="line">3205</span><br><span class="line">3206</span><br><span class="line">3207</span><br><span class="line">3208</span><br><span class="line">3209</span><br><span class="line">3210</span><br><span class="line">3211</span><br><span class="line">3212</span><br><span class="line">3213</span><br><span class="line">3214</span><br><span class="line">3215</span><br><span class="line">3216</span><br><span class="line">3217</span><br><span class="line">3218</span><br><span class="line">3219</span><br><span class="line">3220</span><br><span class="line">3221</span><br><span class="line">3222</span><br><span class="line">3223</span><br><span class="line">3224</span><br><span class="line">3225</span><br><span class="line">3226</span><br><span class="line">3227</span><br><span class="line">3228</span><br><span class="line">3229</span><br><span class="line">3230</span><br><span class="line">3231</span><br><span class="line">3232</span><br><span class="line">3233</span><br><span class="line">3234</span><br><span class="line">3235</span><br><span class="line">3236</span><br><span class="line">3237</span><br><span class="line">3238</span><br><span class="line">3239</span><br><span class="line">3240</span><br><span class="line">3241</span><br><span class="line">3242</span><br><span class="line">3243</span><br><span class="line">3244</span><br><span class="line">3245</span><br><span class="line">3246</span><br><span class="line">3247</span><br><span class="line">3248</span><br><span class="line">3249</span><br><span class="line">3250</span><br><span class="line">3251</span><br><span class="line">3252</span><br><span class="line">3253</span><br><span class="line">3254</span><br><span class="line">3255</span><br><span class="line">3256</span><br><span class="line">3257</span><br><span class="line">3258</span><br><span class="line">3259</span><br><span class="line">3260</span><br><span class="line">3261</span><br><span class="line">3262</span><br><span class="line">3263</span><br><span class="line">3264</span><br><span class="line">3265</span><br><span class="line">3266</span><br><span class="line">3267</span><br><span class="line">3268</span><br><span class="line">3269</span><br><span class="line">3270</span><br><span class="line">3271</span><br><span class="line">3272</span><br><span class="line">3273</span><br><span class="line">3274</span><br><span class="line">3275</span><br><span class="line">3276</span><br><span class="line">3277</span><br><span class="line">3278</span><br><span class="line">3279</span><br><span class="line">3280</span><br><span class="line">3281</span><br><span class="line">3282</span><br><span class="line">3283</span><br><span class="line">3284</span><br><span class="line">3285</span><br><span class="line">3286</span><br><span class="line">3287</span><br><span class="line">3288</span><br><span class="line">3289</span><br><span class="line">3290</span><br><span class="line">3291</span><br><span class="line">3292</span><br><span class="line">3293</span><br><span class="line">3294</span><br><span class="line">3295</span><br><span class="line">3296</span><br><span class="line">3297</span><br><span class="line">3298</span><br><span class="line">3299</span><br><span class="line">3300</span><br><span class="line">3301</span><br><span class="line">3302</span><br><span class="line">3303</span><br><span class="line">3304</span><br><span class="line">3305</span><br><span class="line">3306</span><br><span class="line">3307</span><br><span class="line">3308</span><br><span class="line">3309</span><br><span class="line">3310</span><br><span class="line">3311</span><br><span class="line">3312</span><br><span class="line">3313</span><br><span class="line">3314</span><br><span class="line">3315</span><br><span class="line">3316</span><br><span class="line">3317</span><br><span class="line">3318</span><br><span class="line">3319</span><br><span class="line">3320</span><br><span class="line">3321</span><br><span class="line">3322</span><br><span class="line">3323</span><br><span class="line">3324</span><br><span class="line">3325</span><br><span class="line">3326</span><br><span class="line">3327</span><br><span class="line">3328</span><br><span class="line">3329</span><br><span class="line">3330</span><br><span class="line">3331</span><br><span class="line">3332</span><br><span class="line">3333</span><br><span class="line">3334</span><br><span class="line">3335</span><br><span class="line">3336</span><br><span class="line">3337</span><br><span class="line">3338</span><br><span class="line">3339</span><br><span class="line">3340</span><br><span class="line">3341</span><br><span class="line">3342</span><br><span class="line">3343</span><br><span class="line">3344</span><br><span class="line">3345</span><br><span class="line">3346</span><br><span class="line">3347</span><br><span class="line">3348</span><br><span class="line">3349</span><br><span class="line">3350</span><br><span class="line">3351</span><br><span class="line">3352</span><br><span class="line">3353</span><br><span class="line">3354</span><br><span class="line">3355</span><br><span class="line">3356</span><br><span class="line">3357</span><br><span class="line">3358</span><br><span class="line">3359</span><br><span class="line">3360</span><br><span class="line">3361</span><br><span class="line">3362</span><br><span class="line">3363</span><br><span class="line">3364</span><br><span class="line">3365</span><br><span class="line">3366</span><br><span class="line">3367</span><br><span class="line">3368</span><br><span class="line">3369</span><br><span class="line">3370</span><br><span class="line">3371</span><br><span class="line">3372</span><br><span class="line">3373</span><br><span class="line">3374</span><br><span class="line">3375</span><br><span class="line">3376</span><br><span class="line">3377</span><br><span class="line">3378</span><br><span class="line">3379</span><br><span class="line">3380</span><br><span class="line">3381</span><br><span class="line">3382</span><br><span class="line">3383</span><br><span class="line">3384</span><br><span class="line">3385</span><br><span class="line">3386</span><br><span class="line">3387</span><br><span class="line">3388</span><br><span class="line">3389</span><br><span class="line">3390</span><br><span class="line">3391</span><br><span class="line">3392</span><br><span class="line">3393</span><br><span class="line">3394</span><br><span class="line">3395</span><br><span class="line">3396</span><br><span class="line">3397</span><br><span class="line">3398</span><br><span class="line">3399</span><br><span class="line">3400</span><br><span class="line">3401</span><br><span class="line">3402</span><br><span class="line">3403</span><br><span class="line">3404</span><br><span class="line">3405</span><br><span class="line">3406</span><br><span class="line">3407</span><br><span class="line">3408</span><br><span class="line">3409</span><br><span class="line">3410</span><br><span class="line">3411</span><br><span class="line">3412</span><br><span class="line">3413</span><br><span class="line">3414</span><br><span class="line">3415</span><br><span class="line">3416</span><br><span class="line">3417</span><br><span class="line">3418</span><br><span class="line">3419</span><br><span class="line">3420</span><br><span class="line">3421</span><br><span class="line">3422</span><br><span class="line">3423</span><br><span class="line">3424</span><br><span class="line">3425</span><br><span class="line">3426</span><br><span class="line">3427</span><br><span class="line">3428</span><br><span class="line">3429</span><br><span class="line">3430</span><br><span class="line">3431</span><br><span class="line">3432</span><br><span class="line">3433</span><br><span class="line">3434</span><br><span class="line">3435</span><br><span class="line">3436</span><br><span class="line">3437</span><br><span class="line">3438</span><br><span class="line">3439</span><br><span class="line">3440</span><br><span class="line">3441</span><br><span class="line">3442</span><br><span class="line">3443</span><br><span class="line">3444</span><br><span class="line">3445</span><br><span class="line">3446</span><br><span class="line">3447</span><br><span class="line">3448</span><br><span class="line">3449</span><br><span class="line">3450</span><br><span class="line">3451</span><br><span class="line">3452</span><br><span class="line">3453</span><br><span class="line">3454</span><br><span class="line">3455</span><br><span class="line">3456</span><br><span class="line">3457</span><br><span class="line">3458</span><br><span class="line">3459</span><br><span class="line">3460</span><br><span class="line">3461</span><br><span class="line">3462</span><br><span class="line">3463</span><br><span class="line">3464</span><br><span class="line">3465</span><br><span class="line">3466</span><br><span class="line">3467</span><br><span class="line">3468</span><br><span class="line">3469</span><br><span class="line">3470</span><br><span class="line">3471</span><br><span class="line">3472</span><br><span class="line">3473</span><br><span class="line">3474</span><br><span class="line">3475</span><br><span class="line">3476</span><br><span class="line">3477</span><br><span class="line">3478</span><br><span class="line">3479</span><br><span class="line">3480</span><br><span class="line">3481</span><br><span class="line">3482</span><br><span class="line">3483</span><br><span class="line">3484</span><br><span class="line">3485</span><br><span class="line">3486</span><br><span class="line">3487</span><br><span class="line">3488</span><br><span class="line">3489</span><br><span class="line">3490</span><br><span class="line">3491</span><br><span class="line">3492</span><br><span class="line">3493</span><br><span class="line">3494</span><br><span class="line">3495</span><br><span class="line">3496</span><br><span class="line">3497</span><br><span class="line">3498</span><br><span class="line">3499</span><br><span class="line">3500</span><br><span class="line">3501</span><br><span class="line">3502</span><br><span class="line">3503</span><br><span class="line">3504</span><br><span class="line">3505</span><br><span class="line">3506</span><br><span class="line">3507</span><br><span class="line">3508</span><br><span class="line">3509</span><br><span class="line">3510</span><br><span class="line">3511</span><br><span class="line">3512</span><br><span class="line">3513</span><br><span class="line">3514</span><br><span class="line">3515</span><br><span class="line">3516</span><br><span class="line">3517</span><br><span class="line">3518</span><br><span class="line">3519</span><br><span class="line">3520</span><br><span class="line">3521</span><br><span class="line">3522</span><br><span class="line">3523</span><br><span class="line">3524</span><br><span class="line">3525</span><br><span class="line">3526</span><br><span class="line">3527</span><br><span class="line">3528</span><br><span class="line">3529</span><br><span class="line">3530</span><br><span class="line">3531</span><br><span class="line">3532</span><br><span class="line">3533</span><br><span class="line">3534</span><br><span class="line">3535</span><br><span class="line">3536</span><br><span class="line">3537</span><br><span class="line">3538</span><br><span class="line">3539</span><br><span class="line">3540</span><br><span class="line">3541</span><br><span class="line">3542</span><br><span class="line">3543</span><br><span class="line">3544</span><br><span class="line">3545</span><br><span class="line">3546</span><br><span class="line">3547</span><br><span class="line">3548</span><br><span class="line">3549</span><br><span class="line">3550</span><br><span class="line">3551</span><br><span class="line">3552</span><br><span class="line">3553</span><br><span class="line">3554</span><br><span class="line">3555</span><br><span class="line">3556</span><br><span class="line">3557</span><br><span class="line">3558</span><br><span class="line">3559</span><br><span class="line">3560</span><br><span class="line">3561</span><br><span class="line">3562</span><br><span class="line">3563</span><br><span class="line">3564</span><br><span class="line">3565</span><br><span class="line">3566</span><br><span class="line">3567</span><br><span class="line">3568</span><br><span class="line">3569</span><br><span class="line">3570</span><br><span class="line">3571</span><br><span class="line">3572</span><br><span class="line">3573</span><br><span class="line">3574</span><br><span class="line">3575</span><br><span class="line">3576</span><br><span class="line">3577</span><br><span class="line">3578</span><br><span class="line">3579</span><br><span class="line">3580</span><br><span class="line">3581</span><br><span class="line">3582</span><br><span class="line">3583</span><br><span class="line">3584</span><br><span class="line">3585</span><br><span class="line">3586</span><br><span class="line">3587</span><br><span class="line">3588</span><br><span class="line">3589</span><br><span class="line">3590</span><br><span class="line">3591</span><br><span class="line">3592</span><br><span class="line">3593</span><br><span class="line">3594</span><br><span class="line">3595</span><br><span class="line">3596</span><br><span class="line">3597</span><br><span class="line">3598</span><br><span class="line">3599</span><br><span class="line">3600</span><br><span class="line">3601</span><br><span class="line">3602</span><br><span class="line">3603</span><br><span class="line">3604</span><br><span class="line">3605</span><br><span class="line">3606</span><br><span class="line">3607</span><br><span class="line">3608</span><br><span class="line">3609</span><br><span class="line">3610</span><br><span class="line">3611</span><br><span class="line">3612</span><br><span class="line">3613</span><br><span class="line">3614</span><br><span class="line">3615</span><br><span class="line">3616</span><br><span class="line">3617</span><br><span class="line">3618</span><br><span class="line">3619</span><br><span class="line">3620</span><br><span class="line">3621</span><br><span class="line">3622</span><br><span class="line">3623</span><br><span class="line">3624</span><br><span class="line">3625</span><br><span class="line">3626</span><br><span class="line">3627</span><br><span class="line">3628</span><br><span class="line">3629</span><br><span class="line">3630</span><br><span class="line">3631</span><br><span class="line">3632</span><br><span class="line">3633</span><br><span class="line">3634</span><br><span class="line">3635</span><br><span class="line">3636</span><br><span class="line">3637</span><br><span class="line">3638</span><br><span class="line">3639</span><br><span class="line">3640</span><br><span class="line">3641</span><br><span class="line">3642</span><br><span class="line">3643</span><br><span class="line">3644</span><br><span class="line">3645</span><br><span class="line">3646</span><br><span class="line">3647</span><br><span class="line">3648</span><br><span class="line">3649</span><br><span class="line">3650</span><br><span class="line">3651</span><br><span class="line">3652</span><br><span class="line">3653</span><br><span class="line">3654</span><br><span class="line">3655</span><br><span class="line">3656</span><br><span class="line">3657</span><br><span class="line">3658</span><br><span class="line">3659</span><br><span class="line">3660</span><br><span class="line">3661</span><br><span class="line">3662</span><br><span class="line">3663</span><br><span class="line">3664</span><br><span class="line">3665</span><br><span class="line">3666</span><br><span class="line">3667</span><br><span class="line">3668</span><br><span class="line">3669</span><br><span class="line">3670</span><br><span class="line">3671</span><br><span class="line">3672</span><br><span class="line">3673</span><br><span class="line">3674</span><br><span class="line">3675</span><br><span class="line">3676</span><br><span class="line">3677</span><br><span class="line">3678</span><br><span class="line">3679</span><br><span class="line">3680</span><br><span class="line">3681</span><br><span class="line">3682</span><br><span class="line">3683</span><br><span class="line">3684</span><br><span class="line">3685</span><br><span class="line">3686</span><br><span class="line">3687</span><br><span class="line">3688</span><br><span class="line">3689</span><br><span class="line">3690</span><br><span class="line">3691</span><br><span class="line">3692</span><br><span class="line">3693</span><br><span class="line">3694</span><br><span class="line">3695</span><br><span class="line">3696</span><br><span class="line">3697</span><br><span class="line">3698</span><br><span class="line">3699</span><br><span class="line">3700</span><br><span class="line">3701</span><br><span class="line">3702</span><br><span class="line">3703</span><br><span class="line">3704</span><br><span class="line">3705</span><br><span class="line">3706</span><br><span class="line">3707</span><br><span class="line">3708</span><br><span class="line">3709</span><br><span class="line">3710</span><br><span class="line">3711</span><br><span class="line">3712</span><br><span class="line">3713</span><br><span class="line">3714</span><br><span class="line">3715</span><br><span class="line">3716</span><br><span class="line">3717</span><br><span class="line">3718</span><br><span class="line">3719</span><br><span class="line">3720</span><br><span class="line">3721</span><br><span class="line">3722</span><br><span class="line">3723</span><br><span class="line">3724</span><br><span class="line">3725</span><br><span class="line">3726</span><br><span class="line">3727</span><br><span class="line">3728</span><br><span class="line">3729</span><br><span class="line">3730</span><br><span class="line">3731</span><br><span class="line">3732</span><br><span class="line">3733</span><br><span class="line">3734</span><br><span class="line">3735</span><br><span class="line">3736</span><br><span class="line">3737</span><br><span class="line">3738</span><br><span class="line">3739</span><br><span class="line">3740</span><br><span class="line">3741</span><br><span class="line">3742</span><br><span class="line">3743</span><br><span class="line">3744</span><br><span class="line">3745</span><br><span class="line">3746</span><br><span class="line">3747</span><br><span class="line">3748</span><br><span class="line">3749</span><br><span class="line">3750</span><br><span class="line">3751</span><br><span class="line">3752</span><br><span class="line">3753</span><br><span class="line">3754</span><br><span class="line">3755</span><br><span class="line">3756</span><br><span class="line">3757</span><br><span class="line">3758</span><br><span class="line">3759</span><br><span class="line">3760</span><br><span class="line">3761</span><br><span class="line">3762</span><br><span class="line">3763</span><br><span class="line">3764</span><br><span class="line">3765</span><br><span class="line">3766</span><br><span class="line">3767</span><br><span class="line">3768</span><br><span class="line">3769</span><br><span class="line">3770</span><br><span class="line">3771</span><br><span class="line">3772</span><br><span class="line">3773</span><br><span class="line">3774</span><br><span class="line">3775</span><br><span class="line">3776</span><br><span class="line">3777</span><br><span class="line">3778</span><br><span class="line">3779</span><br><span class="line">3780</span><br><span class="line">3781</span><br><span class="line">3782</span><br><span class="line">3783</span><br><span class="line">3784</span><br><span class="line">3785</span><br><span class="line">3786</span><br><span class="line">3787</span><br><span class="line">3788</span><br><span class="line">3789</span><br><span class="line">3790</span><br><span class="line">3791</span><br><span class="line">3792</span><br><span class="line">3793</span><br><span class="line">3794</span><br><span class="line">3795</span><br><span class="line">3796</span><br><span class="line">3797</span><br><span class="line">3798</span><br><span class="line">3799</span><br><span class="line">3800</span><br><span class="line">3801</span><br><span class="line">3802</span><br><span class="line">3803</span><br><span class="line">3804</span><br><span class="line">3805</span><br><span class="line">3806</span><br><span class="line">3807</span><br><span class="line">3808</span><br><span class="line">3809</span><br><span class="line">3810</span><br><span class="line">3811</span><br><span class="line">3812</span><br><span class="line">3813</span><br><span class="line">3814</span><br><span class="line">3815</span><br><span class="line">3816</span><br><span class="line">3817</span><br><span class="line">3818</span><br><span class="line">3819</span><br><span class="line">3820</span><br><span class="line">3821</span><br><span class="line">3822</span><br><span class="line">3823</span><br><span class="line">3824</span><br><span class="line">3825</span><br><span class="line">3826</span><br><span class="line">3827</span><br><span class="line">3828</span><br><span class="line">3829</span><br><span class="line">3830</span><br><span class="line">3831</span><br><span class="line">3832</span><br><span class="line">3833</span><br><span class="line">3834</span><br><span class="line">3835</span><br><span class="line">3836</span><br><span class="line">3837</span><br><span class="line">3838</span><br><span class="line">3839</span><br><span class="line">3840</span><br><span class="line">3841</span><br><span class="line">3842</span><br><span class="line">3843</span><br><span class="line">3844</span><br><span class="line">3845</span><br><span class="line">3846</span><br><span class="line">3847</span><br><span class="line">3848</span><br><span class="line">3849</span><br><span class="line">3850</span><br><span class="line">3851</span><br><span class="line">3852</span><br><span class="line">3853</span><br><span class="line">3854</span><br><span class="line">3855</span><br><span class="line">3856</span><br><span class="line">3857</span><br><span class="line">3858</span><br><span class="line">3859</span><br><span class="line">3860</span><br><span class="line">3861</span><br><span class="line">3862</span><br><span class="line">3863</span><br><span class="line">3864</span><br><span class="line">3865</span><br><span class="line">3866</span><br><span class="line">3867</span><br><span class="line">3868</span><br><span class="line">3869</span><br><span class="line">3870</span><br><span class="line">3871</span><br><span class="line">3872</span><br><span class="line">3873</span><br><span class="line">3874</span><br><span class="line">3875</span><br><span class="line">3876</span><br><span class="line">3877</span><br><span class="line">3878</span><br><span class="line">3879</span><br><span class="line">3880</span><br><span class="line">3881</span><br><span class="line">3882</span><br><span class="line">3883</span><br><span class="line">3884</span><br><span class="line">3885</span><br><span class="line">3886</span><br><span class="line">3887</span><br><span class="line">3888</span><br><span class="line">3889</span><br><span class="line">3890</span><br><span class="line">3891</span><br><span class="line">3892</span><br><span class="line">3893</span><br><span class="line">3894</span><br><span class="line">3895</span><br><span class="line">3896</span><br><span class="line">3897</span><br><span class="line">3898</span><br><span class="line">3899</span><br><span class="line">3900</span><br><span class="line">3901</span><br><span class="line">3902</span><br><span class="line">3903</span><br><span class="line">3904</span><br><span class="line">3905</span><br><span class="line">3906</span><br><span class="line">3907</span><br><span class="line">3908</span><br><span class="line">3909</span><br><span class="line">3910</span><br><span class="line">3911</span><br><span class="line">3912</span><br><span class="line">3913</span><br><span class="line">3914</span><br><span class="line">3915</span><br><span class="line">3916</span><br><span class="line">3917</span><br><span class="line">3918</span><br><span class="line">3919</span><br><span class="line">3920</span><br><span class="line">3921</span><br><span class="line">3922</span><br><span class="line">3923</span><br><span class="line">3924</span><br><span class="line">3925</span><br><span class="line">3926</span><br><span class="line">3927</span><br><span class="line">3928</span><br><span class="line">3929</span><br><span class="line">3930</span><br><span class="line">3931</span><br><span class="line">3932</span><br><span class="line">3933</span><br><span class="line">3934</span><br><span class="line">3935</span><br><span class="line">3936</span><br><span class="line">3937</span><br><span class="line">3938</span><br><span class="line">3939</span><br><span class="line">3940</span><br><span class="line">3941</span><br><span class="line">3942</span><br><span class="line">3943</span><br><span class="line">3944</span><br><span class="line">3945</span><br><span class="line">3946</span><br><span class="line">3947</span><br><span class="line">3948</span><br><span class="line">3949</span><br><span class="line">3950</span><br><span class="line">3951</span><br><span class="line">3952</span><br><span class="line">3953</span><br><span class="line">3954</span><br><span class="line">3955</span><br><span class="line">3956</span><br><span class="line">3957</span><br><span class="line">3958</span><br><span class="line">3959</span><br><span class="line">3960</span><br><span class="line">3961</span><br><span class="line">3962</span><br><span class="line">3963</span><br><span class="line">3964</span><br><span class="line">3965</span><br><span class="line">3966</span><br><span class="line">3967</span><br><span class="line">3968</span><br><span class="line">3969</span><br><span class="line">3970</span><br><span class="line">3971</span><br><span class="line">3972</span><br><span class="line">3973</span><br><span class="line">3974</span><br><span class="line">3975</span><br><span class="line">3976</span><br><span class="line">3977</span><br><span class="line">3978</span><br><span class="line">3979</span><br><span class="line">3980</span><br><span class="line">3981</span><br><span class="line">3982</span><br><span class="line">3983</span><br><span class="line">3984</span><br><span class="line">3985</span><br><span class="line">3986</span><br><span class="line">3987</span><br><span class="line">3988</span><br><span class="line">3989</span><br><span class="line">3990</span><br><span class="line">3991</span><br><span class="line">3992</span><br><span class="line">3993</span><br><span class="line">3994</span><br><span class="line">3995</span><br><span class="line">3996</span><br><span class="line">3997</span><br><span class="line">3998</span><br><span class="line">3999</span><br><span class="line">4000</span><br><span class="line">4001</span><br><span class="line">4002</span><br><span class="line">4003</span><br><span class="line">4004</span><br><span class="line">4005</span><br><span class="line">4006</span><br><span class="line">4007</span><br><span class="line">4008</span><br><span class="line">4009</span><br><span class="line">4010</span><br><span class="line">4011</span><br><span class="line">4012</span><br><span class="line">4013</span><br><span class="line">4014</span><br><span class="line">4015</span><br><span class="line">4016</span><br><span class="line">4017</span><br><span class="line">4018</span><br><span class="line">4019</span><br><span class="line">4020</span><br><span class="line">4021</span><br><span class="line">4022</span><br><span class="line">4023</span><br><span class="line">4024</span><br><span class="line">4025</span><br><span class="line">4026</span><br><span class="line">4027</span><br><span class="line">4028</span><br><span class="line">4029</span><br><span class="line">4030</span><br><span class="line">4031</span><br><span class="line">4032</span><br><span class="line">4033</span><br><span class="line">4034</span><br><span class="line">4035</span><br><span class="line">4036</span><br><span class="line">4037</span><br><span class="line">4038</span><br><span class="line">4039</span><br><span class="line">4040</span><br><span class="line">4041</span><br><span class="line">4042</span><br><span class="line">4043</span><br><span class="line">4044</span><br><span class="line">4045</span><br><span class="line">4046</span><br><span class="line">4047</span><br><span class="line">4048</span><br><span class="line">4049</span><br><span class="line">4050</span><br><span class="line">4051</span><br><span class="line">4052</span><br><span class="line">4053</span><br><span class="line">4054</span><br><span class="line">4055</span><br><span class="line">4056</span><br><span class="line">4057</span><br><span class="line">4058</span><br><span class="line">4059</span><br><span class="line">4060</span><br><span class="line">4061</span><br><span class="line">4062</span><br><span class="line">4063</span><br><span class="line">4064</span><br><span class="line">4065</span><br><span class="line">4066</span><br><span class="line">4067</span><br><span class="line">4068</span><br><span class="line">4069</span><br><span class="line">4070</span><br><span class="line">4071</span><br><span class="line">4072</span><br><span class="line">4073</span><br><span class="line">4074</span><br><span class="line">4075</span><br><span class="line">4076</span><br><span class="line">4077</span><br><span class="line">4078</span><br><span class="line">4079</span><br><span class="line">4080</span><br><span class="line">4081</span><br><span class="line">4082</span><br><span class="line">4083</span><br><span class="line">4084</span><br><span class="line">4085</span><br><span class="line">4086</span><br><span class="line">4087</span><br><span class="line">4088</span><br><span class="line">4089</span><br><span class="line">4090</span><br><span class="line">4091</span><br><span class="line">4092</span><br><span class="line">4093</span><br><span class="line">4094</span><br><span class="line">4095</span><br><span class="line">4096</span><br><span class="line">4097</span><br><span class="line">4098</span><br><span class="line">4099</span><br><span class="line">4100</span><br><span class="line">4101</span><br><span class="line">4102</span><br><span class="line">4103</span><br><span class="line">4104</span><br><span class="line">4105</span><br><span class="line">4106</span><br><span class="line">4107</span><br><span class="line">4108</span><br><span class="line">4109</span><br><span class="line">4110</span><br><span class="line">4111</span><br><span class="line">4112</span><br><span class="line">4113</span><br><span class="line">4114</span><br><span class="line">4115</span><br><span class="line">4116</span><br><span class="line">4117</span><br><span class="line">4118</span><br><span class="line">4119</span><br><span class="line">4120</span><br><span class="line">4121</span><br><span class="line">4122</span><br><span class="line">4123</span><br><span class="line">4124</span><br><span class="line">4125</span><br><span class="line">4126</span><br><span class="line">4127</span><br><span class="line">4128</span><br><span class="line">4129</span><br><span class="line">4130</span><br><span class="line">4131</span><br><span class="line">4132</span><br><span class="line">4133</span><br><span class="line">4134</span><br><span class="line">4135</span><br><span class="line">4136</span><br><span class="line">4137</span><br><span class="line">4138</span><br><span class="line">4139</span><br><span class="line">4140</span><br><span class="line">4141</span><br><span class="line">4142</span><br><span class="line">4143</span><br><span class="line">4144</span><br><span class="line">4145</span><br><span class="line">4146</span><br><span class="line">4147</span><br><span class="line">4148</span><br><span class="line">4149</span><br><span class="line">4150</span><br><span class="line">4151</span><br><span class="line">4152</span><br><span class="line">4153</span><br><span class="line">4154</span><br><span class="line">4155</span><br><span class="line">4156</span><br><span class="line">4157</span><br><span class="line">4158</span><br><span class="line">4159</span><br><span class="line">4160</span><br><span class="line">4161</span><br><span class="line">4162</span><br><span class="line">4163</span><br><span class="line">4164</span><br><span class="line">4165</span><br><span class="line">4166</span><br><span class="line">4167</span><br><span class="line">4168</span><br><span class="line">4169</span><br><span class="line">4170</span><br><span class="line">4171</span><br><span class="line">4172</span><br><span class="line">4173</span><br><span class="line">4174</span><br><span class="line">4175</span><br><span class="line">4176</span><br><span class="line">4177</span><br><span class="line">4178</span><br><span class="line">4179</span><br><span class="line">4180</span><br><span class="line">4181</span><br><span class="line">4182</span><br><span class="line">4183</span><br><span class="line">4184</span><br><span class="line">4185</span><br><span class="line">4186</span><br><span class="line">4187</span><br><span class="line">4188</span><br><span class="line">4189</span><br><span class="line">4190</span><br><span class="line">4191</span><br><span class="line">4192</span><br><span class="line">4193</span><br><span class="line">4194</span><br><span class="line">4195</span><br><span class="line">4196</span><br><span class="line">4197</span><br><span class="line">4198</span><br><span class="line">4199</span><br><span class="line">4200</span><br><span class="line">4201</span><br><span class="line">4202</span><br><span class="line">4203</span><br><span class="line">4204</span><br><span class="line">4205</span><br><span class="line">4206</span><br><span class="line">4207</span><br><span class="line">4208</span><br><span class="line">4209</span><br><span class="line">4210</span><br><span class="line">4211</span><br><span class="line">4212</span><br><span class="line">4213</span><br><span class="line">4214</span><br><span class="line">4215</span><br><span class="line">4216</span><br><span class="line">4217</span><br><span class="line">4218</span><br><span class="line">4219</span><br><span class="line">4220</span><br><span class="line">4221</span><br><span class="line">4222</span><br><span class="line">4223</span><br><span class="line">4224</span><br><span class="line">4225</span><br><span class="line">4226</span><br><span class="line">4227</span><br><span class="line">4228</span><br><span class="line">4229</span><br><span class="line">4230</span><br><span class="line">4231</span><br><span class="line">4232</span><br><span class="line">4233</span><br><span class="line">4234</span><br><span class="line">4235</span><br><span class="line">4236</span><br><span class="line">4237</span><br><span class="line">4238</span><br><span class="line">4239</span><br><span class="line">4240</span><br><span class="line">4241</span><br><span class="line">4242</span><br><span class="line">4243</span><br><span class="line">4244</span><br><span class="line">4245</span><br><span class="line">4246</span><br><span class="line">4247</span><br><span class="line">4248</span><br><span class="line">4249</span><br><span class="line">4250</span><br><span class="line">4251</span><br><span class="line">4252</span><br><span class="line">4253</span><br><span class="line">4254</span><br><span class="line">4255</span><br><span class="line">4256</span><br><span class="line">4257</span><br><span class="line">4258</span><br><span class="line">4259</span><br><span class="line">4260</span><br><span class="line">4261</span><br><span class="line">4262</span><br><span class="line">4263</span><br><span class="line">4264</span><br><span class="line">4265</span><br><span class="line">4266</span><br><span class="line">4267</span><br><span class="line">4268</span><br><span class="line">4269</span><br><span class="line">4270</span><br><span class="line">4271</span><br><span class="line">4272</span><br><span class="line">4273</span><br><span class="line">4274</span><br><span class="line">4275</span><br><span class="line">4276</span><br><span class="line">4277</span><br><span class="line">4278</span><br><span class="line">4279</span><br><span class="line">4280</span><br><span class="line">4281</span><br><span class="line">4282</span><br><span class="line">4283</span><br><span class="line">4284</span><br><span class="line">4285</span><br><span class="line">4286</span><br><span class="line">4287</span><br><span class="line">4288</span><br><span class="line">4289</span><br><span class="line">4290</span><br><span class="line">4291</span><br><span class="line">4292</span><br><span class="line">4293</span><br><span class="line">4294</span><br><span class="line">4295</span><br><span class="line">4296</span><br><span class="line">4297</span><br><span class="line">4298</span><br><span class="line">4299</span><br><span class="line">4300</span><br><span class="line">4301</span><br><span class="line">4302</span><br><span class="line">4303</span><br><span class="line">4304</span><br><span class="line">4305</span><br><span class="line">4306</span><br><span class="line">4307</span><br><span class="line">4308</span><br><span class="line">4309</span><br><span class="line">4310</span><br><span class="line">4311</span><br><span class="line">4312</span><br><span class="line">4313</span><br><span class="line">4314</span><br><span class="line">4315</span><br><span class="line">4316</span><br><span class="line">4317</span><br><span class="line">4318</span><br><span class="line">4319</span><br><span class="line">4320</span><br><span class="line">4321</span><br><span class="line">4322</span><br><span class="line">4323</span><br><span class="line">4324</span><br><span class="line">4325</span><br><span class="line">4326</span><br><span class="line">4327</span><br><span class="line">4328</span><br><span class="line">4329</span><br><span class="line">4330</span><br><span class="line">4331</span><br><span class="line">4332</span><br><span class="line">4333</span><br><span class="line">4334</span><br><span class="line">4335</span><br><span class="line">4336</span><br><span class="line">4337</span><br><span class="line">4338</span><br><span class="line">4339</span><br><span class="line">4340</span><br><span class="line">4341</span><br><span class="line">4342</span><br><span class="line">4343</span><br><span class="line">4344</span><br><span class="line">4345</span><br><span class="line">4346</span><br><span class="line">4347</span><br><span class="line">4348</span><br><span class="line">4349</span><br><span class="line">4350</span><br><span class="line">4351</span><br><span class="line">4352</span><br><span class="line">4353</span><br><span class="line">4354</span><br><span class="line">4355</span><br><span class="line">4356</span><br><span class="line">4357</span><br><span class="line">4358</span><br><span class="line">4359</span><br><span class="line">4360</span><br><span class="line">4361</span><br><span class="line">4362</span><br><span class="line">4363</span><br><span class="line">4364</span><br><span class="line">4365</span><br><span class="line">4366</span><br><span class="line">4367</span><br><span class="line">4368</span><br><span class="line">4369</span><br><span class="line">4370</span><br><span class="line">4371</span><br><span class="line">4372</span><br><span class="line">4373</span><br><span class="line">4374</span><br><span class="line">4375</span><br><span class="line">4376</span><br><span class="line">4377</span><br><span class="line">4378</span><br><span class="line">4379</span><br><span class="line">4380</span><br><span class="line">4381</span><br><span class="line">4382</span><br><span class="line">4383</span><br><span class="line">4384</span><br><span class="line">4385</span><br><span class="line">4386</span><br><span class="line">4387</span><br><span class="line">4388</span><br><span class="line">4389</span><br><span class="line">4390</span><br><span class="line">4391</span><br><span class="line">4392</span><br><span class="line">4393</span><br><span class="line">4394</span><br><span class="line">4395</span><br><span class="line">4396</span><br><span class="line">4397</span><br><span class="line">4398</span><br><span class="line">4399</span><br><span class="line">4400</span><br><span class="line">4401</span><br><span class="line">4402</span><br><span class="line">4403</span><br><span class="line">4404</span><br><span class="line">4405</span><br><span class="line">4406</span><br><span class="line">4407</span><br><span class="line">4408</span><br><span class="line">4409</span><br><span class="line">4410</span><br><span class="line">4411</span><br><span class="line">4412</span><br><span class="line">4413</span><br><span class="line">4414</span><br><span class="line">4415</span><br><span class="line">4416</span><br><span class="line">4417</span><br><span class="line">4418</span><br><span class="line">4419</span><br><span class="line">4420</span><br><span class="line">4421</span><br><span class="line">4422</span><br><span class="line">4423</span><br><span class="line">4424</span><br><span class="line">4425</span><br><span class="line">4426</span><br><span class="line">4427</span><br><span class="line">4428</span><br><span class="line">4429</span><br><span class="line">4430</span><br><span class="line">4431</span><br><span class="line">4432</span><br><span class="line">4433</span><br><span class="line">4434</span><br><span class="line">4435</span><br><span class="line">4436</span><br><span class="line">4437</span><br><span class="line">4438</span><br><span class="line">4439</span><br><span class="line">4440</span><br><span class="line">4441</span><br><span class="line">4442</span><br><span class="line">4443</span><br><span class="line">4444</span><br><span class="line">4445</span><br><span class="line">4446</span><br><span class="line">4447</span><br><span class="line">4448</span><br><span class="line">4449</span><br><span class="line">4450</span><br><span class="line">4451</span><br><span class="line">4452</span><br><span class="line">4453</span><br><span class="line">4454</span><br><span class="line">4455</span><br><span class="line">4456</span><br><span class="line">4457</span><br><span class="line">4458</span><br><span class="line">4459</span><br><span class="line">4460</span><br><span class="line">4461</span><br><span class="line">4462</span><br><span class="line">4463</span><br><span class="line">4464</span><br><span class="line">4465</span><br><span class="line">4466</span><br><span class="line">4467</span><br><span class="line">4468</span><br><span class="line">4469</span><br><span class="line">4470</span><br><span class="line">4471</span><br><span class="line">4472</span><br><span class="line">4473</span><br><span class="line">4474</span><br><span class="line">4475</span><br><span class="line">4476</span><br><span class="line">4477</span><br><span class="line">4478</span><br><span class="line">4479</span><br><span class="line">4480</span><br><span class="line">4481</span><br><span class="line">4482</span><br><span class="line">4483</span><br><span class="line">4484</span><br><span class="line">4485</span><br><span class="line">4486</span><br><span class="line">4487</span><br><span class="line">4488</span><br><span class="line">4489</span><br><span class="line">4490</span><br><span class="line">4491</span><br><span class="line">4492</span><br><span class="line">4493</span><br><span class="line">4494</span><br><span class="line">4495</span><br><span class="line">4496</span><br><span class="line">4497</span><br><span class="line">4498</span><br><span class="line">4499</span><br><span class="line">4500</span><br><span class="line">4501</span><br><span class="line">4502</span><br><span class="line">4503</span><br><span class="line">4504</span><br><span class="line">4505</span><br><span class="line">4506</span><br><span class="line">4507</span><br><span class="line">4508</span><br><span class="line">4509</span><br><span class="line">4510</span><br><span class="line">4511</span><br><span class="line">4512</span><br><span class="line">4513</span><br><span class="line">4514</span><br><span class="line">4515</span><br><span class="line">4516</span><br><span class="line">4517</span><br><span class="line">4518</span><br><span class="line">4519</span><br><span class="line">4520</span><br><span class="line">4521</span><br><span class="line">4522</span><br><span class="line">4523</span><br><span class="line">4524</span><br><span class="line">4525</span><br><span class="line">4526</span><br><span class="line">4527</span><br><span class="line">4528</span><br><span class="line">4529</span><br><span class="line">4530</span><br><span class="line">4531</span><br><span class="line">4532</span><br><span class="line">4533</span><br><span class="line">4534</span><br><span class="line">4535</span><br><span class="line">4536</span><br><span class="line">4537</span><br><span class="line">4538</span><br><span class="line">4539</span><br><span class="line">4540</span><br><span class="line">4541</span><br><span class="line">4542</span><br><span class="line">4543</span><br><span class="line">4544</span><br><span class="line">4545</span><br><span class="line">4546</span><br><span class="line">4547</span><br><span class="line">4548</span><br><span class="line">4549</span><br><span class="line">4550</span><br><span class="line">4551</span><br><span class="line">4552</span><br><span class="line">4553</span><br><span class="line">4554</span><br><span class="line">4555</span><br><span class="line">4556</span><br><span class="line">4557</span><br><span class="line">4558</span><br><span class="line">4559</span><br><span class="line">4560</span><br><span class="line">4561</span><br><span class="line">4562</span><br><span class="line">4563</span><br><span class="line">4564</span><br><span class="line">4565</span><br><span class="line">4566</span><br><span class="line">4567</span><br><span class="line">4568</span><br><span class="line">4569</span><br><span class="line">4570</span><br><span class="line">4571</span><br><span class="line">4572</span><br><span class="line">4573</span><br><span class="line">4574</span><br><span class="line">4575</span><br><span class="line">4576</span><br><span class="line">4577</span><br><span class="line">4578</span><br><span class="line">4579</span><br><span class="line">4580</span><br><span class="line">4581</span><br><span class="line">4582</span><br><span class="line">4583</span><br><span class="line">4584</span><br><span class="line">4585</span><br><span class="line">4586</span><br><span class="line">4587</span><br><span class="line">4588</span><br><span class="line">4589</span><br><span class="line">4590</span><br><span class="line">4591</span><br><span class="line">4592</span><br><span class="line">4593</span><br><span class="line">4594</span><br><span class="line">4595</span><br><span class="line">4596</span><br><span class="line">4597</span><br><span class="line">4598</span><br><span class="line">4599</span><br><span class="line">4600</span><br><span class="line">4601</span><br><span class="line">4602</span><br><span class="line">4603</span><br><span class="line">4604</span><br><span class="line">4605</span><br><span class="line">4606</span><br><span class="line">4607</span><br><span class="line">4608</span><br><span class="line">4609</span><br><span class="line">4610</span><br><span class="line">4611</span><br><span class="line">4612</span><br><span class="line">4613</span><br><span class="line">4614</span><br><span class="line">4615</span><br><span class="line">4616</span><br><span class="line">4617</span><br><span class="line">4618</span><br><span class="line">4619</span><br><span class="line">4620</span><br><span class="line">4621</span><br><span class="line">4622</span><br><span class="line">4623</span><br><span class="line">4624</span><br><span class="line">4625</span><br><span class="line">4626</span><br><span class="line">4627</span><br><span class="line">4628</span><br><span class="line">4629</span><br><span class="line">4630</span><br><span class="line">4631</span><br><span class="line">4632</span><br><span class="line">4633</span><br><span class="line">4634</span><br><span class="line">4635</span><br><span class="line">4636</span><br><span class="line">4637</span><br><span class="line">4638</span><br><span class="line">4639</span><br><span class="line">4640</span><br><span class="line">4641</span><br><span class="line">4642</span><br><span class="line">4643</span><br><span class="line">4644</span><br><span class="line">4645</span><br><span class="line">4646</span><br><span class="line">4647</span><br><span class="line">4648</span><br><span class="line">4649</span><br><span class="line">4650</span><br><span class="line">4651</span><br><span class="line">4652</span><br><span class="line">4653</span><br><span class="line">4654</span><br><span class="line">4655</span><br><span class="line">4656</span><br><span class="line">4657</span><br><span class="line">4658</span><br><span class="line">4659</span><br><span class="line">4660</span><br><span class="line">4661</span><br><span class="line">4662</span><br><span class="line">4663</span><br><span class="line">4664</span><br><span class="line">4665</span><br><span class="line">4666</span><br><span class="line">4667</span><br><span class="line">4668</span><br><span class="line">4669</span><br><span class="line">4670</span><br><span class="line">4671</span><br><span class="line">4672</span><br><span class="line">4673</span><br><span class="line">4674</span><br><span class="line">4675</span><br><span class="line">4676</span><br><span class="line">4677</span><br><span class="line">4678</span><br><span class="line">4679</span><br><span class="line">4680</span><br><span class="line">4681</span><br><span class="line">4682</span><br><span class="line">4683</span><br><span class="line">4684</span><br><span class="line">4685</span><br><span class="line">4686</span><br><span class="line">4687</span><br><span class="line">4688</span><br><span class="line">4689</span><br><span class="line">4690</span><br><span class="line">4691</span><br><span class="line">4692</span><br><span class="line">4693</span><br><span class="line">4694</span><br><span class="line">4695</span><br><span class="line">4696</span><br><span class="line">4697</span><br><span class="line">4698</span><br><span class="line">4699</span><br><span class="line">4700</span><br><span class="line">4701</span><br><span class="line">4702</span><br><span class="line">4703</span><br><span class="line">4704</span><br><span class="line">4705</span><br><span class="line">4706</span><br><span class="line">4707</span><br><span class="line">4708</span><br><span class="line">4709</span><br><span class="line">4710</span><br><span class="line">4711</span><br><span class="line">4712</span><br><span class="line">4713</span><br><span class="line">4714</span><br><span class="line">4715</span><br><span class="line">4716</span><br><span class="line">4717</span><br><span class="line">4718</span><br><span class="line">4719</span><br><span class="line">4720</span><br><span class="line">4721</span><br><span class="line">4722</span><br><span class="line">4723</span><br><span class="line">4724</span><br><span class="line">4725</span><br><span class="line">4726</span><br><span class="line">4727</span><br><span class="line">4728</span><br><span class="line">4729</span><br><span class="line">4730</span><br><span class="line">4731</span><br><span class="line">4732</span><br><span class="line">4733</span><br><span class="line">4734</span><br><span class="line">4735</span><br><span class="line">4736</span><br><span class="line">4737</span><br><span class="line">4738</span><br><span class="line">4739</span><br><span class="line">4740</span><br><span class="line">4741</span><br><span class="line">4742</span><br><span class="line">4743</span><br><span class="line">4744</span><br><span class="line">4745</span><br><span class="line">4746</span><br><span class="line">4747</span><br><span class="line">4748</span><br><span class="line">4749</span><br><span class="line">4750</span><br><span class="line">4751</span><br><span class="line">4752</span><br><span class="line">4753</span><br><span class="line">4754</span><br><span class="line">4755</span><br><span class="line">4756</span><br><span class="line">4757</span><br><span class="line">4758</span><br><span class="line">4759</span><br><span class="line">4760</span><br><span class="line">4761</span><br><span class="line">4762</span><br><span class="line">4763</span><br><span class="line">4764</span><br><span class="line">4765</span><br><span class="line">4766</span><br><span class="line">4767</span><br><span class="line">4768</span><br><span class="line">4769</span><br><span class="line">4770</span><br><span class="line">4771</span><br><span class="line">4772</span><br><span class="line">4773</span><br><span class="line">4774</span><br><span class="line">4775</span><br><span class="line">4776</span><br><span class="line">4777</span><br><span class="line">4778</span><br><span class="line">4779</span><br><span class="line">4780</span><br><span class="line">4781</span><br><span class="line">4782</span><br><span class="line">4783</span><br><span class="line">4784</span><br><span class="line">4785</span><br><span class="line">4786</span><br><span class="line">4787</span><br><span class="line">4788</span><br><span class="line">4789</span><br><span class="line">4790</span><br><span class="line">4791</span><br><span class="line">4792</span><br><span class="line">4793</span><br><span class="line">4794</span><br><span class="line">4795</span><br><span class="line">4796</span><br><span class="line">4797</span><br><span class="line">4798</span><br><span class="line">4799</span><br><span class="line">4800</span><br><span class="line">4801</span><br><span class="line">4802</span><br><span class="line">4803</span><br><span class="line">4804</span><br><span class="line">4805</span><br><span class="line">4806</span><br><span class="line">4807</span><br><span class="line">4808</span><br><span class="line">4809</span><br><span class="line">4810</span><br><span class="line">4811</span><br><span class="line">4812</span><br><span class="line">4813</span><br><span class="line">4814</span><br><span class="line">4815</span><br><span class="line">4816</span><br><span class="line">4817</span><br><span class="line">4818</span><br><span class="line">4819</span><br><span class="line">4820</span><br><span class="line">4821</span><br><span class="line">4822</span><br><span class="line">4823</span><br><span class="line">4824</span><br><span class="line">4825</span><br><span class="line">4826</span><br><span class="line">4827</span><br><span class="line">4828</span><br><span class="line">4829</span><br><span class="line">4830</span><br><span class="line">4831</span><br><span class="line">4832</span><br><span class="line">4833</span><br><span class="line">4834</span><br><span class="line">4835</span><br><span class="line">4836</span><br><span class="line">4837</span><br><span class="line">4838</span><br><span class="line">4839</span><br><span class="line">4840</span><br><span class="line">4841</span><br><span class="line">4842</span><br><span class="line">4843</span><br><span class="line">4844</span><br><span class="line">4845</span><br><span class="line">4846</span><br><span class="line">4847</span><br><span class="line">4848</span><br><span class="line">4849</span><br><span class="line">4850</span><br><span class="line">4851</span><br><span class="line">4852</span><br><span class="line">4853</span><br><span class="line">4854</span><br><span class="line">4855</span><br><span class="line">4856</span><br><span class="line">4857</span><br><span class="line">4858</span><br><span class="line">4859</span><br><span class="line">4860</span><br><span class="line">4861</span><br><span class="line">4862</span><br><span class="line">4863</span><br><span class="line">4864</span><br><span class="line">4865</span><br><span class="line">4866</span><br><span class="line">4867</span><br><span class="line">4868</span><br><span class="line">4869</span><br><span class="line">4870</span><br><span class="line">4871</span><br><span class="line">4872</span><br><span class="line">4873</span><br><span class="line">4874</span><br><span class="line">4875</span><br><span class="line">4876</span><br><span class="line">4877</span><br><span class="line">4878</span><br><span class="line">4879</span><br><span class="line">4880</span><br><span class="line">4881</span><br><span class="line">4882</span><br><span class="line">4883</span><br><span class="line">4884</span><br><span class="line">4885</span><br><span class="line">4886</span><br><span class="line">4887</span><br><span class="line">4888</span><br><span class="line">4889</span><br><span class="line">4890</span><br><span class="line">4891</span><br><span class="line">4892</span><br><span class="line">4893</span><br><span class="line">4894</span><br><span class="line">4895</span><br><span class="line">4896</span><br><span class="line">4897</span><br><span class="line">4898</span><br><span class="line">4899</span><br><span class="line">4900</span><br><span class="line">4901</span><br><span class="line">4902</span><br><span class="line">4903</span><br><span class="line">4904</span><br><span class="line">4905</span><br><span class="line">4906</span><br><span class="line">4907</span><br><span class="line">4908</span><br><span class="line">4909</span><br><span class="line">4910</span><br><span class="line">4911</span><br><span class="line">4912</span><br><span class="line">4913</span><br><span class="line">4914</span><br><span class="line">4915</span><br><span class="line">4916</span><br><span class="line">4917</span><br><span class="line">4918</span><br><span class="line">4919</span><br><span class="line">4920</span><br><span class="line">4921</span><br><span class="line">4922</span><br><span class="line">4923</span><br><span class="line">4924</span><br><span class="line">4925</span><br><span class="line">4926</span><br><span class="line">4927</span><br><span class="line">4928</span><br><span class="line">4929</span><br><span class="line">4930</span><br><span class="line">4931</span><br><span class="line">4932</span><br><span class="line">4933</span><br><span class="line">4934</span><br><span class="line">4935</span><br><span class="line">4936</span><br><span class="line">4937</span><br><span class="line">4938</span><br><span class="line">4939</span><br><span class="line">4940</span><br><span class="line">4941</span><br><span class="line">4942</span><br><span class="line">4943</span><br><span class="line">4944</span><br><span class="line">4945</span><br><span class="line">4946</span><br><span class="line">4947</span><br><span class="line">4948</span><br><span class="line">4949</span><br><span class="line">4950</span><br><span class="line">4951</span><br><span class="line">4952</span><br><span class="line">4953</span><br><span class="line">4954</span><br><span class="line">4955</span><br><span class="line">4956</span><br><span class="line">4957</span><br><span class="line">4958</span><br><span class="line">4959</span><br><span class="line">4960</span><br><span class="line">4961</span><br><span class="line">4962</span><br><span class="line">4963</span><br><span class="line">4964</span><br><span class="line">4965</span><br><span class="line">4966</span><br><span class="line">4967</span><br><span class="line">4968</span><br><span class="line">4969</span><br><span class="line">4970</span><br><span class="line">4971</span><br><span class="line">4972</span><br><span class="line">4973</span><br><span class="line">4974</span><br><span class="line">4975</span><br><span class="line">4976</span><br><span class="line">4977</span><br><span class="line">4978</span><br><span class="line">4979</span><br><span class="line">4980</span><br><span class="line">4981</span><br><span class="line">4982</span><br><span class="line">4983</span><br><span class="line">4984</span><br><span class="line">4985</span><br><span class="line">4986</span><br><span class="line">4987</span><br><span class="line">4988</span><br><span class="line">4989</span><br><span class="line">4990</span><br><span class="line">4991</span><br><span class="line">4992</span><br><span class="line">4993</span><br><span class="line">4994</span><br><span class="line">4995</span><br><span class="line">4996</span><br><span class="line">4997</span><br><span class="line">4998</span><br><span class="line">4999</span><br><span class="line">5000</span><br><span class="line">5001</span><br><span class="line">5002</span><br><span class="line">5003</span><br><span class="line">5004</span><br><span class="line">5005</span><br><span class="line">5006</span><br><span class="line">5007</span><br><span class="line">5008</span><br><span class="line">5009</span><br><span class="line">5010</span><br><span class="line">5011</span><br><span class="line">5012</span><br><span class="line">5013</span><br><span class="line">5014</span><br><span class="line">5015</span><br><span class="line">5016</span><br><span class="line">5017</span><br><span class="line">5018</span><br><span class="line">5019</span><br><span class="line">5020</span><br><span class="line">5021</span><br><span class="line">5022</span><br><span class="line">5023</span><br><span class="line">5024</span><br><span class="line">5025</span><br><span class="line">5026</span><br><span class="line">5027</span><br><span class="line">5028</span><br><span class="line">5029</span><br><span class="line">5030</span><br><span class="line">5031</span><br><span class="line">5032</span><br><span class="line">5033</span><br><span class="line">5034</span><br><span class="line">5035</span><br><span class="line">5036</span><br><span class="line">5037</span><br><span class="line">5038</span><br><span class="line">5039</span><br><span class="line">5040</span><br><span class="line">5041</span><br><span class="line">5042</span><br><span class="line">5043</span><br><span class="line">5044</span><br><span class="line">5045</span><br><span class="line">5046</span><br><span class="line">5047</span><br><span class="line">5048</span><br><span class="line">5049</span><br><span class="line">5050</span><br><span class="line">5051</span><br><span class="line">5052</span><br><span class="line">5053</span><br><span class="line">5054</span><br><span class="line">5055</span><br><span class="line">5056</span><br><span class="line">5057</span><br><span class="line">5058</span><br><span class="line">5059</span><br><span class="line">5060</span><br><span class="line">5061</span><br><span class="line">5062</span><br><span class="line">5063</span><br><span class="line">5064</span><br><span class="line">5065</span><br><span class="line">5066</span><br><span class="line">5067</span><br><span class="line">5068</span><br><span class="line">5069</span><br><span class="line">5070</span><br><span class="line">5071</span><br><span class="line">5072</span><br><span class="line">5073</span><br><span class="line">5074</span><br><span class="line">5075</span><br><span class="line">5076</span><br><span class="line">5077</span><br><span class="line">5078</span><br><span class="line">5079</span><br><span class="line">5080</span><br><span class="line">5081</span><br><span class="line">5082</span><br><span class="line">5083</span><br><span class="line">5084</span><br><span class="line">5085</span><br><span class="line">5086</span><br><span class="line">5087</span><br><span class="line">5088</span><br><span class="line">5089</span><br><span class="line">5090</span><br><span class="line">5091</span><br><span class="line">5092</span><br><span class="line">5093</span><br><span class="line">5094</span><br><span class="line">5095</span><br><span class="line">5096</span><br><span class="line">5097</span><br><span class="line">5098</span><br><span class="line">5099</span><br><span class="line">5100</span><br><span class="line">5101</span><br><span class="line">5102</span><br><span class="line">5103</span><br><span class="line">5104</span><br><span class="line">5105</span><br><span class="line">5106</span><br><span class="line">5107</span><br><span class="line">5108</span><br><span class="line">5109</span><br><span class="line">5110</span><br><span class="line">5111</span><br><span class="line">5112</span><br><span class="line">5113</span><br><span class="line">5114</span><br><span class="line">5115</span><br><span class="line">5116</span><br><span class="line">5117</span><br><span class="line">5118</span><br><span class="line">5119</span><br><span class="line">5120</span><br><span class="line">5121</span><br><span class="line">5122</span><br><span class="line">5123</span><br><span class="line">5124</span><br><span class="line">5125</span><br><span class="line">5126</span><br><span class="line">5127</span><br><span class="line">5128</span><br><span class="line">5129</span><br><span class="line">5130</span><br><span class="line">5131</span><br><span class="line">5132</span><br><span class="line">5133</span><br><span class="line">5134</span><br><span class="line">5135</span><br><span class="line">5136</span><br><span class="line">5137</span><br><span class="line">5138</span><br><span class="line">5139</span><br><span class="line">5140</span><br><span class="line">5141</span><br><span class="line">5142</span><br><span class="line">5143</span><br><span class="line">5144</span><br><span class="line">5145</span><br><span class="line">5146</span><br><span class="line">5147</span><br><span class="line">5148</span><br><span class="line">5149</span><br><span class="line">5150</span><br><span class="line">5151</span><br><span class="line">5152</span><br><span class="line">5153</span><br><span class="line">5154</span><br><span class="line">5155</span><br><span class="line">5156</span><br><span class="line">5157</span><br><span class="line">5158</span><br><span class="line">5159</span><br><span class="line">5160</span><br><span class="line">5161</span><br><span class="line">5162</span><br><span class="line">5163</span><br><span class="line">5164</span><br><span class="line">5165</span><br><span class="line">5166</span><br><span class="line">5167</span><br><span class="line">5168</span><br><span class="line">5169</span><br><span class="line">5170</span><br><span class="line">5171</span><br><span class="line">5172</span><br><span class="line">5173</span><br><span class="line">5174</span><br><span class="line">5175</span><br><span class="line">5176</span><br><span class="line">5177</span><br><span class="line">5178</span><br><span class="line">5179</span><br><span class="line">5180</span><br><span class="line">5181</span><br><span class="line">5182</span><br><span class="line">5183</span><br><span class="line">5184</span><br><span class="line">5185</span><br><span class="line">5186</span><br><span class="line">5187</span><br><span class="line">5188</span><br><span class="line">5189</span><br><span class="line">5190</span><br><span class="line">5191</span><br><span class="line">5192</span><br><span class="line">5193</span><br><span class="line">5194</span><br><span class="line">5195</span><br><span class="line">5196</span><br><span class="line">5197</span><br><span class="line">5198</span><br><span class="line">5199</span><br><span class="line">5200</span><br><span class="line">5201</span><br><span class="line">5202</span><br><span class="line">5203</span><br><span class="line">5204</span><br><span class="line">5205</span><br><span class="line">5206</span><br><span class="line">5207</span><br><span class="line">5208</span><br><span class="line">5209</span><br><span class="line">5210</span><br><span class="line">5211</span><br><span class="line">5212</span><br><span class="line">5213</span><br><span class="line">5214</span><br><span class="line">5215</span><br><span class="line">5216</span><br><span class="line">5217</span><br><span class="line">5218</span><br><span class="line">5219</span><br><span class="line">5220</span><br><span class="line">5221</span><br><span class="line">5222</span><br><span class="line">5223</span><br><span class="line">5224</span><br><span class="line">5225</span><br><span class="line">5226</span><br><span class="line">5227</span><br><span class="line">5228</span><br><span class="line">5229</span><br><span class="line">5230</span><br><span class="line">5231</span><br><span class="line">5232</span><br><span class="line">5233</span><br><span class="line">5234</span><br><span class="line">5235</span><br><span class="line">5236</span><br><span class="line">5237</span><br><span class="line">5238</span><br><span class="line">5239</span><br><span class="line">5240</span><br><span class="line">5241</span><br><span class="line">5242</span><br><span class="line">5243</span><br><span class="line">5244</span><br><span class="line">5245</span><br><span class="line">5246</span><br><span class="line">5247</span><br><span class="line">5248</span><br><span class="line">5249</span><br><span class="line">5250</span><br><span class="line">5251</span><br><span class="line">5252</span><br><span class="line">5253</span><br><span class="line">5254</span><br><span class="line">5255</span><br><span class="line">5256</span><br><span class="line">5257</span><br><span class="line">5258</span><br><span class="line">5259</span><br><span class="line">5260</span><br><span class="line">5261</span><br><span class="line">5262</span><br><span class="line">5263</span><br><span class="line">5264</span><br><span class="line">5265</span><br><span class="line">5266</span><br><span class="line">5267</span><br><span class="line">5268</span><br><span class="line">5269</span><br><span class="line">5270</span><br><span class="line">5271</span><br><span class="line">5272</span><br><span class="line">5273</span><br><span class="line">5274</span><br><span class="line">5275</span><br><span class="line">5276</span><br><span class="line">5277</span><br><span class="line">5278</span><br><span class="line">5279</span><br><span class="line">5280</span><br><span class="line">5281</span><br><span class="line">5282</span><br><span class="line">5283</span><br><span class="line">5284</span><br><span class="line">5285</span><br><span class="line">5286</span><br><span class="line">5287</span><br><span class="line">5288</span><br><span class="line">5289</span><br><span class="line">5290</span><br><span class="line">5291</span><br><span class="line">5292</span><br><span class="line">5293</span><br><span class="line">5294</span><br><span class="line">5295</span><br><span class="line">5296</span><br><span class="line">5297</span><br><span class="line">5298</span><br><span class="line">5299</span><br><span class="line">5300</span><br><span class="line">5301</span><br><span class="line">5302</span><br><span class="line">5303</span><br><span class="line">5304</span><br><span class="line">5305</span><br><span class="line">5306</span><br><span class="line">5307</span><br><span class="line">5308</span><br><span class="line">5309</span><br><span class="line">5310</span><br><span class="line">5311</span><br><span class="line">5312</span><br><span class="line">5313</span><br><span class="line">5314</span><br><span class="line">5315</span><br><span class="line">5316</span><br><span class="line">5317</span><br><span class="line">5318</span><br><span class="line">5319</span><br><span class="line">5320</span><br><span class="line">5321</span><br><span class="line">5322</span><br><span class="line">5323</span><br><span class="line">5324</span><br><span class="line">5325</span><br><span class="line">5326</span><br><span class="line">5327</span><br><span class="line">5328</span><br><span class="line">5329</span><br><span class="line">5330</span><br><span class="line">5331</span><br><span class="line">5332</span><br><span class="line">5333</span><br><span class="line">5334</span><br><span class="line">5335</span><br><span class="line">5336</span><br><span class="line">5337</span><br><span class="line">5338</span><br><span class="line">5339</span><br><span class="line">5340</span><br><span class="line">5341</span><br><span class="line">5342</span><br><span class="line">5343</span><br><span class="line">5344</span><br><span class="line">5345</span><br><span class="line">5346</span><br><span class="line">5347</span><br><span class="line">5348</span><br><span class="line">5349</span><br><span class="line">5350</span><br><span class="line">5351</span><br><span class="line">5352</span><br><span class="line">5353</span><br><span class="line">5354</span><br><span class="line">5355</span><br><span class="line">5356</span><br><span class="line">5357</span><br><span class="line">5358</span><br><span class="line">5359</span><br><span class="line">5360</span><br><span class="line">5361</span><br><span class="line">5362</span><br><span class="line">5363</span><br><span class="line">5364</span><br><span class="line">5365</span><br><span class="line">5366</span><br><span class="line">5367</span><br><span class="line">5368</span><br><span class="line">5369</span><br><span class="line">5370</span><br><span class="line">5371</span><br><span class="line">5372</span><br><span class="line">5373</span><br><span class="line">5374</span><br><span class="line">5375</span><br><span class="line">5376</span><br><span class="line">5377</span><br><span class="line">5378</span><br><span class="line">5379</span><br><span class="line">5380</span><br><span class="line">5381</span><br><span class="line">5382</span><br><span class="line">5383</span><br><span class="line">5384</span><br><span class="line">5385</span><br><span class="line">5386</span><br><span class="line">5387</span><br><span class="line">5388</span><br><span class="line">5389</span><br><span class="line">5390</span><br><span class="line">5391</span><br><span class="line">5392</span><br><span class="line">5393</span><br><span class="line">5394</span><br><span class="line">5395</span><br><span class="line">5396</span><br><span class="line">5397</span><br><span class="line">5398</span><br><span class="line">5399</span><br><span class="line">5400</span><br><span class="line">5401</span><br><span class="line">5402</span><br><span class="line">5403</span><br><span class="line">5404</span><br><span class="line">5405</span><br><span class="line">5406</span><br><span class="line">5407</span><br><span class="line">5408</span><br><span class="line">5409</span><br><span class="line">5410</span><br><span class="line">5411</span><br><span class="line">5412</span><br><span class="line">5413</span><br><span class="line">5414</span><br><span class="line">5415</span><br><span class="line">5416</span><br><span class="line">5417</span><br><span class="line">5418</span><br><span class="line">5419</span><br><span class="line">5420</span><br><span class="line">5421</span><br><span class="line">5422</span><br><span class="line">5423</span><br><span class="line">5424</span><br><span class="line">5425</span><br><span class="line">5426</span><br><span class="line">5427</span><br><span class="line">5428</span><br><span class="line">5429</span><br><span class="line">5430</span><br><span class="line">5431</span><br><span class="line">5432</span><br><span class="line">5433</span><br><span class="line">5434</span><br><span class="line">5435</span><br><span class="line">5436</span><br><span class="line">5437</span><br><span class="line">5438</span><br><span class="line">5439</span><br><span class="line">5440</span><br><span class="line">5441</span><br><span class="line">5442</span><br><span class="line">5443</span><br><span class="line">5444</span><br><span class="line">5445</span><br><span class="line">5446</span><br><span class="line">5447</span><br><span class="line">5448</span><br><span class="line">5449</span><br><span class="line">5450</span><br><span class="line">5451</span><br><span class="line">5452</span><br><span class="line">5453</span><br><span class="line">5454</span><br><span class="line">5455</span><br><span class="line">5456</span><br><span class="line">5457</span><br><span class="line">5458</span><br><span class="line">5459</span><br><span class="line">5460</span><br><span class="line">5461</span><br><span class="line">5462</span><br><span class="line">5463</span><br><span class="line">5464</span><br><span class="line">5465</span><br><span class="line">5466</span><br><span class="line">5467</span><br><span class="line">5468</span><br><span class="line">5469</span><br><span class="line">5470</span><br><span class="line">5471</span><br><span class="line">5472</span><br><span class="line">5473</span><br><span class="line">5474</span><br><span class="line">5475</span><br><span class="line">5476</span><br><span class="line">5477</span><br><span class="line">5478</span><br><span class="line">5479</span><br><span class="line">5480</span><br><span class="line">5481</span><br><span class="line">5482</span><br><span class="line">5483</span><br><span class="line">5484</span><br><span class="line">5485</span><br><span class="line">5486</span><br><span class="line">5487</span><br><span class="line">5488</span><br><span class="line">5489</span><br><span class="line">5490</span><br><span class="line">5491</span><br><span class="line">5492</span><br><span class="line">5493</span><br><span class="line">5494</span><br><span class="line">5495</span><br><span class="line">5496</span><br><span class="line">5497</span><br><span class="line">5498</span><br><span class="line">5499</span><br><span class="line">5500</span><br><span class="line">5501</span><br><span class="line">5502</span><br><span class="line">5503</span><br><span class="line">5504</span><br><span class="line">5505</span><br><span class="line">5506</span><br><span class="line">5507</span><br><span class="line">5508</span><br><span class="line">5509</span><br><span class="line">5510</span><br><span class="line">5511</span><br><span class="line">5512</span><br><span class="line">5513</span><br><span class="line">5514</span><br><span class="line">5515</span><br><span class="line">5516</span><br><span class="line">5517</span><br><span class="line">5518</span><br><span class="line">5519</span><br><span class="line">5520</span><br><span class="line">5521</span><br><span class="line">5522</span><br><span class="line">5523</span><br><span class="line">5524</span><br><span class="line">5525</span><br><span class="line">5526</span><br><span class="line">5527</span><br><span class="line">5528</span><br><span class="line">5529</span><br><span class="line">5530</span><br><span class="line">5531</span><br><span class="line">5532</span><br><span class="line">5533</span><br><span class="line">5534</span><br><span class="line">5535</span><br><span class="line">5536</span><br><span class="line">5537</span><br><span class="line">5538</span><br><span class="line">5539</span><br><span class="line">5540</span><br><span class="line">5541</span><br><span class="line">5542</span><br><span class="line">5543</span><br><span class="line">5544</span><br><span class="line">5545</span><br><span class="line">5546</span><br><span class="line">5547</span><br><span class="line">5548</span><br><span class="line">5549</span><br><span class="line">5550</span><br><span class="line">5551</span><br><span class="line">5552</span><br><span class="line">5553</span><br><span class="line">5554</span><br><span class="line">5555</span><br><span class="line">5556</span><br><span class="line">5557</span><br><span class="line">5558</span><br><span class="line">5559</span><br><span class="line">5560</span><br><span class="line">5561</span><br><span class="line">5562</span><br><span class="line">5563</span><br><span class="line">5564</span><br><span class="line">5565</span><br><span class="line">5566</span><br><span class="line">5567</span><br><span class="line">5568</span><br><span class="line">5569</span><br><span class="line">5570</span><br><span class="line">5571</span><br><span class="line">5572</span><br><span class="line">5573</span><br><span class="line">5574</span><br><span class="line">5575</span><br><span class="line">5576</span><br><span class="line">5577</span><br><span class="line">5578</span><br><span class="line">5579</span><br><span class="line">5580</span><br><span class="line">5581</span><br><span class="line">5582</span><br><span class="line">5583</span><br><span class="line">5584</span><br><span class="line">5585</span><br><span class="line">5586</span><br><span class="line">5587</span><br><span class="line">5588</span><br><span class="line">5589</span><br><span class="line">5590</span><br><span class="line">5591</span><br><span class="line">5592</span><br><span class="line">5593</span><br><span class="line">5594</span><br><span class="line">5595</span><br><span class="line">5596</span><br><span class="line">5597</span><br><span class="line">5598</span><br><span class="line">5599</span><br><span class="line">5600</span><br><span class="line">5601</span><br><span class="line">5602</span><br><span class="line">5603</span><br><span class="line">5604</span><br><span class="line">5605</span><br><span class="line">5606</span><br><span class="line">5607</span><br><span class="line">5608</span><br><span class="line">5609</span><br><span class="line">5610</span><br><span class="line">5611</span><br><span class="line">5612</span><br><span class="line">5613</span><br><span class="line">5614</span><br><span class="line">5615</span><br><span class="line">5616</span><br><span class="line">5617</span><br><span class="line">5618</span><br><span class="line">5619</span><br><span class="line">5620</span><br><span class="line">5621</span><br><span class="line">5622</span><br><span class="line">5623</span><br><span class="line">5624</span><br><span class="line">5625</span><br><span class="line">5626</span><br><span class="line">5627</span><br><span class="line">5628</span><br><span class="line">5629</span><br><span class="line">5630</span><br><span class="line">5631</span><br><span class="line">5632</span><br><span class="line">5633</span><br><span class="line">5634</span><br><span class="line">5635</span><br><span class="line">5636</span><br><span class="line">5637</span><br><span class="line">5638</span><br><span class="line">5639</span><br><span class="line">5640</span><br><span class="line">5641</span><br><span class="line">5642</span><br><span class="line">5643</span><br><span class="line">5644</span><br><span class="line">5645</span><br><span class="line">5646</span><br><span class="line">5647</span><br><span class="line">5648</span><br><span class="line">5649</span><br><span class="line">5650</span><br><span class="line">5651</span><br><span class="line">5652</span><br><span class="line">5653</span><br><span class="line">5654</span><br><span class="line">5655</span><br><span class="line">5656</span><br><span class="line">5657</span><br><span class="line">5658</span><br><span class="line">5659</span><br><span class="line">5660</span><br><span class="line">5661</span><br><span class="line">5662</span><br><span class="line">5663</span><br><span class="line">5664</span><br><span class="line">5665</span><br><span class="line">5666</span><br><span class="line">5667</span><br><span class="line">5668</span><br><span class="line">5669</span><br><span class="line">5670</span><br><span class="line">5671</span><br><span class="line">5672</span><br><span class="line">5673</span><br><span class="line">5674</span><br><span class="line">5675</span><br><span class="line">5676</span><br><span class="line">5677</span><br><span class="line">5678</span><br><span class="line">5679</span><br><span class="line">5680</span><br><span class="line">5681</span><br><span class="line">5682</span><br><span class="line">5683</span><br><span class="line">5684</span><br><span class="line">5685</span><br><span class="line">5686</span><br><span class="line">5687</span><br><span class="line">5688</span><br><span class="line">5689</span><br><span class="line">5690</span><br><span class="line">5691</span><br><span class="line">5692</span><br><span class="line">5693</span><br><span class="line">5694</span><br><span class="line">5695</span><br><span class="line">5696</span><br><span class="line">5697</span><br><span class="line">5698</span><br><span class="line">5699</span><br><span class="line">5700</span><br><span class="line">5701</span><br><span class="line">5702</span><br><span class="line">5703</span><br><span class="line">5704</span><br><span class="line">5705</span><br><span class="line">5706</span><br><span class="line">5707</span><br><span class="line">5708</span><br><span class="line">5709</span><br><span class="line">5710</span><br><span class="line">5711</span><br><span class="line">5712</span><br><span class="line">5713</span><br><span class="line">5714</span><br><span class="line">5715</span><br><span class="line">5716</span><br><span class="line">5717</span><br><span class="line">5718</span><br><span class="line">5719</span><br><span class="line">5720</span><br><span class="line">5721</span><br><span class="line">5722</span><br><span class="line">5723</span><br><span class="line">5724</span><br><span class="line">5725</span><br><span class="line">5726</span><br><span class="line">5727</span><br><span class="line">5728</span><br><span class="line">5729</span><br><span class="line">5730</span><br><span class="line">5731</span><br><span class="line">5732</span><br><span class="line">5733</span><br><span class="line">5734</span><br><span class="line">5735</span><br><span class="line">5736</span><br><span class="line">5737</span><br><span class="line">5738</span><br><span class="line">5739</span><br><span class="line">5740</span><br><span class="line">5741</span><br><span class="line">5742</span><br><span class="line">5743</span><br><span class="line">5744</span><br><span class="line">5745</span><br><span class="line">5746</span><br><span class="line">5747</span><br><span class="line">5748</span><br><span class="line">5749</span><br><span class="line">5750</span><br><span class="line">5751</span><br><span class="line">5752</span><br><span class="line">5753</span><br><span class="line">5754</span><br><span class="line">5755</span><br><span class="line">5756</span><br><span class="line">5757</span><br><span class="line">5758</span><br><span class="line">5759</span><br><span class="line">5760</span><br><span class="line">5761</span><br><span class="line">5762</span><br><span class="line">5763</span><br><span class="line">5764</span><br><span class="line">5765</span><br><span class="line">5766</span><br><span class="line">5767</span><br><span class="line">5768</span><br><span class="line">5769</span><br><span class="line">5770</span><br><span class="line">5771</span><br><span class="line">5772</span><br><span class="line">5773</span><br><span class="line">5774</span><br><span class="line">5775</span><br><span class="line">5776</span><br><span class="line">5777</span><br><span class="line">5778</span><br><span class="line">5779</span><br><span class="line">5780</span><br><span class="line">5781</span><br><span class="line">5782</span><br><span class="line">5783</span><br><span class="line">5784</span><br><span class="line">5785</span><br><span class="line">5786</span><br><span class="line">5787</span><br><span class="line">5788</span><br><span class="line">5789</span><br><span class="line">5790</span><br><span class="line">5791</span><br><span class="line">5792</span><br><span class="line">5793</span><br><span class="line">5794</span><br><span class="line">5795</span><br><span class="line">5796</span><br><span class="line">5797</span><br><span class="line">5798</span><br><span class="line">5799</span><br><span class="line">5800</span><br><span class="line">5801</span><br><span class="line">5802</span><br><span class="line">5803</span><br><span class="line">5804</span><br><span class="line">5805</span><br><span class="line">5806</span><br><span class="line">5807</span><br><span class="line">5808</span><br><span class="line">5809</span><br><span class="line">5810</span><br><span class="line">5811</span><br><span class="line">5812</span><br><span class="line">5813</span><br><span class="line">5814</span><br><span class="line">5815</span><br><span class="line">5816</span><br><span class="line">5817</span><br><span class="line">5818</span><br><span class="line">5819</span><br><span class="line">5820</span><br><span class="line">5821</span><br><span class="line">5822</span><br><span class="line">5823</span><br><span class="line">5824</span><br><span class="line">5825</span><br><span class="line">5826</span><br><span class="line">5827</span><br><span class="line">5828</span><br><span class="line">5829</span><br><span class="line">5830</span><br><span class="line">5831</span><br><span class="line">5832</span><br><span class="line">5833</span><br><span class="line">5834</span><br><span class="line">5835</span><br><span class="line">5836</span><br><span class="line">5837</span><br><span class="line">5838</span><br><span class="line">5839</span><br><span class="line">5840</span><br><span class="line">5841</span><br><span class="line">5842</span><br><span class="line">5843</span><br><span class="line">5844</span><br><span class="line">5845</span><br><span class="line">5846</span><br><span class="line">5847</span><br><span class="line">5848</span><br><span class="line">5849</span><br><span class="line">5850</span><br><span class="line">5851</span><br><span class="line">5852</span><br><span class="line">5853</span><br><span class="line">5854</span><br><span class="line">5855</span><br><span class="line">5856</span><br><span class="line">5857</span><br><span class="line">5858</span><br><span class="line">5859</span><br><span class="line">5860</span><br><span class="line">5861</span><br><span class="line">5862</span><br><span class="line">5863</span><br><span class="line">5864</span><br><span class="line">5865</span><br><span class="line">5866</span><br><span class="line">5867</span><br><span class="line">5868</span><br><span class="line">5869</span><br><span class="line">5870</span><br><span class="line">5871</span><br><span class="line">5872</span><br><span class="line">5873</span><br><span class="line">5874</span><br><span class="line">5875</span><br><span class="line">5876</span><br><span class="line">5877</span><br><span class="line">5878</span><br><span class="line">5879</span><br><span class="line">5880</span><br><span class="line">5881</span><br><span class="line">5882</span><br><span class="line">5883</span><br><span class="line">5884</span><br><span class="line">5885</span><br><span class="line">5886</span><br><span class="line">5887</span><br><span class="line">5888</span><br><span class="line">5889</span><br><span class="line">5890</span><br><span class="line">5891</span><br><span class="line">5892</span><br><span class="line">5893</span><br><span class="line">5894</span><br><span class="line">5895</span><br><span class="line">5896</span><br><span class="line">5897</span><br><span class="line">5898</span><br><span class="line">5899</span><br><span class="line">5900</span><br><span class="line">5901</span><br><span class="line">5902</span><br><span class="line">5903</span><br><span class="line">5904</span><br><span class="line">5905</span><br><span class="line">5906</span><br><span class="line">5907</span><br><span class="line">5908</span><br><span class="line">5909</span><br><span class="line">5910</span><br><span class="line">5911</span><br><span class="line">5912</span><br><span class="line">5913</span><br><span class="line">5914</span><br><span class="line">5915</span><br><span class="line">5916</span><br><span class="line">5917</span><br><span class="line">5918</span><br><span class="line">5919</span><br><span class="line">5920</span><br><span class="line">5921</span><br><span class="line">5922</span><br><span class="line">5923</span><br><span class="line">5924</span><br><span class="line">5925</span><br><span class="line">5926</span><br><span class="line">5927</span><br><span class="line">5928</span><br><span class="line">5929</span><br><span class="line">5930</span><br><span class="line">5931</span><br><span class="line">5932</span><br><span class="line">5933</span><br><span class="line">5934</span><br><span class="line">5935</span><br><span class="line">5936</span><br><span class="line">5937</span><br><span class="line">5938</span><br><span class="line">5939</span><br><span class="line">5940</span><br><span class="line">5941</span><br><span class="line">5942</span><br><span class="line">5943</span><br><span class="line">5944</span><br><span class="line">5945</span><br><span class="line">5946</span><br><span class="line">5947</span><br><span class="line">5948</span><br><span class="line">5949</span><br><span class="line">5950</span><br><span class="line">5951</span><br><span class="line">5952</span><br><span class="line">5953</span><br><span class="line">5954</span><br><span class="line">5955</span><br><span class="line">5956</span><br><span class="line">5957</span><br><span class="line">5958</span><br><span class="line">5959</span><br><span class="line">5960</span><br><span class="line">5961</span><br><span class="line">5962</span><br><span class="line">5963</span><br><span class="line">5964</span><br><span class="line">5965</span><br><span class="line">5966</span><br><span class="line">5967</span><br><span class="line">5968</span><br><span class="line">5969</span><br><span class="line">5970</span><br><span class="line">5971</span><br><span class="line">5972</span><br><span class="line">5973</span><br><span class="line">5974</span><br><span class="line">5975</span><br><span class="line">5976</span><br><span class="line">5977</span><br><span class="line">5978</span><br><span class="line">5979</span><br><span class="line">5980</span><br><span class="line">5981</span><br><span class="line">5982</span><br><span class="line">5983</span><br><span class="line">5984</span><br><span class="line">5985</span><br><span class="line">5986</span><br><span class="line">5987</span><br><span class="line">5988</span><br><span class="line">5989</span><br><span class="line">5990</span><br><span class="line">5991</span><br><span class="line">5992</span><br><span class="line">5993</span><br><span class="line">5994</span><br><span class="line">5995</span><br><span class="line">5996</span><br><span class="line">5997</span><br><span class="line">5998</span><br><span class="line">5999</span><br><span class="line">6000</span><br><span class="line">6001</span><br><span class="line">6002</span><br><span class="line">6003</span><br><span class="line">6004</span><br><span class="line">6005</span><br><span class="line">6006</span><br><span class="line">6007</span><br><span class="line">6008</span><br><span class="line">6009</span><br><span class="line">6010</span><br><span class="line">6011</span><br><span class="line">6012</span><br><span class="line">6013</span><br><span class="line">6014</span><br><span class="line">6015</span><br><span class="line">6016</span><br><span class="line">6017</span><br><span class="line">6018</span><br><span class="line">6019</span><br><span class="line">6020</span><br><span class="line">6021</span><br><span class="line">6022</span><br><span class="line">6023</span><br><span class="line">6024</span><br><span class="line">6025</span><br><span class="line">6026</span><br><span class="line">6027</span><br><span class="line">6028</span><br><span class="line">6029</span><br><span class="line">6030</span><br><span class="line">6031</span><br><span class="line">6032</span><br><span class="line">6033</span><br><span class="line">6034</span><br><span class="line">6035</span><br><span class="line">6036</span><br><span class="line">6037</span><br><span class="line">6038</span><br><span class="line">6039</span><br><span class="line">6040</span><br><span class="line">6041</span><br><span class="line">6042</span><br><span class="line">6043</span><br><span class="line">6044</span><br><span class="line">6045</span><br><span class="line">6046</span><br><span class="line">6047</span><br><span class="line">6048</span><br><span class="line">6049</span><br><span class="line">6050</span><br><span class="line">6051</span><br><span class="line">6052</span><br><span class="line">6053</span><br><span class="line">6054</span><br><span class="line">6055</span><br><span class="line">6056</span><br><span class="line">6057</span><br><span class="line">6058</span><br><span class="line">6059</span><br><span class="line">6060</span><br><span class="line">6061</span><br><span class="line">6062</span><br><span class="line">6063</span><br><span class="line">6064</span><br><span class="line">6065</span><br><span class="line">6066</span><br><span class="line">6067</span><br><span class="line">6068</span><br><span class="line">6069</span><br><span class="line">6070</span><br><span class="line">6071</span><br><span class="line">6072</span><br><span class="line">6073</span><br><span class="line">6074</span><br><span class="line">6075</span><br><span class="line">6076</span><br><span class="line">6077</span><br><span class="line">6078</span><br><span class="line">6079</span><br><span class="line">6080</span><br><span class="line">6081</span><br><span class="line">6082</span><br><span class="line">6083</span><br><span class="line">6084</span><br><span class="line">6085</span><br><span class="line">6086</span><br><span class="line">6087</span><br><span class="line">6088</span><br><span class="line">6089</span><br><span class="line">6090</span><br><span class="line">6091</span><br><span class="line">6092</span><br><span class="line">6093</span><br><span class="line">6094</span><br><span class="line">6095</span><br><span class="line">6096</span><br><span class="line">6097</span><br><span class="line">6098</span><br><span class="line">6099</span><br><span class="line">6100</span><br><span class="line">6101</span><br><span class="line">6102</span><br><span class="line">6103</span><br><span class="line">6104</span><br><span class="line">6105</span><br><span class="line">6106</span><br><span class="line">6107</span><br><span class="line">6108</span><br><span class="line">6109</span><br><span class="line">6110</span><br><span class="line">6111</span><br><span class="line">6112</span><br><span class="line">6113</span><br><span class="line">6114</span><br><span class="line">6115</span><br><span class="line">6116</span><br><span class="line">6117</span><br><span class="line">6118</span><br><span class="line">6119</span><br><span class="line">6120</span><br><span class="line">6121</span><br><span class="line">6122</span><br><span class="line">6123</span><br><span class="line">6124</span><br><span class="line">6125</span><br><span class="line">6126</span><br><span class="line">6127</span><br><span class="line">6128</span><br><span class="line">6129</span><br><span class="line">6130</span><br><span class="line">6131</span><br><span class="line">6132</span><br><span class="line">6133</span><br><span class="line">6134</span><br><span class="line">6135</span><br><span class="line">6136</span><br><span class="line">6137</span><br><span class="line">6138</span><br><span class="line">6139</span><br><span class="line">6140</span><br><span class="line">6141</span><br><span class="line">6142</span><br><span class="line">6143</span><br><span class="line">6144</span><br><span class="line">6145</span><br><span class="line">6146</span><br><span class="line">6147</span><br><span class="line">6148</span><br><span class="line">6149</span><br><span class="line">6150</span><br><span class="line">6151</span><br><span class="line">6152</span><br><span class="line">6153</span><br><span class="line">6154</span><br><span class="line">6155</span><br><span class="line">6156</span><br><span class="line">6157</span><br><span class="line">6158</span><br><span class="line">6159</span><br><span class="line">6160</span><br><span class="line">6161</span><br><span class="line">6162</span><br><span class="line">6163</span><br><span class="line">6164</span><br><span class="line">6165</span><br><span class="line">6166</span><br><span class="line">6167</span><br><span class="line">6168</span><br><span class="line">6169</span><br><span class="line">6170</span><br><span class="line">6171</span><br><span class="line">6172</span><br><span class="line">6173</span><br><span class="line">6174</span><br><span class="line">6175</span><br><span class="line">6176</span><br><span class="line">6177</span><br><span class="line">6178</span><br><span class="line">6179</span><br><span class="line">6180</span><br><span class="line">6181</span><br><span class="line">6182</span><br><span class="line">6183</span><br><span class="line">6184</span><br><span class="line">6185</span><br><span class="line">6186</span><br><span class="line">6187</span><br><span class="line">6188</span><br><span class="line">6189</span><br><span class="line">6190</span><br><span class="line">6191</span><br><span class="line">6192</span><br><span class="line">6193</span><br><span class="line">6194</span><br><span class="line">6195</span><br><span class="line">6196</span><br><span class="line">6197</span><br><span class="line">6198</span><br><span class="line">6199</span><br><span class="line">6200</span><br><span class="line">6201</span><br><span class="line">6202</span><br><span class="line">6203</span><br><span class="line">6204</span><br><span class="line">6205</span><br><span class="line">6206</span><br><span class="line">6207</span><br><span class="line">6208</span><br><span class="line">6209</span><br><span class="line">6210</span><br><span class="line">6211</span><br><span class="line">6212</span><br><span class="line">6213</span><br><span class="line">6214</span><br><span class="line">6215</span><br><span class="line">6216</span><br><span class="line">6217</span><br><span class="line">6218</span><br><span class="line">6219</span><br><span class="line">6220</span><br><span class="line">6221</span><br><span class="line">6222</span><br><span class="line">6223</span><br><span class="line">6224</span><br><span class="line">6225</span><br><span class="line">6226</span><br><span class="line">6227</span><br><span class="line">6228</span><br><span class="line">6229</span><br><span class="line">6230</span><br><span class="line">6231</span><br><span class="line">6232</span><br><span class="line">6233</span><br><span class="line">6234</span><br><span class="line">6235</span><br><span class="line">6236</span><br><span class="line">6237</span><br><span class="line">6238</span><br><span class="line">6239</span><br><span class="line">6240</span><br><span class="line">6241</span><br><span class="line">6242</span><br><span class="line">6243</span><br><span class="line">6244</span><br><span class="line">6245</span><br><span class="line">6246</span><br><span class="line">6247</span><br><span class="line">6248</span><br><span class="line">6249</span><br><span class="line">6250</span><br><span class="line">6251</span><br><span class="line">6252</span><br><span class="line">6253</span><br><span class="line">6254</span><br><span class="line">6255</span><br><span class="line">6256</span><br><span class="line">6257</span><br><span class="line">6258</span><br><span class="line">6259</span><br><span class="line">6260</span><br><span class="line">6261</span><br><span class="line">6262</span><br><span class="line">6263</span><br><span class="line">6264</span><br><span class="line">6265</span><br><span class="line">6266</span><br><span class="line">6267</span><br><span class="line">6268</span><br><span class="line">6269</span><br><span class="line">6270</span><br><span class="line">6271</span><br><span class="line">6272</span><br><span class="line">6273</span><br><span class="line">6274</span><br><span class="line">6275</span><br><span class="line">6276</span><br><span class="line">6277</span><br><span class="line">6278</span><br><span class="line">6279</span><br><span class="line">6280</span><br><span class="line">6281</span><br><span class="line">6282</span><br><span class="line">6283</span><br><span class="line">6284</span><br><span class="line">6285</span><br><span class="line">6286</span><br><span class="line">6287</span><br><span class="line">6288</span><br><span class="line">6289</span><br><span class="line">6290</span><br><span class="line">6291</span><br><span class="line">6292</span><br><span class="line">6293</span><br><span class="line">6294</span><br><span class="line">6295</span><br><span class="line">6296</span><br><span class="line">6297</span><br><span class="line">6298</span><br><span class="line">6299</span><br><span class="line">6300</span><br><span class="line">6301</span><br><span class="line">6302</span><br><span class="line">6303</span><br><span class="line">6304</span><br><span class="line">6305</span><br><span class="line">6306</span><br><span class="line">6307</span><br><span class="line">6308</span><br><span class="line">6309</span><br><span class="line">6310</span><br><span class="line">6311</span><br><span class="line">6312</span><br><span class="line">6313</span><br><span class="line">6314</span><br><span class="line">6315</span><br><span class="line">6316</span><br><span class="line">6317</span><br><span class="line">6318</span><br><span class="line">6319</span><br><span class="line">6320</span><br><span class="line">6321</span><br><span class="line">6322</span><br><span class="line">6323</span><br><span class="line">6324</span><br><span class="line">6325</span><br><span class="line">6326</span><br><span class="line">6327</span><br><span class="line">6328</span><br><span class="line">6329</span><br><span class="line">6330</span><br><span class="line">6331</span><br><span class="line">6332</span><br><span class="line">6333</span><br><span class="line">6334</span><br><span class="line">6335</span><br><span class="line">6336</span><br><span class="line">6337</span><br><span class="line">6338</span><br><span class="line">6339</span><br><span class="line">6340</span><br><span class="line">6341</span><br><span class="line">6342</span><br><span class="line">6343</span><br><span class="line">6344</span><br><span class="line">6345</span><br><span class="line">6346</span><br><span class="line">6347</span><br><span class="line">6348</span><br><span class="line">6349</span><br><span class="line">6350</span><br><span class="line">6351</span><br><span class="line">6352</span><br><span class="line">6353</span><br><span class="line">6354</span><br><span class="line">6355</span><br><span class="line">6356</span><br><span class="line">6357</span><br><span class="line">6358</span><br><span class="line">6359</span><br><span class="line">6360</span><br><span class="line">6361</span><br><span class="line">6362</span><br><span class="line">6363</span><br><span class="line">6364</span><br><span class="line">6365</span><br><span class="line">6366</span><br><span class="line">6367</span><br><span class="line">6368</span><br><span class="line">6369</span><br><span class="line">6370</span><br><span class="line">6371</span><br><span class="line">6372</span><br><span class="line">6373</span><br><span class="line">6374</span><br><span class="line">6375</span><br><span class="line">6376</span><br><span class="line">6377</span><br><span class="line">6378</span><br><span class="line">6379</span><br><span class="line">6380</span><br><span class="line">6381</span><br><span class="line">6382</span><br><span class="line">6383</span><br><span class="line">6384</span><br><span class="line">6385</span><br><span class="line">6386</span><br><span class="line">6387</span><br><span class="line">6388</span><br><span class="line">6389</span><br><span class="line">6390</span><br><span class="line">6391</span><br><span class="line">6392</span><br><span class="line">6393</span><br><span class="line">6394</span><br><span class="line">6395</span><br><span class="line">6396</span><br><span class="line">6397</span><br><span class="line">6398</span><br><span class="line">6399</span><br><span class="line">6400</span><br><span class="line">6401</span><br><span class="line">6402</span><br><span class="line">6403</span><br><span class="line">6404</span><br><span class="line">6405</span><br><span class="line">6406</span><br><span class="line">6407</span><br><span class="line">6408</span><br><span class="line">6409</span><br><span class="line">6410</span><br><span class="line">6411</span><br><span class="line">6412</span><br><span class="line">6413</span><br><span class="line">6414</span><br><span class="line">6415</span><br><span class="line">6416</span><br><span class="line">6417</span><br><span class="line">6418</span><br><span class="line">6419</span><br><span class="line">6420</span><br><span class="line">6421</span><br><span class="line">6422</span><br><span class="line">6423</span><br><span class="line">6424</span><br><span class="line">6425</span><br><span class="line">6426</span><br><span class="line">6427</span><br><span class="line">6428</span><br><span class="line">6429</span><br><span class="line">6430</span><br><span class="line">6431</span><br><span class="line">6432</span><br><span class="line">6433</span><br><span class="line">6434</span><br><span class="line">6435</span><br><span class="line">6436</span><br><span class="line">6437</span><br><span class="line">6438</span><br><span class="line">6439</span><br><span class="line">6440</span><br><span class="line">6441</span><br><span class="line">6442</span><br><span class="line">6443</span><br><span class="line">6444</span><br><span class="line">6445</span><br><span class="line">6446</span><br><span class="line">6447</span><br><span class="line">6448</span><br><span class="line">6449</span><br><span class="line">6450</span><br><span class="line">6451</span><br><span class="line">6452</span><br><span class="line">6453</span><br><span class="line">6454</span><br><span class="line">6455</span><br><span class="line">6456</span><br><span class="line">6457</span><br><span class="line">6458</span><br><span class="line">6459</span><br><span class="line">6460</span><br><span class="line">6461</span><br><span class="line">6462</span><br><span class="line">6463</span><br><span class="line">6464</span><br><span class="line">6465</span><br><span class="line">6466</span><br><span class="line">6467</span><br><span class="line">6468</span><br><span class="line">6469</span><br><span class="line">6470</span><br><span class="line">6471</span><br><span class="line">6472</span><br><span class="line">6473</span><br><span class="line">6474</span><br><span class="line">6475</span><br><span class="line">6476</span><br><span class="line">6477</span><br><span class="line">6478</span><br><span class="line">6479</span><br><span class="line">6480</span><br><span class="line">6481</span><br><span class="line">6482</span><br><span class="line">6483</span><br><span class="line">6484</span><br><span class="line">6485</span><br><span class="line">6486</span><br><span class="line">6487</span><br><span class="line">6488</span><br><span class="line">6489</span><br><span class="line">6490</span><br><span class="line">6491</span><br><span class="line">6492</span><br><span class="line">6493</span><br><span class="line">6494</span><br><span class="line">6495</span><br><span class="line">6496</span><br><span class="line">6497</span><br><span class="line">6498</span><br><span class="line">6499</span><br><span class="line">6500</span><br><span class="line">6501</span><br><span class="line">6502</span><br><span class="line">6503</span><br><span class="line">6504</span><br><span class="line">6505</span><br><span class="line">6506</span><br><span class="line">6507</span><br><span class="line">6508</span><br><span class="line">6509</span><br><span class="line">6510</span><br><span class="line">6511</span><br><span class="line">6512</span><br><span class="line">6513</span><br><span class="line">6514</span><br><span class="line">6515</span><br><span class="line">6516</span><br><span class="line">6517</span><br><span class="line">6518</span><br><span class="line">6519</span><br><span class="line">6520</span><br><span class="line">6521</span><br><span class="line">6522</span><br><span class="line">6523</span><br><span class="line">6524</span><br><span class="line">6525</span><br><span class="line">6526</span><br><span class="line">6527</span><br><span class="line">6528</span><br><span class="line">6529</span><br><span class="line">6530</span><br><span class="line">6531</span><br><span class="line">6532</span><br><span class="line">6533</span><br><span class="line">6534</span><br><span class="line">6535</span><br><span class="line">6536</span><br><span class="line">6537</span><br><span class="line">6538</span><br><span class="line">6539</span><br><span class="line">6540</span><br><span class="line">6541</span><br><span class="line">6542</span><br><span class="line">6543</span><br><span class="line">6544</span><br><span class="line">6545</span><br><span class="line">6546</span><br><span class="line">6547</span><br><span class="line">6548</span><br><span class="line">6549</span><br><span class="line">6550</span><br><span class="line">6551</span><br><span class="line">6552</span><br><span class="line">6553</span><br><span class="line">6554</span><br><span class="line">6555</span><br><span class="line">6556</span><br><span class="line">6557</span><br><span class="line">6558</span><br><span class="line">6559</span><br><span class="line">6560</span><br><span class="line">6561</span><br><span class="line">6562</span><br><span class="line">6563</span><br><span class="line">6564</span><br><span class="line">6565</span><br><span class="line">6566</span><br><span class="line">6567</span><br><span class="line">6568</span><br><span class="line">6569</span><br><span class="line">6570</span><br><span class="line">6571</span><br><span class="line">6572</span><br><span class="line">6573</span><br><span class="line">6574</span><br><span class="line">6575</span><br><span class="line">6576</span><br><span class="line">6577</span><br><span class="line">6578</span><br><span class="line">6579</span><br><span class="line">6580</span><br><span class="line">6581</span><br><span class="line">6582</span><br><span class="line">6583</span><br><span class="line">6584</span><br><span class="line">6585</span><br><span class="line">6586</span><br><span class="line">6587</span><br><span class="line">6588</span><br><span class="line">6589</span><br><span class="line">6590</span><br><span class="line">6591</span><br><span class="line">6592</span><br><span class="line">6593</span><br><span class="line">6594</span><br><span class="line">6595</span><br><span class="line">6596</span><br><span class="line">6597</span><br><span class="line">6598</span><br><span class="line">6599</span><br><span class="line">6600</span><br><span class="line">6601</span><br><span class="line">6602</span><br><span class="line">6603</span><br><span class="line">6604</span><br><span class="line">6605</span><br><span class="line">6606</span><br><span class="line">6607</span><br><span class="line">6608</span><br><span class="line">6609</span><br><span class="line">6610</span><br><span class="line">6611</span><br><span class="line">6612</span><br><span class="line">6613</span><br><span class="line">6614</span><br><span class="line">6615</span><br><span class="line">6616</span><br><span class="line">6617</span><br><span class="line">6618</span><br><span class="line">6619</span><br><span class="line">6620</span><br><span class="line">6621</span><br><span class="line">6622</span><br><span class="line">6623</span><br><span class="line">6624</span><br><span class="line">6625</span><br><span class="line">6626</span><br><span class="line">6627</span><br><span class="line">6628</span><br><span class="line">6629</span><br><span class="line">6630</span><br><span class="line">6631</span><br><span class="line">6632</span><br><span class="line">6633</span><br><span class="line">6634</span><br><span class="line">6635</span><br><span class="line">6636</span><br><span class="line">6637</span><br><span class="line">6638</span><br><span class="line">6639</span><br><span class="line">6640</span><br><span class="line">6641</span><br><span class="line">6642</span><br><span class="line">6643</span><br><span class="line">6644</span><br><span class="line">6645</span><br><span class="line">6646</span><br><span class="line">6647</span><br><span class="line">6648</span><br><span class="line">6649</span><br><span class="line">6650</span><br><span class="line">6651</span><br><span class="line">6652</span><br><span class="line">6653</span><br><span class="line">6654</span><br><span class="line">6655</span><br><span class="line">6656</span><br><span class="line">6657</span><br><span class="line">6658</span><br><span class="line">6659</span><br><span class="line">6660</span><br><span class="line">6661</span><br><span class="line">6662</span><br><span class="line">6663</span><br><span class="line">6664</span><br><span class="line">6665</span><br><span class="line">6666</span><br><span class="line">6667</span><br><span class="line">6668</span><br><span class="line">6669</span><br><span class="line">6670</span><br><span class="line">6671</span><br><span class="line">6672</span><br><span class="line">6673</span><br><span class="line">6674</span><br><span class="line">6675</span><br><span class="line">6676</span><br><span class="line">6677</span><br><span class="line">6678</span><br><span class="line">6679</span><br><span class="line">6680</span><br><span class="line">6681</span><br><span class="line">6682</span><br><span class="line">6683</span><br><span class="line">6684</span><br><span class="line">6685</span><br><span class="line">6686</span><br><span class="line">6687</span><br><span class="line">6688</span><br><span class="line">6689</span><br><span class="line">6690</span><br><span class="line">6691</span><br><span class="line">6692</span><br><span class="line">6693</span><br><span class="line">6694</span><br><span class="line">6695</span><br><span class="line">6696</span><br><span class="line">6697</span><br><span class="line">6698</span><br><span class="line">6699</span><br><span class="line">6700</span><br><span class="line">6701</span><br><span class="line">6702</span><br><span class="line">6703</span><br><span class="line">6704</span><br><span class="line">6705</span><br><span class="line">6706</span><br><span class="line">6707</span><br><span class="line">6708</span><br><span class="line">6709</span><br><span class="line">6710</span><br><span class="line">6711</span><br><span class="line">6712</span><br><span class="line">6713</span><br><span class="line">6714</span><br><span class="line">6715</span><br><span class="line">6716</span><br><span class="line">6717</span><br><span class="line">6718</span><br><span class="line">6719</span><br><span class="line">6720</span><br><span class="line">6721</span><br><span class="line">6722</span><br><span class="line">6723</span><br><span class="line">6724</span><br><span class="line">6725</span><br><span class="line">6726</span><br><span class="line">6727</span><br><span class="line">6728</span><br><span class="line">6729</span><br><span class="line">6730</span><br><span class="line">6731</span><br><span class="line">6732</span><br><span class="line">6733</span><br><span class="line">6734</span><br><span class="line">6735</span><br><span class="line">6736</span><br><span class="line">6737</span><br><span class="line">6738</span><br><span class="line">6739</span><br><span class="line">6740</span><br><span class="line">6741</span><br><span class="line">6742</span><br><span class="line">6743</span><br><span class="line">6744</span><br><span class="line">6745</span><br><span class="line">6746</span><br><span class="line">6747</span><br><span class="line">6748</span><br><span class="line">6749</span><br><span class="line">6750</span><br><span class="line">6751</span><br><span class="line">6752</span><br><span class="line">6753</span><br><span class="line">6754</span><br><span class="line">6755</span><br><span class="line">6756</span><br><span class="line">6757</span><br><span class="line">6758</span><br><span class="line">6759</span><br><span class="line">6760</span><br><span class="line">6761</span><br><span class="line">6762</span><br><span class="line">6763</span><br><span class="line">6764</span><br><span class="line">6765</span><br><span class="line">6766</span><br><span class="line">6767</span><br><span class="line">6768</span><br><span class="line">6769</span><br><span class="line">6770</span><br><span class="line">6771</span><br><span class="line">6772</span><br><span class="line">6773</span><br><span class="line">6774</span><br><span class="line">6775</span><br><span class="line">6776</span><br><span class="line">6777</span><br><span class="line">6778</span><br><span class="line">6779</span><br><span class="line">6780</span><br><span class="line">6781</span><br><span class="line">6782</span><br><span class="line">6783</span><br><span class="line">6784</span><br><span class="line">6785</span><br><span class="line">6786</span><br><span class="line">6787</span><br><span class="line">6788</span><br><span class="line">6789</span><br><span class="line">6790</span><br><span class="line">6791</span><br><span class="line">6792</span><br><span class="line">6793</span><br><span class="line">6794</span><br><span class="line">6795</span><br><span class="line">6796</span><br><span class="line">6797</span><br><span class="line">6798</span><br><span class="line">6799</span><br><span class="line">6800</span><br><span class="line">6801</span><br><span class="line">6802</span><br><span class="line">6803</span><br><span class="line">6804</span><br><span class="line">6805</span><br><span class="line">6806</span><br><span class="line">6807</span><br><span class="line">6808</span><br><span class="line">6809</span><br><span class="line">6810</span><br><span class="line">6811</span><br><span class="line">6812</span><br><span class="line">6813</span><br><span class="line">6814</span><br><span class="line">6815</span><br><span class="line">6816</span><br><span class="line">6817</span><br><span class="line">6818</span><br><span class="line">6819</span><br><span class="line">6820</span><br><span class="line">6821</span><br><span class="line">6822</span><br><span class="line">6823</span><br><span class="line">6824</span><br><span class="line">6825</span><br><span class="line">6826</span><br><span class="line">6827</span><br><span class="line">6828</span><br><span class="line">6829</span><br><span class="line">6830</span><br><span class="line">6831</span><br><span class="line">6832</span><br><span class="line">6833</span><br><span class="line">6834</span><br><span class="line">6835</span><br><span class="line">6836</span><br><span class="line">6837</span><br><span class="line">6838</span><br><span class="line">6839</span><br><span class="line">6840</span><br><span class="line">6841</span><br><span class="line">6842</span><br><span class="line">6843</span><br><span class="line">6844</span><br><span class="line">6845</span><br><span class="line">6846</span><br><span class="line">6847</span><br><span class="line">6848</span><br><span class="line">6849</span><br><span class="line">6850</span><br><span class="line">6851</span><br><span class="line">6852</span><br><span class="line">6853</span><br><span class="line">6854</span><br><span class="line">6855</span><br><span class="line">6856</span><br><span class="line">6857</span><br><span class="line">6858</span><br><span class="line">6859</span><br><span class="line">6860</span><br><span class="line">6861</span><br><span class="line">6862</span><br><span class="line">6863</span><br><span class="line">6864</span><br><span class="line">6865</span><br><span class="line">6866</span><br><span class="line">6867</span><br><span class="line">6868</span><br><span class="line">6869</span><br><span class="line">6870</span><br><span class="line">6871</span><br><span class="line">6872</span><br><span class="line">6873</span><br><span class="line">6874</span><br><span class="line">6875</span><br><span class="line">6876</span><br><span class="line">6877</span><br><span class="line">6878</span><br><span class="line">6879</span><br><span class="line">6880</span><br><span class="line">6881</span><br><span class="line">6882</span><br><span class="line">6883</span><br><span class="line">6884</span><br><span class="line">6885</span><br><span class="line">6886</span><br><span class="line">6887</span><br><span class="line">6888</span><br><span class="line">6889</span><br><span class="line">6890</span><br><span class="line">6891</span><br><span class="line">6892</span><br><span class="line">6893</span><br><span class="line">6894</span><br><span class="line">6895</span><br><span class="line">6896</span><br><span class="line">6897</span><br><span class="line">6898</span><br><span class="line">6899</span><br><span class="line">6900</span><br><span class="line">6901</span><br><span class="line">6902</span><br><span class="line">6903</span><br><span class="line">6904</span><br><span class="line">6905</span><br><span class="line">6906</span><br><span class="line">6907</span><br><span class="line">6908</span><br><span class="line">6909</span><br><span class="line">6910</span><br><span class="line">6911</span><br><span class="line">6912</span><br><span class="line">6913</span><br><span class="line">6914</span><br><span class="line">6915</span><br><span class="line">6916</span><br><span class="line">6917</span><br><span class="line">6918</span><br><span class="line">6919</span><br><span class="line">6920</span><br><span class="line">6921</span><br><span class="line">6922</span><br><span class="line">6923</span><br><span class="line">6924</span><br><span class="line">6925</span><br><span class="line">6926</span><br><span class="line">6927</span><br><span class="line">6928</span><br><span class="line">6929</span><br><span class="line">6930</span><br><span class="line">6931</span><br><span class="line">6932</span><br><span class="line">6933</span><br><span class="line">6934</span><br><span class="line">6935</span><br><span class="line">6936</span><br><span class="line">6937</span><br><span class="line">6938</span><br><span class="line">6939</span><br><span class="line">6940</span><br><span class="line">6941</span><br><span class="line">6942</span><br><span class="line">6943</span><br><span class="line">6944</span><br><span class="line">6945</span><br><span class="line">6946</span><br><span class="line">6947</span><br><span class="line">6948</span><br><span class="line">6949</span><br><span class="line">6950</span><br><span class="line">6951</span><br><span class="line">6952</span><br><span class="line">6953</span><br><span class="line">6954</span><br><span class="line">6955</span><br><span class="line">6956</span><br><span class="line">6957</span><br><span class="line">6958</span><br><span class="line">6959</span><br><span class="line">6960</span><br><span class="line">6961</span><br><span class="line">6962</span><br><span class="line">6963</span><br><span class="line">6964</span><br><span class="line">6965</span><br><span class="line">6966</span><br><span class="line">6967</span><br><span class="line">6968</span><br><span class="line">6969</span><br><span class="line">6970</span><br><span class="line">6971</span><br><span class="line">6972</span><br><span class="line">6973</span><br><span class="line">6974</span><br><span class="line">6975</span><br><span class="line">6976</span><br><span class="line">6977</span><br><span class="line">6978</span><br><span class="line">6979</span><br><span class="line">6980</span><br><span class="line">6981</span><br><span class="line">6982</span><br><span class="line">6983</span><br><span class="line">6984</span><br><span class="line">6985</span><br><span class="line">6986</span><br><span class="line">6987</span><br><span class="line">6988</span><br><span class="line">6989</span><br><span class="line">6990</span><br><span class="line">6991</span><br><span class="line">6992</span><br><span class="line">6993</span><br><span class="line">6994</span><br><span class="line">6995</span><br><span class="line">6996</span><br><span class="line">6997</span><br><span class="line">6998</span><br><span class="line">6999</span><br><span class="line">7000</span><br><span class="line">7001</span><br><span class="line">7002</span><br><span class="line">7003</span><br><span class="line">7004</span><br><span class="line">7005</span><br><span class="line">7006</span><br><span class="line">7007</span><br><span class="line">7008</span><br><span class="line">7009</span><br><span class="line">7010</span><br><span class="line">7011</span><br><span class="line">7012</span><br><span class="line">7013</span><br><span class="line">7014</span><br><span class="line">7015</span><br><span class="line">7016</span><br><span class="line">7017</span><br><span class="line">7018</span><br><span class="line">7019</span><br><span class="line">7020</span><br><span class="line">7021</span><br><span class="line">7022</span><br><span class="line">7023</span><br><span class="line">7024</span><br><span class="line">7025</span><br><span class="line">7026</span><br><span class="line">7027</span><br><span class="line">7028</span><br><span class="line">7029</span><br><span class="line">7030</span><br><span class="line">7031</span><br><span class="line">7032</span><br><span class="line">7033</span><br><span class="line">7034</span><br><span class="line">7035</span><br><span class="line">7036</span><br><span class="line">7037</span><br><span class="line">7038</span><br><span class="line">7039</span><br><span class="line">7040</span><br><span class="line">7041</span><br><span class="line">7042</span><br><span class="line">7043</span><br><span class="line">7044</span><br><span class="line">7045</span><br><span class="line">7046</span><br><span class="line">7047</span><br><span class="line">7048</span><br><span class="line">7049</span><br><span class="line">7050</span><br><span class="line">7051</span><br><span class="line">7052</span><br><span class="line">7053</span><br><span class="line">7054</span><br><span class="line">7055</span><br><span class="line">7056</span><br><span class="line">7057</span><br><span class="line">7058</span><br><span class="line">7059</span><br><span class="line">7060</span><br><span class="line">7061</span><br><span class="line">7062</span><br><span class="line">7063</span><br><span class="line">7064</span><br><span class="line">7065</span><br><span class="line">7066</span><br><span class="line">7067</span><br><span class="line">7068</span><br><span class="line">7069</span><br><span class="line">7070</span><br><span class="line">7071</span><br><span class="line">7072</span><br><span class="line">7073</span><br><span class="line">7074</span><br><span class="line">7075</span><br><span class="line">7076</span><br><span class="line">7077</span><br><span class="line">7078</span><br><span class="line">7079</span><br><span class="line">7080</span><br><span class="line">7081</span><br><span class="line">7082</span><br><span class="line">7083</span><br><span class="line">7084</span><br><span class="line">7085</span><br><span class="line">7086</span><br><span class="line">7087</span><br><span class="line">7088</span><br><span class="line">7089</span><br><span class="line">7090</span><br><span class="line">7091</span><br><span class="line">7092</span><br><span class="line">7093</span><br><span class="line">7094</span><br><span class="line">7095</span><br><span class="line">7096</span><br><span class="line">7097</span><br><span class="line">7098</span><br><span class="line">7099</span><br><span class="line">7100</span><br><span class="line">7101</span><br><span class="line">7102</span><br><span class="line">7103</span><br><span class="line">7104</span><br><span class="line">7105</span><br><span class="line">7106</span><br><span class="line">7107</span><br><span class="line">7108</span><br><span class="line">7109</span><br><span class="line">7110</span><br><span class="line">7111</span><br><span class="line">7112</span><br><span class="line">7113</span><br><span class="line">7114</span><br><span class="line">7115</span><br><span class="line">7116</span><br><span class="line">7117</span><br><span class="line">7118</span><br><span class="line">7119</span><br><span class="line">7120</span><br><span class="line">7121</span><br><span class="line">7122</span><br><span class="line">7123</span><br><span class="line">7124</span><br><span class="line">7125</span><br><span class="line">7126</span><br><span class="line">7127</span><br><span class="line">7128</span><br><span class="line">7129</span><br><span class="line">7130</span><br><span class="line">7131</span><br><span class="line">7132</span><br><span class="line">7133</span><br><span class="line">7134</span><br><span class="line">7135</span><br><span class="line">7136</span><br><span class="line">7137</span><br><span class="line">7138</span><br><span class="line">7139</span><br><span class="line">7140</span><br><span class="line">7141</span><br><span class="line">7142</span><br><span class="line">7143</span><br><span class="line">7144</span><br><span class="line">7145</span><br><span class="line">7146</span><br><span class="line">7147</span><br><span class="line">7148</span><br><span class="line">7149</span><br><span class="line">7150</span><br><span class="line">7151</span><br><span class="line">7152</span><br><span class="line">7153</span><br><span class="line">7154</span><br><span class="line">7155</span><br><span class="line">7156</span><br><span class="line">7157</span><br><span class="line">7158</span><br><span class="line">7159</span><br><span class="line">7160</span><br><span class="line">7161</span><br><span class="line">7162</span><br><span class="line">7163</span><br><span class="line">7164</span><br><span class="line">7165</span><br><span class="line">7166</span><br><span class="line">7167</span><br><span class="line">7168</span><br><span class="line">7169</span><br><span class="line">7170</span><br><span class="line">7171</span><br><span class="line">7172</span><br><span class="line">7173</span><br><span class="line">7174</span><br><span class="line">7175</span><br><span class="line">7176</span><br><span class="line">7177</span><br><span class="line">7178</span><br><span class="line">7179</span><br><span class="line">7180</span><br><span class="line">7181</span><br><span class="line">7182</span><br><span class="line">7183</span><br><span class="line">7184</span><br><span class="line">7185</span><br><span class="line">7186</span><br><span class="line">7187</span><br><span class="line">7188</span><br><span class="line">7189</span><br><span class="line">7190</span><br><span class="line">7191</span><br><span class="line">7192</span><br><span class="line">7193</span><br><span class="line">7194</span><br><span class="line">7195</span><br><span class="line">7196</span><br><span class="line">7197</span><br><span class="line">7198</span><br><span class="line">7199</span><br><span class="line">7200</span><br><span class="line">7201</span><br><span class="line">7202</span><br><span class="line">7203</span><br><span class="line">7204</span><br><span class="line">7205</span><br><span class="line">7206</span><br><span class="line">7207</span><br><span class="line">7208</span><br><span class="line">7209</span><br><span class="line">7210</span><br><span class="line">7211</span><br><span class="line">7212</span><br><span class="line">7213</span><br><span class="line">7214</span><br><span class="line">7215</span><br><span class="line">7216</span><br><span class="line">7217</span><br><span class="line">7218</span><br><span class="line">7219</span><br><span class="line">7220</span><br><span class="line">7221</span><br><span class="line">7222</span><br><span class="line">7223</span><br><span class="line">7224</span><br><span class="line">7225</span><br><span class="line">7226</span><br><span class="line">7227</span><br><span class="line">7228</span><br><span class="line">7229</span><br><span class="line">7230</span><br><span class="line">7231</span><br><span class="line">7232</span><br><span class="line">7233</span><br><span class="line">7234</span><br><span class="line">7235</span><br><span class="line">7236</span><br><span class="line">7237</span><br><span class="line">7238</span><br><span class="line">7239</span><br><span class="line">7240</span><br><span class="line">7241</span><br><span class="line">7242</span><br><span class="line">7243</span><br><span class="line">7244</span><br><span class="line">7245</span><br><span class="line">7246</span><br><span class="line">7247</span><br><span class="line">7248</span><br><span class="line">7249</span><br><span class="line">7250</span><br><span class="line">7251</span><br><span class="line">7252</span><br><span class="line">7253</span><br><span class="line">7254</span><br><span class="line">7255</span><br><span class="line">7256</span><br><span class="line">7257</span><br><span class="line">7258</span><br><span class="line">7259</span><br><span class="line">7260</span><br><span class="line">7261</span><br><span class="line">7262</span><br><span class="line">7263</span><br><span class="line">7264</span><br><span class="line">7265</span><br><span class="line">7266</span><br><span class="line">7267</span><br><span class="line">7268</span><br><span class="line">7269</span><br><span class="line">7270</span><br><span class="line">7271</span><br><span class="line">7272</span><br><span class="line">7273</span><br><span class="line">7274</span><br><span class="line">7275</span><br><span class="line">7276</span><br><span class="line">7277</span><br><span class="line">7278</span><br><span class="line">7279</span><br><span class="line">7280</span><br><span class="line">7281</span><br><span class="line">7282</span><br><span class="line">7283</span><br><span class="line">7284</span><br><span class="line">7285</span><br><span class="line">7286</span><br><span class="line">7287</span><br><span class="line">7288</span><br><span class="line">7289</span><br><span class="line">7290</span><br><span class="line">7291</span><br><span class="line">7292</span><br><span class="line">7293</span><br><span class="line">7294</span><br><span class="line">7295</span><br><span class="line">7296</span><br><span class="line">7297</span><br><span class="line">7298</span><br><span class="line">7299</span><br><span class="line">7300</span><br><span class="line">7301</span><br><span class="line">7302</span><br><span class="line">7303</span><br><span class="line">7304</span><br><span class="line">7305</span><br><span class="line">7306</span><br><span class="line">7307</span><br><span class="line">7308</span><br><span class="line">7309</span><br><span class="line">7310</span><br><span class="line">7311</span><br><span class="line">7312</span><br><span class="line">7313</span><br><span class="line">7314</span><br><span class="line">7315</span><br><span class="line">7316</span><br><span class="line">7317</span><br><span class="line">7318</span><br><span class="line">7319</span><br><span class="line">7320</span><br><span class="line">7321</span><br><span class="line">7322</span><br><span class="line">7323</span><br><span class="line">7324</span><br><span class="line">7325</span><br><span class="line">7326</span><br><span class="line">7327</span><br><span class="line">7328</span><br><span class="line">7329</span><br><span class="line">7330</span><br><span class="line">7331</span><br><span class="line">7332</span><br><span class="line">7333</span><br><span class="line">7334</span><br><span class="line">7335</span><br><span class="line">7336</span><br><span class="line">7337</span><br><span class="line">7338</span><br><span class="line">7339</span><br><span class="line">7340</span><br><span class="line">7341</span><br><span class="line">7342</span><br><span class="line">7343</span><br><span class="line">7344</span><br><span class="line">7345</span><br><span class="line">7346</span><br><span class="line">7347</span><br><span class="line">7348</span><br><span class="line">7349</span><br><span class="line">7350</span><br><span class="line">7351</span><br><span class="line">7352</span><br><span class="line">7353</span><br><span class="line">7354</span><br><span class="line">7355</span><br><span class="line">7356</span><br><span class="line">7357</span><br><span class="line">7358</span><br><span class="line">7359</span><br><span class="line">7360</span><br><span class="line">7361</span><br><span class="line">7362</span><br><span class="line">7363</span><br><span class="line">7364</span><br><span class="line">7365</span><br><span class="line">7366</span><br><span class="line">7367</span><br><span class="line">7368</span><br><span class="line">7369</span><br><span class="line">7370</span><br><span class="line">7371</span><br><span class="line">7372</span><br><span class="line">7373</span><br><span class="line">7374</span><br><span class="line">7375</span><br><span class="line">7376</span><br><span class="line">7377</span><br><span class="line">7378</span><br><span class="line">7379</span><br><span class="line">7380</span><br><span class="line">7381</span><br><span class="line">7382</span><br><span class="line">7383</span><br><span class="line">7384</span><br><span class="line">7385</span><br><span class="line">7386</span><br><span class="line">7387</span><br><span class="line">7388</span><br><span class="line">7389</span><br><span class="line">7390</span><br><span class="line">7391</span><br><span class="line">7392</span><br><span class="line">7393</span><br><span class="line">7394</span><br><span class="line">7395</span><br><span class="line">7396</span><br><span class="line">7397</span><br><span class="line">7398</span><br><span class="line">7399</span><br><span class="line">7400</span><br><span class="line">7401</span><br><span class="line">7402</span><br><span class="line">7403</span><br><span class="line">7404</span><br><span class="line">7405</span><br><span class="line">7406</span><br><span class="line">7407</span><br><span class="line">7408</span><br><span class="line">7409</span><br><span class="line">7410</span><br><span class="line">7411</span><br><span class="line">7412</span><br><span class="line">7413</span><br><span class="line">7414</span><br><span class="line">7415</span><br><span class="line">7416</span><br><span class="line">7417</span><br><span class="line">7418</span><br><span class="line">7419</span><br><span class="line">7420</span><br><span class="line">7421</span><br><span class="line">7422</span><br><span class="line">7423</span><br><span class="line">7424</span><br><span class="line">7425</span><br><span class="line">7426</span><br><span class="line">7427</span><br><span class="line">7428</span><br><span class="line">7429</span><br><span class="line">7430</span><br><span class="line">7431</span><br><span class="line">7432</span><br><span class="line">7433</span><br><span class="line">7434</span><br><span class="line">7435</span><br><span class="line">7436</span><br><span class="line">7437</span><br><span class="line">7438</span><br><span class="line">7439</span><br><span class="line">7440</span><br><span class="line">7441</span><br><span class="line">7442</span><br><span class="line">7443</span><br><span class="line">7444</span><br><span class="line">7445</span><br><span class="line">7446</span><br><span class="line">7447</span><br><span class="line">7448</span><br><span class="line">7449</span><br><span class="line">7450</span><br><span class="line">7451</span><br><span class="line">7452</span><br><span class="line">7453</span><br><span class="line">7454</span><br><span class="line">7455</span><br><span class="line">7456</span><br><span class="line">7457</span><br><span class="line">7458</span><br><span class="line">7459</span><br><span class="line">7460</span><br><span class="line">7461</span><br><span class="line">7462</span><br><span class="line">7463</span><br><span class="line">7464</span><br><span class="line">7465</span><br><span class="line">7466</span><br><span class="line">7467</span><br><span class="line">7468</span><br><span class="line">7469</span><br><span class="line">7470</span><br><span class="line">7471</span><br><span class="line">7472</span><br><span class="line">7473</span><br><span class="line">7474</span><br><span class="line">7475</span><br><span class="line">7476</span><br><span class="line">7477</span><br><span class="line">7478</span><br><span class="line">7479</span><br><span class="line">7480</span><br><span class="line">7481</span><br><span class="line">7482</span><br><span class="line">7483</span><br><span class="line">7484</span><br><span class="line">7485</span><br><span class="line">7486</span><br><span class="line">7487</span><br><span class="line">7488</span><br><span class="line">7489</span><br><span class="line">7490</span><br><span class="line">7491</span><br><span class="line">7492</span><br><span class="line">7493</span><br><span class="line">7494</span><br><span class="line">7495</span><br><span class="line">7496</span><br><span class="line">7497</span><br><span class="line">7498</span><br><span class="line">7499</span><br><span class="line">7500</span><br><span class="line">7501</span><br><span class="line">7502</span><br><span class="line">7503</span><br><span class="line">7504</span><br><span class="line">7505</span><br><span class="line">7506</span><br><span class="line">7507</span><br><span class="line">7508</span><br><span class="line">7509</span><br><span class="line">7510</span><br><span class="line">7511</span><br><span class="line">7512</span><br><span class="line">7513</span><br><span class="line">7514</span><br><span class="line">7515</span><br><span class="line">7516</span><br><span class="line">7517</span><br><span class="line">7518</span><br><span class="line">7519</span><br><span class="line">7520</span><br><span class="line">7521</span><br><span class="line">7522</span><br><span class="line">7523</span><br><span class="line">7524</span><br><span class="line">7525</span><br><span class="line">7526</span><br><span class="line">7527</span><br><span class="line">7528</span><br><span class="line">7529</span><br><span class="line">7530</span><br><span class="line">7531</span><br><span class="line">7532</span><br><span class="line">7533</span><br><span class="line">7534</span><br><span class="line">7535</span><br><span class="line">7536</span><br><span class="line">7537</span><br><span class="line">7538</span><br><span class="line">7539</span><br><span class="line">7540</span><br><span class="line">7541</span><br><span class="line">7542</span><br><span class="line">7543</span><br><span class="line">7544</span><br><span class="line">7545</span><br><span class="line">7546</span><br><span class="line">7547</span><br><span class="line">7548</span><br><span class="line">7549</span><br><span class="line">7550</span><br><span class="line">7551</span><br><span class="line">7552</span><br><span class="line">7553</span><br><span class="line">7554</span><br><span class="line">7555</span><br><span class="line">7556</span><br><span class="line">7557</span><br><span class="line">7558</span><br><span class="line">7559</span><br><span class="line">7560</span><br><span class="line">7561</span><br><span class="line">7562</span><br><span class="line">7563</span><br><span class="line">7564</span><br><span class="line">7565</span><br><span class="line">7566</span><br><span class="line">7567</span><br><span class="line">7568</span><br><span class="line">7569</span><br><span class="line">7570</span><br><span class="line">7571</span><br><span class="line">7572</span><br><span class="line">7573</span><br><span class="line">7574</span><br><span class="line">7575</span><br><span class="line">7576</span><br><span class="line">7577</span><br><span class="line">7578</span><br><span class="line">7579</span><br><span class="line">7580</span><br><span class="line">7581</span><br><span class="line">7582</span><br><span class="line">7583</span><br><span class="line">7584</span><br><span class="line">7585</span><br><span class="line">7586</span><br><span class="line">7587</span><br><span class="line">7588</span><br><span class="line">7589</span><br><span class="line">7590</span><br><span class="line">7591</span><br><span class="line">7592</span><br><span class="line">7593</span><br><span class="line">7594</span><br><span class="line">7595</span><br><span class="line">7596</span><br><span class="line">7597</span><br><span class="line">7598</span><br><span class="line">7599</span><br><span class="line">7600</span><br><span class="line">7601</span><br><span class="line">7602</span><br><span class="line">7603</span><br><span class="line">7604</span><br><span class="line">7605</span><br><span class="line">7606</span><br><span class="line">7607</span><br><span class="line">7608</span><br><span class="line">7609</span><br><span class="line">7610</span><br><span class="line">7611</span><br><span class="line">7612</span><br><span class="line">7613</span><br><span class="line">7614</span><br><span class="line">7615</span><br><span class="line">7616</span><br><span class="line">7617</span><br><span class="line">7618</span><br><span class="line">7619</span><br><span class="line">7620</span><br><span class="line">7621</span><br><span class="line">7622</span><br><span class="line">7623</span><br><span class="line">7624</span><br><span class="line">7625</span><br><span class="line">7626</span><br><span class="line">7627</span><br><span class="line">7628</span><br><span class="line">7629</span><br><span class="line">7630</span><br><span class="line">7631</span><br><span class="line">7632</span><br><span class="line">7633</span><br><span class="line">7634</span><br><span class="line">7635</span><br><span class="line">7636</span><br><span class="line">7637</span><br><span class="line">7638</span><br><span class="line">7639</span><br><span class="line">7640</span><br><span class="line">7641</span><br><span class="line">7642</span><br><span class="line">7643</span><br><span class="line">7644</span><br><span class="line">7645</span><br><span class="line">7646</span><br><span class="line">7647</span><br><span class="line">7648</span><br><span class="line">7649</span><br><span class="line">7650</span><br><span class="line">7651</span><br><span class="line">7652</span><br><span class="line">7653</span><br><span class="line">7654</span><br><span class="line">7655</span><br><span class="line">7656</span><br><span class="line">7657</span><br><span class="line">7658</span><br><span class="line">7659</span><br><span class="line">7660</span><br><span class="line">7661</span><br><span class="line">7662</span><br><span class="line">7663</span><br><span class="line">7664</span><br><span class="line">7665</span><br><span class="line">7666</span><br><span class="line">7667</span><br><span class="line">7668</span><br><span class="line">7669</span><br><span class="line">7670</span><br><span class="line">7671</span><br><span class="line">7672</span><br><span class="line">7673</span><br><span class="line">7674</span><br><span class="line">7675</span><br><span class="line">7676</span><br><span class="line">7677</span><br><span class="line">7678</span><br><span class="line">7679</span><br><span class="line">7680</span><br><span class="line">7681</span><br><span class="line">7682</span><br><span class="line">7683</span><br><span class="line">7684</span><br><span class="line">7685</span><br><span class="line">7686</span><br><span class="line">7687</span><br><span class="line">7688</span><br><span class="line">7689</span><br><span class="line">7690</span><br><span class="line">7691</span><br><span class="line">7692</span><br><span class="line">7693</span><br><span class="line">7694</span><br><span class="line">7695</span><br><span class="line">7696</span><br><span class="line">7697</span><br><span class="line">7698</span><br><span class="line">7699</span><br><span class="line">7700</span><br><span class="line">7701</span><br><span class="line">7702</span><br><span class="line">7703</span><br><span class="line">7704</span><br><span class="line">7705</span><br><span class="line">7706</span><br><span class="line">7707</span><br><span class="line">7708</span><br><span class="line">7709</span><br><span class="line">7710</span><br><span class="line">7711</span><br><span class="line">7712</span><br><span class="line">7713</span><br><span class="line">7714</span><br><span class="line">7715</span><br><span class="line">7716</span><br><span class="line">7717</span><br><span class="line">7718</span><br><span class="line">7719</span><br><span class="line">7720</span><br><span class="line">7721</span><br><span class="line">7722</span><br><span class="line">7723</span><br><span class="line">7724</span><br><span class="line">7725</span><br><span class="line">7726</span><br><span class="line">7727</span><br><span class="line">7728</span><br><span class="line">7729</span><br><span class="line">7730</span><br><span class="line">7731</span><br><span class="line">7732</span><br><span class="line">7733</span><br><span class="line">7734</span><br><span class="line">7735</span><br><span class="line">7736</span><br><span class="line">7737</span><br><span class="line">7738</span><br><span class="line">7739</span><br><span class="line">7740</span><br><span class="line">7741</span><br><span class="line">7742</span><br><span class="line">7743</span><br><span class="line">7744</span><br><span class="line">7745</span><br><span class="line">7746</span><br><span class="line">7747</span><br><span class="line">7748</span><br><span class="line">7749</span><br><span class="line">7750</span><br><span class="line">7751</span><br><span class="line">7752</span><br><span class="line">7753</span><br><span class="line">7754</span><br><span class="line">7755</span><br><span class="line">7756</span><br><span class="line">7757</span><br><span class="line">7758</span><br><span class="line">7759</span><br><span class="line">7760</span><br><span class="line">7761</span><br><span class="line">7762</span><br><span class="line">7763</span><br><span class="line">7764</span><br><span class="line">7765</span><br><span class="line">7766</span><br><span class="line">7767</span><br><span class="line">7768</span><br><span class="line">7769</span><br><span class="line">7770</span><br><span class="line">7771</span><br><span class="line">7772</span><br><span class="line">7773</span><br><span class="line">7774</span><br><span class="line">7775</span><br><span class="line">7776</span><br><span class="line">7777</span><br><span class="line">7778</span><br><span class="line">7779</span><br><span class="line">7780</span><br><span class="line">7781</span><br><span class="line">7782</span><br><span class="line">7783</span><br><span class="line">7784</span><br><span class="line">7785</span><br><span class="line">7786</span><br><span class="line">7787</span><br><span class="line">7788</span><br><span class="line">7789</span><br><span class="line">7790</span><br><span class="line">7791</span><br><span class="line">7792</span><br><span class="line">7793</span><br><span class="line">7794</span><br><span class="line">7795</span><br><span class="line">7796</span><br><span class="line">7797</span><br><span class="line">7798</span><br><span class="line">7799</span><br><span class="line">7800</span><br><span class="line">7801</span><br><span class="line">7802</span><br><span class="line">7803</span><br><span class="line">7804</span><br><span class="line">7805</span><br><span class="line">7806</span><br><span class="line">7807</span><br><span class="line">7808</span><br><span class="line">7809</span><br><span class="line">7810</span><br><span class="line">7811</span><br><span class="line">7812</span><br><span class="line">7813</span><br><span class="line">7814</span><br><span class="line">7815</span><br><span class="line">7816</span><br><span class="line">7817</span><br><span class="line">7818</span><br><span class="line">7819</span><br><span class="line">7820</span><br><span class="line">7821</span><br><span class="line">7822</span><br><span class="line">7823</span><br><span class="line">7824</span><br><span class="line">7825</span><br><span class="line">7826</span><br><span class="line">7827</span><br><span class="line">7828</span><br><span class="line">7829</span><br><span class="line">7830</span><br><span class="line">7831</span><br><span class="line">7832</span><br><span class="line">7833</span><br><span class="line">7834</span><br><span class="line">7835</span><br><span class="line">7836</span><br><span class="line">7837</span><br><span class="line">7838</span><br><span class="line">7839</span><br><span class="line">7840</span><br><span class="line">7841</span><br><span class="line">7842</span><br><span class="line">7843</span><br><span class="line">7844</span><br><span class="line">7845</span><br><span class="line">7846</span><br><span class="line">7847</span><br><span class="line">7848</span><br><span class="line">7849</span><br><span class="line">7850</span><br><span class="line">7851</span><br><span class="line">7852</span><br><span class="line">7853</span><br><span class="line">7854</span><br><span class="line">7855</span><br><span class="line">7856</span><br><span class="line">7857</span><br><span class="line">7858</span><br><span class="line">7859</span><br><span class="line">7860</span><br><span class="line">7861</span><br><span class="line">7862</span><br><span class="line">7863</span><br><span class="line">7864</span><br><span class="line">7865</span><br><span class="line">7866</span><br><span class="line">7867</span><br><span class="line">7868</span><br><span class="line">7869</span><br><span class="line">7870</span><br><span class="line">7871</span><br><span class="line">7872</span><br><span class="line">7873</span><br><span class="line">7874</span><br><span class="line">7875</span><br><span class="line">7876</span><br><span class="line">7877</span><br><span class="line">7878</span><br><span class="line">7879</span><br><span class="line">7880</span><br><span class="line">7881</span><br><span class="line">7882</span><br><span class="line">7883</span><br><span class="line">7884</span><br><span class="line">7885</span><br><span class="line">7886</span><br><span class="line">7887</span><br><span class="line">7888</span><br><span class="line">7889</span><br><span class="line">7890</span><br><span class="line">7891</span><br><span class="line">7892</span><br><span class="line">7893</span><br><span class="line">7894</span><br><span class="line">7895</span><br><span class="line">7896</span><br><span class="line">7897</span><br><span class="line">7898</span><br><span class="line">7899</span><br><span class="line">7900</span><br><span class="line">7901</span><br><span class="line">7902</span><br><span class="line">7903</span><br><span class="line">7904</span><br><span class="line">7905</span><br><span class="line">7906</span><br><span class="line">7907</span><br><span class="line">7908</span><br><span class="line">7909</span><br><span class="line">7910</span><br><span class="line">7911</span><br><span class="line">7912</span><br><span class="line">7913</span><br><span class="line">7914</span><br><span class="line">7915</span><br><span class="line">7916</span><br><span class="line">7917</span><br><span class="line">7918</span><br><span class="line">7919</span><br><span class="line">7920</span><br><span class="line">7921</span><br><span class="line">7922</span><br><span class="line">7923</span><br><span class="line">7924</span><br><span class="line">7925</span><br><span class="line">7926</span><br><span class="line">7927</span><br><span class="line">7928</span><br><span class="line">7929</span><br><span class="line">7930</span><br><span class="line">7931</span><br><span class="line">7932</span><br><span class="line">7933</span><br><span class="line">7934</span><br><span class="line">7935</span><br><span class="line">7936</span><br><span class="line">7937</span><br><span class="line">7938</span><br><span class="line">7939</span><br><span class="line">7940</span><br><span class="line">7941</span><br><span class="line">7942</span><br><span class="line">7943</span><br><span class="line">7944</span><br><span class="line">7945</span><br><span class="line">7946</span><br><span class="line">7947</span><br><span class="line">7948</span><br><span class="line">7949</span><br><span class="line">7950</span><br><span class="line">7951</span><br><span class="line">7952</span><br><span class="line">7953</span><br><span class="line">7954</span><br><span class="line">7955</span><br><span class="line">7956</span><br><span class="line">7957</span><br><span class="line">7958</span><br><span class="line">7959</span><br><span class="line">7960</span><br><span class="line">7961</span><br><span class="line">7962</span><br><span class="line">7963</span><br><span class="line">7964</span><br><span class="line">7965</span><br><span class="line">7966</span><br><span class="line">7967</span><br><span class="line">7968</span><br><span class="line">7969</span><br><span class="line">7970</span><br><span class="line">7971</span><br><span class="line">7972</span><br><span class="line">7973</span><br><span class="line">7974</span><br><span class="line">7975</span><br><span class="line">7976</span><br><span class="line">7977</span><br><span class="line">7978</span><br><span class="line">7979</span><br><span class="line">7980</span><br><span class="line">7981</span><br><span class="line">7982</span><br><span class="line">7983</span><br><span class="line">7984</span><br><span class="line">7985</span><br><span class="line">7986</span><br><span class="line">7987</span><br><span class="line">7988</span><br><span class="line">7989</span><br><span class="line">7990</span><br><span class="line">7991</span><br><span class="line">7992</span><br><span class="line">7993</span><br><span class="line">7994</span><br><span class="line">7995</span><br><span class="line">7996</span><br><span class="line">7997</span><br><span class="line">7998</span><br><span class="line">7999</span><br><span class="line">8000</span><br><span class="line">8001</span><br><span class="line">8002</span><br><span class="line">8003</span><br><span class="line">8004</span><br><span class="line">8005</span><br><span class="line">8006</span><br><span class="line">8007</span><br><span class="line">8008</span><br><span class="line">8009</span><br><span class="line">8010</span><br><span class="line">8011</span><br><span class="line">8012</span><br><span class="line">8013</span><br><span class="line">8014</span><br><span class="line">8015</span><br><span class="line">8016</span><br><span class="line">8017</span><br><span class="line">8018</span><br><span class="line">8019</span><br><span class="line">8020</span><br><span class="line">8021</span><br><span class="line">8022</span><br><span class="line">8023</span><br><span class="line">8024</span><br><span class="line">8025</span><br><span class="line">8026</span><br><span class="line">8027</span><br><span class="line">8028</span><br><span class="line">8029</span><br><span class="line">8030</span><br><span class="line">8031</span><br><span class="line">8032</span><br><span class="line">8033</span><br><span class="line">8034</span><br><span class="line">8035</span><br><span class="line">8036</span><br><span class="line">8037</span><br><span class="line">8038</span><br><span class="line">8039</span><br><span class="line">8040</span><br><span class="line">8041</span><br><span class="line">8042</span><br><span class="line">8043</span><br><span class="line">8044</span><br><span class="line">8045</span><br><span class="line">8046</span><br><span class="line">8047</span><br><span class="line">8048</span><br><span class="line">8049</span><br><span class="line">8050</span><br><span class="line">8051</span><br><span class="line">8052</span><br><span class="line">8053</span><br><span class="line">8054</span><br><span class="line">8055</span><br><span class="line">8056</span><br><span class="line">8057</span><br><span class="line">8058</span><br><span class="line">8059</span><br><span class="line">8060</span><br><span class="line">8061</span><br><span class="line">8062</span><br><span class="line">8063</span><br><span class="line">8064</span><br><span class="line">8065</span><br><span class="line">8066</span><br><span class="line">8067</span><br><span class="line">8068</span><br><span class="line">8069</span><br><span class="line">8070</span><br><span class="line">8071</span><br><span class="line">8072</span><br><span class="line">8073</span><br><span class="line">8074</span><br><span class="line">8075</span><br><span class="line">8076</span><br><span class="line">8077</span><br><span class="line">8078</span><br><span class="line">8079</span><br><span class="line">8080</span><br><span class="line">8081</span><br><span class="line">8082</span><br><span class="line">8083</span><br><span class="line">8084</span><br><span class="line">8085</span><br><span class="line">8086</span><br><span class="line">8087</span><br><span class="line">8088</span><br><span class="line">8089</span><br><span class="line">8090</span><br><span class="line">8091</span><br><span class="line">8092</span><br><span class="line">8093</span><br><span class="line">8094</span><br><span class="line">8095</span><br><span class="line">8096</span><br><span class="line">8097</span><br><span class="line">8098</span><br><span class="line">8099</span><br><span class="line">8100</span><br><span class="line">8101</span><br><span class="line">8102</span><br><span class="line">8103</span><br><span class="line">8104</span><br><span class="line">8105</span><br><span class="line">8106</span><br><span class="line">8107</span><br><span class="line">8108</span><br><span class="line">8109</span><br><span class="line">8110</span><br><span class="line">8111</span><br><span class="line">8112</span><br><span class="line">8113</span><br><span class="line">8114</span><br><span class="line">8115</span><br><span class="line">8116</span><br><span class="line">8117</span><br><span class="line">8118</span><br><span class="line">8119</span><br><span class="line">8120</span><br><span class="line">8121</span><br><span class="line">8122</span><br><span class="line">8123</span><br><span class="line">8124</span><br><span class="line">8125</span><br><span class="line">8126</span><br><span class="line">8127</span><br><span class="line">8128</span><br><span class="line">8129</span><br><span class="line">8130</span><br><span class="line">8131</span><br><span class="line">8132</span><br><span class="line">8133</span><br><span class="line">8134</span><br><span class="line">8135</span><br><span class="line">8136</span><br><span class="line">8137</span><br><span class="line">8138</span><br><span class="line">8139</span><br><span class="line">8140</span><br><span class="line">8141</span><br><span class="line">8142</span><br><span class="line">8143</span><br><span class="line">8144</span><br><span class="line">8145</span><br><span class="line">8146</span><br><span class="line">8147</span><br><span class="line">8148</span><br><span class="line">8149</span><br><span class="line">8150</span><br><span class="line">8151</span><br><span class="line">8152</span><br><span class="line">8153</span><br><span class="line">8154</span><br><span class="line">8155</span><br><span class="line">8156</span><br><span class="line">8157</span><br><span class="line">8158</span><br><span class="line">8159</span><br><span class="line">8160</span><br><span class="line">8161</span><br><span class="line">8162</span><br><span class="line">8163</span><br><span class="line">8164</span><br><span class="line">8165</span><br><span class="line">8166</span><br><span class="line">8167</span><br><span class="line">8168</span><br><span class="line">8169</span><br><span class="line">8170</span><br><span class="line">8171</span><br><span class="line">8172</span><br><span class="line">8173</span><br><span class="line">8174</span><br><span class="line">8175</span><br><span class="line">8176</span><br><span class="line">8177</span><br><span class="line">8178</span><br><span class="line">8179</span><br><span class="line">8180</span><br><span class="line">8181</span><br><span class="line">8182</span><br><span class="line">8183</span><br><span class="line">8184</span><br><span class="line">8185</span><br><span class="line">8186</span><br><span class="line">8187</span><br><span class="line">8188</span><br><span class="line">8189</span><br><span class="line">8190</span><br><span class="line">8191</span><br><span class="line">8192</span><br><span class="line">8193</span><br><span class="line">8194</span><br><span class="line">8195</span><br><span class="line">8196</span><br><span class="line">8197</span><br><span class="line">8198</span><br><span class="line">8199</span><br><span class="line">8200</span><br><span class="line">8201</span><br><span class="line">8202</span><br><span class="line">8203</span><br><span class="line">8204</span><br><span class="line">8205</span><br><span class="line">8206</span><br><span class="line">8207</span><br><span class="line">8208</span><br><span class="line">8209</span><br><span class="line">8210</span><br><span class="line">8211</span><br><span class="line">8212</span><br><span class="line">8213</span><br><span class="line">8214</span><br><span class="line">8215</span><br><span class="line">8216</span><br><span class="line">8217</span><br><span class="line">8218</span><br><span class="line">8219</span><br><span class="line">8220</span><br><span class="line">8221</span><br><span class="line">8222</span><br><span class="line">8223</span><br><span class="line">8224</span><br><span class="line">8225</span><br><span class="line">8226</span><br><span class="line">8227</span><br><span class="line">8228</span><br><span class="line">8229</span><br><span class="line">8230</span><br><span class="line">8231</span><br><span class="line">8232</span><br><span class="line">8233</span><br><span class="line">8234</span><br><span class="line">8235</span><br><span class="line">8236</span><br><span class="line">8237</span><br><span class="line">8238</span><br><span class="line">8239</span><br><span class="line">8240</span><br><span class="line">8241</span><br><span class="line">8242</span><br><span class="line">8243</span><br><span class="line">8244</span><br><span class="line">8245</span><br><span class="line">8246</span><br><span class="line">8247</span><br><span class="line">8248</span><br><span class="line">8249</span><br><span class="line">8250</span><br><span class="line">8251</span><br><span class="line">8252</span><br><span class="line">8253</span><br><span class="line">8254</span><br><span class="line">8255</span><br><span class="line">8256</span><br><span class="line">8257</span><br><span class="line">8258</span><br><span class="line">8259</span><br><span class="line">8260</span><br><span class="line">8261</span><br><span class="line">8262</span><br><span class="line">8263</span><br><span class="line">8264</span><br><span class="line">8265</span><br><span class="line">8266</span><br><span class="line">8267</span><br><span class="line">8268</span><br><span class="line">8269</span><br><span class="line">8270</span><br><span class="line">8271</span><br><span class="line">8272</span><br><span class="line">8273</span><br><span class="line">8274</span><br><span class="line">8275</span><br><span class="line">8276</span><br><span class="line">8277</span><br><span class="line">8278</span><br><span class="line">8279</span><br><span class="line">8280</span><br><span class="line">8281</span><br><span class="line">8282</span><br><span class="line">8283</span><br><span class="line">8284</span><br><span class="line">8285</span><br><span class="line">8286</span><br><span class="line">8287</span><br><span class="line">8288</span><br><span class="line">8289</span><br><span class="line">8290</span><br><span class="line">8291</span><br><span class="line">8292</span><br><span class="line">8293</span><br><span class="line">8294</span><br><span class="line">8295</span><br><span class="line">8296</span><br><span class="line">8297</span><br><span class="line">8298</span><br><span class="line">8299</span><br><span class="line">8300</span><br><span class="line">8301</span><br><span class="line">8302</span><br><span class="line">8303</span><br><span class="line">8304</span><br><span class="line">8305</span><br><span class="line">8306</span><br><span class="line">8307</span><br><span class="line">8308</span><br><span class="line">8309</span><br><span class="line">8310</span><br><span class="line">8311</span><br><span class="line">8312</span><br><span class="line">8313</span><br><span class="line">8314</span><br><span class="line">8315</span><br><span class="line">8316</span><br><span class="line">8317</span><br><span class="line">8318</span><br><span class="line">8319</span><br><span class="line">8320</span><br><span class="line">8321</span><br><span class="line">8322</span><br><span class="line">8323</span><br><span class="line">8324</span><br><span class="line">8325</span><br><span class="line">8326</span><br><span class="line">8327</span><br><span class="line">8328</span><br><span class="line">8329</span><br><span class="line">8330</span><br><span class="line">8331</span><br><span class="line">8332</span><br><span class="line">8333</span><br><span class="line">8334</span><br><span class="line">8335</span><br><span class="line">8336</span><br><span class="line">8337</span><br><span class="line">8338</span><br><span class="line">8339</span><br><span class="line">8340</span><br><span class="line">8341</span><br><span class="line">8342</span><br><span class="line">8343</span><br><span class="line">8344</span><br><span class="line">8345</span><br><span class="line">8346</span><br><span class="line">8347</span><br><span class="line">8348</span><br><span class="line">8349</span><br><span class="line">8350</span><br><span class="line">8351</span><br><span class="line">8352</span><br><span class="line">8353</span><br><span class="line">8354</span><br><span class="line">8355</span><br><span class="line">8356</span><br><span class="line">8357</span><br><span class="line">8358</span><br><span class="line">8359</span><br><span class="line">8360</span><br><span class="line">8361</span><br><span class="line">8362</span><br><span class="line">8363</span><br><span class="line">8364</span><br><span class="line">8365</span><br><span class="line">8366</span><br><span class="line">8367</span><br><span class="line">8368</span><br><span class="line">8369</span><br><span class="line">8370</span><br><span class="line">8371</span><br><span class="line">8372</span><br><span class="line">8373</span><br><span class="line">8374</span><br><span class="line">8375</span><br><span class="line">8376</span><br><span class="line">8377</span><br><span class="line">8378</span><br><span class="line">8379</span><br><span class="line">8380</span><br><span class="line">8381</span><br><span class="line">8382</span><br><span class="line">8383</span><br><span class="line">8384</span><br><span class="line">8385</span><br><span class="line">8386</span><br><span class="line">8387</span><br><span class="line">8388</span><br><span class="line">8389</span><br><span class="line">8390</span><br><span class="line">8391</span><br><span class="line">8392</span><br><span class="line">8393</span><br><span class="line">8394</span><br><span class="line">8395</span><br><span class="line">8396</span><br><span class="line">8397</span><br><span class="line">8398</span><br><span class="line">8399</span><br><span class="line">8400</span><br><span class="line">8401</span><br><span class="line">8402</span><br><span class="line">8403</span><br><span class="line">8404</span><br><span class="line">8405</span><br><span class="line">8406</span><br><span class="line">8407</span><br><span class="line">8408</span><br><span class="line">8409</span><br><span class="line">8410</span><br><span class="line">8411</span><br><span class="line">8412</span><br><span class="line">8413</span><br><span class="line">8414</span><br><span class="line">8415</span><br><span class="line">8416</span><br><span class="line">8417</span><br><span class="line">8418</span><br><span class="line">8419</span><br><span class="line">8420</span><br><span class="line">8421</span><br><span class="line">8422</span><br><span class="line">8423</span><br><span class="line">8424</span><br><span class="line">8425</span><br><span class="line">8426</span><br><span class="line">8427</span><br><span class="line">8428</span><br><span class="line">8429</span><br><span class="line">8430</span><br><span class="line">8431</span><br><span class="line">8432</span><br><span class="line">8433</span><br><span class="line">8434</span><br><span class="line">8435</span><br><span class="line">8436</span><br><span class="line">8437</span><br><span class="line">8438</span><br><span class="line">8439</span><br><span class="line">8440</span><br><span class="line">8441</span><br><span class="line">8442</span><br><span class="line">8443</span><br><span class="line">8444</span><br><span class="line">8445</span><br><span class="line">8446</span><br><span class="line">8447</span><br><span class="line">8448</span><br><span class="line">8449</span><br><span class="line">8450</span><br><span class="line">8451</span><br><span class="line">8452</span><br><span class="line">8453</span><br><span class="line">8454</span><br><span class="line">8455</span><br><span class="line">8456</span><br><span class="line">8457</span><br><span class="line">8458</span><br><span class="line">8459</span><br><span class="line">8460</span><br><span class="line">8461</span><br><span class="line">8462</span><br><span class="line">8463</span><br><span class="line">8464</span><br><span class="line">8465</span><br><span class="line">8466</span><br><span class="line">8467</span><br><span class="line">8468</span><br><span class="line">8469</span><br><span class="line">8470</span><br><span class="line">8471</span><br><span class="line">8472</span><br><span class="line">8473</span><br><span class="line">8474</span><br><span class="line">8475</span><br><span class="line">8476</span><br><span class="line">8477</span><br><span class="line">8478</span><br><span class="line">8479</span><br><span class="line">8480</span><br><span class="line">8481</span><br><span class="line">8482</span><br><span class="line">8483</span><br><span class="line">8484</span><br><span class="line">8485</span><br><span class="line">8486</span><br><span class="line">8487</span><br><span class="line">8488</span><br><span class="line">8489</span><br><span class="line">8490</span><br><span class="line">8491</span><br><span class="line">8492</span><br><span class="line">8493</span><br><span class="line">8494</span><br><span class="line">8495</span><br><span class="line">8496</span><br><span class="line">8497</span><br><span class="line">8498</span><br><span class="line">8499</span><br><span class="line">8500</span><br><span class="line">8501</span><br><span class="line">8502</span><br><span class="line">8503</span><br><span class="line">8504</span><br><span class="line">8505</span><br><span class="line">8506</span><br><span class="line">8507</span><br><span class="line">8508</span><br><span class="line">8509</span><br><span class="line">8510</span><br><span class="line">8511</span><br><span class="line">8512</span><br><span class="line">8513</span><br><span class="line">8514</span><br><span class="line">8515</span><br><span class="line">8516</span><br><span class="line">8517</span><br><span class="line">8518</span><br><span class="line">8519</span><br><span class="line">8520</span><br><span class="line">8521</span><br><span class="line">8522</span><br><span class="line">8523</span><br><span class="line">8524</span><br><span class="line">8525</span><br><span class="line">8526</span><br><span class="line">8527</span><br><span class="line">8528</span><br><span class="line">8529</span><br><span class="line">8530</span><br><span class="line">8531</span><br><span class="line">8532</span><br><span class="line">8533</span><br><span class="line">8534</span><br><span class="line">8535</span><br><span class="line">8536</span><br><span class="line">8537</span><br><span class="line">8538</span><br><span class="line">8539</span><br><span class="line">8540</span><br><span class="line">8541</span><br><span class="line">8542</span><br><span class="line">8543</span><br><span class="line">8544</span><br><span class="line">8545</span><br><span class="line">8546</span><br><span class="line">8547</span><br><span class="line">8548</span><br><span class="line">8549</span><br><span class="line">8550</span><br><span class="line">8551</span><br><span class="line">8552</span><br><span class="line">8553</span><br><span class="line">8554</span><br><span class="line">8555</span><br><span class="line">8556</span><br><span class="line">8557</span><br><span class="line">8558</span><br><span class="line">8559</span><br><span class="line">8560</span><br><span class="line">8561</span><br><span class="line">8562</span><br><span class="line">8563</span><br><span class="line">8564</span><br><span class="line">8565</span><br><span class="line">8566</span><br><span class="line">8567</span><br><span class="line">8568</span><br><span class="line">8569</span><br><span class="line">8570</span><br><span class="line">8571</span><br><span class="line">8572</span><br><span class="line">8573</span><br><span class="line">8574</span><br><span class="line">8575</span><br><span class="line">8576</span><br><span class="line">8577</span><br><span class="line">8578</span><br><span class="line">8579</span><br><span class="line">8580</span><br><span class="line">8581</span><br><span class="line">8582</span><br><span class="line">8583</span><br><span class="line">8584</span><br><span class="line">8585</span><br><span class="line">8586</span><br><span class="line">8587</span><br><span class="line">8588</span><br><span class="line">8589</span><br><span class="line">8590</span><br><span class="line">8591</span><br><span class="line">8592</span><br><span class="line">8593</span><br><span class="line">8594</span><br><span class="line">8595</span><br><span class="line">8596</span><br><span class="line">8597</span><br><span class="line">8598</span><br><span class="line">8599</span><br><span class="line">8600</span><br><span class="line">8601</span><br><span class="line">8602</span><br><span class="line">8603</span><br><span class="line">8604</span><br><span class="line">8605</span><br><span class="line">8606</span><br><span class="line">8607</span><br><span class="line">8608</span><br><span class="line">8609</span><br><span class="line">8610</span><br><span class="line">8611</span><br><span class="line">8612</span><br><span class="line">8613</span><br><span class="line">8614</span><br><span class="line">8615</span><br><span class="line">8616</span><br><span class="line">8617</span><br><span class="line">8618</span><br><span class="line">8619</span><br><span class="line">8620</span><br><span class="line">8621</span><br><span class="line">8622</span><br><span class="line">8623</span><br><span class="line">8624</span><br><span class="line">8625</span><br><span class="line">8626</span><br><span class="line">8627</span><br><span class="line">8628</span><br><span class="line">8629</span><br><span class="line">8630</span><br><span class="line">8631</span><br><span class="line">8632</span><br><span class="line">8633</span><br><span class="line">8634</span><br><span class="line">8635</span><br><span class="line">8636</span><br><span class="line">8637</span><br><span class="line">8638</span><br><span class="line">8639</span><br><span class="line">8640</span><br><span class="line">8641</span><br><span class="line">8642</span><br><span class="line">8643</span><br><span class="line">8644</span><br><span class="line">8645</span><br><span class="line">8646</span><br><span class="line">8647</span><br><span class="line">8648</span><br><span class="line">8649</span><br><span class="line">8650</span><br><span class="line">8651</span><br><span class="line">8652</span><br><span class="line">8653</span><br><span class="line">8654</span><br><span class="line">8655</span><br><span class="line">8656</span><br><span class="line">8657</span><br><span class="line">8658</span><br><span class="line">8659</span><br><span class="line">8660</span><br><span class="line">8661</span><br><span class="line">8662</span><br><span class="line">8663</span><br><span class="line">8664</span><br><span class="line">8665</span><br><span class="line">8666</span><br><span class="line">8667</span><br><span class="line">8668</span><br><span class="line">8669</span><br><span class="line">8670</span><br><span class="line">8671</span><br><span class="line">8672</span><br><span class="line">8673</span><br><span class="line">8674</span><br><span class="line">8675</span><br><span class="line">8676</span><br><span class="line">8677</span><br><span class="line">8678</span><br><span class="line">8679</span><br><span class="line">8680</span><br><span class="line">8681</span><br><span class="line">8682</span><br><span class="line">8683</span><br><span class="line">8684</span><br><span class="line">8685</span><br><span class="line">8686</span><br><span class="line">8687</span><br><span class="line">8688</span><br><span class="line">8689</span><br><span class="line">8690</span><br><span class="line">8691</span><br><span class="line">8692</span><br><span class="line">8693</span><br><span class="line">8694</span><br><span class="line">8695</span><br><span class="line">8696</span><br><span class="line">8697</span><br><span class="line">8698</span><br><span class="line">8699</span><br><span class="line">8700</span><br><span class="line">8701</span><br><span class="line">8702</span><br><span class="line">8703</span><br><span class="line">8704</span><br><span class="line">8705</span><br><span class="line">8706</span><br><span class="line">8707</span><br><span class="line">8708</span><br><span class="line">8709</span><br><span class="line">8710</span><br><span class="line">8711</span><br><span class="line">8712</span><br><span class="line">8713</span><br><span class="line">8714</span><br><span class="line">8715</span><br><span class="line">8716</span><br><span class="line">8717</span><br><span class="line">8718</span><br><span class="line">8719</span><br><span class="line">8720</span><br><span class="line">8721</span><br><span class="line">8722</span><br><span class="line">8723</span><br><span class="line">8724</span><br><span class="line">8725</span><br><span class="line">8726</span><br><span class="line">8727</span><br><span class="line">8728</span><br><span class="line">8729</span><br><span class="line">8730</span><br><span class="line">8731</span><br><span class="line">8732</span><br><span class="line">8733</span><br><span class="line">8734</span><br><span class="line">8735</span><br><span class="line">8736</span><br><span class="line">8737</span><br><span class="line">8738</span><br><span class="line">8739</span><br><span class="line">8740</span><br><span class="line">8741</span><br><span class="line">8742</span><br><span class="line">8743</span><br><span class="line">8744</span><br><span class="line">8745</span><br><span class="line">8746</span><br><span class="line">8747</span><br><span class="line">8748</span><br><span class="line">8749</span><br><span class="line">8750</span><br><span class="line">8751</span><br><span class="line">8752</span><br><span class="line">8753</span><br><span class="line">8754</span><br><span class="line">8755</span><br><span class="line">8756</span><br><span class="line">8757</span><br><span class="line">8758</span><br><span class="line">8759</span><br><span class="line">8760</span><br><span class="line">8761</span><br><span class="line">8762</span><br><span class="line">8763</span><br><span class="line">8764</span><br><span class="line">8765</span><br><span class="line">8766</span><br><span class="line">8767</span><br><span class="line">8768</span><br><span class="line">8769</span><br><span class="line">8770</span><br><span class="line">8771</span><br><span class="line">8772</span><br><span class="line">8773</span><br><span class="line">8774</span><br><span class="line">8775</span><br><span class="line">8776</span><br><span class="line">8777</span><br><span class="line">8778</span><br><span class="line">8779</span><br><span class="line">8780</span><br><span class="line">8781</span><br><span class="line">8782</span><br><span class="line">8783</span><br><span class="line">8784</span><br><span class="line">8785</span><br><span class="line">8786</span><br><span class="line">8787</span><br><span class="line">8788</span><br><span class="line">8789</span><br><span class="line">8790</span><br><span class="line">8791</span><br><span class="line">8792</span><br><span class="line">8793</span><br><span class="line">8794</span><br><span class="line">8795</span><br><span class="line">8796</span><br><span class="line">8797</span><br><span class="line">8798</span><br><span class="line">8799</span><br><span class="line">8800</span><br><span class="line">8801</span><br><span class="line">8802</span><br><span class="line">8803</span><br><span class="line">8804</span><br><span class="line">8805</span><br><span class="line">8806</span><br><span class="line">8807</span><br><span class="line">8808</span><br><span class="line">8809</span><br><span class="line">8810</span><br><span class="line">8811</span><br><span class="line">8812</span><br><span class="line">8813</span><br><span class="line">8814</span><br><span class="line">8815</span><br><span class="line">8816</span><br><span class="line">8817</span><br><span class="line">8818</span><br><span class="line">8819</span><br><span class="line">8820</span><br><span class="line">8821</span><br><span class="line">8822</span><br><span class="line">8823</span><br><span class="line">8824</span><br><span class="line">8825</span><br><span class="line">8826</span><br><span class="line">8827</span><br><span class="line">8828</span><br><span class="line">8829</span><br><span class="line">8830</span><br><span class="line">8831</span><br><span class="line">8832</span><br><span class="line">8833</span><br><span class="line">8834</span><br><span class="line">8835</span><br><span class="line">8836</span><br><span class="line">8837</span><br><span class="line">8838</span><br><span class="line">8839</span><br><span class="line">8840</span><br><span class="line">8841</span><br><span class="line">8842</span><br><span class="line">8843</span><br><span class="line">8844</span><br><span class="line">8845</span><br><span class="line">8846</span><br><span class="line">8847</span><br><span class="line">8848</span><br><span class="line">8849</span><br><span class="line">8850</span><br><span class="line">8851</span><br><span class="line">8852</span><br><span class="line">8853</span><br><span class="line">8854</span><br><span class="line">8855</span><br><span class="line">8856</span><br><span class="line">8857</span><br><span class="line">8858</span><br><span class="line">8859</span><br><span class="line">8860</span><br><span class="line">8861</span><br><span class="line">8862</span><br><span class="line">8863</span><br><span class="line">8864</span><br><span class="line">8865</span><br><span class="line">8866</span><br><span class="line">8867</span><br><span class="line">8868</span><br><span class="line">8869</span><br><span class="line">8870</span><br><span class="line">8871</span><br><span class="line">8872</span><br><span class="line">8873</span><br><span class="line">8874</span><br><span class="line">8875</span><br><span class="line">8876</span><br><span class="line">8877</span><br><span class="line">8878</span><br><span class="line">8879</span><br><span class="line">8880</span><br><span class="line">8881</span><br><span class="line">8882</span><br><span class="line">8883</span><br><span class="line">8884</span><br><span class="line">8885</span><br><span class="line">8886</span><br><span class="line">8887</span><br><span class="line">8888</span><br><span class="line">8889</span><br><span class="line">8890</span><br><span class="line">8891</span><br><span class="line">8892</span><br><span class="line">8893</span><br><span class="line">8894</span><br><span class="line">8895</span><br><span class="line">8896</span><br><span class="line">8897</span><br><span class="line">8898</span><br><span class="line">8899</span><br><span class="line">8900</span><br><span class="line">8901</span><br><span class="line">8902</span><br><span class="line">8903</span><br><span class="line">8904</span><br><span class="line">8905</span><br><span class="line">8906</span><br><span class="line">8907</span><br><span class="line">8908</span><br><span class="line">8909</span><br><span class="line">8910</span><br><span class="line">8911</span><br><span class="line">8912</span><br><span class="line">8913</span><br><span class="line">8914</span><br><span class="line">8915</span><br><span class="line">8916</span><br><span class="line">8917</span><br><span class="line">8918</span><br><span class="line">8919</span><br><span class="line">8920</span><br><span class="line">8921</span><br><span class="line">8922</span><br><span class="line">8923</span><br><span class="line">8924</span><br><span class="line">8925</span><br><span class="line">8926</span><br><span class="line">8927</span><br><span class="line">8928</span><br><span class="line">8929</span><br><span class="line">8930</span><br><span class="line">8931</span><br><span class="line">8932</span><br><span class="line">8933</span><br><span class="line">8934</span><br><span class="line">8935</span><br><span class="line">8936</span><br><span class="line">8937</span><br><span class="line">8938</span><br><span class="line">8939</span><br><span class="line">8940</span><br><span class="line">8941</span><br><span class="line">8942</span><br><span class="line">8943</span><br><span class="line">8944</span><br><span class="line">8945</span><br><span class="line">8946</span><br><span class="line">8947</span><br><span class="line">8948</span><br><span class="line">8949</span><br><span class="line">8950</span><br><span class="line">8951</span><br><span class="line">8952</span><br><span class="line">8953</span><br><span class="line">8954</span><br><span class="line">8955</span><br><span class="line">8956</span><br><span class="line">8957</span><br><span class="line">8958</span><br><span class="line">8959</span><br><span class="line">8960</span><br><span class="line">8961</span><br><span class="line">8962</span><br><span class="line">8963</span><br><span class="line">8964</span><br><span class="line">8965</span><br><span class="line">8966</span><br><span class="line">8967</span><br><span class="line">8968</span><br><span class="line">8969</span><br><span class="line">8970</span><br><span class="line">8971</span><br><span class="line">8972</span><br><span class="line">8973</span><br><span class="line">8974</span><br><span class="line">8975</span><br><span class="line">8976</span><br><span class="line">8977</span><br><span class="line">8978</span><br><span class="line">8979</span><br><span class="line">8980</span><br><span class="line">8981</span><br><span class="line">8982</span><br><span class="line">8983</span><br><span class="line">8984</span><br><span class="line">8985</span><br><span class="line">8986</span><br><span class="line">8987</span><br><span class="line">8988</span><br><span class="line">8989</span><br><span class="line">8990</span><br><span class="line">8991</span><br><span class="line">8992</span><br><span class="line">8993</span><br><span class="line">8994</span><br><span class="line">8995</span><br><span class="line">8996</span><br><span class="line">8997</span><br><span class="line">8998</span><br><span class="line">8999</span><br><span class="line">9000</span><br><span class="line">9001</span><br><span class="line">9002</span><br><span class="line">9003</span><br><span class="line">9004</span><br><span class="line">9005</span><br><span class="line">9006</span><br><span class="line">9007</span><br><span class="line">9008</span><br><span class="line">9009</span><br><span class="line">9010</span><br><span class="line">9011</span><br><span class="line">9012</span><br><span class="line">9013</span><br><span class="line">9014</span><br><span class="line">9015</span><br><span class="line">9016</span><br><span class="line">9017</span><br><span class="line">9018</span><br><span class="line">9019</span><br><span class="line">9020</span><br><span class="line">9021</span><br><span class="line">9022</span><br><span class="line">9023</span><br><span class="line">9024</span><br><span class="line">9025</span><br><span class="line">9026</span><br><span class="line">9027</span><br><span class="line">9028</span><br><span class="line">9029</span><br><span class="line">9030</span><br><span class="line">9031</span><br><span class="line">9032</span><br><span class="line">9033</span><br><span class="line">9034</span><br><span class="line">9035</span><br><span class="line">9036</span><br><span class="line">9037</span><br><span class="line">9038</span><br><span class="line">9039</span><br><span class="line">9040</span><br><span class="line">9041</span><br><span class="line">9042</span><br><span class="line">9043</span><br><span class="line">9044</span><br><span class="line">9045</span><br><span class="line">9046</span><br><span class="line">9047</span><br><span class="line">9048</span><br><span class="line">9049</span><br><span class="line">9050</span><br><span class="line">9051</span><br><span class="line">9052</span><br><span class="line">9053</span><br><span class="line">9054</span><br><span class="line">9055</span><br><span class="line">9056</span><br><span class="line">9057</span><br><span class="line">9058</span><br><span class="line">9059</span><br><span class="line">9060</span><br><span class="line">9061</span><br><span class="line">9062</span><br><span class="line">9063</span><br><span class="line">9064</span><br><span class="line">9065</span><br><span class="line">9066</span><br><span class="line">9067</span><br><span class="line">9068</span><br><span class="line">9069</span><br><span class="line">9070</span><br><span class="line">9071</span><br><span class="line">9072</span><br><span class="line">9073</span><br><span class="line">9074</span><br><span class="line">9075</span><br><span class="line">9076</span><br><span class="line">9077</span><br><span class="line">9078</span><br><span class="line">9079</span><br><span class="line">9080</span><br><span class="line">9081</span><br><span class="line">9082</span><br><span class="line">9083</span><br><span class="line">9084</span><br><span class="line">9085</span><br><span class="line">9086</span><br><span class="line">9087</span><br><span class="line">9088</span><br><span class="line">9089</span><br><span class="line">9090</span><br><span class="line">9091</span><br><span class="line">9092</span><br><span class="line">9093</span><br><span class="line">9094</span><br><span class="line">9095</span><br><span class="line">9096</span><br><span class="line">9097</span><br><span class="line">9098</span><br><span class="line">9099</span><br><span class="line">9100</span><br><span class="line">9101</span><br><span class="line">9102</span><br><span class="line">9103</span><br><span class="line">9104</span><br><span class="line">9105</span><br><span class="line">9106</span><br><span class="line">9107</span><br><span class="line">9108</span><br><span class="line">9109</span><br><span class="line">9110</span><br><span class="line">9111</span><br><span class="line">9112</span><br><span class="line">9113</span><br><span class="line">9114</span><br><span class="line">9115</span><br><span class="line">9116</span><br><span class="line">9117</span><br><span class="line">9118</span><br><span class="line">9119</span><br><span class="line">9120</span><br><span class="line">9121</span><br><span class="line">9122</span><br><span class="line">9123</span><br><span class="line">9124</span><br><span class="line">9125</span><br><span class="line">9126</span><br><span class="line">9127</span><br><span class="line">9128</span><br><span class="line">9129</span><br><span class="line">9130</span><br><span class="line">9131</span><br><span class="line">9132</span><br><span class="line">9133</span><br><span class="line">9134</span><br><span class="line">9135</span><br><span class="line">9136</span><br><span class="line">9137</span><br><span class="line">9138</span><br><span class="line">9139</span><br><span class="line">9140</span><br><span class="line">9141</span><br><span class="line">9142</span><br><span class="line">9143</span><br><span class="line">9144</span><br><span class="line">9145</span><br><span class="line">9146</span><br><span class="line">9147</span><br><span class="line">9148</span><br><span class="line">9149</span><br><span class="line">9150</span><br><span class="line">9151</span><br><span class="line">9152</span><br><span class="line">9153</span><br><span class="line">9154</span><br><span class="line">9155</span><br><span class="line">9156</span><br><span class="line">9157</span><br><span class="line">9158</span><br><span class="line">9159</span><br><span class="line">9160</span><br><span class="line">9161</span><br><span class="line">9162</span><br><span class="line">9163</span><br><span class="line">9164</span><br><span class="line">9165</span><br><span class="line">9166</span><br><span class="line">9167</span><br><span class="line">9168</span><br><span class="line">9169</span><br><span class="line">9170</span><br><span class="line">9171</span><br><span class="line">9172</span><br><span class="line">9173</span><br><span class="line">9174</span><br><span class="line">9175</span><br><span class="line">9176</span><br><span class="line">9177</span><br><span class="line">9178</span><br><span class="line">9179</span><br><span class="line">9180</span><br><span class="line">9181</span><br><span class="line">9182</span><br><span class="line">9183</span><br><span class="line">9184</span><br><span class="line">9185</span><br><span class="line">9186</span><br><span class="line">9187</span><br><span class="line">9188</span><br><span class="line">9189</span><br><span class="line">9190</span><br><span class="line">9191</span><br><span class="line">9192</span><br><span class="line">9193</span><br><span class="line">9194</span><br><span class="line">9195</span><br><span class="line">9196</span><br><span class="line">9197</span><br><span class="line">9198</span><br><span class="line">9199</span><br><span class="line">9200</span><br><span class="line">9201</span><br><span class="line">9202</span><br><span class="line">9203</span><br><span class="line">9204</span><br><span class="line">9205</span><br><span class="line">9206</span><br><span class="line">9207</span><br><span class="line">9208</span><br><span class="line">9209</span><br><span class="line">9210</span><br><span class="line">9211</span><br><span class="line">9212</span><br><span class="line">9213</span><br><span class="line">9214</span><br><span class="line">9215</span><br><span class="line">9216</span><br><span class="line">9217</span><br><span class="line">9218</span><br><span class="line">9219</span><br><span class="line">9220</span><br><span class="line">9221</span><br><span class="line">9222</span><br><span class="line">9223</span><br><span class="line">9224</span><br><span class="line">9225</span><br><span class="line">9226</span><br><span class="line">9227</span><br><span class="line">9228</span><br><span class="line">9229</span><br><span class="line">9230</span><br><span class="line">9231</span><br><span class="line">9232</span><br><span class="line">9233</span><br><span class="line">9234</span><br><span class="line">9235</span><br><span class="line">9236</span><br><span class="line">9237</span><br><span class="line">9238</span><br><span class="line">9239</span><br><span class="line">9240</span><br><span class="line">9241</span><br><span class="line">9242</span><br><span class="line">9243</span><br><span class="line">9244</span><br><span class="line">9245</span><br><span class="line">9246</span><br><span class="line">9247</span><br><span class="line">9248</span><br><span class="line">9249</span><br><span class="line">9250</span><br><span class="line">9251</span><br><span class="line">9252</span><br><span class="line">9253</span><br><span class="line">9254</span><br><span class="line">9255</span><br><span class="line">9256</span><br><span class="line">9257</span><br><span class="line">9258</span><br><span class="line">9259</span><br><span class="line">9260</span><br><span class="line">9261</span><br><span class="line">9262</span><br><span class="line">9263</span><br><span class="line">9264</span><br><span class="line">9265</span><br><span class="line">9266</span><br><span class="line">9267</span><br><span class="line">9268</span><br><span class="line">9269</span><br><span class="line">9270</span><br><span class="line">9271</span><br><span class="line">9272</span><br><span class="line">9273</span><br><span class="line">9274</span><br><span class="line">9275</span><br><span class="line">9276</span><br><span class="line">9277</span><br><span class="line">9278</span><br><span class="line">9279</span><br><span class="line">9280</span><br><span class="line">9281</span><br><span class="line">9282</span><br><span class="line">9283</span><br><span class="line">9284</span><br><span class="line">9285</span><br><span class="line">9286</span><br><span class="line">9287</span><br><span class="line">9288</span><br><span class="line">9289</span><br><span class="line">9290</span><br><span class="line">9291</span><br><span class="line">9292</span><br><span class="line">9293</span><br><span class="line">9294</span><br><span class="line">9295</span><br><span class="line">9296</span><br><span class="line">9297</span><br><span class="line">9298</span><br><span class="line">9299</span><br><span class="line">9300</span><br><span class="line">9301</span><br><span class="line">9302</span><br><span class="line">9303</span><br><span class="line">9304</span><br><span class="line">9305</span><br><span class="line">9306</span><br><span class="line">9307</span><br><span class="line">9308</span><br><span class="line">9309</span><br><span class="line">9310</span><br><span class="line">9311</span><br><span class="line">9312</span><br><span class="line">9313</span><br><span class="line">9314</span><br><span class="line">9315</span><br><span class="line">9316</span><br><span class="line">9317</span><br><span class="line">9318</span><br><span class="line">9319</span><br><span class="line">9320</span><br><span class="line">9321</span><br><span class="line">9322</span><br><span class="line">9323</span><br><span class="line">9324</span><br><span class="line">9325</span><br><span class="line">9326</span><br><span class="line">9327</span><br><span class="line">9328</span><br><span class="line">9329</span><br><span class="line">9330</span><br><span class="line">9331</span><br><span class="line">9332</span><br><span class="line">9333</span><br><span class="line">9334</span><br><span class="line">9335</span><br><span class="line">9336</span><br><span class="line">9337</span><br><span class="line">9338</span><br><span class="line">9339</span><br><span class="line">9340</span><br><span class="line">9341</span><br><span class="line">9342</span><br><span class="line">9343</span><br><span class="line">9344</span><br><span class="line">9345</span><br><span class="line">9346</span><br><span class="line">9347</span><br><span class="line">9348</span><br><span class="line">9349</span><br><span class="line">9350</span><br><span class="line">9351</span><br><span class="line">9352</span><br><span class="line">9353</span><br><span class="line">9354</span><br><span class="line">9355</span><br><span class="line">9356</span><br><span class="line">9357</span><br><span class="line">9358</span><br><span class="line">9359</span><br><span class="line">9360</span><br><span class="line">9361</span><br><span class="line">9362</span><br><span class="line">9363</span><br><span class="line">9364</span><br><span class="line">9365</span><br><span class="line">9366</span><br><span class="line">9367</span><br><span class="line">9368</span><br><span class="line">9369</span><br><span class="line">9370</span><br><span class="line">9371</span><br><span class="line">9372</span><br><span class="line">9373</span><br><span class="line">9374</span><br><span class="line">9375</span><br><span class="line">9376</span><br><span class="line">9377</span><br><span class="line">9378</span><br><span class="line">9379</span><br><span class="line">9380</span><br><span class="line">9381</span><br><span class="line">9382</span><br><span class="line">9383</span><br><span class="line">9384</span><br><span class="line">9385</span><br><span class="line">9386</span><br><span class="line">9387</span><br><span class="line">9388</span><br><span class="line">9389</span><br><span class="line">9390</span><br><span class="line">9391</span><br><span class="line">9392</span><br><span class="line">9393</span><br><span class="line">9394</span><br><span class="line">9395</span><br><span class="line">9396</span><br><span class="line">9397</span><br><span class="line">9398</span><br><span class="line">9399</span><br><span class="line">9400</span><br><span class="line">9401</span><br><span class="line">9402</span><br><span class="line">9403</span><br><span class="line">9404</span><br><span class="line">9405</span><br><span class="line">9406</span><br><span class="line">9407</span><br><span class="line">9408</span><br><span class="line">9409</span><br><span class="line">9410</span><br><span class="line">9411</span><br><span class="line">9412</span><br><span class="line">9413</span><br><span class="line">9414</span><br><span class="line">9415</span><br><span class="line">9416</span><br><span class="line">9417</span><br><span class="line">9418</span><br><span class="line">9419</span><br><span class="line">9420</span><br><span class="line">9421</span><br><span class="line">9422</span><br><span class="line">9423</span><br><span class="line">9424</span><br><span class="line">9425</span><br><span class="line">9426</span><br><span class="line">9427</span><br><span class="line">9428</span><br><span class="line">9429</span><br><span class="line">9430</span><br><span class="line">9431</span><br><span class="line">9432</span><br><span class="line">9433</span><br><span class="line">9434</span><br><span class="line">9435</span><br><span class="line">9436</span><br><span class="line">9437</span><br><span class="line">9438</span><br><span class="line">9439</span><br><span class="line">9440</span><br><span class="line">9441</span><br><span class="line">9442</span><br><span class="line">9443</span><br><span class="line">9444</span><br><span class="line">9445</span><br><span class="line">9446</span><br><span class="line">9447</span><br><span class="line">9448</span><br><span class="line">9449</span><br><span class="line">9450</span><br><span class="line">9451</span><br><span class="line">9452</span><br><span class="line">9453</span><br><span class="line">9454</span><br><span class="line">9455</span><br><span class="line">9456</span><br><span class="line">9457</span><br><span class="line">9458</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">PROGRAM</span> zdtp_massdownload.</span><br><span class="line"><span class="comment">*======================================================================================================================</span></span><br><span class="line"><span class="comment">*  Mass download version 1.5.5.</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  PROGRAM DESCRIPTION &amp; USE</span></span><br><span class="line"><span class="comment">*  Allows a user to download programs, Functions, DD definitions, etc to the presentation server.  This version searches</span></span><br><span class="line"><span class="comment">*  recursively for nested includes and function modules, and allows you to download the resulting code as standard text</span></span><br><span class="line"><span class="comment">*  or HTML web pages within a suitable directory structure.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  You can either search by object name, using wildcards if you wish, or a combination of Author and object name.  If</span></span><br><span class="line"><span class="comment">*  you want all objects returned for a particular author then select the author name and choose the most suitable</span></span><br><span class="line"><span class="comment">*  radiobutton.  All objects will be returned if the fields to the right hand side of the radiobutton are left completely</span></span><br><span class="line"><span class="comment">*  blank.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  Compatible with R/3 Enterprise and Netweaver, for older versions of SAP you will need Direct Download version 5.xx.</span></span><br><span class="line"><span class="comment">*  This version removes the programming limitations imposed by developing across SAP releases 3 to 4.6.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*  In order to be able to download files to the SAP server you must first set up a logical filepath within transaction</span></span><br><span class="line"><span class="comment">*  'FILE', or use an existing one.  You must also create a external operating system command in SM69 called ZDTX_MKDIR. This</span></span><br><span class="line"><span class="comment">*  will then be used to create any directories needed on the SAP server</span></span><br><span class="line"></span><br><span class="line"><span class="comment">*  This program is intended to allow a person to keep a visual representation of a program for backup purposes only as</span></span><br><span class="line"><span class="comment">*  has not been designed to allow programs to be uploaded to SAP systems.</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* Author          : Copyright (C) 1998 E.G.Mellodew</span></span><br><span class="line"><span class="comment">* program contact : www.dalestech.com</span></span><br><span class="line"></span><br><span class="line"><span class="comment">* This program is free software; you can redistribute it and/or</span></span><br><span class="line"><span class="comment">* modify it under the terms of the GNU General Public License</span></span><br><span class="line"><span class="comment">* as published by the Free Software Foundation; either version 2</span></span><br><span class="line"><span class="comment">* of the License, or (at your option) any later version.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* This program is distributed in the hope that it will be useful,</span></span><br><span class="line"><span class="comment">* but WITHOUT ANY WARRANTY; without even the implied warranty of</span></span><br><span class="line"><span class="comment">* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></span><br><span class="line"><span class="comment">* GNU General Public License for more details.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* You should have received a copy of the GNU General Public License</span></span><br><span class="line"><span class="comment">* along with this program; if not, write to the Free Software</span></span><br><span class="line"><span class="comment">* Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  SAP Tables</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line">TABLES: trdir, seoclass, tfdir, enlfdir, dd02l, tadiv, dd40l, transfdesc.</span><br><span class="line"><span class="keyword">TYPE</span>-POOLS: abap, seor.</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  Types</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* text element structure</span></span><br><span class="line">TYPES: ttexttable LIKE textpool.</span><br><span class="line"><span class="comment">* GUI titles</span></span><br><span class="line">TYPES: tguititle LIKE d347t.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Message classes</span></span><br><span class="line">TYPES: BEGIN OF tmessage,</span><br><span class="line">         arbgb LIKE t100-arbgb,</span><br><span class="line">         stext LIKE t100a-stext,</span><br><span class="line">         msgnr LIKE t100-msgnr,</span><br><span class="line">         text  LIKE t100-text,</span><br><span class="line">       END OF tmessage.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Screen flow.</span></span><br><span class="line">TYPES: BEGIN OF tscreenflow,</span><br><span class="line">         screen LIKE d020s-dnum,</span><br><span class="line">         code   LIKE d022s-<span class="keyword">line</span>,</span><br><span class="line">       END OF tscreenflow.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Holds all domain texts</span></span><br><span class="line">TYPES: BEGIN OF tdomainstructure,</span><br><span class="line">         domname    <span class="keyword">TYPE</span> domname,</span><br><span class="line">         domvalue_l <span class="keyword">TYPE</span> domvalue_l,</span><br><span class="line">         domvalue_h <span class="keyword">TYPE</span> domvalue_l,</span><br><span class="line">         ddtext     <span class="keyword">TYPE</span> val_text,</span><br><span class="line">       END OF tdomainstructure.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Holds a table\structure definition</span></span><br><span class="line">TYPES: BEGIN OF tdicttablestructure,</span><br><span class="line">         fieldname LIKE dd03l-fieldname,</span><br><span class="line">         position  LIKE dd03l-position,</span><br><span class="line">         keyflag   LIKE dd03l-keyflag,</span><br><span class="line">         rollname  LIKE dd03l-rollname,</span><br><span class="line">         domname   LIKE dd03l-domname,</span><br><span class="line">         datatype  LIKE dd03l-datatype,</span><br><span class="line">         leng      LIKE dd03l-leng,</span><br><span class="line">         lowercase <span class="keyword">TYPE</span> lowercase,</span><br><span class="line">         ddtext    LIKE dd04t-ddtext,</span><br><span class="line">         idomains  <span class="keyword">TYPE</span> tdomainstructure OCCURS 0,</span><br><span class="line">       END OF tdicttablestructure.</span><br><span class="line"></span><br><span class="line"><span class="comment">*-- Holds a table type</span></span><br><span class="line">TYPES: BEGIN OF ttabletype,</span><br><span class="line">         typename   <span class="keyword">TYPE</span> ttypename,  " Name of <span class="keyword">table</span> <span class="keyword">type</span></span><br><span class="line">         rowtype    <span class="keyword">TYPE</span> ttrowtype,  " Name of row <span class="keyword">type</span> <span class="keyword">for</span> <span class="keyword">table</span> types</span><br><span class="line">         ttypkind   <span class="keyword">TYPE</span> ttypkind,   " Category of <span class="keyword">table</span> <span class="keyword">type</span> (<span class="keyword">range</span> or general <span class="keyword">table</span> <span class="keyword">type</span>)</span><br><span class="line">         range_ctyp <span class="keyword">TYPE</span> range_ctyp, " Elem. <span class="keyword">type</span> of LOW and HIGH components of a Ranges <span class="keyword">type</span></span><br><span class="line">         reftype    <span class="keyword">TYPE</span> ddreftype,  " <span class="keyword">Type</span> of Object Referenced</span><br><span class="line">         occurs     <span class="keyword">TYPE</span> ddoccurs,   " Initial <span class="keyword">Line</span> Number <span class="keyword">for</span> <span class="keyword">Table</span> Types</span><br><span class="line">         ddtext     <span class="keyword">TYPE</span> ddtext,     " Description</span><br><span class="line">       END OF ttabletype.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Holds a tables attributes + its definition</span></span><br><span class="line">TYPES: BEGIN OF tdicttable,</span><br><span class="line">         tablename  LIKE dd03l-tabname,</span><br><span class="line">         tabletitle LIKE dd02t-ddtext,</span><br><span class="line">         istructure <span class="keyword">TYPE</span> tdicttablestructure OCCURS 0,</span><br><span class="line">       END OF tdicttable.</span><br><span class="line"></span><br><span class="line">TYPES: BEGIN OF tdictfilename,</span><br><span class="line">         tablename LIKE dd03l-tabname,</span><br><span class="line">         filename  <span class="keyword">TYPE</span> string,</span><br><span class="line">       END OF tdictfilename.</span><br><span class="line"></span><br><span class="line">TYPES: BEGIN OF ttransformation,</span><br><span class="line">         xsltname LIKE trdir-name,</span><br><span class="line">         xsltdesc LIKE tftit-stext,</span><br><span class="line">         subc     LIKE trdir-subc,</span><br><span class="line">       END OF ttransformation.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Include program names</span></span><br><span class="line">TYPES: BEGIN OF tinclude,</span><br><span class="line">         includename  LIKE trdir-name,</span><br><span class="line">         includetitle LIKE tftit-stext,</span><br><span class="line">       END OF tinclude.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Exception class texts</span></span><br><span class="line">TYPES: BEGIN OF tconcept,</span><br><span class="line">         constname <span class="keyword">TYPE</span> string,</span><br><span class="line">         concept   <span class="keyword">TYPE</span> sotr_conc,</span><br><span class="line">       END OF tconcept.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Method</span></span><br><span class="line">TYPES: BEGIN OF tmethod,</span><br><span class="line">         cmpname(61),</span><br><span class="line">         descript    LIKE vseomethod-descript,</span><br><span class="line">         exposure    LIKE vseomethod-exposure,</span><br><span class="line">         methodkey   <span class="keyword">TYPE</span> string,</span><br><span class="line">       END OF tmethod.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Interfaces</span></span><br><span class="line">TYPES: BEGIN OF tinterface,</span><br><span class="line">         interfacename LIKE vseoclass-clsname,</span><br><span class="line">       END OF tinterface.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Class</span></span><br><span class="line">TYPES: BEGIN OF tclass,</span><br><span class="line">         scanned(1),</span><br><span class="line">         clsname           LIKE vseoclass-clsname,</span><br><span class="line">         descript          LIKE vseoclass-descript,</span><br><span class="line">         msg_id            LIKE vseoclass-msg_id,</span><br><span class="line">         exposure          LIKE vseoclass-exposure,</span><br><span class="line">         state             LIKE vseoclass-state,</span><br><span class="line">         clsfinal          LIKE vseoclass-clsfinal,</span><br><span class="line">         r3release         LIKE vseoclass-r3release,</span><br><span class="line">         imethods          <span class="keyword">TYPE</span> tmethod OCCURS 0,</span><br><span class="line">         idictstruct       <span class="keyword">TYPE</span> tdicttable OCCURS 0,</span><br><span class="line">         itextelements     <span class="keyword">TYPE</span> ttexttable OCCURS 0,</span><br><span class="line">         imessages         <span class="keyword">TYPE</span> tmessage OCCURS 0,</span><br><span class="line">         iinterfaces       <span class="keyword">TYPE</span> tinterface OCCURS 0,</span><br><span class="line">         iconcepts         <span class="keyword">TYPE</span> tconcept OCCURS 0,</span><br><span class="line">         itabletypes       <span class="keyword">TYPE</span> ttabletype OCCURS 0,</span><br><span class="line">         itransformations  <span class="keyword">TYPE</span> ttransformation OCCURS 0,</span><br><span class="line">         textelementkey    <span class="keyword">TYPE</span> string,</span><br><span class="line">         publicclasskey    <span class="keyword">TYPE</span> string,</span><br><span class="line">         privateclasskey   <span class="keyword">TYPE</span> string,</span><br><span class="line">         protectedclasskey <span class="keyword">TYPE</span> string,</span><br><span class="line">         typesclasskey     <span class="keyword">TYPE</span> string,</span><br><span class="line">         exceptionclass    <span class="keyword">TYPE</span> abap_bool,</span><br><span class="line">       END OF tclass.</span><br><span class="line"></span><br><span class="line"><span class="comment">* function modules</span></span><br><span class="line">TYPES: BEGIN OF tfunction,</span><br><span class="line">         functionname        LIKE tfdir-funcname,</span><br><span class="line">         functiongroup       LIKE enlfdir-area,</span><br><span class="line">         includenumber       LIKE tfdir-<span class="keyword">include</span>,</span><br><span class="line">         functionmaininclude LIKE tfdir-funcname,</span><br><span class="line">         functiontitle       LIKE tftit-stext,</span><br><span class="line">         topincludename      LIKE tfdir-funcname,</span><br><span class="line">         progname            LIKE tfdir-pname,</span><br><span class="line">         programlinkname     LIKE tfdir-pname,</span><br><span class="line">         messageclass        LIKE t100-arbgb,</span><br><span class="line">         itextelements       <span class="keyword">TYPE</span> ttexttable OCCURS 0,</span><br><span class="line">         iselectiontexts     <span class="keyword">TYPE</span> ttexttable OCCURS 0,</span><br><span class="line">         imessages           <span class="keyword">TYPE</span> tmessage OCCURS 0,</span><br><span class="line">         iincludes           <span class="keyword">TYPE</span> tinclude OCCURS 0,</span><br><span class="line">         idictstruct         <span class="keyword">TYPE</span> tdicttable OCCURS 0,</span><br><span class="line">         iguititle           <span class="keyword">TYPE</span> tguititle OCCURS 0,</span><br><span class="line">         iscreenflow         <span class="keyword">TYPE</span> tscreenflow OCCURS 0,</span><br><span class="line">         itabletypes         <span class="keyword">TYPE</span> ttabletype OCCURS 0,</span><br><span class="line">         itransformations    <span class="keyword">TYPE</span> ttransformation OCCURS 0,</span><br><span class="line">       END OF tfunction.</span><br><span class="line"></span><br><span class="line">TYPES: BEGIN OF tprogram,</span><br><span class="line">         progname         LIKE trdir-name,</span><br><span class="line">         programtitle     LIKE tftit-stext,</span><br><span class="line">         subc             LIKE trdir-subc,</span><br><span class="line">         messageclass     LIKE t100-arbgb,</span><br><span class="line">         imessages        <span class="keyword">TYPE</span> tmessage OCCURS 0,</span><br><span class="line">         itextelements    <span class="keyword">TYPE</span> ttexttable OCCURS 0,</span><br><span class="line">         iselectiontexts  <span class="keyword">TYPE</span> ttexttable OCCURS 0,</span><br><span class="line">         iguititle        <span class="keyword">TYPE</span> tguititle OCCURS 0,</span><br><span class="line">         iscreenflow      <span class="keyword">TYPE</span> tscreenflow OCCURS 0,</span><br><span class="line">         iincludes        <span class="keyword">TYPE</span> tinclude OCCURS 0,</span><br><span class="line">         idictstruct      <span class="keyword">TYPE</span> tdicttable OCCURS 0,</span><br><span class="line">         itabletypes      <span class="keyword">TYPE</span> ttabletype OCCURS 0,</span><br><span class="line">         itransformations <span class="keyword">TYPE</span> ttransformation OCCURS 0,</span><br><span class="line">       END OF tprogram.</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  Internal tables</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  Dictionary object</span></span><br><span class="line">DATA: idictionary <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF tdicttable WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line"><span class="comment">*  Dictionary objects which have previously been downloaded</span></span><br><span class="line">DATA: idictfilename <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF tdictfilename WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line"><span class="comment">*  Table Types</span></span><br><span class="line">DATA: itabletypes <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF ttabletype WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line"><span class="comment">*  Table Type objects which have previously been downloaded</span></span><br><span class="line">DATA: itabletypefilename <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF tdictfilename WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line"><span class="comment">* Function modules.</span></span><br><span class="line">DATA: ifunctions <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF tfunction WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line"><span class="comment">* Function modules used within programs.</span></span><br><span class="line">DATA: iprogfunctions <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF tfunction WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line"><span class="comment">* Tree display structure.</span></span><br><span class="line">DATA: itreedisplay <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF snodetext WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line"><span class="comment">* Message class data</span></span><br><span class="line">DATA: imessages <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF tmessage WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line"><span class="comment">* Holds a single message class an all of its messages</span></span><br><span class="line">DATA: isinglemessageclass <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF tmessage WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line"><span class="comment">* Holds program related data</span></span><br><span class="line">DATA: iprograms <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF tprogram WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line"><span class="comment">* Classes</span></span><br><span class="line">DATA: iclasses <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF tclass WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line"><span class="comment">* Table of paths created on the SAP server</span></span><br><span class="line">DATA: iserverpaths <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF string WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line"><span class="comment">* Table of XSL Transformations</span></span><br><span class="line">DATA: itransformations <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF ttransformation WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  Table prototypes</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line">DATA: dumidictstructure <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF tdicttablestructure.</span><br><span class="line">DATA: dumitexttab <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF ttexttable.</span><br><span class="line">DATA: dumiincludes <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF tinclude.</span><br><span class="line">DATA: dumihtml <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF string.</span><br><span class="line">DATA: dumiheader <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF string .</span><br><span class="line">DATA: dumiscreen <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF tscreenflow .</span><br><span class="line">DATA: dumiguititle <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF tguititle.</span><br><span class="line">DATA: dumimethods <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF tmethod.</span><br><span class="line">DATA: dumiconcepts <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF tconcept.</span><br><span class="line">DATA: dumiinterfaces <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF tinterface.</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*   Global objects</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line">DATA: objfile <span class="keyword">TYPE</span> REF TO cl_gui_frontend_services.</span><br><span class="line">DATA: objruntimeerror <span class="keyword">TYPE</span> REF TO cx_root.</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  Constants</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line">CONSTANTS: versionno <span class="keyword">TYPE</span> string VALUE '1.5.5'.</span><br><span class="line">CONSTANTS: tables <span class="keyword">TYPE</span> string VALUE 'TABLES'.</span><br><span class="line">CONSTANTS: <span class="keyword">table</span> <span class="keyword">TYPE</span> string VALUE '<span class="keyword">TABLE</span>'.</span><br><span class="line">CONSTANTS: like <span class="keyword">TYPE</span> string VALUE 'LIKE'.</span><br><span class="line">CONSTANTS: <span class="keyword">type</span> <span class="keyword">TYPE</span> string VALUE '<span class="keyword">TYPE</span>'.</span><br><span class="line">CONSTANTS: typerefto <span class="keyword">TYPE</span> string VALUE '<span class="keyword">TYPE</span> REF TO'.</span><br><span class="line">CONSTANTS: structure <span class="keyword">TYPE</span> string VALUE 'STRUCTURE'.</span><br><span class="line">CONSTANTS: lowstructure <span class="keyword">TYPE</span> string VALUE 'structure'.</span><br><span class="line">CONSTANTS: occurs <span class="keyword">TYPE</span> string VALUE 'OCCURS'.</span><br><span class="line">CONSTANTS: function <span class="keyword">TYPE</span> string VALUE 'FUNCTION'.</span><br><span class="line">CONSTANTS: callfunction <span class="keyword">TYPE</span> string VALUE ' CALL FUNCTION'.</span><br><span class="line">CONSTANTS: message <span class="keyword">TYPE</span> string  VALUE 'MESSAGE'.</span><br><span class="line">CONSTANTS: <span class="keyword">include</span> <span class="keyword">TYPE</span> string VALUE '<span class="keyword">INCLUDE</span>'.</span><br><span class="line">CONSTANTS: transformation <span class="keyword">TYPE</span> string VALUE 'TRANSFORMATION'.</span><br><span class="line">CONSTANTS: lowinclude <span class="keyword">TYPE</span> string VALUE '<span class="keyword">include</span>'.</span><br><span class="line">CONSTANTS: destination <span class="keyword">TYPE</span> string VALUE 'DESTINATION'.</span><br><span class="line">CONSTANTS: is_table <span class="keyword">TYPE</span> string VALUE 'T'.</span><br><span class="line">CONSTANTS: is_transformation <span class="keyword">TYPE</span> string VALUE 'X'.</span><br><span class="line">CONSTANTS: is_program <span class="keyword">TYPE</span> string VALUE 'P'.</span><br><span class="line">CONSTANTS: is_screen <span class="keyword">TYPE</span> string VALUE 'S'.</span><br><span class="line">CONSTANTS: is_guititle <span class="keyword">TYPE</span> string VALUE '<span class="keyword">G</span>'.</span><br><span class="line">CONSTANTS: is_documentation <span class="keyword">TYPE</span> string VALUE '<span class="keyword">D</span>'.</span><br><span class="line">CONSTANTS: is_messageclass <span class="keyword">TYPE</span> string VALUE 'MC'.</span><br><span class="line">CONSTANTS: is_function <span class="keyword">TYPE</span> string VALUE 'F'.</span><br><span class="line">CONSTANTS: is_class <span class="keyword">TYPE</span> string VALUE 'C'.</span><br><span class="line">CONSTANTS: is_method <span class="keyword">TYPE</span> string VALUE '<span class="keyword">M</span>'.</span><br><span class="line">CONSTANTS: asterix <span class="keyword">TYPE</span> string VALUE '*'.</span><br><span class="line">CONSTANTS: comma <span class="keyword">TYPE</span> string VALUE ','.</span><br><span class="line">CONSTANTS: period <span class="keyword">TYPE</span> string VALUE '.'.</span><br><span class="line">CONSTANTS: dash <span class="keyword">TYPE</span> string VALUE '-'.</span><br><span class="line">CONSTANTS: true <span class="keyword">TYPE</span> abap_bool VALUE 'X'.</span><br><span class="line">CONSTANTS: false <span class="keyword">TYPE</span> abap_bool VALUE ''.</span><br><span class="line">CONSTANTS: lt <span class="keyword">TYPE</span> string VALUE '&amp;lt;'.</span><br><span class="line">CONSTANTS: gt <span class="keyword">TYPE</span> string VALUE '&amp;gt;'.</span><br><span class="line">CONSTANTS: unix <span class="keyword">TYPE</span> string VALUE 'UNIX'.</span><br><span class="line">CONSTANTS: non_unix <span class="keyword">TYPE</span> string VALUE 'not UNIX'.</span><br><span class="line">CONSTANTS: htmlextension <span class="keyword">TYPE</span> string VALUE 'html'.</span><br><span class="line">CONSTANTS: textextension <span class="keyword">TYPE</span> string VALUE 'txt'.</span><br><span class="line">CONSTANTS: ss_code <span class="keyword">TYPE</span> c VALUE 'C'.</span><br><span class="line">CONSTANTS: ss_table <span class="keyword">TYPE</span> c VALUE 'T'.</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  Global variables</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line">DATA: statusbarmessage(100).</span><br><span class="line">DATA: forcedexit <span class="keyword">TYPE</span> abap_bool VALUE false.</span><br><span class="line">DATA: starttime LIKE sy-uzeit.</span><br><span class="line">DATA: runtime LIKE sy-uzeit.</span><br><span class="line">DATA: downloadfileextension <span class="keyword">TYPE</span> string.</span><br><span class="line">DATA: downloadfolder <span class="keyword">TYPE</span> string.</span><br><span class="line">DATA: serverslashseparator <span class="keyword">TYPE</span> string.</span><br><span class="line">DATA: frontendslashseparator <span class="keyword">TYPE</span> string.</span><br><span class="line">DATA: slashseparatortouse <span class="keyword">TYPE</span> string.</span><br><span class="line">DATA: serverfilesystem <span class="keyword">TYPE</span> filesys_d.</span><br><span class="line">DATA: serverfolder <span class="keyword">TYPE</span> string.</span><br><span class="line">DATA: frontendopsystem <span class="keyword">TYPE</span> string.</span><br><span class="line">DATA: serveropsystem <span class="keyword">TYPE</span> string.</span><br><span class="line">DATA: customernamespace <span class="keyword">TYPE</span> string.</span><br><span class="line">RANGES: soprogramname <span class="keyword">FOR</span> trdir-name.</span><br><span class="line">RANGES: soauthor <span class="keyword">FOR</span> usr02-bname.</span><br><span class="line">RANGES: sotablenames <span class="keyword">FOR</span> dd02l-tabname.</span><br><span class="line">RANGES: sotabletypenames <span class="keyword">FOR</span> dd40l-typename.</span><br><span class="line">RANGES: sofunctionname  <span class="keyword">FOR</span> tfdir-funcname.</span><br><span class="line">RANGES: soclassname <span class="keyword">FOR</span> vseoclass-clsname.</span><br><span class="line">RANGES: sofunctiongroup <span class="keyword">FOR</span> enlfdir-area.</span><br><span class="line">RANGES: soxsltname <span class="keyword">FOR</span> tadir-obj_name.</span><br><span class="line">FIELD-SYMBOLS: &lt;wadictstruct&gt; <span class="keyword">TYPE</span> tdicttable.</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  Selection screen declaration</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* Author</span></span><br><span class="line">SELECTION-SCREEN: BEGIN OF BLOCK b1 WITH FRAME TITLE tblock1.</span><br><span class="line">SELECTION-SCREEN BEGIN OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN COMMENT 5(23) tauth.</span><br><span class="line">PARAMETERS: pauth LIKE usr02-bname <span class="keyword">MEMORY</span> ID mauth.</span><br><span class="line">SELECTION-SCREEN END OF <span class="keyword">LINE</span>.</span><br><span class="line"></span><br><span class="line">SELECTION-SCREEN BEGIN OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN COMMENT 5(36) tpmod.</span><br><span class="line">PARAMETERS: pmod <span class="keyword">AS</span> CHECKBOX.</span><br><span class="line">SELECTION-SCREEN END OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN: END OF BLOCK b1.</span><br><span class="line"></span><br><span class="line">SELECTION-SCREEN BEGIN OF BLOCK b2 WITH FRAME TITLE tblock2.</span><br><span class="line"><span class="comment">* Tables</span></span><br><span class="line">SELECTION-SCREEN BEGIN OF <span class="keyword">LINE</span>.</span><br><span class="line">PARAMETERS: rtable RADIOBUTTON GROUP r1.</span><br><span class="line">SELECTION-SCREEN COMMENT 5(15) trtable.</span><br><span class="line">SELECTION-SCREEN END OF <span class="keyword">LINE</span>.</span><br><span class="line"></span><br><span class="line">SELECTION-SCREEN BEGIN OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN COMMENT 10(15) tptable.</span><br><span class="line">SELECT-OPTIONS: sotable <span class="keyword">FOR</span> dd02l-tabname.</span><br><span class="line">SELECTION-SCREEN END OF <span class="keyword">LINE</span>.</span><br><span class="line"></span><br><span class="line">SELECTION-SCREEN BEGIN OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN COMMENT 10(79) ttnote.</span><br><span class="line">SELECTION-SCREEN END OF <span class="keyword">LINE</span>.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Table Types</span></span><br><span class="line">SELECTION-SCREEN BEGIN OF <span class="keyword">LINE</span>.</span><br><span class="line">PARAMETERS: rtabtype RADIOBUTTON GROUP r1.</span><br><span class="line">SELECTION-SCREEN COMMENT 5(15) trtabtyp.</span><br><span class="line">SELECTION-SCREEN END OF <span class="keyword">LINE</span>.</span><br><span class="line"></span><br><span class="line">SELECTION-SCREEN BEGIN OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN COMMENT 10(15) tptabtyp.</span><br><span class="line">SELECT-OPTIONS: sotabtyp <span class="keyword">FOR</span> dd40l-typename.</span><br><span class="line">SELECTION-SCREEN END OF <span class="keyword">LINE</span>.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Message classes</span></span><br><span class="line">SELECTION-SCREEN BEGIN OF <span class="keyword">LINE</span>.</span><br><span class="line">PARAMETERS: rmess RADIOBUTTON GROUP r1.</span><br><span class="line">SELECTION-SCREEN COMMENT 5(18) tpmes.</span><br><span class="line">SELECTION-SCREEN END OF <span class="keyword">LINE</span>.</span><br><span class="line"></span><br><span class="line">SELECTION-SCREEN BEGIN OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN COMMENT 10(18) tmname.</span><br><span class="line">PARAMETERS: pmname LIKE t100-arbgb <span class="keyword">MEMORY</span> ID mmname.</span><br><span class="line">SELECTION-SCREEN END OF <span class="keyword">LINE</span>.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Function modules</span></span><br><span class="line">SELECTION-SCREEN BEGIN OF <span class="keyword">LINE</span>.</span><br><span class="line">PARAMETERS: rfunc RADIOBUTTON GROUP r1.</span><br><span class="line">SELECTION-SCREEN COMMENT 5(30) trfunc.</span><br><span class="line">SELECTION-SCREEN END OF <span class="keyword">LINE</span>.</span><br><span class="line"></span><br><span class="line">SELECTION-SCREEN BEGIN OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN COMMENT 10(15) tpfname.</span><br><span class="line">SELECT-OPTIONS: sofname <span class="keyword">FOR</span> tfdir-funcname.</span><br><span class="line">SELECTION-SCREEN END OF <span class="keyword">LINE</span>.</span><br><span class="line"></span><br><span class="line">SELECTION-SCREEN BEGIN OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN COMMENT 10(15) tfgroup.</span><br><span class="line">SELECT-OPTIONS: sofgroup <span class="keyword">FOR</span> enlfdir-area.</span><br><span class="line">SELECTION-SCREEN END OF <span class="keyword">LINE</span>.</span><br><span class="line"></span><br><span class="line"><span class="comment">* XSLT</span></span><br><span class="line">SELECTION-SCREEN BEGIN OF <span class="keyword">LINE</span>.</span><br><span class="line">PARAMETERS: rxslt RADIOBUTTON GROUP r1.</span><br><span class="line">SELECTION-SCREEN COMMENT 5(30) trxslt.</span><br><span class="line">SELECTION-SCREEN END OF <span class="keyword">LINE</span>.</span><br><span class="line"></span><br><span class="line">SELECTION-SCREEN BEGIN OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN COMMENT 10(15) tpxslt.</span><br><span class="line">SELECT-OPTIONS: soxslt <span class="keyword">FOR</span> transfdesc-xsltdesc.</span><br><span class="line">SELECTION-SCREEN END OF <span class="keyword">LINE</span>.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Classes</span></span><br><span class="line">SELECTION-SCREEN BEGIN OF <span class="keyword">LINE</span>.</span><br><span class="line">PARAMETERS: rclass RADIOBUTTON GROUP r1.</span><br><span class="line">SELECTION-SCREEN COMMENT 5(30) trclass.</span><br><span class="line">SELECTION-SCREEN END OF <span class="keyword">LINE</span>.</span><br><span class="line"></span><br><span class="line">SELECTION-SCREEN BEGIN OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN COMMENT 10(15) tpcname.</span><br><span class="line">SELECT-OPTIONS: soclass <span class="keyword">FOR</span> seoclass-clsname.</span><br><span class="line">SELECTION-SCREEN END OF <span class="keyword">LINE</span>.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Programs / includes</span></span><br><span class="line">SELECTION-SCREEN BEGIN OF <span class="keyword">LINE</span>.</span><br><span class="line">PARAMETERS: rprog RADIOBUTTON GROUP r1 DEFAULT 'X'.</span><br><span class="line">SELECTION-SCREEN COMMENT 5(18) tprog.</span><br><span class="line">SELECTION-SCREEN END OF <span class="keyword">LINE</span>.</span><br><span class="line"></span><br><span class="line">SELECTION-SCREEN BEGIN OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN COMMENT 10(15) trpname.</span><br><span class="line">SELECT-OPTIONS: soprog <span class="keyword">FOR</span> trdir-name.</span><br><span class="line">SELECTION-SCREEN END OF <span class="keyword">LINE</span>.</span><br><span class="line"></span><br><span class="line">SELECTION-SCREEN SKIP.</span><br><span class="line"><span class="comment">* Language</span></span><br><span class="line">SELECTION-SCREEN BEGIN OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN COMMENT 1(27) tmlang.</span><br><span class="line">PARAMETERS: pmlang LIKE t100-sprsl DEFAULT '<span class="keyword">EN</span>'.</span><br><span class="line">SELECTION-SCREEN END OF <span class="keyword">LINE</span>.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Package</span></span><br><span class="line">SELECTION-SCREEN BEGIN OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN COMMENT 1(24) tpack.</span><br><span class="line">SELECT-OPTIONS: sopack <span class="keyword">FOR</span> tadiv-devclass.</span><br><span class="line">SELECTION-SCREEN END OF <span class="keyword">LINE</span>.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Customer objects</span></span><br><span class="line">SELECTION-SCREEN BEGIN OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN COMMENT 1(27) tcust.</span><br><span class="line">PARAMETERS: pcust <span class="keyword">AS</span> CHECKBOX DEFAULT 'X'.</span><br><span class="line">SELECTION-SCREEN END OF <span class="keyword">LINE</span>.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Alt customer name range</span></span><br><span class="line">SELECTION-SCREEN BEGIN OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN COMMENT 1(27) tnrange.</span><br><span class="line">PARAMETERS: pcname <span class="keyword">TYPE</span> namespace <span class="keyword">MEMORY</span> ID mnamespace.</span><br><span class="line">SELECTION-SCREEN END OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN: END OF BLOCK b2.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Additional things to download.</span></span><br><span class="line">SELECTION-SCREEN: BEGIN OF BLOCK b3 WITH FRAME TITLE tblock3.</span><br><span class="line">SELECTION-SCREEN BEGIN OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN COMMENT 1(33) tptext.</span><br><span class="line">PARAMETERS: ptext <span class="keyword">AS</span> CHECKBOX DEFAULT 'X' <span class="keyword">MEMORY</span> ID mtext.</span><br><span class="line">SELECTION-SCREEN END OF <span class="keyword">LINE</span>.</span><br><span class="line"></span><br><span class="line">SELECTION-SCREEN BEGIN OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN COMMENT 1(33) tmess.</span><br><span class="line">PARAMETERS: pmess <span class="keyword">AS</span> CHECKBOX DEFAULT 'X' <span class="keyword">MEMORY</span> ID mmess.</span><br><span class="line">SELECTION-SCREEN END OF <span class="keyword">LINE</span>.</span><br><span class="line"></span><br><span class="line">SELECTION-SCREEN BEGIN OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN COMMENT 1(33) tttyp.</span><br><span class="line">PARAMETERS: pttyp <span class="keyword">AS</span> CHECKBOX DEFAULT 'X' <span class="keyword">MEMORY</span> ID mttyp.</span><br><span class="line">SELECTION-SCREEN END OF <span class="keyword">LINE</span>.</span><br><span class="line"></span><br><span class="line">SELECTION-SCREEN BEGIN OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN COMMENT 1(33) txslt.</span><br><span class="line">PARAMETERS: ptrans <span class="keyword">AS</span> CHECKBOX DEFAULT 'X' <span class="keyword">MEMORY</span> ID mxslt.</span><br><span class="line">SELECTION-SCREEN END OF <span class="keyword">LINE</span>.</span><br><span class="line"></span><br><span class="line">SELECTION-SCREEN BEGIN OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN COMMENT 1(33) tpinc.</span><br><span class="line">PARAMETERS: pinc <span class="keyword">AS</span> CHECKBOX DEFAULT 'X' <span class="keyword">MEMORY</span> ID minc.</span><br><span class="line">SELECTION-SCREEN COMMENT 40(20) treci.</span><br><span class="line">PARAMETERS: preci <span class="keyword">AS</span> CHECKBOX DEFAULT 'X' <span class="keyword">MEMORY</span> ID mreci.</span><br><span class="line">SELECTION-SCREEN END OF <span class="keyword">LINE</span>.</span><br><span class="line"></span><br><span class="line">SELECTION-SCREEN BEGIN OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN COMMENT 1(33) tpfunc.</span><br><span class="line">PARAMETERS: pfunc <span class="keyword">AS</span> CHECKBOX DEFAULT 'X' <span class="keyword">MEMORY</span> ID mfunc.</span><br><span class="line">SELECTION-SCREEN COMMENT 40(20) trecf.</span><br><span class="line">PARAMETERS: precf <span class="keyword">AS</span> CHECKBOX DEFAULT 'X' <span class="keyword">MEMORY</span> ID mrecf.</span><br><span class="line">SELECTION-SCREEN END OF <span class="keyword">LINE</span>.</span><br><span class="line"></span><br><span class="line">SELECTION-SCREEN BEGIN OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN COMMENT 1(33) trecc.</span><br><span class="line">PARAMETERS: precc <span class="keyword">AS</span> CHECKBOX DEFAULT 'X' <span class="keyword">MEMORY</span> ID mrecc.</span><br><span class="line">SELECTION-SCREEN END OF <span class="keyword">LINE</span>.</span><br><span class="line"></span><br><span class="line">SELECTION-SCREEN BEGIN OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN COMMENT 1(33) tfdoc.</span><br><span class="line">PARAMETERS: pfdoc <span class="keyword">AS</span> CHECKBOX DEFAULT 'X' <span class="keyword">MEMORY</span> ID mfdoc.</span><br><span class="line">SELECTION-SCREEN END OF <span class="keyword">LINE</span>.</span><br><span class="line"></span><br><span class="line">SELECTION-SCREEN BEGIN OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN COMMENT 1(33) tcdoc.</span><br><span class="line">PARAMETERS: pcdoc <span class="keyword">AS</span> CHECKBOX DEFAULT 'X' <span class="keyword">MEMORY</span> ID mcdoc.</span><br><span class="line">SELECTION-SCREEN END OF <span class="keyword">LINE</span>.</span><br><span class="line"></span><br><span class="line">SELECTION-SCREEN BEGIN OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN COMMENT 1(33) tpscr.</span><br><span class="line">PARAMETERS: pscr <span class="keyword">AS</span> CHECKBOX DEFAULT 'X' <span class="keyword">MEMORY</span> ID mscr.</span><br><span class="line">SELECTION-SCREEN END OF <span class="keyword">LINE</span>.</span><br><span class="line"></span><br><span class="line">SELECTION-SCREEN BEGIN OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN COMMENT 1(33) tpdict.</span><br><span class="line">PARAMETERS: pdict <span class="keyword">AS</span> CHECKBOX DEFAULT 'X' <span class="keyword">MEMORY</span> ID mdict.</span><br><span class="line">SELECTION-SCREEN END OF <span class="keyword">LINE</span>.</span><br><span class="line"></span><br><span class="line">SELECTION-SCREEN BEGIN OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN COMMENT 1(33) tsortt.</span><br><span class="line">PARAMETERS: psortt <span class="keyword">AS</span> CHECKBOX DEFAULT ' ' <span class="keyword">MEMORY</span> ID msortt.</span><br><span class="line">SELECTION-SCREEN END OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN: END OF BLOCK b3.</span><br><span class="line"></span><br><span class="line"><span class="comment">* File details</span></span><br><span class="line">SELECTION-SCREEN: BEGIN OF BLOCK b4 WITH FRAME TITLE tblock4.</span><br><span class="line">SELECTION-SCREEN BEGIN OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN COMMENT 1(20) tphtml.</span><br><span class="line">PARAMETERS: phtml RADIOBUTTON GROUP g1 DEFAULT 'X'.</span><br><span class="line">SELECTION-SCREEN END OF <span class="keyword">LINE</span>.</span><br><span class="line"></span><br><span class="line">SELECTION-SCREEN BEGIN OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN COMMENT 5(29) tback.</span><br><span class="line">PARAMETERS: pback <span class="keyword">AS</span> CHECKBOX DEFAULT 'X'.</span><br><span class="line">SELECTION-SCREEN END OF <span class="keyword">LINE</span>.</span><br><span class="line"></span><br><span class="line">SELECTION-SCREEN BEGIN OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN COMMENT 1(20) tptxt.</span><br><span class="line">PARAMETERS: ptxt RADIOBUTTON GROUP g1.</span><br><span class="line">SELECTION-SCREEN END OF <span class="keyword">LINE</span>.</span><br><span class="line"></span><br><span class="line">SELECTION-SCREEN SKIP.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Download to SAP server</span></span><br><span class="line">SELECTION-SCREEN BEGIN OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN COMMENT 1(25) tserv.</span><br><span class="line">PARAMETERS: pserv RADIOBUTTON GROUP g2.</span><br><span class="line">SELECTION-SCREEN END OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN BEGIN OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN COMMENT 8(20) tspath.</span><br><span class="line">PARAMETERS: plogical LIKE filename-fileintern <span class="keyword">MEMORY</span> ID mlogical.</span><br><span class="line">SELECTION-SCREEN END OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN COMMENT /28(60) tsdpath.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Download to PC</span></span><br><span class="line">SELECTION-SCREEN BEGIN OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN COMMENT 1(25) tpc.</span><br><span class="line">PARAMETERS: ppc RADIOBUTTON GROUP g2 DEFAULT 'X'.</span><br><span class="line">SELECTION-SCREEN END OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN BEGIN OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN COMMENT 8(20) tppath.</span><br><span class="line">PARAMETERS: pfolder LIKE rlgrap-filename <span class="keyword">MEMORY</span> ID mfolder.</span><br><span class="line">SELECTION-SCREEN END OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN: END OF BLOCK b4.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Display options</span></span><br><span class="line">SELECTION-SCREEN: BEGIN OF BLOCK b5 WITH FRAME TITLE tblock5.</span><br><span class="line"><span class="comment">* Display final report</span></span><br><span class="line">SELECTION-SCREEN BEGIN OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN COMMENT 1(33) trep.</span><br><span class="line">PARAMETERS: prep <span class="keyword">AS</span> CHECKBOX DEFAULT 'X'.</span><br><span class="line">SELECTION-SCREEN END OF <span class="keyword">LINE</span>.</span><br><span class="line"><span class="comment">* Display progress messages</span></span><br><span class="line">SELECTION-SCREEN BEGIN OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN COMMENT 1(33) tpromess.</span><br><span class="line">PARAMETERS: ppromess <span class="keyword">AS</span> CHECKBOX DEFAULT 'X'.</span><br><span class="line">SELECTION-SCREEN END OF <span class="keyword">LINE</span>.</span><br><span class="line">SELECTION-SCREEN: END OF BLOCK b5.</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* Display a directory picker window</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line">AT SELECTION-SCREEN <span class="keyword">ON</span> VALUE-REQUEST <span class="keyword">FOR</span> pfolder.</span><br><span class="line"></span><br><span class="line">  DATA: objfile <span class="keyword">TYPE</span> REF TO cl_gui_frontend_services.</span><br><span class="line">  DATA: pickedfolder <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: initialfolder <span class="keyword">TYPE</span> string.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> sy-batch IS INITIAL.</span><br><span class="line">    CREATE OBJECT objfile.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">IF</span> NOT pfolder IS INITIAL.</span><br><span class="line">      initialfolder = pfolder.</span><br><span class="line">    <span class="keyword">ELSE</span>.</span><br><span class="line">      objfile-&gt;get_temp_directory( CHANGING temp_dir = initialfolder</span><br><span class="line">      EXCEPTIONS cntl_error = 1</span><br><span class="line">        error_no_gui = 2</span><br><span class="line">        not_supported_by_gui = 3 ).</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line">    objfile-&gt;directory_browse( EXPORTING initial_folder = initialfolder</span><br><span class="line">    CHANGING selected_folder = pickedfolder</span><br><span class="line">    EXCEPTIONS cntl_error = 1</span><br><span class="line">      error_no_gui = 2</span><br><span class="line">      not_supported_by_gui = 3 ).</span><br><span class="line"></span><br><span class="line">    <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line">      pfolder = pickedfolder.</span><br><span class="line">    <span class="keyword">ELSE</span>.</span><br><span class="line">      WRITE: / '<span class="keyword">An</span> <span class="keyword">error</span> has occured picking a folder'.</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line">AT SELECTION-SCREEN.</span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line">  CASE 'X'.</span><br><span class="line">    WHEN ppc.</span><br><span class="line">      <span class="keyword">IF</span> pfolder IS INITIAL.</span><br><span class="line"><span class="comment">*       User must enter a path to save to</span></span><br><span class="line">        MESSAGE e000(oo) WITH 'You must enter a <span class="keyword">file</span> path'.</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line">    WHEN pserv.</span><br><span class="line">      <span class="keyword">IF</span> plogical IS INITIAL.</span><br><span class="line"><span class="comment">*       User must enter a logical path to save to</span></span><br><span class="line">        MESSAGE e000(oo) WITH 'You must enter a logical <span class="keyword">file</span> name'.</span><br><span class="line">      ENDIF.</span><br><span class="line">  ENDCASE.</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line">AT SELECTION-SCREEN <span class="keyword">ON</span> plogical.</span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line">  <span class="keyword">IF</span> NOT pserv IS INITIAL.</span><br><span class="line">    CALL FUNCTION 'FILE_GET_NAME'</span><br><span class="line">      EXPORTING</span><br><span class="line">        logical_filename = plogical</span><br><span class="line">      IMPORTING</span><br><span class="line">        file_name        = serverfolder</span><br><span class="line">      EXCEPTIONS</span><br><span class="line">        file_not_found   = 1</span><br><span class="line">        OTHERS           = 2.</span><br><span class="line">    <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line">      <span class="keyword">IF</span> serverfolder IS INITIAL.</span><br><span class="line">        MESSAGE e000(oo) WITH '<span class="keyword">No</span> <span class="keyword">file</span> path returned from logical filename'.</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line"><span class="comment">*       Path to display on the selection screen</span></span><br><span class="line">        tsdpath = serverfolder.</span><br><span class="line"><span class="comment">*       Remove the trailing slash off the path as the subroutine buildFilename will add an extra one</span></span><br><span class="line">        SHIFT serverfolder RIGHT DELETING TRAILING serverslashseparator.</span><br><span class="line">        SHIFT serverfolder LEFT DELETING LEADING space.</span><br><span class="line">      ENDIF.</span><br><span class="line">    <span class="keyword">ELSE</span>.</span><br><span class="line">      MESSAGE e000(oo) WITH 'Logical filename does not exist'.</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">* ---------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line">AT SELECTION-SCREEN <span class="keyword">ON</span> VALUE-REQUEST <span class="keyword">FOR</span> soprog-low.</span><br><span class="line"><span class="comment">* ---------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line">  CALL FUNCTION 'REPOSITORY_INFO_SYSTEM_F4'</span><br><span class="line">    EXPORTING</span><br><span class="line">      object_type           = '<span class="keyword">PROG</span>'</span><br><span class="line">      object_name           = soprog-low</span><br><span class="line">      suppress_selection    = 'X'</span><br><span class="line">      use_alv_grid          = ''</span><br><span class="line">      without_personal_list = ''</span><br><span class="line">    IMPORTING</span><br><span class="line">      object_name_selected  = soprog-low</span><br><span class="line">    EXCEPTIONS</span><br><span class="line">      cancel                = 1.</span><br><span class="line"></span><br><span class="line"><span class="comment">* ---------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line">AT SELECTION-SCREEN <span class="keyword">ON</span> VALUE-REQUEST <span class="keyword">FOR</span> soprog-high.</span><br><span class="line"><span class="comment">* ---------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line">  CALL FUNCTION 'REPOSITORY_INFO_SYSTEM_F4'</span><br><span class="line">    EXPORTING</span><br><span class="line">      object_type           = '<span class="keyword">PROG</span>'</span><br><span class="line">      object_name           = soprog-high</span><br><span class="line">      suppress_selection    = 'X'</span><br><span class="line">      use_alv_grid          = ''</span><br><span class="line">      without_personal_list = ''</span><br><span class="line">    IMPORTING</span><br><span class="line">      object_name_selected  = soprog-high</span><br><span class="line">    EXCEPTIONS</span><br><span class="line">      cancel                = 1.</span><br><span class="line"></span><br><span class="line"><span class="comment">* ---------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line">AT SELECTION-SCREEN <span class="keyword">ON</span> VALUE-REQUEST <span class="keyword">FOR</span> soxslt-low.</span><br><span class="line"><span class="comment">* ---------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line">  CALL FUNCTION 'REPOSITORY_INFO_SYSTEM_F4'</span><br><span class="line">    EXPORTING</span><br><span class="line">      object_type           = 'XSLT'</span><br><span class="line">      object_name           = soxslt-low</span><br><span class="line">      suppress_selection    = 'X'</span><br><span class="line">      use_alv_grid          = ''</span><br><span class="line">      without_personal_list = ''</span><br><span class="line">    IMPORTING</span><br><span class="line">      object_name_selected  = soxslt-low</span><br><span class="line">    EXCEPTIONS</span><br><span class="line">      cancel                = 1.</span><br><span class="line"></span><br><span class="line"><span class="comment">* ---------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line">AT SELECTION-SCREEN <span class="keyword">ON</span> VALUE-REQUEST <span class="keyword">FOR</span> soxslt-high.</span><br><span class="line"><span class="comment">* ---------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line">  CALL FUNCTION 'REPOSITORY_INFO_SYSTEM_F4'</span><br><span class="line">    EXPORTING</span><br><span class="line">      object_type           = 'XSLT'</span><br><span class="line">      object_name           = soxslt-high</span><br><span class="line">      suppress_selection    = 'X'</span><br><span class="line">      use_alv_grid          = ''</span><br><span class="line">      without_personal_list = ''</span><br><span class="line">    IMPORTING</span><br><span class="line">      object_name_selected  = soxslt-high</span><br><span class="line">    EXCEPTIONS</span><br><span class="line">      cancel                = 1.</span><br><span class="line"></span><br><span class="line"><span class="comment">* ---------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line">AT SELECTION-SCREEN <span class="keyword">ON</span> VALUE-REQUEST <span class="keyword">FOR</span> soclass-low.</span><br><span class="line"><span class="comment">* ---------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line">  CALL FUNCTION 'F4_DD_ALLTYPES'</span><br><span class="line">    EXPORTING</span><br><span class="line">      object               = soclass-low</span><br><span class="line">      suppress_selection   = 'X'</span><br><span class="line">      display_only         = ''</span><br><span class="line">      only_types_for_clifs = 'X'</span><br><span class="line">    IMPORTING</span><br><span class="line">      result               = soclass-low.</span><br><span class="line"></span><br><span class="line"><span class="comment">* ---------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line">AT SELECTION-SCREEN <span class="keyword">ON</span> VALUE-REQUEST <span class="keyword">FOR</span> soclass-high.</span><br><span class="line"><span class="comment">* ---------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line">  CALL FUNCTION 'F4_DD_ALLTYPES'</span><br><span class="line">    EXPORTING</span><br><span class="line">      object               = soclass-high</span><br><span class="line">      suppress_selection   = 'X'</span><br><span class="line">      display_only         = ''</span><br><span class="line">      only_types_for_clifs = 'X'</span><br><span class="line">    IMPORTING</span><br><span class="line">      result               = soclass-high.</span><br><span class="line"></span><br><span class="line"><span class="comment">* ---------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line">AT SELECTION-SCREEN <span class="keyword">ON</span> VALUE-REQUEST <span class="keyword">FOR</span> sofname-low.</span><br><span class="line"><span class="comment">* ---------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line">  CALL FUNCTION 'REPOSITORY_INFO_SYSTEM_F4'</span><br><span class="line">    EXPORTING</span><br><span class="line">      object_type           = 'FUNC'</span><br><span class="line">      object_name           = sofname-low</span><br><span class="line">      suppress_selection    = 'X'</span><br><span class="line">      use_alv_grid          = ''</span><br><span class="line">      without_personal_list = ''</span><br><span class="line">    IMPORTING</span><br><span class="line">      object_name_selected  = sofname-low</span><br><span class="line">    EXCEPTIONS</span><br><span class="line">      cancel                = 1.</span><br><span class="line"></span><br><span class="line"><span class="comment">* ---------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line">AT SELECTION-SCREEN <span class="keyword">ON</span> VALUE-REQUEST <span class="keyword">FOR</span> sofname-high.</span><br><span class="line"><span class="comment">* ---------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line">  CALL FUNCTION 'REPOSITORY_INFO_SYSTEM_F4'</span><br><span class="line">    EXPORTING</span><br><span class="line">      object_type           = 'FUNC'</span><br><span class="line">      object_name           = sofname-high</span><br><span class="line">      suppress_selection    = 'X'</span><br><span class="line">      use_alv_grid          = ''</span><br><span class="line">      without_personal_list = ''</span><br><span class="line">    IMPORTING</span><br><span class="line">      object_name_selected  = sofname-high</span><br><span class="line">    EXCEPTIONS</span><br><span class="line">      cancel                = 1.</span><br><span class="line"></span><br><span class="line"><span class="comment">* ---------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line">AT SELECTION-SCREEN <span class="keyword">ON</span> VALUE-REQUEST <span class="keyword">FOR</span> sofgroup-low.</span><br><span class="line"><span class="comment">* ---------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line">  CALL FUNCTION 'REPOSITORY_INFO_SYSTEM_F4'</span><br><span class="line">    EXPORTING</span><br><span class="line">      object_type           = 'FUGR'</span><br><span class="line">      object_name           = sofgroup-low</span><br><span class="line">      suppress_selection    = 'X'</span><br><span class="line">      use_alv_grid          = ''</span><br><span class="line">      without_personal_list = ''</span><br><span class="line">    IMPORTING</span><br><span class="line">      object_name_selected  = sofgroup-low</span><br><span class="line">    EXCEPTIONS</span><br><span class="line">      cancel                = 1.</span><br><span class="line"></span><br><span class="line"><span class="comment">* ---------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line">AT SELECTION-SCREEN <span class="keyword">ON</span> VALUE-REQUEST <span class="keyword">FOR</span> sofgroup-high.</span><br><span class="line"><span class="comment">* ---------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line">  CALL FUNCTION 'REPOSITORY_INFO_SYSTEM_F4'</span><br><span class="line">    EXPORTING</span><br><span class="line">      object_type           = 'FUGR'</span><br><span class="line">      object_name           = sofgroup-high</span><br><span class="line">      suppress_selection    = 'X'</span><br><span class="line">      use_alv_grid          = ''</span><br><span class="line">      without_personal_list = ''</span><br><span class="line">    IMPORTING</span><br><span class="line">      object_name_selected  = sofgroup-high</span><br><span class="line">    EXCEPTIONS</span><br><span class="line">      cancel                = 1.</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* initialisation</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line">INITIALIZATION.</span><br><span class="line"><span class="comment">* Parameter screen texts.</span></span><br><span class="line">  tblock1 = 'Author (Optional)'.</span><br><span class="line">  tblock2 = 'Objects to download'.</span><br><span class="line">  tblock3 = 'Additional downloads <span class="keyword">for</span> programs, function modules and classes'.</span><br><span class="line">  tblock4 = 'Download parameters'.</span><br><span class="line">  tblock5 = '<span class="keyword">Display</span> options'.</span><br><span class="line">  tauth   = 'Author name'.</span><br><span class="line">  tpmod   = '<span class="keyword">Include</span> programs modified <span class="keyword">by</span> author'.</span><br><span class="line">  tcust   = 'Only customer objects'.</span><br><span class="line">  tnrange = 'Alt customer name <span class="keyword">range</span>'.</span><br><span class="line">  trtable = 'Tables / Structures'.</span><br><span class="line">  trtabtyp = '<span class="keyword">Table</span> types'.</span><br><span class="line">  tptable = '<span class="keyword">Table</span> name'.</span><br><span class="line">  ttnote  = '<span class="keyword">Note</span>: tables are stored under the username of the last person who modified them'.</span><br><span class="line">  trfunc  = 'Function modules'.</span><br><span class="line">  tpfname = 'Function name'.</span><br><span class="line">  tfgroup = 'Function group'.</span><br><span class="line">  trclass  = 'Classes'.</span><br><span class="line">  tpcname = '<span class="keyword">Class</span> name'.</span><br><span class="line">  tmess   = 'Message <span class="keyword">class</span>'.</span><br><span class="line">  tmname  = '<span class="keyword">Class</span> name'.</span><br><span class="line">  tmlang  = 'Language'.</span><br><span class="line">  tprog   = 'Programs'.</span><br><span class="line">  trpname = '<span class="keyword">Program</span> name'.</span><br><span class="line">  tpack   = 'Package'.</span><br><span class="line">  tptxt   = 'Text document'.</span><br><span class="line">  tphtml  = 'HTML document'.</span><br><span class="line">  tback   = '<span class="keyword">Include</span> background colour'.</span><br><span class="line">  tptext  = 'Text elements'.</span><br><span class="line">  tpinc   = '<span class="keyword">Include</span> programs'.</span><br><span class="line">  treci   = 'Recursive <span class="keyword">search</span>'.</span><br><span class="line">  tppath  = '<span class="keyword">File</span> path'.</span><br><span class="line">  tspath  = 'Logical <span class="keyword">file</span> name'.</span><br><span class="line">  tpmes   = 'Message classes'.</span><br><span class="line">  tpfunc  = 'Function modules'.</span><br><span class="line">  tfdoc    = 'Function module documentation'.</span><br><span class="line">  tcdoc    = '<span class="keyword">Class</span> documentation'.</span><br><span class="line">  trecf   = 'Recursive <span class="keyword">search</span>'.</span><br><span class="line">  trecc   = '<span class="keyword">Class</span> recursive <span class="keyword">search</span>'.</span><br><span class="line">  tpscr   = 'Screens'.</span><br><span class="line">  tpdict  = 'Dictionary structures'.</span><br><span class="line">  tsortt  = '<span class="keyword">Sort</span> <span class="keyword">table</span> fields alphabetically'.</span><br><span class="line">  tserv   = 'Download to server'.</span><br><span class="line">  tpc     = 'Download to PC'.</span><br><span class="line">  trep    = '<span class="keyword">Display</span> download <span class="keyword">report</span>'.</span><br><span class="line">  tpromess  = '<span class="keyword">Display</span> progress messages'.</span><br><span class="line">  trxslt     = 'Transformations'.</span><br><span class="line">  tpxslt    = 'XSLT Name'.</span><br><span class="line">  tttyp = '<span class="keyword">Table</span> Types'.</span><br><span class="line">  txslt = 'Transformation'.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Determine the frontend operating system type.</span></span><br><span class="line">  <span class="keyword">IF</span> sy-batch IS INITIAL.</span><br><span class="line">    PERFORM determinefrontendopsystem USING frontendslashseparator frontendopsystem.</span><br><span class="line">  ENDIF.</span><br><span class="line">  PERFORM determineserveropsystem USING serverslashseparator serverfilesystem serveropsystem.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Determine if the external command exists.  If it doesn't then disable the server input field</span></span><br><span class="line">  PERFORM findexternalcommand USING serverfilesystem.</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line">START-OF-SELECTION.</span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line">  PERFORM checkcomboboxes.</span><br><span class="line">  PERFORM fillselectionranges.</span><br><span class="line">  starttime = sy-uzeit.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Don't display status messages if we are running in the background</span></span><br><span class="line">  <span class="keyword">IF</span> NOT sy-batch IS INITIAL.</span><br><span class="line">    ppromess = ''.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Fool the HTML routines to stop them hyperlinking anything with a space in them</span></span><br><span class="line">  <span class="keyword">IF</span> pcname IS INITIAL.</span><br><span class="line">    customernamespace  = '^'.</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line">    customernamespace = pcname.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Set the file extension and output type of the file</span></span><br><span class="line">  <span class="keyword">IF</span> ptxt IS INITIAL.</span><br><span class="line">    downloadfileextension = htmlextension.</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line">    downloadfileextension = textextension.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Determine which operating slash and download directory to use</span></span><br><span class="line">  CASE 'X'.</span><br><span class="line">    WHEN ppc.</span><br><span class="line">      slashseparatortouse = frontendslashseparator.</span><br><span class="line">      downloadfolder = pfolder.</span><br><span class="line">    WHEN pserv.</span><br><span class="line">      slashseparatortouse = serverslashseparator.</span><br><span class="line">      downloadfolder = serverfolder.</span><br><span class="line">  ENDCASE.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Main program flow.</span></span><br><span class="line">  CASE 'X'.</span><br><span class="line"><span class="comment">*   Select tables</span></span><br><span class="line">    WHEN rtable.</span><br><span class="line">      PERFORM retrievetables USING idictionary[]</span><br><span class="line">            sotablenames[]</span><br><span class="line">            soauthor[]</span><br><span class="line">            sopack[].</span><br><span class="line"></span><br><span class="line">    WHEN rtabtype.</span><br><span class="line">      PERFORM retrievetabletypes USING itabletypes[]</span><br><span class="line">            sotabletypenames[]</span><br><span class="line">            soauthor[]</span><br><span class="line">            sopack[].</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Select message classes tables</span></span><br><span class="line">    WHEN rmess.</span><br><span class="line">      PERFORM retrievemessageclass USING imessages[]</span><br><span class="line">            soauthor[]      "Author</span><br><span class="line">            pmname          "Message <span class="keyword">class</span> name</span><br><span class="line">            pmlang          "Message <span class="keyword">class</span> language</span><br><span class="line">            pmod            "Modified <span class="keyword">by</span> author</span><br><span class="line">            sopack[].       "Package</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Select function modules</span></span><br><span class="line">    WHEN rfunc.</span><br><span class="line">      PERFORM retrievefunctions USING sofunctionname[]   "Function name</span><br><span class="line">            sofunctiongroup[]  "Function <span class="literal">group</span></span><br><span class="line">            ifunctions[]       "Found functions</span><br><span class="line">            soauthor[]         "Author</span><br><span class="line">            ptext              "Get text elements</span><br><span class="line">            pscr               "Get screens</span><br><span class="line">            pcust              "Customer data only</span><br><span class="line">            customernamespace  "Customer name <span class="keyword">range</span></span><br><span class="line">            sopack[].             "Package</span><br><span class="line"></span><br><span class="line"><span class="comment">*       Find Dict structures, messages, functions, includes etc.</span></span><br><span class="line">      PERFORM scanforadditionalfuncstuff USING ifunctions[]</span><br><span class="line">            preci                   "<span class="keyword">Search</span> <span class="keyword">for</span> includes recursively</span><br><span class="line">            precf                   "<span class="keyword">Search</span> <span class="keyword">for</span> functions recursively</span><br><span class="line">            pinc                    "<span class="keyword">Search</span> <span class="keyword">for</span> includes</span><br><span class="line">            pfunc                   "<span class="keyword">Search</span> <span class="keyword">for</span> functions</span><br><span class="line">            pdict                   "<span class="keyword">search</span> <span class="keyword">for</span> dictionary objects</span><br><span class="line">            pmess                   "<span class="keyword">Search</span> <span class="keyword">for</span> messages</span><br><span class="line">            ptrans                  "<span class="keyword">Search</span> <span class="keyword">for</span> transformations</span><br><span class="line">            pcust                   "Customer data only</span><br><span class="line">            customernamespace.      "Customer name <span class="keyword">range</span></span><br><span class="line"></span><br><span class="line"><span class="comment">*   Select Classes</span></span><br><span class="line">    WHEN rclass.</span><br><span class="line">      PERFORM retrieveclasses USING iclasses[]</span><br><span class="line">            ifunctions[]</span><br><span class="line">            soclassname[]       "<span class="keyword">Class</span> name</span><br><span class="line">            soauthor[]          "Author</span><br><span class="line">            customernamespace   "Customer name <span class="keyword">range</span></span><br><span class="line">            pmod                "Also modified <span class="keyword">by</span> author</span><br><span class="line">            pcust               "Customer object only</span><br><span class="line">            pmess               "Find messages</span><br><span class="line">            ptext               "Text Elements</span><br><span class="line">            pdict               "Dictionary structures</span><br><span class="line">            pfunc               "Get functions</span><br><span class="line">            pinc                "Get includes</span><br><span class="line">            ptrans</span><br><span class="line">            precf               "<span class="keyword">Search</span> recursively <span class="keyword">for</span> functions</span><br><span class="line">            preci               "<span class="keyword">Search</span> recursively <span class="keyword">for</span> includes</span><br><span class="line">            precc               "<span class="keyword">Search</span> recursively <span class="keyword">for</span> classes</span><br><span class="line">            pmlang              "Language</span><br><span class="line">            sopack[].           "Package</span><br><span class="line"></span><br><span class="line">      LOOP AT ifunctions.</span><br><span class="line"><span class="comment">*       Find Dict structures, messages, functions, includes etc.</span></span><br><span class="line">        PERFORM scanforadditionalfuncstuff USING ifunctions[]</span><br><span class="line">              preci                   "<span class="keyword">Search</span> <span class="keyword">for</span> includes recursively</span><br><span class="line">              precf                   "<span class="keyword">Search</span> <span class="keyword">for</span> functions recursively</span><br><span class="line">              pinc                    "<span class="keyword">Search</span> <span class="keyword">for</span> includes</span><br><span class="line">              pfunc                   "<span class="keyword">Search</span> <span class="keyword">for</span> functions</span><br><span class="line">              pdict                   "<span class="keyword">search</span> <span class="keyword">for</span> dictionary objects</span><br><span class="line">              pmess                   "<span class="keyword">Search</span> <span class="keyword">for</span> messages</span><br><span class="line">              ptrans                  "<span class="keyword">Search</span> <span class="keyword">for</span> transformations</span><br><span class="line">              pcust                   "Customer data only</span><br><span class="line">              customernamespace.      "Customer name <span class="keyword">range</span></span><br><span class="line">      ENDLOOP.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Select programs</span></span><br><span class="line">    WHEN rprog.</span><br><span class="line">      PERFORM retrieveprograms USING iprograms[]</span><br><span class="line">            iprogfunctions[]</span><br><span class="line">            soprogramname[]    "<span class="keyword">Program</span> name</span><br><span class="line">            soauthor[]         "Author</span><br><span class="line">            customernamespace  "Customer name <span class="keyword">range</span></span><br><span class="line">            pmod               "Also modified <span class="keyword">by</span> author</span><br><span class="line">            pcust              "Customer object only</span><br><span class="line">            pmess              "Find messages</span><br><span class="line">            ptext              "Text Elements</span><br><span class="line">            pdict              "Dictionay structures</span><br><span class="line">            pfunc              "Get functions</span><br><span class="line">            pinc               "Get includes</span><br><span class="line">            pscr               "Get screens</span><br><span class="line">            ptrans             "Get Transformations</span><br><span class="line">            precf              "<span class="keyword">Search</span> recursively <span class="keyword">for</span> functions</span><br><span class="line">            preci              "<span class="keyword">Search</span> recursively <span class="keyword">for</span> includes</span><br><span class="line">            sopack[].             "Package</span><br><span class="line"></span><br><span class="line">    WHEN rxslt.</span><br><span class="line">      PERFORM retrievexslt USING itransformations[]</span><br><span class="line">            soxsltname[]           "XSL Transformation name</span><br><span class="line">            soauthor[]             "Author</span><br><span class="line">            customernamespace      "Customer name <span class="keyword">range</span></span><br><span class="line">            pmod                   "Also modified <span class="keyword">by</span> author</span><br><span class="line">            pcust                  "Customer object only</span><br><span class="line">            sopack[].              "Package</span><br><span class="line"></span><br><span class="line">  ENDCASE.</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line">END-OF-SELECTION.</span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line">  <span class="keyword">IF</span> forcedexit = 0.</span><br><span class="line"><span class="comment">*   Decide what to download</span></span><br><span class="line">    CASE 'X'.</span><br><span class="line"><span class="comment">*     Download tables</span></span><br><span class="line">      WHEN rtable.</span><br><span class="line">        <span class="keyword">IF</span> NOT ( idictionary[] IS INITIAL ).</span><br><span class="line">          PERFORM downloadddstructures USING idictionary[]</span><br><span class="line">                idictfilename[]</span><br><span class="line">                downloadfolder</span><br><span class="line">                htmlextension</span><br><span class="line">                space</span><br><span class="line">                psortt</span><br><span class="line">                slashseparatortouse</span><br><span class="line">                pserv</span><br><span class="line">                ppromess</span><br><span class="line">                serverfilesystem</span><br><span class="line">                pback.</span><br><span class="line">        ENDIF.</span><br><span class="line"></span><br><span class="line">      WHEN rtabtype.</span><br><span class="line">        <span class="keyword">IF</span> NOT ( itabletypes[] IS INITIAL ).</span><br><span class="line">          PERFORM downloadddtabletypes USING itabletypes[]</span><br><span class="line">                itabletypefilename[]</span><br><span class="line">                downloadfolder</span><br><span class="line">                htmlextension</span><br><span class="line">                space</span><br><span class="line">                psortt</span><br><span class="line">                slashseparatortouse</span><br><span class="line">                pserv</span><br><span class="line">                ppromess</span><br><span class="line">                serverfilesystem</span><br><span class="line">                pback.</span><br><span class="line">        ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*     Download message class</span></span><br><span class="line">      WHEN rmess.</span><br><span class="line">        <span class="keyword">IF</span> NOT ( imessages[] IS INITIAL ).</span><br><span class="line">          <span class="keyword">SORT</span> imessages ASCENDING <span class="keyword">BY</span> arbgb msgnr.</span><br><span class="line">          LOOP AT imessages.</span><br><span class="line">            <span class="keyword">APPEND</span> imessages TO isinglemessageclass.</span><br><span class="line">            AT END OF arbgb.</span><br><span class="line">              PERFORM downloadmessageclass USING isinglemessageclass[]</span><br><span class="line">                    imessages-arbgb</span><br><span class="line">                    downloadfolder</span><br><span class="line">                    downloadfileextension</span><br><span class="line">                    phtml</span><br><span class="line">                    space</span><br><span class="line">                    customernamespace</span><br><span class="line">                    pinc</span><br><span class="line">                    pdict</span><br><span class="line">                    pmess</span><br><span class="line">                    slashseparatortouse</span><br><span class="line">                    pserv</span><br><span class="line">                    ppromess</span><br><span class="line">                    serverfilesystem</span><br><span class="line">                    pback.</span><br><span class="line">              <span class="keyword">CLEAR</span> isinglemessageclass[].</span><br><span class="line">            ENDAT.</span><br><span class="line">          ENDLOOP.</span><br><span class="line">        ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*     Download functions</span></span><br><span class="line">      WHEN rfunc.</span><br><span class="line">        <span class="keyword">IF</span> NOT ( ifunctions[] IS INITIAL ).</span><br><span class="line">          PERFORM downloadfunctions USING ifunctions[]</span><br><span class="line">                idictfilename[]</span><br><span class="line">                itabletypefilename[]</span><br><span class="line">                downloadfolder</span><br><span class="line">                downloadfileextension</span><br><span class="line">                space</span><br><span class="line">                pfdoc</span><br><span class="line">                phtml</span><br><span class="line">                customernamespace</span><br><span class="line">                pinc</span><br><span class="line">                pdict</span><br><span class="line">                textextension</span><br><span class="line">                htmlextension</span><br><span class="line">                psortt</span><br><span class="line">                slashseparatortouse</span><br><span class="line">                pserv</span><br><span class="line">                ppromess</span><br><span class="line">                serverfilesystem</span><br><span class="line">                pback.</span><br><span class="line">        ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*     Download Classes</span></span><br><span class="line">      WHEN rclass.</span><br><span class="line">        <span class="keyword">IF</span> NOT ( iclasses[] IS INITIAL ).</span><br><span class="line">          PERFORM downloadclasses USING iclasses[]</span><br><span class="line">                ifunctions[]</span><br><span class="line">                idictfilename[]</span><br><span class="line">                itabletypefilename[]</span><br><span class="line">                downloadfolder</span><br><span class="line">                downloadfileextension</span><br><span class="line">                htmlextension</span><br><span class="line">                textextension</span><br><span class="line">                phtml</span><br><span class="line">                customernamespace</span><br><span class="line">                pinc</span><br><span class="line">                pdict</span><br><span class="line">                pcdoc</span><br><span class="line">                psortt</span><br><span class="line">                slashseparatortouse</span><br><span class="line">                pserv</span><br><span class="line">                ppromess</span><br><span class="line">                serverfilesystem</span><br><span class="line">                pback.</span><br><span class="line">        ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*     Download programs</span></span><br><span class="line">      WHEN rprog.</span><br><span class="line">        <span class="keyword">IF</span> NOT ( iprograms[] IS INITIAL ).</span><br><span class="line">          PERFORM downloadprograms USING iprograms[]</span><br><span class="line">                iprogfunctions[]</span><br><span class="line">                idictfilename[]</span><br><span class="line">                itabletypefilename[]</span><br><span class="line">                downloadfolder</span><br><span class="line">                downloadfileextension</span><br><span class="line">                htmlextension</span><br><span class="line">                textextension</span><br><span class="line">                phtml</span><br><span class="line">                customernamespace</span><br><span class="line">                pinc</span><br><span class="line">                pdict</span><br><span class="line">                '' "Documentation</span><br><span class="line">                psortt</span><br><span class="line">                slashseparatortouse</span><br><span class="line">                pserv</span><br><span class="line">                ppromess</span><br><span class="line">                serverfilesystem</span><br><span class="line">                pback.</span><br><span class="line">        ENDIF.</span><br><span class="line"></span><br><span class="line">      WHEN rxslt.</span><br><span class="line">        <span class="keyword">IF</span> NOT ( itransformations[] IS INITIAL ).</span><br><span class="line">          PERFORM downloadxslt USING itransformations[]</span><br><span class="line">                downloadfolder</span><br><span class="line">                downloadfileextension</span><br><span class="line">                htmlextension</span><br><span class="line">                textextension</span><br><span class="line">                phtml</span><br><span class="line">                customernamespace</span><br><span class="line">                slashseparatortouse</span><br><span class="line">                pserv</span><br><span class="line">                space</span><br><span class="line">                ppromess</span><br><span class="line">                serverfilesystem</span><br><span class="line">                pback.</span><br><span class="line">        ENDIF.</span><br><span class="line">    ENDCASE.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Free all the memory IDs we may have built up in the program</span></span><br><span class="line"><span class="comment">*   Free up any memory used for caching HTML versions of objects</span></span><br><span class="line">    PERFORM freememory USING iprograms[]</span><br><span class="line">          ifunctions[]</span><br><span class="line">          iprogfunctions[]</span><br><span class="line">          idictionary[]</span><br><span class="line">          itabletypes[]</span><br><span class="line">          itransformations[].</span><br><span class="line"></span><br><span class="line">    <span class="keyword">IF</span> NOT prep IS INITIAL.</span><br><span class="line">      GET TIME.</span><br><span class="line">      runtime = sy-uzeit - starttime.</span><br><span class="line"></span><br><span class="line">      CASE 'X'.</span><br><span class="line">        WHEN rtable.</span><br><span class="line">          PERFORM filltreenodetables USING idictionary[]</span><br><span class="line">                itreedisplay[]</span><br><span class="line">                runtime.</span><br><span class="line">        WHEN rtabtype.</span><br><span class="line">          PERFORM filltreenodetabletypes USING itabletypes[]</span><br><span class="line">                itreedisplay[]</span><br><span class="line">                runtime.</span><br><span class="line"></span><br><span class="line">        WHEN rmess.</span><br><span class="line">          PERFORM filltreenodemessages USING imessages[]</span><br><span class="line">                itreedisplay[]</span><br><span class="line">                runtime.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        WHEN rfunc.</span><br><span class="line">          PERFORM filltreenodefunctions USING ifunctions[]</span><br><span class="line">                itreedisplay[]</span><br><span class="line">                runtime.</span><br><span class="line"></span><br><span class="line">        WHEN rclass.</span><br><span class="line">          PERFORM filltreenodeclasses USING iclasses[]</span><br><span class="line">                ifunctions[]</span><br><span class="line">                itreedisplay[]</span><br><span class="line">                runtime.</span><br><span class="line"></span><br><span class="line">        WHEN rprog.</span><br><span class="line">          PERFORM filltreenodeprograms USING iprograms[]</span><br><span class="line">                iprogfunctions[]</span><br><span class="line">                itreedisplay[]</span><br><span class="line">                runtime.</span><br><span class="line"></span><br><span class="line">        WHEN rxslt.</span><br><span class="line">          PERFORM filltreenodexslt USING itransformations[]</span><br><span class="line">                itreedisplay[]</span><br><span class="line">                runtime.</span><br><span class="line">      ENDCASE.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">IF</span> NOT ( itreedisplay[] IS INITIAL ).</span><br><span class="line">        PERFORM displaytree USING itreedisplay[].</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line">        statusbarmessage = '<span class="keyword">No</span> items found matching selection criteria'.</span><br><span class="line">        PERFORM displaystatus USING statusbarmessage 2.</span><br><span class="line">      ENDIF.</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Clear out all the internal tables</span></span><br><span class="line">  <span class="keyword">CLEAR</span> iprograms[].</span><br><span class="line">  <span class="keyword">CLEAR</span> ifunctions[].</span><br><span class="line">  <span class="keyword">CLEAR</span> iclasses[].</span><br><span class="line">  <span class="keyword">CLEAR</span> iprogfunctions[].</span><br><span class="line">  <span class="keyword">CLEAR</span> imessages[].</span><br><span class="line">  <span class="keyword">CLEAR</span> idictionary[].</span><br><span class="line">  <span class="keyword">CLEAR</span> idictfilename[].</span><br><span class="line">  <span class="keyword">CLEAR</span> itabletypefilename[].</span><br><span class="line">  <span class="keyword">CLEAR</span> itransformations[].</span><br><span class="line">  <span class="keyword">CLEAR</span> itabletypes[].</span><br><span class="line"></span><br><span class="line"><span class="comment">*--- Memory IDs</span></span><br><span class="line"><span class="comment">* User name</span></span><br><span class="line">  <span class="keyword">SET</span> PARAMETER ID 'MAUTH' FIELD pauth.</span><br><span class="line"><span class="comment">* Message class</span></span><br><span class="line">  <span class="keyword">SET</span> PARAMETER ID 'MMNAME' FIELD pmname.</span><br><span class="line"><span class="comment">* Customer namespace</span></span><br><span class="line">  <span class="keyword">SET</span> PARAMETER ID 'MNAMESPACE' FIELD pcname.</span><br><span class="line"><span class="comment">* Folder</span></span><br><span class="line">  <span class="keyword">SET</span> PARAMETER ID 'MFOLDER' FIELD pfolder.</span><br><span class="line"><span class="comment">* Logical filepath</span></span><br><span class="line">  <span class="keyword">SET</span> PARAMETER ID 'MLOGICAL' FIELD plogical.</span><br><span class="line"><span class="comment">* Text element checkbox</span></span><br><span class="line">  <span class="keyword">SET</span> PARAMETER ID 'MTEXT' FIELD ptext.</span><br><span class="line"><span class="comment">* Messages checkbox</span></span><br><span class="line">  <span class="keyword">SET</span> PARAMETER ID 'MMESS' FIELD pmess.</span><br><span class="line"><span class="comment">* Includes checkbox</span></span><br><span class="line">  <span class="keyword">SET</span> PARAMETER ID 'MINC' FIELD pinc.</span><br><span class="line"><span class="comment">* Recursive includes checkbox.</span></span><br><span class="line">  <span class="keyword">SET</span> PARAMETER ID 'MRECI' FIELD preci.</span><br><span class="line"><span class="comment">* Functions checkbox</span></span><br><span class="line">  <span class="keyword">SET</span> PARAMETER ID 'MFUNC' FIELD pfunc.</span><br><span class="line"><span class="comment">* Recursive functions checkbox</span></span><br><span class="line">  <span class="keyword">SET</span> PARAMETER ID 'MRECF' FIELD precf.</span><br><span class="line"><span class="comment">* Recursive classes checkbox</span></span><br><span class="line">  <span class="keyword">SET</span> PARAMETER ID 'MRECF' FIELD precc.</span><br><span class="line"><span class="comment">* Function module documentation checkbox</span></span><br><span class="line">  <span class="keyword">SET</span> PARAMETER ID 'MFDOC' FIELD pfdoc.</span><br><span class="line"><span class="comment">* Class documentation checkbox</span></span><br><span class="line">  <span class="keyword">SET</span> PARAMETER ID 'MCDOC' FIELD pcdoc.</span><br><span class="line"><span class="comment">* Screens checkbox</span></span><br><span class="line">  <span class="keyword">SET</span> PARAMETER ID 'MSCR' FIELD pscr.</span><br><span class="line"><span class="comment">* Dictionary checkbox</span></span><br><span class="line">  <span class="keyword">SET</span> PARAMETER ID 'MDICT' FIELD pdict.</span><br><span class="line"><span class="comment">* Sort table ascending checkBox</span></span><br><span class="line">  <span class="keyword">SET</span> PARAMETER ID 'MSORTT' FIELD psortt.</span><br><span class="line"><span class="comment">* Table Types checkbox</span></span><br><span class="line">  <span class="keyword">SET</span> PARAMETER ID 'MTTYP' FIELD pttyp.</span><br><span class="line"><span class="comment">* XSLT checkbox</span></span><br><span class="line">  <span class="keyword">SET</span> PARAMETER ID 'MXSLT' FIELD ptrans.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">***********************************************************************************************************************</span></span><br><span class="line"><span class="comment">***************************************************SUBROUTINES*********************************************************</span></span><br><span class="line"><span class="comment">***********************************************************************************************************************</span></span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  free memory...</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> freememory USING ilocprograms LIKE iprograms[]</span><br><span class="line">      ilocfunctions LIKE ifunctions[]</span><br><span class="line">      ilocprogfunctions LIKE iprogfunctions[]</span><br><span class="line">      ilocdictionary LIKE idictionary[]</span><br><span class="line">      iloctabletypes LIKE itabletypes[]</span><br><span class="line">      iloctransformation LIKE itransformations[] .</span><br><span class="line"></span><br><span class="line">  FIELD-SYMBOLS: &lt;wafunction&gt; LIKE <span class="keyword">LINE</span> OF ilocfunctions.</span><br><span class="line">  FIELD-SYMBOLS: &lt;waprogram&gt; LIKE <span class="keyword">LINE</span> OF ilocprograms.</span><br><span class="line">  FIELD-SYMBOLS: &lt;wadictstruct&gt; <span class="keyword">TYPE</span> tdicttable.</span><br><span class="line">  FIELD-SYMBOLS: &lt;watabletypestruct&gt; LIKE <span class="keyword">LINE</span> OF iloctabletypes.</span><br><span class="line">  FIELD-SYMBOLS: &lt;watransformation&gt; <span class="keyword">TYPE</span> ttransformation.</span><br><span class="line"></span><br><span class="line">  LOOP AT ilocfunctions ASSIGNING &lt;wafunction&gt;.</span><br><span class="line">    LOOP AT &lt;wafunction&gt;-idictstruct ASSIGNING &lt;wadictstruct&gt;.</span><br><span class="line">      FREE <span class="keyword">MEMORY</span> ID &lt;wadictstruct&gt;-tablename.</span><br><span class="line">    ENDLOOP.</span><br><span class="line">  ENDLOOP.</span><br><span class="line"></span><br><span class="line">  LOOP AT ilocprogfunctions ASSIGNING &lt;wafunction&gt;.</span><br><span class="line">    LOOP AT &lt;wafunction&gt;-idictstruct ASSIGNING &lt;wadictstruct&gt;.</span><br><span class="line">      FREE <span class="keyword">MEMORY</span> ID &lt;wadictstruct&gt;-tablename.</span><br><span class="line">    ENDLOOP.</span><br><span class="line">  ENDLOOP.</span><br><span class="line"></span><br><span class="line">  LOOP AT ilocprograms ASSIGNING &lt;waprogram&gt;.</span><br><span class="line">    LOOP AT &lt;waprogram&gt;-idictstruct ASSIGNING &lt;wadictstruct&gt;.</span><br><span class="line">      FREE <span class="keyword">MEMORY</span> ID &lt;wadictstruct&gt;-tablename.</span><br><span class="line">    ENDLOOP.</span><br><span class="line">  ENDLOOP.</span><br><span class="line"></span><br><span class="line">  LOOP AT ilocdictionary ASSIGNING &lt;wadictstruct&gt;.</span><br><span class="line">    FREE <span class="keyword">MEMORY</span> ID &lt;wadictstruct&gt;-tablename.</span><br><span class="line">  ENDLOOP.</span><br><span class="line"></span><br><span class="line">  LOOP AT iloctabletypes ASSIGNING &lt;watabletypestruct&gt;.</span><br><span class="line">    FREE <span class="keyword">MEMORY</span> ID &lt;watabletypestruct&gt;-typename.</span><br><span class="line">  ENDLOOP.</span><br><span class="line"></span><br><span class="line">  LOOP AT iloctransformation ASSIGNING &lt;watransformation&gt;.</span><br><span class="line">    FREE <span class="keyword">MEMORY</span> ID &lt;watransformation&gt;-xsltname.</span><br><span class="line">  ENDLOOP.</span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  checkComboBoxes...  Check input parameters</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> checkcomboboxes.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> pauth IS INITIAL.</span><br><span class="line">    <span class="keyword">IF</span> sopack[] IS INITIAL.</span><br><span class="line">      CASE 'X'.</span><br><span class="line">        WHEN rtable.</span><br><span class="line">          <span class="keyword">IF</span> sotable[] IS INITIAL.</span><br><span class="line">            statusbarmessage = 'You must enter either a <span class="keyword">table</span> name or author.'.</span><br><span class="line">          ENDIF.</span><br><span class="line">        WHEN rfunc.</span><br><span class="line">          <span class="keyword">IF</span> ( sofname[] IS INITIAL ) AND ( sofgroup[] IS INITIAL ).</span><br><span class="line">            <span class="keyword">IF</span> sofname[] IS INITIAL.</span><br><span class="line">              statusbarmessage = 'You must enter either a function name or author.'.</span><br><span class="line">            <span class="keyword">ELSE</span>.</span><br><span class="line">              <span class="keyword">IF</span> sofgroup[] IS INITIAL.</span><br><span class="line">                statusbarmessage = 'You must enter either a function group, or <span class="keyword">an</span> author name.'.</span><br><span class="line">              ENDIF.</span><br><span class="line">            ENDIF.</span><br><span class="line">          ENDIF.</span><br><span class="line">        WHEN rprog.</span><br><span class="line">          <span class="keyword">IF</span> soprog[] IS INITIAL.</span><br><span class="line">            statusbarmessage = 'You must enter either a <span class="keyword">program</span> name or author name.'.</span><br><span class="line">          ENDIF.</span><br><span class="line">      ENDCASE.</span><br><span class="line">    ENDIF.</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line"><span class="comment">*   Check the user name of the person objects are to be downloaded for</span></span><br><span class="line">    <span class="keyword">IF</span> pauth = 'SAP*' OR pauth = 'SAP'.</span><br><span class="line">      statusbarmessage = 'Sorry cannot download all objects <span class="keyword">for</span> SAP standard user'.</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> NOT statusbarmessage IS INITIAL.</span><br><span class="line">    PERFORM displaystatus USING statusbarmessage 3.</span><br><span class="line">    forcedexit = 1.</span><br><span class="line">    STOP.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.                                                                                "checkComboBoxes</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* fillSelectionRanges...      for selection routines</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> fillselectionranges.</span><br><span class="line"></span><br><span class="line">  DATA: strlength <span class="keyword">TYPE</span> i.</span><br><span class="line"></span><br><span class="line">  strlength = <span class="literal">strlen</span>( pcname ).</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> NOT pauth IS INITIAL.</span><br><span class="line">    soauthor-sign = 'I'.</span><br><span class="line">    soauthor-option = '<span class="keyword">EQ</span>'.</span><br><span class="line">    soauthor-low = pauth.</span><br><span class="line">    <span class="keyword">APPEND</span> soauthor.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Tables</span></span><br><span class="line">  <span class="keyword">IF</span> NOT sotable IS INITIAL.</span><br><span class="line">    sotablenames[] = sotable[].</span><br><span class="line"><span class="comment">*   Add in the customer namespace if we need to</span></span><br><span class="line">    <span class="keyword">IF</span> NOT pcname IS INITIAL.</span><br><span class="line">      LOOP AT sotablenames.</span><br><span class="line">        <span class="keyword">IF</span> sotablenames-low+0(strlength) &lt;&gt; pcname.</span><br><span class="line">          CONCATENATE pcname sotablenames-low INTO sotablenames-low.</span><br><span class="line">        ENDIF.</span><br><span class="line"></span><br><span class="line">        <span class="keyword">IF</span> sotablenames-high+0(strlength) &lt;&gt; pcname.</span><br><span class="line">          CONCATENATE pcname sotablenames-high INTO sotablenames-high.</span><br><span class="line">        ENDIF.</span><br><span class="line"></span><br><span class="line">        MODIFY sotablenames.</span><br><span class="line">      ENDLOOP.</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Function names</span></span><br><span class="line">  <span class="keyword">IF</span> NOT sofname IS INITIAL.</span><br><span class="line">    sofunctionname[] = sofname[].</span><br><span class="line"><span class="comment">*   Add in the customer namespace if we need to</span></span><br><span class="line">    <span class="keyword">IF</span> NOT pcname IS INITIAL.</span><br><span class="line">      LOOP AT sofunctionname.</span><br><span class="line">        <span class="keyword">IF</span> sofunctionname-low+0(strlength) &lt;&gt; pcname.</span><br><span class="line">          CONCATENATE pcname sofunctionname-low INTO sofunctionname-low.</span><br><span class="line">        ENDIF.</span><br><span class="line"></span><br><span class="line">        <span class="keyword">IF</span> sofunctionname-high+0(strlength) &lt;&gt; pcname.</span><br><span class="line">          CONCATENATE pcname sofunctionname-high INTO sofunctionname-high.</span><br><span class="line">        ENDIF.</span><br><span class="line"></span><br><span class="line">        MODIFY sofunctionname.</span><br><span class="line">      ENDLOOP.</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Table Types</span></span><br><span class="line">  <span class="keyword">IF</span> NOT sotabtyp IS INITIAL.</span><br><span class="line">    sotabletypenames[] = sotabtyp[].</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Add in the customer namespace if we need to</span></span><br><span class="line">    <span class="keyword">IF</span> NOT pcname IS INITIAL.</span><br><span class="line">      LOOP AT sotabletypenames.</span><br><span class="line">        <span class="keyword">IF</span> sotabletypenames-low+0(strlength) &lt;&gt; pcname.</span><br><span class="line">          CONCATENATE pcname sotabletypenames-low INTO sotabletypenames-low.</span><br><span class="line">        ENDIF.</span><br><span class="line"></span><br><span class="line">        <span class="keyword">IF</span> sotablenames-high+0(strlength) &lt;&gt; pcname.</span><br><span class="line">          CONCATENATE pcname sotabletypenames-high INTO sotabletypenames-high.</span><br><span class="line">        ENDIF.</span><br><span class="line"></span><br><span class="line">        MODIFY sotabletypenames.</span><br><span class="line">      ENDLOOP.</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Function group</span></span><br><span class="line">  <span class="keyword">IF</span> NOT sofgroup IS INITIAL.</span><br><span class="line">    sofunctiongroup[] = sofgroup[].</span><br><span class="line"><span class="comment">*   Add in the customer namespace if we need to</span></span><br><span class="line">    <span class="keyword">IF</span> NOT pcname IS INITIAL.</span><br><span class="line">      LOOP AT sofunctionname.</span><br><span class="line">        <span class="keyword">IF</span> sofunctiongroup-low+0(strlength) &lt;&gt; pcname.</span><br><span class="line">          CONCATENATE pcname sofunctiongroup-low INTO sofunctiongroup-low.</span><br><span class="line">        ENDIF.</span><br><span class="line"></span><br><span class="line">        <span class="keyword">IF</span> sofunctiongroup-high+0(strlength) &lt;&gt; pcname.</span><br><span class="line">          CONCATENATE pcname sofunctiongroup-high INTO sofunctiongroup-high.</span><br><span class="line">        ENDIF.</span><br><span class="line"></span><br><span class="line">        MODIFY sofunctiongroup.</span><br><span class="line">      ENDLOOP.</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Class names</span></span><br><span class="line">  <span class="keyword">IF</span> NOT soclass IS INITIAL.</span><br><span class="line">    soclassname[] = soclass[].</span><br><span class="line"><span class="comment">*   Add in the customer namespace if we need to</span></span><br><span class="line">    <span class="keyword">IF</span> NOT pcname IS INITIAL.</span><br><span class="line">      LOOP AT soclassname.</span><br><span class="line">        <span class="keyword">IF</span> soclassname-low+0(strlength) &lt;&gt; pcname.</span><br><span class="line">          CONCATENATE pcname soclassname-low INTO soclassname-low.</span><br><span class="line">        ENDIF.</span><br><span class="line"></span><br><span class="line">        <span class="keyword">IF</span> soclassname-high+0(strlength) &lt;&gt; pcname.</span><br><span class="line">          CONCATENATE pcname soclassname-high INTO soclassname-high.</span><br><span class="line">        ENDIF.</span><br><span class="line"></span><br><span class="line">        MODIFY soclassname.</span><br><span class="line">      ENDLOOP.</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Program names</span></span><br><span class="line">  <span class="keyword">IF</span> NOT soprog IS INITIAL.</span><br><span class="line">    soprogramname[] = soprog[].</span><br><span class="line"><span class="comment">*   Add in the customer namespace if we need to</span></span><br><span class="line">    <span class="keyword">IF</span> NOT pcname IS INITIAL.</span><br><span class="line">      LOOP AT soprogramname.</span><br><span class="line">        <span class="keyword">IF</span> soprogramname-low+0(strlength) &lt;&gt; pcname.</span><br><span class="line">          CONCATENATE pcname soprogramname-low INTO soprogramname-low.</span><br><span class="line">        ENDIF.</span><br><span class="line"></span><br><span class="line">        <span class="keyword">IF</span> soprogramname-high+0(strlength) &lt;&gt; pcname.</span><br><span class="line">          CONCATENATE pcname soprogramname-high INTO soprogramname-high.</span><br><span class="line">        ENDIF.</span><br><span class="line"></span><br><span class="line">        MODIFY soprogramname.</span><br><span class="line">      ENDLOOP.</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">* XSLT names</span></span><br><span class="line">  <span class="keyword">IF</span> NOT soxslt IS INITIAL.</span><br><span class="line">    soxsltname[] = soxslt[].</span><br><span class="line"><span class="comment">*   Add in the customer namespace if we need to</span></span><br><span class="line">    <span class="keyword">IF</span> NOT pcname IS INITIAL.</span><br><span class="line">      LOOP AT soxsltname.</span><br><span class="line">        <span class="keyword">IF</span> soxsltname-low+0(strlength) &lt;&gt; pcname.</span><br><span class="line">          CONCATENATE pcname soxsltname-low INTO soxsltname-low.</span><br><span class="line">        ENDIF.</span><br><span class="line"></span><br><span class="line">        <span class="keyword">IF</span> soxsltname-high+0(strlength) &lt;&gt; pcname.</span><br><span class="line">          CONCATENATE pcname soxsltname-high INTO soxsltname-high.</span><br><span class="line">        ENDIF.</span><br><span class="line"></span><br><span class="line">        MODIFY soxsltname.</span><br><span class="line">      ENDLOOP.</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.                                                                                          " fillSelectionRanges</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  retrieveTables...             Search for tables in dictionary</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> retrievetables USING ilocdictstructure LIKE idictionary[]</span><br><span class="line">      sotable LIKE sotable[]</span><br><span class="line">      soauthor LIKE soauthor[]</span><br><span class="line">      VALUE(solocpackage) LIKE sopack[].</span><br><span class="line"></span><br><span class="line">  DATA: idictstructure <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF tdicttable.</span><br><span class="line">  DATA: wadictstructure <span class="keyword">TYPE</span> tdicttable.</span><br><span class="line"></span><br><span class="line">  SELECT a~tabname <span class="keyword">AS</span> tablename</span><br><span class="line">  INTO CORRESPONDING FIELDS OF <span class="keyword">TABLE</span> idictstructure</span><br><span class="line">  FROM dd02l <span class="keyword">AS</span> a</span><br><span class="line">  INNER JOIN tadir <span class="keyword">AS</span> b</span><br><span class="line">  <span class="keyword">ON</span> a~tabname = b~obj_name</span><br><span class="line">  WHERE a~tabname <span class="keyword">IN</span> sotable</span><br><span class="line">  AND a~tabclass &lt;&gt; '<span class="keyword">CLUSTER</span>'</span><br><span class="line">  AND a~tabclass &lt;&gt; 'POOL'</span><br><span class="line">  AND a~tabclass &lt;&gt; '<span class="keyword">VIEW</span>'</span><br><span class="line">  AND a~as4user <span class="keyword">IN</span> soauthor</span><br><span class="line">  AND a~as4local = 'A'</span><br><span class="line">  AND b~pgmid = 'R3TR'</span><br><span class="line">  AND b~object = 'TABL'</span><br><span class="line">  AND b~devclass <span class="keyword">IN</span> solocpackage[].</span><br><span class="line"></span><br><span class="line">  LOOP AT idictstructure INTO wadictstructure.</span><br><span class="line">    PERFORM findtabledescription USING wadictstructure-tablename</span><br><span class="line">          wadictstructure-tabletitle.</span><br><span class="line"></span><br><span class="line">    PERFORM findtabledefinition USING wadictstructure-tablename</span><br><span class="line">          wadictstructure-istructure[].</span><br><span class="line"></span><br><span class="line">    <span class="keyword">APPEND</span> wadictstructure TO ilocdictstructure.</span><br><span class="line">    <span class="keyword">CLEAR</span> wadictstructure.</span><br><span class="line">  ENDLOOP.</span><br><span class="line">ENDFORM.                                                                                                "retrieveTables</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  retrieveTableTypes</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> retrievetabletypes  USING iloctabletypes      LIKE itabletypes[]</span><br><span class="line">      sotabletypenames    LIKE sotable[]</span><br><span class="line">      soauthor            LIKE soauthor[]</span><br><span class="line">      VALUE(solocpackage) LIKE sopack[].</span><br><span class="line"></span><br><span class="line">  SELECT *</span><br><span class="line">  INTO CORRESPONDING FIELDS OF <span class="keyword">TABLE</span> iloctabletypes</span><br><span class="line">  FROM dd40l <span class="keyword">AS</span> a</span><br><span class="line">  INNER JOIN dd40t <span class="keyword">AS</span> t</span><br><span class="line">  <span class="keyword">ON</span> a~typename = t~typename</span><br><span class="line">  INNER JOIN tadir <span class="keyword">AS</span> b</span><br><span class="line">  <span class="keyword">ON</span> a~typename = b~obj_name</span><br><span class="line">  WHERE a~typename <span class="keyword">IN</span> sotabletypenames</span><br><span class="line">  AND t~ddlanguage <span class="keyword">EQ</span> sy-langu</span><br><span class="line">  AND a~as4user <span class="keyword">IN</span> soauthor</span><br><span class="line">  AND a~as4local = 'A'</span><br><span class="line">  AND b~pgmid = 'R3TR'</span><br><span class="line">  AND b~object = 'TTYP'</span><br><span class="line">  AND b~devclass <span class="keyword">IN</span> solocpackage[].</span><br><span class="line"></span><br><span class="line">ENDFORM.                                                                                          " RETRIEVETABLETYPES</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  retrieveXSLT...</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> retrievexslt USING iloctransformations LIKE itransformations[]</span><br><span class="line">      rangexslt   LIKE soxsltname[]</span><br><span class="line">      rangeauthor LIKE soauthor[]</span><br><span class="line">      VALUE(custnamerange)</span><br><span class="line">      VALUE(alsomodifiedbyauthor)</span><br><span class="line">      VALUE(customerprogsonly)</span><br><span class="line">      VALUE(solocpackage) LIKE sopack[].</span><br><span class="line"></span><br><span class="line">  DATA: warangexslt LIKE <span class="keyword">LINE</span> OF rangexslt.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> rangexslt[] IS INITIAL.</span><br><span class="line"><span class="comment">*   We are finding all programs by an author</span></span><br><span class="line">    PERFORM findallxsltforauthor USING iloctransformations[]</span><br><span class="line">          rangexslt[]</span><br><span class="line">          rangeauthor[]</span><br><span class="line">          custnamerange</span><br><span class="line">          alsomodifiedbyauthor</span><br><span class="line">          customerprogsonly</span><br><span class="line">          solocpackage[].</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line">    <span class="keyword">READ</span> <span class="keyword">TABLE</span> rangexslt INDEX 1 INTO warangexslt.</span><br><span class="line">    <span class="keyword">IF</span> warangexslt-low <span class="keyword">CS</span> asterix.</span><br><span class="line">      PERFORM findxsltbywildcard USING iloctransformations[]</span><br><span class="line">            rangexslt[]</span><br><span class="line">            rangeauthor[]</span><br><span class="line">            custnamerange</span><br><span class="line">            customerprogsonly</span><br><span class="line">            solocpackage[].</span><br><span class="line">    <span class="keyword">ELSE</span>.</span><br><span class="line">      PERFORM checkxsltdoesexist USING iloctransformations[]</span><br><span class="line">            rangexslt[].</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.                                                                               "retrieveXSLT</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  findTableDescription...  Search for table description in dictionary</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> findtabledescription USING VALUE(tablename)</span><br><span class="line">      tabledescription.</span><br><span class="line"></span><br><span class="line">  SELECT SINGLE ddtext</span><br><span class="line">  FROM dd02t</span><br><span class="line">  INTO tabledescription</span><br><span class="line">  WHERE tabname = tablename</span><br><span class="line">  AND ddlanguage = pmlang.</span><br><span class="line">ENDFORM.                                                                                          "findTableDescription</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  findTableDefinition... Find the structure of a table from the SAP database.</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> findtabledefinition USING VALUE(tablename)</span><br><span class="line">      idictstruct LIKE dumidictstructure[].</span><br><span class="line"></span><br><span class="line">  DATA gotstate LIKE dcobjif-gotstate.</span><br><span class="line">  DATA: definition <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF dd03p WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: idomaindataa <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF dd07v WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: idomaindatan <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF dd07v WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: wadictstruct <span class="keyword">TYPE</span> tdicttablestructure.</span><br><span class="line">  DATA: wadomainstruct <span class="keyword">TYPE</span> tdomainstructure.</span><br><span class="line">  DATA: wadd02v_n <span class="keyword">TYPE</span> dd02v.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">CLEAR</span> idictstruct[].</span><br><span class="line"></span><br><span class="line">  CALL FUNCTION 'DD_INT_TABL_GET'</span><br><span class="line">    EXPORTING</span><br><span class="line">      tabname        = tablename</span><br><span class="line">      langu          = pmlang</span><br><span class="line">    IMPORTING</span><br><span class="line">      gotstate       = gotstate</span><br><span class="line">      dd02v_n        = wadd02v_n</span><br><span class="line">    TABLES</span><br><span class="line">      dd03p_n        = definition</span><br><span class="line">    EXCEPTIONS</span><br><span class="line">      internal_error = 1.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> sy-subrc = 0 AND NOT wadd02v_n IS INITIAL.</span><br><span class="line">    CALL FUNCTION 'DD_TABL_EXPAND'</span><br><span class="line">      EXPORTING</span><br><span class="line">        dd02v_wa          = wadd02v_n</span><br><span class="line">        mode              = 46</span><br><span class="line">        prid              = 0</span><br><span class="line">      TABLES</span><br><span class="line">        dd03p_tab         = definition</span><br><span class="line">      EXCEPTIONS</span><br><span class="line">        illegal_parameter = 1.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> sy-subrc = 0 AND gotstate = 'A'.</span><br><span class="line">    LOOP AT definition.</span><br><span class="line">      <span class="keyword">MOVE</span>-CORRESPONDING definition TO wadictstruct.</span><br><span class="line">      PERFORM removeleadingzeros CHANGING wadictstruct-position.</span><br><span class="line">      PERFORM removeleadingzeros CHANGING wadictstruct-leng.</span><br><span class="line"></span><br><span class="line"><span class="comment">*     Add any domain data</span></span><br><span class="line">      CALL FUNCTION 'DD_DOMA_GET'</span><br><span class="line">        EXPORTING</span><br><span class="line">          domain_name   = definition-domname</span><br><span class="line">          get_state     = '<span class="keyword">M</span>  '</span><br><span class="line">          langu         = pmlang</span><br><span class="line"><span class="comment">*         prid          = 0</span></span><br><span class="line">          withtext      = 'X'</span><br><span class="line">        TABLES</span><br><span class="line">          dd07v_tab_a   = idomaindataa</span><br><span class="line">          dd07v_tab_n   = idomaindatan</span><br><span class="line">        EXCEPTIONS</span><br><span class="line">          illegal_value = 1</span><br><span class="line">          op_failure    = 2.</span><br><span class="line"></span><br><span class="line">      LOOP AT idomaindataa.</span><br><span class="line">        <span class="keyword">MOVE</span>-CORRESPONDING idomaindataa TO wadomainstruct.</span><br><span class="line">        <span class="keyword">APPEND</span> wadomainstruct TO wadictstruct-idomains.</span><br><span class="line">      ENDLOOP.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">CLEAR</span> idomaindataa[].</span><br><span class="line">      <span class="keyword">APPEND</span> wadictstruct TO idictstruct.</span><br><span class="line">      <span class="keyword">CLEAR</span> wadictstruct.</span><br><span class="line">    ENDLOOP.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.                                                                                           "findTableDefinition</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  retrieveMessageClass...   Retrieve a message class from the SAP database</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> retrievemessageclass USING ilocmessages LIKE imessages[]</span><br><span class="line">      rangeauthor LIKE soauthor[]</span><br><span class="line">      VALUE(messageclassname)</span><br><span class="line">      VALUE(messageclasslang)</span><br><span class="line">      VALUE(modifiedby)</span><br><span class="line">      VALUE(solocpackage) LIKE sopack[].</span><br><span class="line"></span><br><span class="line">  DATA: wamessage <span class="keyword">TYPE</span> tmessage.</span><br><span class="line">  DATA: imclasses <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF arbgb.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> NOT messageclassname IS INITIAL.</span><br><span class="line"><span class="comment">*   Check to see if the message class exists in the package</span></span><br><span class="line">    <span class="keyword">IF</span> NOT solocpackage[] IS INITIAL.</span><br><span class="line">      SELECT obj_name <span class="keyword">AS</span> arbgb</span><br><span class="line">      INTO <span class="keyword">TABLE</span> imclasses</span><br><span class="line">      FROM tadir</span><br><span class="line">      WHERE pgmid = 'R3TR'</span><br><span class="line">      AND object = 'MSAG'</span><br><span class="line">      AND devclass <span class="keyword">IN</span> solocpackage.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">REPLACE</span> '*' WITH '%' INTO messageclassname.</span><br><span class="line">    <span class="keyword">IF</span> imclasses[] IS INITIAL.</span><br><span class="line">      SELECT t100~arbgb</span><br><span class="line">      t100~text</span><br><span class="line">      t100~msgnr</span><br><span class="line">      t100a~stext</span><br><span class="line">      APPENDING CORRESPONDING FIELDS OF <span class="keyword">TABLE</span> ilocmessages</span><br><span class="line">      FROM t100</span><br><span class="line">      INNER JOIN t100a</span><br><span class="line">      <span class="keyword">ON</span> t100a~arbgb = t100~arbgb</span><br><span class="line">      WHERE t100a~masterlang = messageclasslang</span><br><span class="line">      AND t100~sprsl = messageclasslang</span><br><span class="line">      AND t100~arbgb LIKE messageclassname</span><br><span class="line">      AND t100a~respuser <span class="keyword">IN</span> rangeauthor[].</span><br><span class="line">    <span class="keyword">ELSE</span>.</span><br><span class="line">      SELECT t100~arbgb</span><br><span class="line">      t100~text</span><br><span class="line">      t100~msgnr</span><br><span class="line">      t100a~stext</span><br><span class="line">      APPENDING CORRESPONDING FIELDS OF <span class="keyword">TABLE</span> ilocmessages</span><br><span class="line">      FROM t100</span><br><span class="line">      INNER JOIN t100a</span><br><span class="line">      <span class="keyword">ON</span> t100a~arbgb = t100~arbgb</span><br><span class="line">      <span class="keyword">FOR</span> ALL ENTRIES <span class="keyword">IN</span> imclasses</span><br><span class="line">      WHERE t100~sprsl = messageclasslang</span><br><span class="line">      AND ( t100~arbgb LIKE messageclassname AND t100~arbgb = imclasses-table_line )</span><br><span class="line">      AND t100a~masterlang = messageclasslang</span><br><span class="line">      AND t100a~respuser <span class="keyword">IN</span> rangeauthor[].</span><br><span class="line">    ENDIF.</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line">    <span class="keyword">IF</span> modifiedby IS INITIAL.</span><br><span class="line"><span class="comment">*       Select by author</span></span><br><span class="line">      SELECT t100~arbgb                                "#EC CI_BUFFJOIN</span><br><span class="line">      t100~msgnr</span><br><span class="line">      t100~text</span><br><span class="line">      t100a~stext</span><br><span class="line">      APPENDING CORRESPONDING FIELDS OF <span class="keyword">TABLE</span> ilocmessages</span><br><span class="line">      FROM t100</span><br><span class="line">      INNER JOIN t100a</span><br><span class="line">      <span class="keyword">ON</span> t100a~arbgb = t100~arbgb</span><br><span class="line">      INNER JOIN tadir</span><br><span class="line">      <span class="keyword">ON</span> t100~arbgb = tadir~obj_name</span><br><span class="line">      WHERE t100a~masterlang = messageclasslang</span><br><span class="line">      AND t100a~respuser <span class="keyword">IN</span> rangeauthor[]</span><br><span class="line">      AND tadir~pgmid = 'R3TR'</span><br><span class="line">      AND tadir~object = 'MSAG'</span><br><span class="line">      AND tadir~devclass <span class="keyword">IN</span> solocpackage[].</span><br><span class="line"></span><br><span class="line">    <span class="keyword">ELSE</span>.</span><br><span class="line"><span class="comment">*     Select also by the last person who modified the message class</span></span><br><span class="line">      SELECT t100~arbgb                                "#EC CI_BUFFJOIN</span><br><span class="line">      t100~msgnr</span><br><span class="line">      t100~text</span><br><span class="line">      t100a~stext</span><br><span class="line">      APPENDING CORRESPONDING FIELDS OF <span class="keyword">TABLE</span> ilocmessages</span><br><span class="line">      FROM t100</span><br><span class="line">      INNER JOIN t100a</span><br><span class="line">      <span class="keyword">ON</span> t100a~arbgb = t100~arbgb</span><br><span class="line">      INNER JOIN tadir</span><br><span class="line">      <span class="keyword">ON</span> t100~arbgb = tadir~obj_name</span><br><span class="line">      WHERE t100a~masterlang = messageclasslang</span><br><span class="line">      AND t100a~respuser <span class="keyword">IN</span> rangeauthor[]</span><br><span class="line">      AND t100a~lastuser <span class="keyword">IN</span> rangeauthor[]</span><br><span class="line">      AND tadir~pgmid = 'R3TR'</span><br><span class="line">      AND tadir~object = 'MSAG'</span><br><span class="line">      AND tadir~devclass <span class="keyword">IN</span> solocpackage[].</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.                                                                                          "retrieveMessageClass</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  retrieveFunctions...   Retrieve function modules from SAP DB.  May be called in one of two ways</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> retrievefunctions USING sofname LIKE sofunctionname[]</span><br><span class="line">      sofgroup LIKE sofunctiongroup[]</span><br><span class="line">      ilocfunctionnames LIKE ifunctions[]</span><br><span class="line">      VALUE(solocauthor) LIKE soauthor[]</span><br><span class="line">      VALUE(gettextelements)</span><br><span class="line">      VALUE(getscreens)</span><br><span class="line">      VALUE(customeronly)</span><br><span class="line">      VALUE(customernamerange)</span><br><span class="line">      VALUE(solocpackage) LIKE sopack[].</span><br><span class="line"></span><br><span class="line">  DATA: wafunctionname <span class="keyword">TYPE</span> tfunction.</span><br><span class="line">  DATA: nogroupsfound <span class="keyword">TYPE</span> abap_bool VALUE true.</span><br><span class="line">  DATA: previousfg <span class="keyword">TYPE</span> v_fdir-area.</span><br><span class="line"></span><br><span class="line"><span class="comment">* select by function name and/or function group.</span></span><br><span class="line">  SELECT a~funcname <span class="keyword">AS</span> functionname</span><br><span class="line">  a~area <span class="keyword">AS</span> functiongroup</span><br><span class="line">  INTO CORRESPONDING FIELDS OF <span class="keyword">TABLE</span> ilocfunctionnames</span><br><span class="line">  FROM v_fdir <span class="keyword">AS</span> a</span><br><span class="line">  INNER JOIN tlibv <span class="keyword">AS</span> b</span><br><span class="line">  <span class="keyword">ON</span> a~area = b~area</span><br><span class="line">  INNER JOIN tadir <span class="keyword">AS</span> c</span><br><span class="line">  <span class="keyword">ON</span> a~area = c~obj_name</span><br><span class="line">  WHERE a~funcname <span class="keyword">IN</span> sofname[]</span><br><span class="line">  AND a~area <span class="keyword">IN</span> sofgroup[]</span><br><span class="line">  AND a~generated = ''</span><br><span class="line">  AND b~uname <span class="keyword">IN</span> solocauthor[]</span><br><span class="line">  AND pgmid = 'R3TR'</span><br><span class="line">  AND object = 'FUGR'</span><br><span class="line">  AND devclass <span class="keyword">IN</span> solocpackage[]</span><br><span class="line">  <span class="keyword">ORDER</span> <span class="keyword">BY</span> a~area.</span><br><span class="line"></span><br><span class="line">  LOOP AT ilocfunctionnames INTO wafunctionname.</span><br><span class="line">    PERFORM retrievefunctiondetail USING wafunctionname-functionname</span><br><span class="line">          wafunctionname-progname</span><br><span class="line">          wafunctionname-includenumber</span><br><span class="line">          wafunctionname-functiontitle.</span><br><span class="line"></span><br><span class="line">    PERFORM findmainfunctioninclude USING wafunctionname-progname</span><br><span class="line">          wafunctionname-functiongroup</span><br><span class="line">          wafunctionname-includenumber</span><br><span class="line">          wafunctionname-functionmaininclude.</span><br><span class="line"></span><br><span class="line">    PERFORM findfunctiontopinclude USING wafunctionname-progname</span><br><span class="line">          wafunctionname-functiongroup</span><br><span class="line">          wafunctionname-topincludename.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Find all user defined includes within the function group</span></span><br><span class="line">    PERFORM scanforfunctionincludes USING wafunctionname-progname</span><br><span class="line">          customeronly</span><br><span class="line">          customernamerange</span><br><span class="line">          wafunctionname-iincludes[].</span><br><span class="line"><span class="comment">*   Find main message class</span></span><br><span class="line">    PERFORM findmainmessageclass USING wafunctionname-progname</span><br><span class="line">          wafunctionname-messageclass.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Find any screens declared within the main include</span></span><br><span class="line">    <span class="keyword">IF</span> NOT getscreens IS INITIAL.</span><br><span class="line">      <span class="keyword">IF</span> previousfg IS INITIAL OR previousfg &lt;&gt; wafunctionname-functiongroup.</span><br><span class="line">        PERFORM findfunctionscreenflow USING wafunctionname.</span><br><span class="line"></span><br><span class="line"><span class="comment">*       Search for any GUI texts</span></span><br><span class="line">        PERFORM retrieveguititles USING wafunctionname-iguititle[]</span><br><span class="line">              wafunctionname-progname.</span><br><span class="line">      ENDIF.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">IF</span> NOT gettextelements IS INITIAL.</span><br><span class="line"><span class="comment">*     Find the program texts from out of the database.</span></span><br><span class="line">      PERFORM retrieveprogramtexts USING wafunctionname-iselectiontexts[]</span><br><span class="line">            wafunctionname-itextelements[]</span><br><span class="line">            wafunctionname-progname.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line">    previousfg = wafunctionname-functiongroup.</span><br><span class="line">    MODIFY ilocfunctionnames FROM wafunctionname.</span><br><span class="line">  ENDLOOP.</span><br><span class="line">ENDFORM.                                                                                             "retrieveFunctions</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  retrieveFunctionDetail...   Retrieve function module details from SAP DB.</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> retrievefunctiondetail USING VALUE(functionname)</span><br><span class="line">      progname</span><br><span class="line">      includename</span><br><span class="line">      titletext.</span><br><span class="line"></span><br><span class="line">  SELECT SINGLE pname</span><br><span class="line">  <span class="keyword">include</span></span><br><span class="line">  FROM tfdir</span><br><span class="line">  INTO (progname, includename)</span><br><span class="line">  WHERE funcname = functionname.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line">    SELECT SINGLE stext</span><br><span class="line">    FROM tftit</span><br><span class="line">    INTO titletext</span><br><span class="line">    WHERE spras = pmlang</span><br><span class="line">    AND funcname = functionname.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.                                                                                        <span class="string">"retrieveFunctionDetail                                                                                  "</span>findFunctionTopInclude</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* scanForAdditionalFuncStuff... Search for additional things relating to functions</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> scanforadditionalfuncstuff USING ilocfunctions LIKE ifunctions[]</span><br><span class="line">      VALUE(recursiveincludes)</span><br><span class="line">      VALUE(recursivefunctions)</span><br><span class="line">      VALUE(searchforincludes)</span><br><span class="line">      VALUE(searchforfunctions)</span><br><span class="line">      VALUE(searchfordictionary)</span><br><span class="line">      VALUE(searchformessages)</span><br><span class="line">      VALUE(searchfortransformations)</span><br><span class="line">      VALUE(customeronly)</span><br><span class="line">      VALUE(customernamerange).</span><br><span class="line"></span><br><span class="line">  DATA: wafunction <span class="keyword">TYPE</span> tfunction.</span><br><span class="line">  DATA: wainclude <span class="keyword">TYPE</span> tinclude.</span><br><span class="line"></span><br><span class="line">  LOOP AT ilocfunctions INTO wafunction.</span><br><span class="line">    <span class="keyword">IF</span> NOT searchforincludes IS INITIAL.</span><br><span class="line"><span class="comment">*     Search in the main program</span></span><br><span class="line">      PERFORM scanforincludeprograms USING wafunction-progname</span><br><span class="line">            recursiveincludes</span><br><span class="line">            customeronly</span><br><span class="line">            customernamerange</span><br><span class="line">            wafunction-iincludes[].</span><br><span class="line"></span><br><span class="line"><span class="comment">*     Search in the main include</span></span><br><span class="line">      PERFORM scanforincludeprograms USING wafunction-functionmaininclude</span><br><span class="line">            recursiveincludes</span><br><span class="line">            customeronly</span><br><span class="line">            customernamerange</span><br><span class="line">            wafunction-iincludes[].</span><br><span class="line"></span><br><span class="line"><span class="comment">*     Search in the top include</span></span><br><span class="line">      PERFORM scanforincludeprograms USING wafunction-topincludename</span><br><span class="line">            recursiveincludes</span><br><span class="line">            customeronly</span><br><span class="line">            customernamerange</span><br><span class="line">            wafunction-iincludes[].</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">IF</span> NOT searchforfunctions IS INITIAL.</span><br><span class="line">      PERFORM scanforfunctions USING wafunction-functionmaininclude</span><br><span class="line">            wafunction-programlinkname</span><br><span class="line">            recursiveincludes</span><br><span class="line">            recursivefunctions</span><br><span class="line">            customeronly</span><br><span class="line">            customernamerange</span><br><span class="line">            ilocfunctions[].</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line">    MODIFY ilocfunctions FROM wafunction.</span><br><span class="line">  ENDLOOP.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  LOOP AT ilocfunctions INTO wafunction.</span><br><span class="line"><span class="comment">*   Now we have everthing perhaps we had better find all the dictionary structures</span></span><br><span class="line">    <span class="keyword">IF</span> NOT searchfordictionary IS INITIAL.</span><br><span class="line">      PERFORM scanfortables USING wafunction-progname</span><br><span class="line">            customeronly</span><br><span class="line">            customernamerange</span><br><span class="line">            wafunction-idictstruct[].</span><br><span class="line"></span><br><span class="line">      PERFORM scanforlikeortype USING wafunction-progname</span><br><span class="line">            customeronly</span><br><span class="line">            customernamerange</span><br><span class="line">            wafunction-idictstruct[]</span><br><span class="line">            wafunction-itabletypes[].</span><br><span class="line"></span><br><span class="line">      PERFORM scanfortables USING wafunction-functionmaininclude</span><br><span class="line">            customeronly</span><br><span class="line">            customernamerange</span><br><span class="line">            wafunction-idictstruct[].</span><br><span class="line"></span><br><span class="line">      PERFORM scanforlikeortype USING wafunction-functionmaininclude</span><br><span class="line">            customeronly</span><br><span class="line">            customernamerange</span><br><span class="line">            wafunction-idictstruct[]</span><br><span class="line">            wafunction-itabletypes[].</span><br><span class="line"></span><br><span class="line">      LOOP AT wafunction-iincludes INTO wainclude.</span><br><span class="line">        PERFORM scanfortables USING wainclude-includename</span><br><span class="line">              customeronly</span><br><span class="line">              customernamerange</span><br><span class="line">              wafunction-idictstruct[].</span><br><span class="line"></span><br><span class="line">        PERFORM scanforlikeortype USING wainclude-includename</span><br><span class="line">              customeronly</span><br><span class="line">              customernamerange</span><br><span class="line">              wafunction-idictstruct[]</span><br><span class="line">              wafunction-itabletypes[].</span><br><span class="line">      ENDLOOP.</span><br><span class="line"></span><br><span class="line">      MODIFY ilocfunctions FROM wafunction.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Now search for all messages</span></span><br><span class="line">    <span class="keyword">IF</span> NOT searchformessages IS INITIAL.</span><br><span class="line">      PERFORM scanformessages USING wafunction-progname</span><br><span class="line">            wafunction-messageclass</span><br><span class="line">            wafunction-imessages[].</span><br><span class="line">      MODIFY ilocfunctions FROM wafunction.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Search for TRansformations.</span></span><br><span class="line">    <span class="keyword">IF</span> NOT searchfortransformations IS INITIAL.</span><br><span class="line">      PERFORM scanfortransformations USING wafunction-progname</span><br><span class="line">            customeronly</span><br><span class="line">            customernamerange</span><br><span class="line">            wafunction-itransformations[].</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDLOOP.</span><br><span class="line">ENDFORM.                                                                                    "scanForAdditionalFuncStuff</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* scanForClasses... Search each class or method for other classes</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> scanforclasses USING VALUE(classname)</span><br><span class="line">      VALUE(classlinkname)</span><br><span class="line">      VALUE(customeronly)</span><br><span class="line">      VALUE(customernamerange)</span><br><span class="line">      ilocclasses LIKE iclasses[]</span><br><span class="line">      VALUE(solocpackage) LIKE sopack[].</span><br><span class="line"></span><br><span class="line">  DATA ilines <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF string WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: head <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: tail <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: linelength <span class="keyword">TYPE</span> i VALUE 0.</span><br><span class="line">  DATA: waline <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: waclass <span class="keyword">TYPE</span> tclass.</span><br><span class="line">  DATA: wasearchclass <span class="keyword">TYPE</span> tclass.</span><br><span class="line">  DATA: castclassname <span class="keyword">TYPE</span> <span class="keyword">program</span>.</span><br><span class="line">  DATA: exceptioncustomernamerange <span class="keyword">TYPE</span> string.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Build the name of the possible cusotmer exception classes</span></span><br><span class="line">  CONCATENATE customernamerange 'CX_' INTO  exceptioncustomernamerange.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Read the program code from the textpool.</span></span><br><span class="line">  castclassname = classname.</span><br><span class="line">  <span class="keyword">READ</span> <span class="keyword">REPORT</span> castclassname INTO ilines.</span><br><span class="line"></span><br><span class="line">  LOOP AT ilines INTO waline.</span><br><span class="line"><span class="comment">*   Find custom tables.</span></span><br><span class="line">    linelength = <span class="literal">strlen</span>( waline ).</span><br><span class="line">    <span class="keyword">IF</span> linelength &gt; 0.</span><br><span class="line">      <span class="keyword">IF</span> waline(1) = asterix.</span><br><span class="line">        <span class="keyword">CONTINUE</span>.</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">TRANSLATE</span> waline TO UPPER CASE.</span><br><span class="line"></span><br><span class="line">      FIND typerefto <span class="keyword">IN</span> waline IGNORING CASE.</span><br><span class="line">      <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line"><span class="comment">*       Have found a reference to another class</span></span><br><span class="line">        <span class="keyword">SPLIT</span> waline AT <span class="keyword">type</span> INTO head tail.</span><br><span class="line">        SHIFT tail LEFT DELETING LEADING space.</span><br><span class="line">        <span class="keyword">SPLIT</span> tail AT 'REF' INTO head tail.</span><br><span class="line">        SHIFT tail LEFT DELETING LEADING space.</span><br><span class="line">        <span class="keyword">SPLIT</span> tail AT 'TO' INTO head tail.</span><br><span class="line">        SHIFT tail LEFT DELETING LEADING space.</span><br><span class="line">        <span class="keyword">IF</span> tail <span class="keyword">CS</span> period.</span><br><span class="line">          <span class="keyword">SPLIT</span> tail AT period INTO head tail.</span><br><span class="line">        <span class="keyword">ELSE</span>.</span><br><span class="line">          <span class="keyword">IF</span> tail <span class="keyword">CS</span> comma.</span><br><span class="line">            <span class="keyword">SPLIT</span> tail AT comma INTO head tail.</span><br><span class="line">          ENDIF.</span><br><span class="line">        ENDIF.</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line"><span class="comment">*       Try and find classes which are only referenced through static mehods</span></span><br><span class="line">        FIND '=&gt;' <span class="keyword">IN</span> waline MATCH OFFSET sy-fdpos.</span><br><span class="line">        <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line">          head = waline+0(sy-fdpos).</span><br><span class="line">          SHIFT head LEFT DELETING LEADING space.</span><br><span class="line">          CONDENSE head.</span><br><span class="line">          FIND 'call method' <span class="keyword">IN</span> head IGNORING CASE.</span><br><span class="line">          <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line">            SHIFT head LEFT DELETING LEADING space.</span><br><span class="line">            <span class="keyword">SPLIT</span> head AT space INTO head tail.</span><br><span class="line">            <span class="keyword">SPLIT</span> tail AT space INTO head tail.</span><br><span class="line"><span class="comment">*           Should have the class name here</span></span><br><span class="line">            head = tail.</span><br><span class="line">          <span class="keyword">ELSE</span>.</span><br><span class="line"><span class="comment">*           Still have a class name even though it does not have the words call method in front</span></span><br><span class="line">            <span class="keyword">IF</span> waline <span class="keyword">CS</span> '='.</span><br><span class="line">              <span class="keyword">SPLIT</span> waline AT '=' INTO tail head.</span><br><span class="line">              SHIFT head LEFT DELETING LEADING space.</span><br><span class="line">              <span class="keyword">SPLIT</span> head AT '=' INTO head tail.</span><br><span class="line">            ENDIF.</span><br><span class="line">            sy-subrc = 0.</span><br><span class="line">          ENDIF.</span><br><span class="line">        ENDIF.</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line">        TRY.</span><br><span class="line">            <span class="keyword">IF</span> head+0(1) = 'Y' OR head+0(1) = 'Z' OR head <span class="keyword">CS</span> customernamerange.</span><br><span class="line"><span class="comment">*           We have found a class best append it to our class table if we do not already have it.</span></span><br><span class="line">              <span class="keyword">READ</span> <span class="keyword">TABLE</span> ilocclasses INTO wasearchclass WITH KEY clsname = head.</span><br><span class="line">              <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line">                <span class="keyword">IF</span> head+0(3) = 'CX_'</span><br><span class="line">                OR head+0(4) = 'ZCX_'</span><br><span class="line">                OR head+0(4) = 'YCX_'</span><br><span class="line">                OR head <span class="keyword">CS</span> exceptioncustomernamerange.</span><br><span class="line"></span><br><span class="line">                  waclass-exceptionclass = true.</span><br><span class="line">                ENDIF.</span><br><span class="line"></span><br><span class="line">                waclass-clsname = head.</span><br><span class="line"></span><br><span class="line"><span class="comment">*             Check the package</span></span><br><span class="line">                <span class="keyword">IF</span> NOT solocpackage[] IS INITIAL.</span><br><span class="line">                  SELECT SINGLE obj_name</span><br><span class="line">                  FROM tadir</span><br><span class="line">                  INTO waclass-clsname</span><br><span class="line">                  WHERE pgmid = 'R3TR'</span><br><span class="line">                  AND object = 'CLAS'</span><br><span class="line">                  AND obj_name = waclass-clsname</span><br><span class="line">                  AND devclass <span class="keyword">IN</span> solocpackage[].</span><br><span class="line">                  <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line">                    <span class="keyword">APPEND</span> waclass TO ilocclasses.</span><br><span class="line">                  ENDIF.</span><br><span class="line">                <span class="keyword">ELSE</span>.</span><br><span class="line">                  <span class="keyword">APPEND</span> waclass TO ilocclasses.</span><br><span class="line">                ENDIF.</span><br><span class="line">              ENDIF.</span><br><span class="line">            ENDIF.</span><br><span class="line">          CATCH cx_sy_range_out_of_bounds.</span><br><span class="line">        ENDTRY.</span><br><span class="line">      ENDIF.</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDLOOP.</span><br><span class="line">ENDFORM.                                                                                                "scanForClasses</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* scanForIncludePrograms... Search each program for include programs</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> scanforincludeprograms USING VALUE(programname)</span><br><span class="line">      VALUE(recursiveincludes)</span><br><span class="line">      VALUE(customeronly)</span><br><span class="line">      VALUE(customernamerange)</span><br><span class="line">      ilocincludes LIKE dumiincludes[].</span><br><span class="line"></span><br><span class="line">  DATA: iincludelines <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF string WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: itokens <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF stokes WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: ikeywords <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF text20 WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: istatements <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF sstmnt WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: watokens <span class="keyword">TYPE</span> stokes.</span><br><span class="line">  DATA: wainclude <span class="keyword">TYPE</span> tinclude.</span><br><span class="line">  DATA: waincludeexists <span class="keyword">TYPE</span> tinclude.</span><br><span class="line">  DATA: maxlines <span class="keyword">TYPE</span> i.</span><br><span class="line">  DATA: nextline <span class="keyword">TYPE</span> i.</span><br><span class="line">  DATA: castprogramname <span class="keyword">TYPE</span> <span class="keyword">program</span>.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Read the program code from the textpool.</span></span><br><span class="line">  castprogramname = programname.</span><br><span class="line">  <span class="keyword">READ</span> <span class="keyword">REPORT</span> castprogramname INTO iincludelines.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">APPEND</span> <span class="keyword">include</span> TO ikeywords.</span><br><span class="line">  SCAN ABAP-SOURCE iincludelines TOKENS INTO itokens WITH INCLUDES STATEMENTS INTO istatements KEYWORDS FROM ikeywords.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">CLEAR</span> iincludelines[].</span><br><span class="line"></span><br><span class="line">  maxlines = lines( itokens ).</span><br><span class="line">  LOOP AT itokens WHERE str = <span class="keyword">include</span> AND <span class="keyword">type</span> = 'I'.</span><br><span class="line">    nextline = sy-tabix + 1.</span><br><span class="line">    <span class="keyword">IF</span> nextline &lt;= maxlines.</span><br><span class="line">      <span class="keyword">READ</span> <span class="keyword">TABLE</span> itokens INDEX nextline INTO watokens.</span><br><span class="line"></span><br><span class="line"><span class="comment">*      Are we only to find customer includes?</span></span><br><span class="line">      <span class="keyword">IF</span> NOT customeronly IS INITIAL.</span><br><span class="line">        TRY.</span><br><span class="line">            <span class="keyword">IF</span> watokens-str+0(1) = 'Y' OR watokens-str+0(1) = 'Z' OR watokens-str <span class="keyword">CS</span> customernamerange</span><br><span class="line">            OR watokens-str+0(2) = 'MZ' OR watokens-str+0(2) = 'MY'.</span><br><span class="line"></span><br><span class="line">            <span class="keyword">ELSE</span>.</span><br><span class="line">              <span class="keyword">CONTINUE</span>.</span><br><span class="line">            ENDIF.</span><br><span class="line">          CATCH cx_sy_range_out_of_bounds INTO objruntimeerror.</span><br><span class="line">        ENDTRY.</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line">      wainclude-includename = watokens-str.</span><br><span class="line"></span><br><span class="line"><span class="comment">*      Best find the program title text as well.</span></span><br><span class="line">      PERFORM findprogramorincludetitle USING wainclude-includename</span><br><span class="line">            wainclude-includetitle.</span><br><span class="line"></span><br><span class="line"><span class="comment">*      Don't append the include if we already have it listed</span></span><br><span class="line">      <span class="keyword">READ</span> <span class="keyword">TABLE</span> ilocincludes INTO waincludeexists WITH KEY includename = wainclude-includename.</span><br><span class="line">      <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line">        <span class="keyword">APPEND</span> wainclude TO ilocincludes.</span><br><span class="line"></span><br><span class="line">        <span class="keyword">IF</span> NOT recursiveincludes IS INITIAL.</span><br><span class="line"><span class="comment">*          Do a recursive search for other includes</span></span><br><span class="line">          PERFORM scanforincludeprograms USING wainclude-includename</span><br><span class="line">                recursiveincludes</span><br><span class="line">                customeronly</span><br><span class="line">                customernamerange</span><br><span class="line">                ilocincludes[].</span><br><span class="line">        ENDIF.</span><br><span class="line">      ENDIF.</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDLOOP.</span><br><span class="line">ENDFORM.                                                                                        "scanForIncludePrograms</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* scanForIncludePrograms... Search each program for include programs</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> scanfortransformations USING VALUE(programname)</span><br><span class="line">      VALUE(customeronly)</span><br><span class="line">      VALUE(customernamerange)</span><br><span class="line">      iloctransformation LIKE itransformations[].</span><br><span class="line"></span><br><span class="line">  DATA: iincludelines <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF string WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: itokens <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF stokes WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: ikeywords <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF text20 WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: istatements <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF sstmnt WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: watokens <span class="keyword">TYPE</span> stokes.</span><br><span class="line">  DATA: watransformation <span class="keyword">TYPE</span> ttransformation.</span><br><span class="line">  DATA: watransformationexists <span class="keyword">TYPE</span> ttransformation.</span><br><span class="line">  DATA: maxlines <span class="keyword">TYPE</span> i.</span><br><span class="line">  DATA: nextline <span class="keyword">TYPE</span> i.</span><br><span class="line">  DATA: castprogramname <span class="keyword">TYPE</span> <span class="keyword">program</span>.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* Read the program code from the textpool.</span></span><br><span class="line">  castprogramname = programname.</span><br><span class="line">  <span class="keyword">READ</span> <span class="keyword">REPORT</span> castprogramname INTO iincludelines.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">APPEND</span> 'CALL' TO ikeywords.</span><br><span class="line">  SCAN ABAP-SOURCE iincludelines TOKENS INTO itokens WITH INCLUDES STATEMENTS INTO istatements KEYWORDS FROM ikeywords.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">CLEAR</span> iincludelines[].</span><br><span class="line"></span><br><span class="line">  maxlines = lines( itokens ).</span><br><span class="line">  LOOP AT itokens WHERE str = transformation AND <span class="keyword">type</span> = 'I'.</span><br><span class="line">    nextline = sy-tabix + 1.</span><br><span class="line">    <span class="keyword">IF</span> nextline &lt;= maxlines.</span><br><span class="line">      <span class="keyword">READ</span> <span class="keyword">TABLE</span> itokens INDEX nextline INTO watokens.</span><br><span class="line"></span><br><span class="line"><span class="comment">*      Are we only to find customer transformations?</span></span><br><span class="line">      <span class="keyword">IF</span> NOT customeronly IS INITIAL.</span><br><span class="line">        TRY.</span><br><span class="line">            <span class="keyword">IF</span> watokens-str+0(1) = 'Y' OR watokens-str+0(1) = 'Z' OR watokens-str <span class="keyword">CS</span> customernamerange.</span><br><span class="line">            <span class="keyword">ELSE</span>.</span><br><span class="line">              <span class="keyword">CONTINUE</span>.</span><br><span class="line">            ENDIF.</span><br><span class="line">          CATCH cx_sy_range_out_of_bounds INTO objruntimeerror.</span><br><span class="line">        ENDTRY.</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line">      watransformation-xsltname = watokens-str.</span><br><span class="line"></span><br><span class="line"><span class="comment">*      Don't append the include if we already have it listed</span></span><br><span class="line">      <span class="keyword">READ</span> <span class="keyword">TABLE</span> iloctransformation INTO watransformationexists WITH KEY xsltname = watransformation-xsltname.</span><br><span class="line">      <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line">        <span class="keyword">APPEND</span> watransformation TO iloctransformation.</span><br><span class="line"></span><br><span class="line">        PERFORM scanfortransincludes USING watransformation-xsltname</span><br><span class="line">              customeronly</span><br><span class="line">              customernamerange</span><br><span class="line">              iloctransformation[].</span><br><span class="line"></span><br><span class="line">      ENDIF.</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDLOOP.</span><br><span class="line">ENDFORM.                                                                                        "scanForIncludePrograms</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* scanforTransIncludes...</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> scanfortransincludes USING VALUE(xsltname)</span><br><span class="line">      VALUE(customeronly)</span><br><span class="line">      VALUE(customernamerange)</span><br><span class="line">      iloctransformations LIKE itransformations[].</span><br><span class="line"></span><br><span class="line">  DATA: ixsltsource <span class="keyword">TYPE</span> o2pageline_table.</span><br><span class="line">  DATA: waxsltattributes <span class="keyword">TYPE</span> o2xsltattr.</span><br><span class="line">  DATA: waxsltsource LIKE <span class="keyword">LINE</span> OF ixsltsource.</span><br><span class="line">  DATA: dummy <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: watransformationexists <span class="keyword">TYPE</span> ttransformation.</span><br><span class="line">  DATA: watransformation <span class="keyword">TYPE</span> ttransformation.</span><br><span class="line"></span><br><span class="line">  cl_o2_api_xsltdesc=&gt;load( EXPORTING p_xslt_desc = xsltname</span><br><span class="line">  IMPORTING p_source = ixsltsource</span><br><span class="line">    p_attributes = waxsltattributes</span><br><span class="line">  EXCEPTIONS not_existing = 1</span><br><span class="line">    permission_failure = 2</span><br><span class="line">    error_occured = 3</span><br><span class="line">    version_not_found = 4 ).</span><br><span class="line"></span><br><span class="line">  LOOP AT ixsltsource INTO waxsltsource.</span><br><span class="line">    <span class="keyword">IF</span> waxsltsource-<span class="keyword">line</span> <span class="keyword">CS</span> '&lt;xsl:<span class="keyword">include</span>'.</span><br><span class="line">      <span class="keyword">SPLIT</span> waxsltsource-<span class="keyword">line</span> AT '"' INTO dummy waxsltsource-<span class="keyword">line</span>.</span><br><span class="line">      <span class="keyword">SPLIT</span> waxsltsource-<span class="keyword">line</span> AT '"' INTO waxsltsource dummy.</span><br><span class="line"></span><br><span class="line"><span class="comment">*      Are we only to find customer transformations?</span></span><br><span class="line">      <span class="keyword">IF</span> NOT customeronly IS INITIAL.</span><br><span class="line">        TRY.</span><br><span class="line">            <span class="keyword">IF</span> waxsltsource-<span class="keyword">line</span>+0(1) = 'Y' OR waxsltsource-<span class="keyword">line</span>+0(1) = 'Z' OR waxsltsource-<span class="keyword">line</span> <span class="keyword">CS</span> customernamerange.</span><br><span class="line">            <span class="keyword">ELSE</span>.</span><br><span class="line">              <span class="keyword">CONTINUE</span>.</span><br><span class="line">            ENDIF.</span><br><span class="line">          CATCH cx_sy_range_out_of_bounds INTO objruntimeerror.</span><br><span class="line">        ENDTRY.</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*      Don't append the include if we already have it listed</span></span><br><span class="line">      <span class="keyword">READ</span> <span class="keyword">TABLE</span> iloctransformations INTO watransformationexists WITH KEY xsltname = waxsltsource-<span class="keyword">line</span>.</span><br><span class="line">      <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line">        watransformation-xsltname = waxsltsource-<span class="keyword">line</span>.</span><br><span class="line">        <span class="keyword">APPEND</span> watransformation TO iloctransformations.</span><br><span class="line"></span><br><span class="line"><span class="comment">*        Ok we have an include.  Are there any sub includes</span></span><br><span class="line">        PERFORM scanfortransincludes USING watransformation-xsltname</span><br><span class="line">              customeronly</span><br><span class="line">              customernamerange</span><br><span class="line">              iloctransformations[].</span><br><span class="line">      ENDIF.</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDLOOP.</span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* scanForFunctions... Search each program for function modules</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> scanforfunctions USING VALUE(programname)</span><br><span class="line">      VALUE(programlinkname)</span><br><span class="line">      VALUE(recursiveincludes)</span><br><span class="line">      VALUE(recursivefunctions)</span><br><span class="line">      VALUE(customeronly)</span><br><span class="line">      VALUE(customernamerange)</span><br><span class="line">      ilocfunctions LIKE ifunctions[].</span><br><span class="line"></span><br><span class="line">  DATA: iincludelines <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF string WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: itokens <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF stokes WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: istatements <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF sstmnt WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: watokens <span class="keyword">TYPE</span> stokes.</span><br><span class="line">  DATA: wafunction <span class="keyword">TYPE</span> tfunction.</span><br><span class="line">  DATA: wafunctioncomparison <span class="keyword">TYPE</span> tfunction.</span><br><span class="line">  DATA: maxlines <span class="keyword">TYPE</span> i.</span><br><span class="line">  DATA: nextline <span class="keyword">TYPE</span> i.</span><br><span class="line">  DATA: castprogramname <span class="keyword">TYPE</span> <span class="keyword">program</span>.</span><br><span class="line">  DATA: skipthisloop <span class="keyword">TYPE</span> abap_bool.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Read the program code from the textpool.</span></span><br><span class="line">  castprogramname = programname.</span><br><span class="line">  <span class="keyword">READ</span> <span class="keyword">REPORT</span> castprogramname INTO iincludelines.</span><br><span class="line">  SCAN ABAP-SOURCE iincludelines TOKENS INTO itokens WITH INCLUDES STATEMENTS INTO istatements.</span><br><span class="line">  <span class="keyword">CLEAR</span> iincludelines[].</span><br><span class="line"></span><br><span class="line">  maxlines = lines( itokens ).</span><br><span class="line">  LOOP AT itokens WHERE str = function AND <span class="keyword">type</span> = 'I'.</span><br><span class="line"></span><br><span class="line">    nextline = sy-tabix + 1.</span><br><span class="line">    <span class="keyword">IF</span> nextline &lt;= maxlines.</span><br><span class="line">      <span class="keyword">READ</span> <span class="keyword">TABLE</span> itokens INDEX nextline INTO watokens.</span><br><span class="line"></span><br><span class="line"><span class="comment">*      Are we only to find customer functions</span></span><br><span class="line">      skipthisloop = false.</span><br><span class="line">      <span class="keyword">IF</span> NOT customeronly IS INITIAL.</span><br><span class="line">        TRY.</span><br><span class="line">            <span class="keyword">IF</span> watokens-str+1(1) = 'Y' OR watokens-str+1(1) = 'Z' OR watokens-str <span class="keyword">CS</span> customernamerange.</span><br><span class="line">            <span class="keyword">ELSE</span>.</span><br><span class="line">              skipthisloop = true.</span><br><span class="line">            ENDIF.</span><br><span class="line">          CATCH cx_sy_range_out_of_bounds INTO objruntimeerror.</span><br><span class="line">          CLEANUP.</span><br><span class="line">            skipthisloop = true.</span><br><span class="line">        ENDTRY.</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">IF</span> skipthisloop = false.</span><br><span class="line">        wafunction-functionname = watokens-str.</span><br><span class="line">        <span class="keyword">REPLACE</span> ALL OCCURRENCES OF '''' <span class="keyword">IN</span> wafunction-functionname WITH ' '.</span><br><span class="line">        CONDENSE wafunction-functionname.</span><br><span class="line"></span><br><span class="line"><span class="comment">*        Don't add a function if we alread have it listed.</span></span><br><span class="line">        <span class="keyword">READ</span> <span class="keyword">TABLE</span> ilocfunctions WITH KEY functionname = wafunction-functionname INTO wafunctioncomparison.</span><br><span class="line">        <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line"><span class="comment">*          Add in the link name if the function is linked to a program</span></span><br><span class="line">          wafunction-programlinkname = programlinkname.</span><br><span class="line"></span><br><span class="line"><span class="comment">*          Don't download functions which are called through an RFC destination</span></span><br><span class="line">          nextline = sy-tabix + 2.</span><br><span class="line">          <span class="keyword">READ</span> <span class="keyword">TABLE</span> itokens INDEX nextline INTO watokens.</span><br><span class="line">          <span class="keyword">IF</span> watokens-str &lt;&gt; destination.</span><br><span class="line"></span><br><span class="line"><span class="comment">*            Find the function group</span></span><br><span class="line">            SELECT SINGLE area FROM v_fdir INTO wafunction-functiongroup WHERE funcname = wafunction-functionname.</span><br><span class="line"></span><br><span class="line">            <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line"><span class="comment">*              Best find the function number as well.</span></span><br><span class="line">              PERFORM retrievefunctiondetail USING wafunction-functionname</span><br><span class="line">                    wafunction-progname</span><br><span class="line">                    wafunction-includenumber</span><br><span class="line">                    wafunction-functiontitle.</span><br><span class="line"></span><br><span class="line">              PERFORM findmainfunctioninclude USING wafunction-progname</span><br><span class="line">                    wafunction-functiongroup</span><br><span class="line">                    wafunction-includenumber</span><br><span class="line">                    wafunction-functionmaininclude.</span><br><span class="line"></span><br><span class="line">              PERFORM findfunctiontopinclude USING wafunction-progname</span><br><span class="line">                    wafunction-functiongroup</span><br><span class="line">                    wafunction-topincludename.</span><br><span class="line"></span><br><span class="line"><span class="comment">*              Find main message class</span></span><br><span class="line">              PERFORM findmainmessageclass USING wafunction-progname</span><br><span class="line">                    wafunction-messageclass.</span><br><span class="line"></span><br><span class="line">              <span class="keyword">APPEND</span> wafunction TO ilocfunctions.</span><br><span class="line"></span><br><span class="line"><span class="comment">*              Now lets search a little bit deeper and do a recursive search for other includes</span></span><br><span class="line">              <span class="keyword">IF</span> NOT recursiveincludes IS INITIAL.</span><br><span class="line">                PERFORM scanforincludeprograms USING wafunction-functionmaininclude</span><br><span class="line">                      recursiveincludes</span><br><span class="line">                      customeronly</span><br><span class="line">                      customernamerange</span><br><span class="line">                      wafunction-iincludes[].</span><br><span class="line">              ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*              Now lets search a little bit deeper and do a recursive search for other functions</span></span><br><span class="line">              <span class="keyword">IF</span> NOT recursivefunctions IS INITIAL.</span><br><span class="line">                PERFORM scanforfunctions USING wafunction-functionmaininclude</span><br><span class="line">                      space</span><br><span class="line">                      recursiveincludes</span><br><span class="line">                      recursivefunctions</span><br><span class="line">                      customeronly</span><br><span class="line">                      customernamerange</span><br><span class="line">                      ilocfunctions[].</span><br><span class="line">              ENDIF.</span><br><span class="line">              <span class="keyword">CLEAR</span> wafunction.</span><br><span class="line">            ENDIF.</span><br><span class="line">          ENDIF.</span><br><span class="line">        ENDIF.</span><br><span class="line"></span><br><span class="line">        <span class="keyword">CLEAR</span> wafunction.</span><br><span class="line">      ENDIF.</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDLOOP.</span><br><span class="line">ENDFORM.                                                                                              "scanForFunctions</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  scanForFunctionIncludes... Find all user defined includes within the function group</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> scanforfunctionincludes USING poolname</span><br><span class="line">      VALUE(customeronly)</span><br><span class="line">      VALUE(customernamerange)</span><br><span class="line">      ilocincludes LIKE dumiincludes[].</span><br><span class="line"></span><br><span class="line">  DATA: iincludelines <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF string WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: itokens <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF stokes WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: ikeywords <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF text20 WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: istatements <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF sstmnt WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: watokens <span class="keyword">TYPE</span> stokes.</span><br><span class="line">  DATA: wainclude <span class="keyword">TYPE</span> tinclude.</span><br><span class="line">  DATA: waincludeexists <span class="keyword">TYPE</span> tinclude.</span><br><span class="line">  DATA: maxlines <span class="keyword">TYPE</span> i.</span><br><span class="line">  DATA: nextline <span class="keyword">TYPE</span> i.</span><br><span class="line">  DATA: castprogramname <span class="keyword">TYPE</span> <span class="keyword">program</span>.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Read the program code from the textpool.</span></span><br><span class="line">  castprogramname = poolname.</span><br><span class="line">  <span class="keyword">READ</span> <span class="keyword">REPORT</span> castprogramname INTO iincludelines.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">APPEND</span> <span class="keyword">include</span> TO ikeywords.</span><br><span class="line">  SCAN ABAP-SOURCE iincludelines TOKENS INTO itokens WITH INCLUDES STATEMENTS INTO istatements KEYWORDS FROM ikeywords.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">CLEAR</span> iincludelines[].</span><br><span class="line"></span><br><span class="line">  maxlines = lines( itokens ).</span><br><span class="line">  LOOP AT itokens WHERE str = <span class="keyword">include</span> AND <span class="keyword">type</span> = 'I'.</span><br><span class="line">    nextline = sy-tabix + 1.</span><br><span class="line">    <span class="keyword">IF</span> nextline &lt;= maxlines.</span><br><span class="line">      <span class="keyword">READ</span> <span class="keyword">TABLE</span> itokens INDEX nextline INTO watokens.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">IF</span> watokens-str CP '*F++'.</span><br><span class="line"><span class="comment">*        Are we only to find customer includes?</span></span><br><span class="line">        <span class="keyword">IF</span> NOT customeronly IS INITIAL.</span><br><span class="line">          TRY.</span><br><span class="line">              <span class="keyword">IF</span> watokens-str+0(2) = 'LY' OR watokens-str+0(2) = 'LZ' OR watokens-str <span class="keyword">CS</span> customernamerange.</span><br><span class="line">              <span class="keyword">ELSE</span>.</span><br><span class="line">                <span class="keyword">CONTINUE</span>.</span><br><span class="line">              ENDIF.</span><br><span class="line">            CATCH cx_sy_range_out_of_bounds INTO objruntimeerror.</span><br><span class="line">          ENDTRY.</span><br><span class="line">        ENDIF.</span><br><span class="line"></span><br><span class="line">        wainclude-includename = watokens-str.</span><br><span class="line"></span><br><span class="line"><span class="comment">*        Best find the program title text as well.</span></span><br><span class="line">        PERFORM findprogramorincludetitle USING wainclude-includename</span><br><span class="line">              wainclude-includetitle.</span><br><span class="line"></span><br><span class="line"><span class="comment">*        Don't append the include if we already have it listed</span></span><br><span class="line">        <span class="keyword">READ</span> <span class="keyword">TABLE</span> ilocincludes INTO waincludeexists WITH KEY includename = wainclude-includename.</span><br><span class="line">        <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line">          <span class="keyword">APPEND</span> wainclude TO ilocincludes.</span><br><span class="line">        ENDIF.</span><br><span class="line">      ENDIF.</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDLOOP.</span><br><span class="line">ENDFORM.                                                                                       "scanForFunctionIncludes</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  findProgramOrIncludeTitle...   Finds the title text of a program.</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> findprogramorincludetitle USING VALUE(programname)</span><br><span class="line">      titletext.</span><br><span class="line"></span><br><span class="line">  SELECT SINGLE text</span><br><span class="line">  FROM trdirt</span><br><span class="line">  INTO titletext</span><br><span class="line">  WHERE name = programname</span><br><span class="line">  AND sprsl = pmlang.</span><br><span class="line">ENDFORM.                                                                                     "findProgramOrIncludeTitle</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* retrievePrograms...    find programs and sub objects from SAP DB</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> retrieveprograms USING ilocprogram LIKE iprograms[]</span><br><span class="line">      ilocfunctions LIKE ifunctions[]</span><br><span class="line">      rangeprogram LIKE soprogramname[]</span><br><span class="line">      rangeauthor LIKE soauthor[]</span><br><span class="line">      VALUE(custnamerange)</span><br><span class="line">      VALUE(alsomodifiedbyauthor)</span><br><span class="line">      VALUE(customerprogsonly)</span><br><span class="line">      VALUE(getmessages)</span><br><span class="line">      VALUE(gettextelements)</span><br><span class="line">      VALUE(getcustdictstructures)</span><br><span class="line">      VALUE(getfunctions)</span><br><span class="line">      VALUE(getincludes)</span><br><span class="line">      VALUE(getscreens)</span><br><span class="line">      VALUE(gettransformations)</span><br><span class="line">      VALUE(recursivefuncsearch)</span><br><span class="line">      VALUE(recursiveincludesearch)</span><br><span class="line">      VALUE(solocpackage) LIKE sopack[].</span><br><span class="line"></span><br><span class="line">  DATA: warangeprogram LIKE <span class="keyword">LINE</span> OF rangeprogram.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> rangeprogram[] IS INITIAL.</span><br><span class="line"><span class="comment">*   We are finding all programs by an author</span></span><br><span class="line">    PERFORM findallprogramsforauthor USING ilocprogram[]</span><br><span class="line">          rangeprogram[]</span><br><span class="line">          rangeauthor[]</span><br><span class="line">          custnamerange</span><br><span class="line">          alsomodifiedbyauthor</span><br><span class="line">          customerprogsonly</span><br><span class="line">          solocpackage[].</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line">    <span class="keyword">READ</span> <span class="keyword">TABLE</span> rangeprogram INDEX 1 INTO warangeprogram.</span><br><span class="line">    <span class="keyword">IF</span> warangeprogram-low <span class="keyword">CS</span> asterix.</span><br><span class="line">      PERFORM findprogramsbywildcard USING ilocprogram[]</span><br><span class="line">            rangeprogram[]</span><br><span class="line">            rangeauthor[]</span><br><span class="line">            custnamerange</span><br><span class="line">            customerprogsonly</span><br><span class="line">            solocpackage[].</span><br><span class="line">    <span class="keyword">ELSE</span>.</span><br><span class="line">      PERFORM checkprogramdoesexist USING ilocprogram[]</span><br><span class="line">            rangeprogram[].</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Find extra items</span></span><br><span class="line">  PERFORM scanforadditionalprogstuff USING ilocprogram[]</span><br><span class="line">        ilocfunctions[]</span><br><span class="line">        gettextelements</span><br><span class="line">        getmessages</span><br><span class="line">        getscreens</span><br><span class="line">        getcustdictstructures</span><br><span class="line">        getfunctions</span><br><span class="line">        getincludes</span><br><span class="line">        gettransformations</span><br><span class="line">        customerprogsonly</span><br><span class="line">        custnamerange</span><br><span class="line">        recursiveincludesearch</span><br><span class="line">        recursivefuncsearch.</span><br><span class="line">ENDFORM.                                                                               "retrievePrograms</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  scanForAdditionalProgStuff...</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> scanforadditionalprogstuff USING ilocprogram LIKE iprograms[]</span><br><span class="line">      ilocfunctions LIKE ifunctions[]</span><br><span class="line">      VALUE(gettextelements)</span><br><span class="line">      VALUE(getmessages)</span><br><span class="line">      VALUE(getscreens)</span><br><span class="line">      VALUE(getcustdictstructures)</span><br><span class="line">      VALUE(getfunctions)</span><br><span class="line">      VALUE(getincludes)</span><br><span class="line">      VALUE(gettransformations)</span><br><span class="line">      VALUE(customeronly)</span><br><span class="line">      VALUE(customernamerange)</span><br><span class="line">      VALUE(recursiveincludesearch)</span><br><span class="line">      VALUE(recursivefuncsearch).</span><br><span class="line"></span><br><span class="line">  DATA: waprogram <span class="keyword">TYPE</span> tprogram.</span><br><span class="line">  DATA: wainclude <span class="keyword">TYPE</span> tinclude.</span><br><span class="line">  DATA: mytabix <span class="keyword">TYPE</span> sytabix.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Best to find all the includes used in a program first</span></span><br><span class="line">  <span class="keyword">IF</span> NOT getincludes IS INITIAL.</span><br><span class="line">    LOOP AT ilocprogram INTO waprogram.</span><br><span class="line">      mytabix = sy-tabix.</span><br><span class="line">      PERFORM scanforincludeprograms USING waprogram-progname</span><br><span class="line">            recursiveincludesearch</span><br><span class="line">            customeronly</span><br><span class="line">            customernamerange</span><br><span class="line">            waprogram-iincludes[].</span><br><span class="line"></span><br><span class="line">      MODIFY ilocprogram FROM waprogram INDEX mytabix.</span><br><span class="line">    ENDLOOP.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Once we have a list of all the includes we need to loop round them an select all the other objects</span></span><br><span class="line">  LOOP AT ilocprogram INTO waprogram.</span><br><span class="line">    mytabix = sy-tabix.</span><br><span class="line">    PERFORM findprogramdetails USING waprogram-progname</span><br><span class="line">          waprogram-subc</span><br><span class="line">          waprogram-programtitle</span><br><span class="line">          waprogram</span><br><span class="line">          gettextelements</span><br><span class="line">          getmessages</span><br><span class="line">          getscreens</span><br><span class="line">          gettransformations</span><br><span class="line">          getcustdictstructures</span><br><span class="line">          customeronly</span><br><span class="line">          customernamerange.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Find any screens</span></span><br><span class="line">    <span class="keyword">IF</span> NOT getscreens IS INITIAL.</span><br><span class="line">      PERFORM findprogramscreenflow USING waprogram.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line">    LOOP AT waprogram-iincludes INTO wainclude.</span><br><span class="line">      PERFORM findprogramdetails USING wainclude-includename</span><br><span class="line">            'I'</span><br><span class="line">            wainclude-includetitle</span><br><span class="line">            waprogram</span><br><span class="line">            gettextelements</span><br><span class="line">            getmessages</span><br><span class="line">            getscreens</span><br><span class="line">            gettransformations</span><br><span class="line">            getcustdictstructures</span><br><span class="line">            customeronly</span><br><span class="line">            customernamerange.</span><br><span class="line">    ENDLOOP.</span><br><span class="line"></span><br><span class="line">    MODIFY ilocprogram FROM waprogram INDEX mytabix.</span><br><span class="line">  ENDLOOP.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Now we have all the program includes and details we need to find extra functions</span></span><br><span class="line">  <span class="keyword">IF</span> NOT getfunctions IS INITIAL.</span><br><span class="line">    LOOP AT ilocprogram INTO waprogram.</span><br><span class="line"><span class="comment">*     Find any functions defined in the code</span></span><br><span class="line">      PERFORM scanforfunctions USING waprogram-progname</span><br><span class="line">            waprogram-progname</span><br><span class="line">            space</span><br><span class="line">            space</span><br><span class="line">            customeronly</span><br><span class="line">            customernamerange</span><br><span class="line">            ilocfunctions[].</span><br><span class="line">    ENDLOOP.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   We have a list of all the functions so lets go and find details and other function calls</span></span><br><span class="line">    PERFORM scanforadditionalfuncstuff USING ilocfunctions[]</span><br><span class="line">          recursiveincludesearch</span><br><span class="line">          recursivefuncsearch</span><br><span class="line">          getincludes</span><br><span class="line">          getfunctions</span><br><span class="line">          getcustdictstructures</span><br><span class="line">          getmessages</span><br><span class="line">          gettransformations</span><br><span class="line">          customeronly</span><br><span class="line">          customernamerange.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.                                                                     "scanForAdditionalProgStuff</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  findProgramDetails...</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> findprogramdetails USING VALUE(programname)</span><br><span class="line">      VALUE(programtype)</span><br><span class="line">      programtitle</span><br><span class="line">      waprogram <span class="keyword">TYPE</span> tprogram</span><br><span class="line">      VALUE(gettextelements)</span><br><span class="line">      VALUE(getmessages)</span><br><span class="line">      VALUE(getscreens)</span><br><span class="line">      VALUE(gettransformations)</span><br><span class="line">      VALUE(getcustdictstructures)</span><br><span class="line">      VALUE(customeronly)</span><br><span class="line">      VALUE(customernamerange).</span><br><span class="line"></span><br><span class="line">  PERFORM findprogramorincludetitle USING programname</span><br><span class="line">        programtitle.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> NOT gettextelements IS INITIAL.</span><br><span class="line"><span class="comment">*   Find the program texts from out of the database.</span></span><br><span class="line">    PERFORM retrieveprogramtexts USING waprogram-iselectiontexts[]</span><br><span class="line">          waprogram-itextelements[]</span><br><span class="line">          programname.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Search for any GUI texts</span></span><br><span class="line">  <span class="keyword">IF</span> NOT getscreens IS INITIAL AND ( programtype = '<span class="keyword">M</span>' OR programtype = '1' ).</span><br><span class="line">    PERFORM retrieveguititles USING waprogram-iguititle[]</span><br><span class="line">          programname.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Find individual messages</span></span><br><span class="line">  <span class="keyword">IF</span> NOT getmessages IS INITIAL.</span><br><span class="line">    <span class="keyword">IF</span> programtype = '<span class="keyword">M</span>' OR programtype = '1'.</span><br><span class="line">      PERFORM findmainmessageclass USING programname</span><br><span class="line">            waprogram-messageclass.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line">    PERFORM scanformessages USING programname</span><br><span class="line">          waprogram-messageclass</span><br><span class="line">          waprogram-imessages[].</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Find any XSLT Transformations</span></span><br><span class="line">  <span class="keyword">IF</span> NOT gettransformations IS INITIAL.</span><br><span class="line">    PERFORM scanfortransformations USING programname</span><br><span class="line">          customeronly</span><br><span class="line">          customernamerange</span><br><span class="line">          waprogram-itransformations[].</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> NOT getcustdictstructures IS INITIAL.</span><br><span class="line">    PERFORM scanfortables USING programname</span><br><span class="line">          customeronly</span><br><span class="line">          customernamerange</span><br><span class="line">          waprogram-idictstruct[].</span><br><span class="line"></span><br><span class="line">    PERFORM scanforlikeortype USING programname</span><br><span class="line">          customeronly</span><br><span class="line">          customernamerange</span><br><span class="line">          waprogram-idictstruct[]</span><br><span class="line">          waprogram-itabletypes[].</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.                                                                             "findProgramDetails</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  findAllProgramsForAuthor...</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> findallprogramsforauthor USING ilocprogram LIKE iprograms[]</span><br><span class="line">      rangeprogram LIKE soprogramname[]</span><br><span class="line">      rangeauthor LIKE soauthor[]</span><br><span class="line">      VALUE(custnamerange)</span><br><span class="line">      VALUE(alsomodifiedbyauthor)</span><br><span class="line">      VALUE(customerprogsonly)</span><br><span class="line">      VALUE(solocpackage) LIKE sopack[].</span><br><span class="line"></span><br><span class="line">  DATA: altcustomernamerange <span class="keyword">TYPE</span> string.</span><br><span class="line">  FIELD-SYMBOLS: &lt;waprogram&gt; <span class="keyword">TYPE</span> tprogram.</span><br><span class="line">  DATA: genflag <span class="keyword">TYPE</span> genflag.</span><br><span class="line"></span><br><span class="line"><span class="comment">* build up the customer name range used for select statements</span></span><br><span class="line">  CONCATENATE custnamerange '%' INTO altcustomernamerange.</span><br><span class="line"></span><br><span class="line"><span class="comment">* select by name and author</span></span><br><span class="line">  <span class="keyword">IF</span> NOT alsomodifiedbyauthor IS INITIAL.</span><br><span class="line"><span class="comment">*   Programs modified by author</span></span><br><span class="line"><span class="comment">*   Program to search for is an executable program</span></span><br><span class="line">    <span class="keyword">IF</span> customerprogsonly IS INITIAL.</span><br><span class="line"><span class="comment">*     Select all programs</span></span><br><span class="line">      SELECT a~progname</span><br><span class="line">      a~subc</span><br><span class="line">      APPENDING CORRESPONDING FIELDS OF <span class="keyword">TABLE</span> ilocprogram</span><br><span class="line">      FROM reposrc <span class="keyword">AS</span> a</span><br><span class="line">      INNER JOIN tadir <span class="keyword">AS</span> b</span><br><span class="line">      <span class="keyword">ON</span> a~progname = b~obj_name</span><br><span class="line">      WHERE a~progname <span class="keyword">IN</span> rangeprogram</span><br><span class="line">      AND a~cnam <span class="keyword">IN</span> rangeauthor</span><br><span class="line">      AND ( a~subc = '1' OR a~subc = '<span class="keyword">M</span>' OR a~subc = 'S' )</span><br><span class="line">      AND b~pgmid = 'R3TR'</span><br><span class="line">      AND b~object = '<span class="keyword">PROG</span>'</span><br><span class="line">      AND b~devclass <span class="keyword">IN</span> solocpackage.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">ELSE</span>.</span><br><span class="line"><span class="comment">*     Select only customer specific programs</span></span><br><span class="line">      SELECT progname</span><br><span class="line">      subc</span><br><span class="line">      APPENDING CORRESPONDING FIELDS OF <span class="keyword">TABLE</span> ilocprogram</span><br><span class="line">      FROM reposrc <span class="keyword">AS</span> a</span><br><span class="line">      INNER JOIN tadir <span class="keyword">AS</span> b</span><br><span class="line">      <span class="keyword">ON</span> a~progname = b~obj_name</span><br><span class="line">      WHERE a~progname  <span class="keyword">IN</span> rangeprogram</span><br><span class="line">      AND ( a~progname LIKE altcustomernamerange</span><br><span class="line">      OR a~progname LIKE 'Z%'</span><br><span class="line">      OR a~progname LIKE 'Y%'</span><br><span class="line">      OR a~progname LIKE 'SAPMZ%'</span><br><span class="line">      OR a~progname LIKE 'SAPMY%')</span><br><span class="line">      AND a~cnam <span class="keyword">IN</span> rangeauthor</span><br><span class="line">      AND ( a~subc = '1' OR a~subc = '<span class="keyword">M</span>' OR a~subc = 'S' )</span><br><span class="line">      AND b~pgmid = 'R3TR'</span><br><span class="line">      AND b~object = '<span class="keyword">PROG</span>'</span><br><span class="line">      AND b~devclass <span class="keyword">IN</span> solocpackage.</span><br><span class="line">    ENDIF.</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Programs created by author</span></span><br><span class="line">    <span class="keyword">IF</span> customerprogsonly IS INITIAL.</span><br><span class="line"><span class="comment">*     Select all programs</span></span><br><span class="line">      SELECT progname</span><br><span class="line">      subc</span><br><span class="line">      APPENDING CORRESPONDING FIELDS OF <span class="keyword">TABLE</span> ilocprogram</span><br><span class="line">      FROM reposrc <span class="keyword">AS</span> a</span><br><span class="line">      INNER JOIN tadir <span class="keyword">AS</span> b</span><br><span class="line">      <span class="keyword">ON</span> a~progname = b~obj_name</span><br><span class="line">      WHERE a~progname <span class="keyword">IN</span> rangeprogram</span><br><span class="line">      AND ( a~subc = '1' OR a~subc = '<span class="keyword">M</span>' OR a~subc = 'S' )</span><br><span class="line">      AND ( a~cnam <span class="keyword">IN</span> rangeauthor OR a~unam <span class="keyword">IN</span> rangeauthor )</span><br><span class="line">      AND b~pgmid = 'R3TR'</span><br><span class="line">      AND b~object = '<span class="keyword">PROG</span>'</span><br><span class="line">      AND b~devclass <span class="keyword">IN</span> solocpackage.</span><br><span class="line">    <span class="keyword">ELSE</span>.</span><br><span class="line"><span class="comment">*     Select only customer specific programs</span></span><br><span class="line">      SELECT a~progname</span><br><span class="line">      a~subc</span><br><span class="line">      APPENDING CORRESPONDING FIELDS OF <span class="keyword">TABLE</span> ilocprogram</span><br><span class="line">      FROM reposrc <span class="keyword">AS</span> a</span><br><span class="line">      INNER JOIN tadir <span class="keyword">AS</span> b</span><br><span class="line">      <span class="keyword">ON</span> a~progname = b~obj_name</span><br><span class="line">      WHERE a~progname <span class="keyword">IN</span> rangeprogram</span><br><span class="line">      AND ( a~progname LIKE altcustomernamerange</span><br><span class="line">      OR a~progname LIKE 'Z%'</span><br><span class="line">      OR a~progname LIKE 'Y%'</span><br><span class="line">      OR a~progname LIKE 'SAPMZ%'</span><br><span class="line">      OR a~progname LIKE 'SAPMY%')</span><br><span class="line">      AND ( a~subc = '1' OR a~subc = '<span class="keyword">M</span>' OR a~subc = 'S' )</span><br><span class="line">      AND ( a~cnam <span class="keyword">IN</span> rangeauthor OR a~unam <span class="keyword">IN</span> rangeauthor )</span><br><span class="line">      AND b~pgmid = 'R3TR'</span><br><span class="line">      AND b~object = '<span class="keyword">PROG</span>'</span><br><span class="line">      AND b~devclass <span class="keyword">IN</span> solocpackage.</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.                                                                       "findAllProgramsForAuthor</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  findAllXSLTForAuthor...</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> findallxsltforauthor USING iloctransformations  LIKE itransformations[]</span><br><span class="line">      rangexslt LIKE soxsltname[]</span><br><span class="line">      rangeauthor LIKE soauthor[]</span><br><span class="line">      VALUE(custnamerange)</span><br><span class="line">      VALUE(alsomodifiedbyauthor)</span><br><span class="line">      VALUE(customerprogsonly)</span><br><span class="line">      VALUE(solocpackage) LIKE sopack[].</span><br><span class="line"></span><br><span class="line">  DATA: altcustomernamerange <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: watransformation LIKE <span class="keyword">LINE</span> OF itransformations.</span><br><span class="line">  FIELD-SYMBOLS: &lt;waxslt&gt; <span class="keyword">TYPE</span> ttransformation.</span><br><span class="line">  DATA: genflag <span class="keyword">TYPE</span> genflag.</span><br><span class="line"></span><br><span class="line"><span class="comment">* build up the customer name range used for select statements</span></span><br><span class="line">  CONCATENATE custnamerange '%' INTO altcustomernamerange.</span><br><span class="line"></span><br><span class="line"><span class="comment">* select by name and author</span></span><br><span class="line">  <span class="keyword">IF</span> NOT alsomodifiedbyauthor IS INITIAL.</span><br><span class="line"><span class="comment">*   Programs modified by author</span></span><br><span class="line"><span class="comment">*   Program to search for is an executable program</span></span><br><span class="line">    <span class="keyword">IF</span> customerprogsonly IS INITIAL.</span><br><span class="line"><span class="comment">*     Select all XSLT programs</span></span><br><span class="line">      SELECT obj_name</span><br><span class="line">      INTO   watransformation-xsltname</span><br><span class="line">      FROM   tadir</span><br><span class="line">      WHERE  pgmid     = 'R3TR'</span><br><span class="line">      AND    object    = 'XSLT'</span><br><span class="line">      AND    author    <span class="keyword">IN</span> rangeauthor</span><br><span class="line">      AND    obj_name  <span class="keyword">IN</span> rangexslt</span><br><span class="line">      AND    devclass  <span class="keyword">IN</span> solocpackage.</span><br><span class="line"></span><br><span class="line">        <span class="keyword">APPEND</span> watransformation TO iloctransformations.</span><br><span class="line">      ENDSELECT.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">ELSE</span>.</span><br><span class="line"><span class="comment">*     Select only customer specific programs</span></span><br><span class="line">      SELECT obj_name</span><br><span class="line">      INTO   watransformation-xsltname</span><br><span class="line">      FROM   tadir</span><br><span class="line">      WHERE  pgmid     = 'R3TR'</span><br><span class="line">      AND    object    = 'XSLT'</span><br><span class="line">      AND    author    <span class="keyword">IN</span> rangeauthor</span><br><span class="line">      AND    obj_name  <span class="keyword">IN</span> rangexslt</span><br><span class="line">      AND    devclass  <span class="keyword">IN</span> solocpackage</span><br><span class="line">      AND ( obj_name LIKE altcustomernamerange</span><br><span class="line">      OR obj_name LIKE 'Z%'</span><br><span class="line">      OR obj_name LIKE 'Y%').</span><br><span class="line"></span><br><span class="line">        <span class="keyword">APPEND</span> watransformation TO iloctransformations.</span><br><span class="line">      ENDSELECT.</span><br><span class="line">    ENDIF.</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line"><span class="comment">*   Programs created by author</span></span><br><span class="line">    <span class="keyword">IF</span> customerprogsonly IS INITIAL.</span><br><span class="line"><span class="comment">*     Select all programs</span></span><br><span class="line">      SELECT obj_name</span><br><span class="line">      INTO   watransformation-xsltname</span><br><span class="line">      FROM   tadir</span><br><span class="line">      WHERE  pgmid     = 'R3TR'</span><br><span class="line">      AND    object    = 'XSLT'</span><br><span class="line">      AND    author    <span class="keyword">IN</span> rangeauthor</span><br><span class="line">      AND    obj_name  <span class="keyword">IN</span> rangexslt</span><br><span class="line">      AND    devclass  <span class="keyword">IN</span> solocpackage.</span><br><span class="line"></span><br><span class="line">        <span class="keyword">APPEND</span> watransformation TO iloctransformations.</span><br><span class="line">      ENDSELECT.</span><br><span class="line">    <span class="keyword">ELSE</span>.</span><br><span class="line"><span class="comment">*     Select only customer specific programs</span></span><br><span class="line">      SELECT obj_name</span><br><span class="line">      INTO   watransformation-xsltname</span><br><span class="line">      FROM   tadir</span><br><span class="line">      WHERE  pgmid     = 'R3TR'</span><br><span class="line">      AND    object    = 'XSLT'</span><br><span class="line">      AND    author    <span class="keyword">IN</span> rangeauthor</span><br><span class="line">      AND    obj_name  <span class="keyword">IN</span> rangexslt</span><br><span class="line">      AND    devclass  <span class="keyword">IN</span> solocpackage</span><br><span class="line">      AND ( obj_name LIKE altcustomernamerange</span><br><span class="line">      OR obj_name LIKE 'Z%'</span><br><span class="line">      OR obj_name LIKE 'Y%').</span><br><span class="line"></span><br><span class="line">        <span class="keyword">APPEND</span> watransformation TO iloctransformations.</span><br><span class="line">      ENDSELECT.</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.                                                                       "findAllXSLTForAuthor</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  findXsltByWildcard...</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> findxsltbywildcard USING iloctransformations LIKE itransformations[]</span><br><span class="line">      VALUE(rangexslt) LIKE soxsltname[]</span><br><span class="line">      VALUE(rangeauthor) LIKE soauthor[]</span><br><span class="line">      VALUE(custnamerange)</span><br><span class="line">      VALUE(customerprogsonly)</span><br><span class="line">      VALUE(solocpackage) LIKE sopack[].</span><br><span class="line"></span><br><span class="line">  DATA: altcustomernamerange <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: watransformation LIKE <span class="keyword">LINE</span> OF iloctransformations.</span><br><span class="line">  FIELD-SYMBOLS: &lt;watransformation&gt; <span class="keyword">TYPE</span> ttransformation.</span><br><span class="line">  DATA: genflag <span class="keyword">TYPE</span> genflag.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> customerprogsonly IS INITIAL.</span><br><span class="line"><span class="comment">*   build up the customer name range used for select statements</span></span><br><span class="line">    <span class="keyword">IF</span> custnamerange &lt;&gt; '^'.</span><br><span class="line">      CONCATENATE custnamerange '%' INTO altcustomernamerange.</span><br><span class="line"></span><br><span class="line">      SELECT obj_name</span><br><span class="line">      INTO   watransformation-xsltname</span><br><span class="line">      FROM   tadir</span><br><span class="line">      WHERE  pgmid     = 'R3TR'</span><br><span class="line">      AND    object    = 'XSLT'</span><br><span class="line">      AND    obj_name  <span class="keyword">IN</span> rangexslt</span><br><span class="line">      AND    obj_name  LIKE altcustomernamerange</span><br><span class="line">      AND    author    <span class="keyword">IN</span> rangeauthor.</span><br><span class="line"></span><br><span class="line">        <span class="keyword">APPEND</span> watransformation TO iloctransformations.</span><br><span class="line">      ENDSELECT.</span><br><span class="line">    <span class="keyword">ELSE</span>.</span><br><span class="line">      SELECT obj_name</span><br><span class="line">      INTO   watransformation-xsltname</span><br><span class="line">      FROM   tadir</span><br><span class="line">      WHERE  pgmid     = 'R3TR'</span><br><span class="line">      AND    object    = 'XSLT'</span><br><span class="line">      AND    obj_name  <span class="keyword">IN</span> rangexslt</span><br><span class="line">      AND    author    <span class="keyword">IN</span> rangeauthor.</span><br><span class="line"></span><br><span class="line">        <span class="keyword">APPEND</span> watransformation TO iloctransformations.</span><br><span class="line">      ENDSELECT.</span><br><span class="line">    ENDIF.</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line"><span class="comment">*   Only customer xslt</span></span><br><span class="line">    <span class="keyword">IF</span> custnamerange &lt;&gt; '^'.</span><br><span class="line">      CONCATENATE custnamerange '%' INTO altcustomernamerange.</span><br><span class="line"></span><br><span class="line">      SELECT obj_name</span><br><span class="line">      INTO   watransformation-xsltname</span><br><span class="line">      FROM   tadir</span><br><span class="line">      WHERE  pgmid     = 'R3TR'</span><br><span class="line">      AND    object    = 'XSLT'</span><br><span class="line">      AND    obj_name  <span class="keyword">IN</span> rangexslt</span><br><span class="line">      AND    obj_name  LIKE altcustomernamerange</span><br><span class="line">      AND    ( obj_name LIKE 'Z%' OR</span><br><span class="line">      obj_name LIKE 'Y%' ).</span><br><span class="line"></span><br><span class="line">        <span class="keyword">APPEND</span> watransformation TO iloctransformations.</span><br><span class="line">      ENDSELECT.</span><br><span class="line">    <span class="keyword">ELSE</span>.</span><br><span class="line">      SELECT obj_name</span><br><span class="line">      INTO   watransformation-xsltname</span><br><span class="line">      FROM   tadir</span><br><span class="line">      WHERE  pgmid     = 'R3TR'</span><br><span class="line">      AND    object    = 'XSLT'</span><br><span class="line">      AND    obj_name  <span class="keyword">IN</span> rangexslt</span><br><span class="line">      AND    ( obj_name LIKE 'Z%' OR</span><br><span class="line">      obj_name LIKE 'Y%' ).</span><br><span class="line"></span><br><span class="line">        <span class="keyword">APPEND</span> watransformation TO iloctransformations.</span><br><span class="line">      ENDSELECT.</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.                                                                         "findxsltByWildcard</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  checkXsltDoesExist...</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> checkxsltdoesexist USING iloctransformations LIKE itransformations[]</span><br><span class="line">      rangexslt LIKE soxsltname[].</span><br><span class="line"></span><br><span class="line">  DATA: watransformation <span class="keyword">TYPE</span> ttransformation.</span><br><span class="line"></span><br><span class="line"><span class="comment">*-- Make sure XSLT exists</span></span><br><span class="line">  SELECT SINGLE obj_name</span><br><span class="line">  INTO   watransformation-xsltname</span><br><span class="line">  FROM   tadir</span><br><span class="line">  WHERE  pgmid     = 'R3TR'</span><br><span class="line">  AND    object    = 'XSLT'</span><br><span class="line">  AND    obj_name  <span class="keyword">IN</span> rangexslt.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line">    <span class="keyword">APPEND</span> watransformation TO iloctransformations.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.                                                                          "checkxsltDoesExist</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  checkProgramDoesExist...</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> checkprogramdoesexist USING ilocprogram LIKE iprograms[]</span><br><span class="line">      rangeprogram LIKE soprogramname[].</span><br><span class="line"></span><br><span class="line"><span class="comment">*  Check to see if the program is an executable program</span></span><br><span class="line">  SELECT progname</span><br><span class="line">  subc</span><br><span class="line">  INTO CORRESPONDING FIELDS OF <span class="keyword">TABLE</span> ilocprogram</span><br><span class="line">  FROM reposrc</span><br><span class="line">  WHERE progname <span class="keyword">IN</span> rangeprogram</span><br><span class="line">  AND ( subc = '1' OR</span><br><span class="line">  subc = 'I' OR</span><br><span class="line">  subc = '<span class="keyword">M</span>' OR</span><br><span class="line">  subc = 'S' ).</span><br><span class="line">ENDFORM.                                                                          "checkProgramDoesExist</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  findProgramsByWildcard.. Search in the system for programs</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> checkandaddtabletype USING wadictionary-tablename</span><br><span class="line">      iloctabletypes LIKE itabletypes[].</span><br><span class="line"></span><br><span class="line">  SELECT *</span><br><span class="line">  INTO CORRESPONDING FIELDS OF <span class="keyword">TABLE</span> iloctabletypes</span><br><span class="line">  FROM dd40l <span class="keyword">AS</span> a</span><br><span class="line">  INNER JOIN dd40t <span class="keyword">AS</span> t</span><br><span class="line">  <span class="keyword">ON</span> a~typename = t~typename</span><br><span class="line">  WHERE a~typename = wadictionary-tablename</span><br><span class="line">  AND t~ddlanguage <span class="keyword">EQ</span> sy-langu</span><br><span class="line">  AND a~as4local = 'A'.</span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  findProgramsByWildcard.. Search in the system for programs</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> findprogramsbywildcard USING ilocprogram LIKE iprograms[]</span><br><span class="line">      VALUE(rangeprogram) LIKE soprogramname[]</span><br><span class="line">      VALUE(rangeauthor) LIKE soauthor[]</span><br><span class="line">      VALUE(custnamerange)</span><br><span class="line">      VALUE(customerprogsonly)</span><br><span class="line">      VALUE(solocpackage) LIKE sopack[].</span><br><span class="line"></span><br><span class="line">  DATA: altcustomernamerange <span class="keyword">TYPE</span> string.</span><br><span class="line">  FIELD-SYMBOLS: &lt;waprogram&gt; <span class="keyword">TYPE</span> tprogram.</span><br><span class="line">  DATA: genflag <span class="keyword">TYPE</span> genflag.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> customerprogsonly IS INITIAL.</span><br><span class="line"><span class="comment">*   build up the customer name range used for select statements</span></span><br><span class="line">    <span class="keyword">IF</span> custnamerange &lt;&gt; '^'.</span><br><span class="line">      CONCATENATE custnamerange '%' INTO altcustomernamerange.</span><br><span class="line"></span><br><span class="line">      SELECT progname</span><br><span class="line">      subc</span><br><span class="line">      FROM reposrc</span><br><span class="line">      APPENDING CORRESPONDING FIELDS OF <span class="keyword">TABLE</span> ilocprogram</span><br><span class="line">      WHERE progname  <span class="keyword">IN</span> rangeprogram</span><br><span class="line">      AND progname LIKE altcustomernamerange</span><br><span class="line">      AND ( subc = '1' OR subc = '<span class="keyword">M</span>' OR subc = 'S' )</span><br><span class="line">      AND ( cnam <span class="keyword">IN</span> rangeauthor OR unam <span class="keyword">IN</span> rangeauthor ).</span><br><span class="line">    <span class="keyword">ELSE</span>.</span><br><span class="line">      SELECT progname</span><br><span class="line">      subc</span><br><span class="line">      FROM reposrc</span><br><span class="line">      APPENDING CORRESPONDING FIELDS OF <span class="keyword">TABLE</span> ilocprogram</span><br><span class="line">      WHERE progname  <span class="keyword">IN</span> rangeprogram</span><br><span class="line">      AND ( subc = '1' OR subc = '<span class="keyword">M</span>' OR subc = 'S' )</span><br><span class="line">      AND ( cnam <span class="keyword">IN</span> rangeauthor OR unam <span class="keyword">IN</span> rangeauthor ).</span><br><span class="line">    ENDIF.</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line"><span class="comment">*   Only customer programs</span></span><br><span class="line">    <span class="keyword">IF</span> custnamerange &lt;&gt; '^'.</span><br><span class="line">      CONCATENATE custnamerange '%' INTO altcustomernamerange.</span><br><span class="line"></span><br><span class="line">      SELECT progname</span><br><span class="line">      subc</span><br><span class="line">      FROM reposrc</span><br><span class="line">      APPENDING CORRESPONDING FIELDS OF <span class="keyword">TABLE</span> ilocprogram</span><br><span class="line">      WHERE progname  <span class="keyword">IN</span> rangeprogram</span><br><span class="line">      AND ( progname LIKE altcustomernamerange</span><br><span class="line">      OR progname LIKE 'Z%'</span><br><span class="line">      OR progname LIKE 'Y%'</span><br><span class="line">      OR progname LIKE 'SAPMZ%'</span><br><span class="line">      OR progname LIKE 'SAPMY%')</span><br><span class="line">      AND ( subc = '1' OR subc = '<span class="keyword">M</span>' OR subc = 'S' )</span><br><span class="line">      AND ( cnam <span class="keyword">IN</span> rangeauthor OR unam <span class="keyword">IN</span> rangeauthor ).</span><br><span class="line">    <span class="keyword">ELSE</span>.</span><br><span class="line">      SELECT progname</span><br><span class="line">      subc</span><br><span class="line">      FROM reposrc</span><br><span class="line">      APPENDING CORRESPONDING FIELDS OF <span class="keyword">TABLE</span> ilocprogram</span><br><span class="line">      WHERE progname  <span class="keyword">IN</span> rangeprogram</span><br><span class="line">      AND ( progname LIKE 'Z%'</span><br><span class="line">      OR progname LIKE 'Y%'</span><br><span class="line">      OR progname LIKE 'SAPMZ%'</span><br><span class="line">      OR progname LIKE 'SAPMY%')</span><br><span class="line">      AND ( subc = '1' OR subc = '<span class="keyword">M</span>' OR subc = 'S' )</span><br><span class="line">      AND ( cnam <span class="keyword">IN</span> rangeauthor OR unam <span class="keyword">IN</span> rangeauthor ).</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.                                                                         "findProgramsByWildcard</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  retrieveProgramTexts... Find the text elements and selection texts for a program</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> retrieveprogramtexts USING ilocselectiontexts LIKE dumitexttab[]</span><br><span class="line">      iloctextelements LIKE dumitexttab[]</span><br><span class="line">      VALUE(programname).</span><br><span class="line"></span><br><span class="line">  DATA: itexttable <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF ttexttable WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: watexts <span class="keyword">TYPE</span> ttexttable.</span><br><span class="line">  DATA: castprogramname(50).</span><br><span class="line"></span><br><span class="line">  <span class="keyword">MOVE</span> programname TO castprogramname.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">READ</span> TEXTPOOL castprogramname INTO itexttable LANGUAGE pmlang.</span><br><span class="line">  DELETE itexttable WHERE key = 'R'.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Selection texts.</span></span><br><span class="line">  LOOP AT itexttable WHERE id = 'S'.</span><br><span class="line">    <span class="keyword">MOVE</span> itexttable-key TO watexts-key.</span><br><span class="line">    <span class="keyword">MOVE</span> itexttable-entry TO watexts-entry.</span><br><span class="line">    <span class="keyword">APPEND</span> watexts TO ilocselectiontexts.</span><br><span class="line">    <span class="keyword">CLEAR</span> watexts.</span><br><span class="line">  ENDLOOP.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Text elements.</span></span><br><span class="line">  DELETE itexttable WHERE key = 'S'.</span><br><span class="line">  LOOP AT itexttable WHERE id = 'I'.</span><br><span class="line">    <span class="keyword">MOVE</span> itexttable-key TO watexts-key.</span><br><span class="line">    <span class="keyword">MOVE</span> itexttable-entry TO watexts-entry.</span><br><span class="line">    <span class="keyword">APPEND</span> watexts TO iloctextelements.</span><br><span class="line">  ENDLOOP.</span><br><span class="line">ENDFORM.                                                                           "retrieveProgramTexts</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  retrieveGUITitles...  Search for any GUI texts</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> retrieveguititles USING ilocguititle LIKE dumiguititle[]</span><br><span class="line">      VALUE(programname).</span><br><span class="line"></span><br><span class="line">  SELECT obj_code</span><br><span class="line">  text</span><br><span class="line">  FROM d347t</span><br><span class="line">  APPENDING CORRESPONDING FIELDS OF <span class="keyword">TABLE</span> ilocguititle</span><br><span class="line">  WHERE progname = programname.</span><br><span class="line">ENDFORM.                                                                              "retrieveGUITitles</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*   findMainMessageClass... find the message class stated at the top of  program.</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> findmainmessageclass USING VALUE(programname)</span><br><span class="line">      messageclass.</span><br><span class="line"></span><br><span class="line">  SELECT SINGLE msgid</span><br><span class="line">  FROM trdire INTO messageclass</span><br><span class="line">  WHERE <span class="keyword">report</span> = programname.</span><br><span class="line">ENDFORM.                                                                           "findMainMessageClass</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* retrieveClasses...    find classes and sub objects from SAP DB</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> retrieveclasses USING ilocclasses LIKE iclasses[]</span><br><span class="line">      ilocfunctions LIKE ifunctions[]</span><br><span class="line">      rangeclass LIKE soclassname[]</span><br><span class="line">      rangeauthor LIKE soauthor[]</span><br><span class="line">      VALUE(custnamerange)</span><br><span class="line">      VALUE(alsomodifiedbyauthor)</span><br><span class="line">      VALUE(customerprogsonly)</span><br><span class="line">      VALUE(getmessages)</span><br><span class="line">      VALUE(gettextelements)</span><br><span class="line">      VALUE(getcustdictstructures)</span><br><span class="line">      VALUE(getfunctions)</span><br><span class="line">      VALUE(getincludes)</span><br><span class="line">      VALUE(gettransformations)</span><br><span class="line">      VALUE(recursivefuncsearch)</span><br><span class="line">      VALUE(recursiveincludesearch)</span><br><span class="line">      VALUE(recursiveclasssearch)</span><br><span class="line">      VALUE(language)</span><br><span class="line">      VALUE(solocpackage) LIKE sopack[].</span><br><span class="line"></span><br><span class="line">  DATA: warangeclass LIKE <span class="keyword">LINE</span> OF rangeclass.</span><br><span class="line">  DATA: waclass LIKE <span class="keyword">LINE</span> OF ilocclasses[].</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> rangeclass[] IS INITIAL.</span><br><span class="line"><span class="comment">*   We are finding all programs by an author</span></span><br><span class="line">    PERFORM findallclassesforauthor USING ilocclasses[]</span><br><span class="line">          rangeclass[]</span><br><span class="line">          rangeauthor[]</span><br><span class="line">          custnamerange</span><br><span class="line">          alsomodifiedbyauthor</span><br><span class="line">          customerprogsonly</span><br><span class="line">          language.</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line">    <span class="keyword">READ</span> <span class="keyword">TABLE</span> rangeclass INDEX 1 INTO warangeclass.</span><br><span class="line">    <span class="keyword">IF</span> warangeclass-low <span class="keyword">CS</span> asterix.</span><br><span class="line">      PERFORM findclassesbywildcard USING ilocclasses[]</span><br><span class="line">            rangeclass[]</span><br><span class="line">            rangeauthor[]</span><br><span class="line">            custnamerange</span><br><span class="line">            customerprogsonly</span><br><span class="line">            language.</span><br><span class="line">    <span class="keyword">ELSE</span>.</span><br><span class="line">      PERFORM checkclassdoesexist USING ilocclasses[]</span><br><span class="line">            rangeclass[].</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Check the package</span></span><br><span class="line">  <span class="keyword">IF</span> NOT solocpackage[] IS INITIAL.</span><br><span class="line">    LOOP AT ilocclasses INTO waclass.</span><br><span class="line">      SELECT SINGLE obj_name</span><br><span class="line">      FROM tadir</span><br><span class="line">      INTO waclass-clsname</span><br><span class="line">      WHERE pgmid = 'R3TR'</span><br><span class="line">      AND object = 'CLAS'</span><br><span class="line">      AND obj_name = waclass-clsname</span><br><span class="line">      AND devclass <span class="keyword">IN</span> solocpackage[].</span><br><span class="line">      <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line">        DELETE ilocclasses.</span><br><span class="line">      ENDIF.</span><br><span class="line">    ENDLOOP.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Find extra items</span></span><br><span class="line">  <span class="keyword">IF</span> NOT ilocclasses[] IS INITIAL.</span><br><span class="line">    PERFORM scanforadditionalclassstuff USING ilocclasses[]</span><br><span class="line">          ilocfunctions[]</span><br><span class="line">          gettextelements</span><br><span class="line">          getmessages</span><br><span class="line">          getcustdictstructures</span><br><span class="line">          getfunctions</span><br><span class="line">          getincludes</span><br><span class="line">          gettransformations</span><br><span class="line">          customerprogsonly</span><br><span class="line">          custnamerange</span><br><span class="line">          recursiveincludesearch</span><br><span class="line">          recursivefuncsearch</span><br><span class="line">          recursiveclasssearch</span><br><span class="line">          solocpackage[].</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.                                                                                "retrieveClasses</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  findAllClassesForAuthor...</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> findallclassesforauthor USING ilocclass LIKE iclasses[]</span><br><span class="line">      rangeclass LIKE soclassname[]</span><br><span class="line">      rangeauthor LIKE soauthor[]</span><br><span class="line">      VALUE(custnamerange)</span><br><span class="line">      VALUE(alsomodifiedbyauthor)</span><br><span class="line">      VALUE(customerclassesonly)</span><br><span class="line">      VALUE(language).</span><br><span class="line"></span><br><span class="line">  DATA: altcustomernamerange <span class="keyword">TYPE</span> string.</span><br><span class="line"></span><br><span class="line"><span class="comment">* build up the customer name range used for select statements</span></span><br><span class="line">  CONCATENATE custnamerange '%' INTO altcustomernamerange.</span><br><span class="line"></span><br><span class="line"><span class="comment">* select by name and author</span></span><br><span class="line">  <span class="keyword">IF</span> NOT alsomodifiedbyauthor IS INITIAL.</span><br><span class="line"><span class="comment">*   Classes modified by author</span></span><br><span class="line">    <span class="keyword">IF</span> customerclassesonly IS INITIAL.</span><br><span class="line"><span class="comment">*     Select all classes</span></span><br><span class="line">      SELECT clsname descript msg_id</span><br><span class="line">      FROM vseoclass</span><br><span class="line">      APPENDING CORRESPONDING FIELDS OF <span class="keyword">TABLE</span> ilocclass</span><br><span class="line">      WHERE clsname <span class="keyword">IN</span> rangeclass</span><br><span class="line">      AND langu = language</span><br><span class="line">      AND ( author <span class="keyword">IN</span> rangeauthor OR changedby <span class="keyword">IN</span> rangeauthor )</span><br><span class="line">      AND <span class="keyword">version</span> = '1'</span><br><span class="line">      AND ( state = '0' OR state = '1' ).</span><br><span class="line"></span><br><span class="line">      <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line">        SELECT clsname descript msg_id</span><br><span class="line">        FROM vseoclass</span><br><span class="line">        APPENDING CORRESPONDING FIELDS OF <span class="keyword">TABLE</span> ilocclass</span><br><span class="line">        WHERE clsname <span class="keyword">IN</span> rangeclass</span><br><span class="line">        AND langu = language</span><br><span class="line">        AND ( author <span class="keyword">IN</span> rangeauthor OR changedby <span class="keyword">IN</span> rangeauthor )</span><br><span class="line">        AND <span class="keyword">version</span> = '0'</span><br><span class="line">        AND ( state = '0' OR state = '1' ).</span><br><span class="line">      ENDIF.</span><br><span class="line">    <span class="keyword">ELSE</span>.</span><br><span class="line"><span class="comment">*     Select only customer specific classes</span></span><br><span class="line">      SELECT clsname descript msg_id</span><br><span class="line">      FROM vseoclass</span><br><span class="line">      APPENDING CORRESPONDING FIELDS OF <span class="keyword">TABLE</span> ilocclass</span><br><span class="line">      WHERE clsname <span class="keyword">IN</span> rangeclass</span><br><span class="line">      AND ( clsname LIKE altcustomernamerange</span><br><span class="line">      OR clsname LIKE 'Z%'</span><br><span class="line">      OR clsname LIKE 'Y%')</span><br><span class="line">      AND langu = language</span><br><span class="line">      AND ( author <span class="keyword">IN</span> rangeauthor OR changedby <span class="keyword">IN</span> rangeauthor )</span><br><span class="line">      AND <span class="keyword">version</span> = '1'</span><br><span class="line">      AND ( state = '0' OR state = '1' ).</span><br><span class="line"></span><br><span class="line">      <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line">        SELECT clsname descript msg_id</span><br><span class="line">        FROM vseoclass</span><br><span class="line">        APPENDING CORRESPONDING FIELDS OF <span class="keyword">TABLE</span> ilocclass</span><br><span class="line">        WHERE clsname <span class="keyword">IN</span> rangeclass</span><br><span class="line">        AND ( clsname LIKE altcustomernamerange</span><br><span class="line">        OR clsname LIKE 'Z%'</span><br><span class="line">        OR clsname LIKE 'Y%')</span><br><span class="line">        AND langu = language</span><br><span class="line">        AND ( author <span class="keyword">IN</span> rangeauthor OR changedby <span class="keyword">IN</span> rangeauthor )</span><br><span class="line">        AND <span class="keyword">version</span> = '0'</span><br><span class="line">        AND ( state = '0' OR state = '1' ).</span><br><span class="line">      ENDIF.</span><br><span class="line">    ENDIF.</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line"><span class="comment">*   Programs created by author</span></span><br><span class="line">    <span class="keyword">IF</span> customerclassesonly IS INITIAL.</span><br><span class="line"><span class="comment">*     Select all classes</span></span><br><span class="line">      SELECT clsname descript msg_id</span><br><span class="line">      FROM vseoclass</span><br><span class="line">      APPENDING CORRESPONDING FIELDS OF <span class="keyword">TABLE</span> ilocclass</span><br><span class="line">      WHERE clsname <span class="keyword">IN</span> rangeclass</span><br><span class="line">      AND langu = language</span><br><span class="line">      AND author <span class="keyword">IN</span> rangeauthor</span><br><span class="line">      AND <span class="keyword">version</span> = '1'</span><br><span class="line">      AND ( state = '0' OR state = '1' ).</span><br><span class="line"></span><br><span class="line">      <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line">        SELECT clsname descript msg_id</span><br><span class="line">        FROM vseoclass</span><br><span class="line">        APPENDING CORRESPONDING FIELDS OF <span class="keyword">TABLE</span> ilocclass</span><br><span class="line">        WHERE clsname <span class="keyword">IN</span> rangeclass</span><br><span class="line">        AND langu = language</span><br><span class="line">        AND author <span class="keyword">IN</span> rangeauthor</span><br><span class="line">        AND <span class="keyword">version</span> = '0'</span><br><span class="line">        AND ( state = '0' OR state = '1' ).</span><br><span class="line">      ENDIF.</span><br><span class="line">    <span class="keyword">ELSE</span>.</span><br><span class="line"><span class="comment">*     Select only customer specific classes</span></span><br><span class="line">      SELECT clsname descript msg_id</span><br><span class="line">      FROM vseoclass</span><br><span class="line">      APPENDING CORRESPONDING FIELDS OF <span class="keyword">TABLE</span> ilocclass</span><br><span class="line">      WHERE clsname <span class="keyword">IN</span> rangeclass</span><br><span class="line">      AND ( clsname LIKE altcustomernamerange</span><br><span class="line">      OR clsname LIKE 'Z%'</span><br><span class="line">      OR clsname LIKE 'Y%')</span><br><span class="line">      AND langu = language</span><br><span class="line">      AND author <span class="keyword">IN</span> rangeauthor</span><br><span class="line">      AND <span class="keyword">version</span> = '1'</span><br><span class="line">      AND ( state = '0' OR state = '1' ).</span><br><span class="line"></span><br><span class="line">      <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line">        SELECT clsname descript msg_id</span><br><span class="line">        FROM vseoclass</span><br><span class="line">        APPENDING CORRESPONDING FIELDS OF <span class="keyword">TABLE</span> ilocclass</span><br><span class="line">        WHERE clsname <span class="keyword">IN</span> rangeclass</span><br><span class="line">        AND ( clsname LIKE altcustomernamerange</span><br><span class="line">        OR clsname LIKE 'Z%'</span><br><span class="line">        OR clsname LIKE 'Y%')</span><br><span class="line">        AND langu = language</span><br><span class="line">        AND author <span class="keyword">IN</span> rangeauthor</span><br><span class="line">        AND <span class="keyword">version</span> = '0'</span><br><span class="line">        AND ( state = '0' OR state = '1' ).</span><br><span class="line">      ENDIF.</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.                                                                        "findAllClassesForAuthor</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  findClassesByWildcard...  Find classes using a wildcard search</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> findclassesbywildcard USING ilocclass LIKE iclasses[]</span><br><span class="line">      rangeclass LIKE soclassname[]</span><br><span class="line">      VALUE(rangeauthor) LIKE soauthor[]</span><br><span class="line">      VALUE(custnamerange)</span><br><span class="line">      VALUE(customerclassesonly)</span><br><span class="line">      VALUE(language).</span><br><span class="line"></span><br><span class="line">  DATA: altcustomernamerange <span class="keyword">TYPE</span> string.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> customerclassesonly IS INITIAL.</span><br><span class="line"><span class="comment">*   Searching for customer and SAP classes</span></span><br><span class="line">    <span class="keyword">IF</span> custnamerange &lt;&gt; '^'.</span><br><span class="line"><span class="comment">*     build up the customer name range used for select statements</span></span><br><span class="line">      CONCATENATE custnamerange '%' INTO altcustomernamerange.</span><br><span class="line"></span><br><span class="line">      SELECT clsname descript msg_id</span><br><span class="line">      FROM vseoclass</span><br><span class="line">      APPENDING CORRESPONDING FIELDS OF <span class="keyword">TABLE</span> ilocclass</span><br><span class="line">      WHERE clsname <span class="keyword">IN</span> rangeclass</span><br><span class="line">      AND clsname LIKE custnamerange</span><br><span class="line">      AND langu = language</span><br><span class="line">      AND ( author <span class="keyword">IN</span> rangeauthor OR changedby <span class="keyword">IN</span> rangeauthor )</span><br><span class="line">      AND <span class="keyword">version</span> = '1'</span><br><span class="line">      AND ( state = '0' OR state = '1' ).</span><br><span class="line">      <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line">        SELECT clsname descript msg_id</span><br><span class="line">        FROM vseoclass</span><br><span class="line">        APPENDING CORRESPONDING FIELDS OF <span class="keyword">TABLE</span> ilocclass</span><br><span class="line">        WHERE clsname <span class="keyword">IN</span> rangeclass</span><br><span class="line">        AND clsname LIKE custnamerange</span><br><span class="line">        AND langu = language</span><br><span class="line">        AND ( author <span class="keyword">IN</span> rangeauthor OR changedby <span class="keyword">IN</span> rangeauthor )</span><br><span class="line">        AND <span class="keyword">version</span> = '0'</span><br><span class="line">        AND ( state = '0' OR state = '1' ).</span><br><span class="line">      ENDIF.</span><br><span class="line">    <span class="keyword">ELSE</span>.</span><br><span class="line"><span class="comment">*     Searching using normal name ranges</span></span><br><span class="line">      SELECT clsname descript msg_id</span><br><span class="line">      FROM vseoclass</span><br><span class="line">      APPENDING CORRESPONDING FIELDS OF <span class="keyword">TABLE</span> ilocclass</span><br><span class="line">      WHERE clsname <span class="keyword">IN</span> rangeclass</span><br><span class="line">      AND langu = language</span><br><span class="line">      AND ( author <span class="keyword">IN</span> rangeauthor OR changedby <span class="keyword">IN</span> rangeauthor )</span><br><span class="line">      AND <span class="keyword">version</span> = '1'</span><br><span class="line">      AND ( state = '0' OR state = '1' ).</span><br><span class="line">      <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line">        SELECT clsname descript msg_id</span><br><span class="line">        FROM vseoclass</span><br><span class="line">        APPENDING CORRESPONDING FIELDS OF <span class="keyword">TABLE</span> ilocclass</span><br><span class="line">        WHERE clsname <span class="keyword">IN</span> rangeclass</span><br><span class="line">        AND langu = language</span><br><span class="line">        AND ( author <span class="keyword">IN</span> rangeauthor OR changedby <span class="keyword">IN</span> rangeauthor )</span><br><span class="line">        AND <span class="keyword">version</span> = '0'</span><br><span class="line">        AND ( state = '0' OR state = '1' ).</span><br><span class="line">      ENDIF.</span><br><span class="line">    ENDIF.</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line"><span class="comment">*   searching for only customer classes</span></span><br><span class="line">    <span class="keyword">IF</span> custnamerange &lt;&gt; '^'.</span><br><span class="line"><span class="comment">*     build up the customer name range used for select statements</span></span><br><span class="line">      CONCATENATE custnamerange '%' INTO altcustomernamerange.</span><br><span class="line"></span><br><span class="line">      SELECT clsname descript msg_id</span><br><span class="line">      FROM vseoclass</span><br><span class="line">      APPENDING CORRESPONDING FIELDS OF <span class="keyword">TABLE</span> ilocclass</span><br><span class="line">      WHERE clsname <span class="keyword">IN</span> rangeclass</span><br><span class="line">      AND clsname LIKE custnamerange</span><br><span class="line">      AND langu = language</span><br><span class="line">      AND ( clsname LIKE 'ZC%' OR clsname LIKE 'YC%' )</span><br><span class="line">      AND ( author <span class="keyword">IN</span> rangeauthor OR changedby <span class="keyword">IN</span> rangeauthor )</span><br><span class="line">      AND <span class="keyword">version</span> = '1'</span><br><span class="line">      AND ( state = '0' OR state = '1' ).</span><br><span class="line">      <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line">        SELECT clsname descript msg_id</span><br><span class="line">        FROM vseoclass</span><br><span class="line">        APPENDING CORRESPONDING FIELDS OF <span class="keyword">TABLE</span> ilocclass</span><br><span class="line">        WHERE clsname <span class="keyword">IN</span> rangeclass</span><br><span class="line">        AND langu = language</span><br><span class="line">        AND ( clsname LIKE 'ZC%' OR clsname LIKE 'YC%' )</span><br><span class="line">        AND ( author <span class="keyword">IN</span> rangeauthor OR changedby <span class="keyword">IN</span> rangeauthor )</span><br><span class="line">        AND <span class="keyword">version</span> = '0'</span><br><span class="line">        AND ( state = '0' OR state = '1' ).</span><br><span class="line">      ENDIF.</span><br><span class="line">    <span class="keyword">ELSE</span>.</span><br><span class="line"><span class="comment">*     Searching using normal name ranges</span></span><br><span class="line">      SELECT clsname descript msg_id</span><br><span class="line">      FROM vseoclass</span><br><span class="line">      APPENDING CORRESPONDING FIELDS OF <span class="keyword">TABLE</span> ilocclass</span><br><span class="line">      WHERE clsname <span class="keyword">IN</span> rangeclass</span><br><span class="line">      AND ( clsname LIKE 'ZC%' OR clsname LIKE 'YC%' )</span><br><span class="line">      AND ( author <span class="keyword">IN</span> rangeauthor OR changedby <span class="keyword">IN</span> rangeauthor )</span><br><span class="line">      AND <span class="keyword">version</span> = '1'</span><br><span class="line">      AND ( state = '0' OR state = '1' ).</span><br><span class="line">      <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line">        SELECT clsname descript msg_id</span><br><span class="line">        FROM vseoclass</span><br><span class="line">        APPENDING CORRESPONDING FIELDS OF <span class="keyword">TABLE</span> ilocclass</span><br><span class="line">        WHERE clsname <span class="keyword">IN</span> rangeclass</span><br><span class="line">        AND ( clsname LIKE 'ZC%' OR clsname LIKE 'YC%' )</span><br><span class="line">        AND ( author <span class="keyword">IN</span> rangeauthor OR changedby <span class="keyword">IN</span> rangeauthor )</span><br><span class="line">        AND <span class="keyword">version</span> = '0'</span><br><span class="line">        AND ( state = '0' OR state = '1' ).</span><br><span class="line">      ENDIF.</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.                                                                          "findClassesByWildcard</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  checkClassDoesExist...</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> checkclassdoesexist USING ilocclass LIKE iclasses[]</span><br><span class="line">      rangeclass LIKE soclassname[].</span><br><span class="line"></span><br><span class="line">  DATA: waclass <span class="keyword">TYPE</span> tclass.</span><br><span class="line"></span><br><span class="line">  SELECT SINGLE clsname descript msg_id</span><br><span class="line">  FROM vseoclass</span><br><span class="line">  INTO CORRESPONDING FIELDS OF waclass</span><br><span class="line">  WHERE clsname <span class="keyword">IN</span> rangeclass</span><br><span class="line">  AND <span class="keyword">version</span> = '1'</span><br><span class="line">  AND ( state = '0' OR state = '1' ).</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line">    SELECT SINGLE clsname descript msg_id</span><br><span class="line">    FROM vseoclass</span><br><span class="line">    INTO CORRESPONDING FIELDS OF waclass</span><br><span class="line">    WHERE clsname <span class="keyword">IN</span> rangeclass</span><br><span class="line">    AND <span class="keyword">version</span> = '0'</span><br><span class="line">    AND ( state = '0' OR state = '1' ).</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> NOT waclass-clsname IS INITIAL.</span><br><span class="line">    <span class="keyword">APPEND</span> waclass TO ilocclass.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.                                                                            "checkClassDoesExist</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  scanForAdditionalClassStuff...</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> scanforadditionalclassstuff USING ilocclasses LIKE iclasses[]</span><br><span class="line">      ilocfunctions LIKE ifunctions[]</span><br><span class="line">      VALUE(gettextelements)</span><br><span class="line">      VALUE(getmessages)</span><br><span class="line">      VALUE(getcustdictstructures)</span><br><span class="line">      VALUE(getfunctions)</span><br><span class="line">      VALUE(getincludes)</span><br><span class="line">      VALUE(gettransformations)</span><br><span class="line">      VALUE(customeronly)</span><br><span class="line">      VALUE(customernamerange)</span><br><span class="line">      VALUE(recursiveincludesearch)</span><br><span class="line">      VALUE(recursivefuncsearch)</span><br><span class="line">      VALUE(recursiveclasssearch)</span><br><span class="line">      VALUE(solocpackage) LIKE sopack[].</span><br><span class="line"></span><br><span class="line">  DATA: waclass <span class="keyword">TYPE</span> tclass.</span><br><span class="line">  DATA: wamethod <span class="keyword">TYPE</span> tmethod.</span><br><span class="line">  DATA: mytabix <span class="keyword">TYPE</span> sytabix.</span><br><span class="line">  DATA: scanningforclasses <span class="keyword">TYPE</span> abap_bool VALUE false.</span><br><span class="line">  DATA: classnewlines <span class="keyword">TYPE</span> i VALUE 0.</span><br><span class="line">  DATA: classcurrentlines <span class="keyword">TYPE</span> i VALUE 0.</span><br><span class="line"></span><br><span class="line">  LOOP AT ilocclasses INTO waclass WHERE scanned IS INITIAL.</span><br><span class="line"><span class="comment">*  Once we have a list of all the classes we need to loop round them an select all the other objects</span></span><br><span class="line">    mytabix = sy-tabix.</span><br><span class="line">    PERFORM findclassdetails USING waclass-clsname</span><br><span class="line">          waclass</span><br><span class="line">          ilocfunctions[]</span><br><span class="line">          gettextelements</span><br><span class="line">          getmessages</span><br><span class="line">          getfunctions</span><br><span class="line">          getcustdictstructures</span><br><span class="line">          gettransformations</span><br><span class="line">          customeronly</span><br><span class="line">          customernamerange.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Set the scanned class so we do not check them again when running recursively.</span></span><br><span class="line">    waclass-scanned = 'X'.</span><br><span class="line">    MODIFY ilocclasses FROM waclass INDEX mytabix.</span><br><span class="line">  ENDLOOP.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Now we have all the classes and details we need to find extra classes</span></span><br><span class="line">  <span class="keyword">IF</span> NOT recursiveclasssearch IS INITIAL.</span><br><span class="line">    classcurrentlines = lines( ilocclasses ).</span><br><span class="line">    LOOP AT ilocclasses INTO waclass.</span><br><span class="line"><span class="comment">*     Don't try and find any other details for an exception class</span></span><br><span class="line">      <span class="keyword">IF</span> ( waclass-clsname NS 'ZCX_' OR waclass-clsname NS 'CX_'  ).</span><br><span class="line"><span class="comment">*       Find any classes defined in the main class definition</span></span><br><span class="line">        PERFORM scanforclasses USING waclass-privateclasskey</span><br><span class="line">              waclass-clsname</span><br><span class="line">              customeronly</span><br><span class="line">              customernamerange</span><br><span class="line">              ilocclasses[]</span><br><span class="line">              solocpackage[].</span><br><span class="line"></span><br><span class="line">        PERFORM scanforclasses USING waclass-publicclasskey</span><br><span class="line">              waclass-clsname</span><br><span class="line">              customeronly</span><br><span class="line">              customernamerange</span><br><span class="line">              ilocclasses[]</span><br><span class="line">              solocpackage[].</span><br><span class="line"></span><br><span class="line">        PERFORM scanforclasses USING waclass-protectedclasskey</span><br><span class="line">              waclass-clsname</span><br><span class="line">              customeronly</span><br><span class="line">              customernamerange</span><br><span class="line">              ilocclasses[]</span><br><span class="line">              solocpackage[].</span><br><span class="line"></span><br><span class="line">        LOOP AT waclass-imethods INTO wamethod.</span><br><span class="line"><span class="comment">*         Find any classes defined in any of the methods</span></span><br><span class="line">          PERFORM scanforclasses USING wamethod-methodkey</span><br><span class="line">                waclass-clsname</span><br><span class="line">                customeronly</span><br><span class="line">                customernamerange</span><br><span class="line">                ilocclasses[]</span><br><span class="line">                solocpackage[].</span><br><span class="line">        ENDLOOP.</span><br><span class="line">      ENDIF.</span><br><span class="line">    ENDLOOP.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   We have a list of all the classes so lets go and find their details</span></span><br><span class="line">    classnewlines = lines( ilocclasses ).</span><br><span class="line">    <span class="keyword">IF</span> classnewlines &gt; classcurrentlines.</span><br><span class="line">      PERFORM scanforadditionalclassstuff USING ilocclasses[]</span><br><span class="line">            ilocfunctions[]</span><br><span class="line">            gettextelements</span><br><span class="line">            getmessages</span><br><span class="line">            getcustdictstructures</span><br><span class="line">            getfunctions</span><br><span class="line">            getincludes</span><br><span class="line">            gettransformations</span><br><span class="line">            customeronly</span><br><span class="line">            customernamerange</span><br><span class="line">            recursiveincludesearch</span><br><span class="line">            recursivefuncsearch</span><br><span class="line">            recursiveclasssearch</span><br><span class="line">            solocpackage[].</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.                                                                   "scanForAdditionalClassStuff</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  findClassDetails...</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> findclassdetails USING VALUE(classname)</span><br><span class="line">      waclass <span class="keyword">TYPE</span> tclass</span><br><span class="line">      ilocfunctions LIKE ifunctions[]</span><br><span class="line">      VALUE(gettextelements)</span><br><span class="line">      VALUE(getmessages)</span><br><span class="line">      VALUE(getfunctions)</span><br><span class="line">      VALUE(getcustdictstructures)</span><br><span class="line">      VALUE(gettransformations)</span><br><span class="line">      VALUE(customeronly)</span><br><span class="line">      VALUE(customernamerange).</span><br><span class="line"></span><br><span class="line">  DATA: iemptyselectiontexts <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF ttexttable.</span><br><span class="line">  DATA: mytabix <span class="keyword">TYPE</span> sytabix.</span><br><span class="line">  DATA: wamethod <span class="keyword">TYPE</span> tmethod.</span><br><span class="line">  DATA: rnblankauthor LIKE soauthor[].</span><br><span class="line">  DATA: rnblankpackage LIKE sopack[].</span><br><span class="line">  DATA: wainterface <span class="keyword">TYPE</span> tinterface.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Build up the keys we will use for finding data</span></span><br><span class="line">  PERFORM buildclasskeys USING waclass.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> waclass-descript IS INITIAL.</span><br><span class="line">    PERFORM findclassdescription USING classname</span><br><span class="line">          waclass-descript.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Find the class attributes.</span></span><br><span class="line">  SELECT SINGLE exposure msg_id state clsfinal r3release</span><br><span class="line">  FROM vseoclass</span><br><span class="line">  INTO (waclass-exposure, waclass-msg_id, waclass-state,</span><br><span class="line">  waclass-clsfinal, waclass-r3release)</span><br><span class="line">  WHERE clsname = waclass-clsname.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Don't try and find any other details for an exception class</span></span><br><span class="line">  <span class="keyword">IF</span> ( waclass-clsname <span class="keyword">CS</span> 'ZCX_' OR waclass-clsname <span class="keyword">CS</span> 'CX_'  ).</span><br><span class="line"><span class="comment">*   Exception texts</span></span><br><span class="line">    PERFORM findexceptiontexts USING waclass-publicclasskey</span><br><span class="line">          waclass-iconcepts[].</span><br><span class="line">    waclass-scanned = 'X'.</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line">    <span class="keyword">IF</span> NOT gettextelements IS INITIAL.</span><br><span class="line"><span class="comment">*     Find the class texts from out of the database.</span></span><br><span class="line">      PERFORM retrieveprogramtexts USING iemptyselectiontexts[]</span><br><span class="line">            waclass-itextelements[]</span><br><span class="line">            waclass-textelementkey.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Find any declared dictionary structures</span></span><br><span class="line">    <span class="keyword">IF</span> NOT getcustdictstructures IS INITIAL.</span><br><span class="line">      PERFORM scanfortables USING waclass-privateclasskey</span><br><span class="line">            customeronly</span><br><span class="line">            customernamerange</span><br><span class="line">            waclass-idictstruct[].</span><br><span class="line"></span><br><span class="line">      PERFORM scanfortables USING waclass-publicclasskey</span><br><span class="line">            customeronly</span><br><span class="line">            customernamerange</span><br><span class="line">            waclass-idictstruct[].</span><br><span class="line"></span><br><span class="line">      PERFORM scanfortables USING waclass-protectedclasskey</span><br><span class="line">            customeronly</span><br><span class="line">            customernamerange</span><br><span class="line">            waclass-idictstruct[].</span><br><span class="line"></span><br><span class="line">      PERFORM scanfortables USING waclass-typesclasskey</span><br><span class="line">            customeronly</span><br><span class="line">            customernamerange</span><br><span class="line">            waclass-idictstruct[].</span><br><span class="line"></span><br><span class="line">      PERFORM scanforlikeortype USING waclass-privateclasskey</span><br><span class="line">            customeronly</span><br><span class="line">            customernamerange</span><br><span class="line">            waclass-idictstruct[]</span><br><span class="line">            waclass-itabletypes[].</span><br><span class="line"></span><br><span class="line">      PERFORM scanforlikeortype USING waclass-publicclasskey</span><br><span class="line">            customeronly</span><br><span class="line">            customernamerange</span><br><span class="line">            waclass-idictstruct[]</span><br><span class="line">            waclass-itabletypes[].</span><br><span class="line"></span><br><span class="line">      PERFORM scanforlikeortype USING waclass-protectedclasskey</span><br><span class="line">            customeronly</span><br><span class="line">            customernamerange</span><br><span class="line">            waclass-idictstruct[]</span><br><span class="line">            waclass-itabletypes[].</span><br><span class="line"></span><br><span class="line">      PERFORM scanforlikeortype USING waclass-typesclasskey</span><br><span class="line">            customeronly</span><br><span class="line">            customernamerange</span><br><span class="line">            waclass-idictstruct[]</span><br><span class="line">            waclass-itabletypes[].</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Find all the interfaces used in this class</span></span><br><span class="line">    PERFORM findclassinterfaces USING classname</span><br><span class="line">          waclass-iinterfaces[].</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Find all the methods defined by the interfaces</span></span><br><span class="line">    PERFORM findinterfacemethods USING classname</span><br><span class="line">          waclass-iinterfaces[]</span><br><span class="line">          waclass-imethods[].</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Methods</span></span><br><span class="line"><span class="comment">*   Find all the methods for this class</span></span><br><span class="line">    PERFORM findclassmethods USING classname</span><br><span class="line">          waclass-imethods[].</span><br><span class="line"></span><br><span class="line">    LOOP AT waclass-imethods[] INTO wamethod.</span><br><span class="line">      mytabix = sy-tabix.</span><br><span class="line"><span class="comment">*     Find individual messages</span></span><br><span class="line">      <span class="keyword">IF</span> NOT getmessages IS INITIAL.</span><br><span class="line">        PERFORM scanformessages USING wamethod-methodkey</span><br><span class="line">              waclass-msg_id</span><br><span class="line">              waclass-imessages[].</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">IF</span> NOT getcustdictstructures IS INITIAL.</span><br><span class="line"><span class="comment">*       Find any declared dictionary structures</span></span><br><span class="line">        PERFORM scanfortables USING wamethod-methodkey</span><br><span class="line">              customeronly</span><br><span class="line">              customernamerange</span><br><span class="line">              waclass-idictstruct[].</span><br><span class="line"></span><br><span class="line">        PERFORM scanforlikeortype USING wamethod-methodkey</span><br><span class="line">              customeronly</span><br><span class="line">              customernamerange</span><br><span class="line">              waclass-idictstruct[]</span><br><span class="line">              waclass-itabletypes[].</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">IF</span> NOT getfunctions IS INITIAL.</span><br><span class="line">        PERFORM scanforfunctions USING wamethod-methodkey</span><br><span class="line">              waclass-clsname</span><br><span class="line">              space</span><br><span class="line">              space</span><br><span class="line">              customeronly</span><br><span class="line">              customernamerange</span><br><span class="line">              ilocfunctions[].</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*     Find any XSLT Transformations</span></span><br><span class="line">      <span class="keyword">IF</span> NOT gettransformations IS INITIAL.</span><br><span class="line">        PERFORM scanfortransformations USING wamethod-methodkey</span><br><span class="line">              customeronly</span><br><span class="line">              customernamerange</span><br><span class="line">              waclass-itransformations[].</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line">      MODIFY waclass-imethods FROM wamethod INDEX mytabix.</span><br><span class="line">    ENDLOOP.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   If the class has specified a message class but were unable to find any specific messages</span></span><br><span class="line"><span class="comment">*   then retrieve the whole message class.</span></span><br><span class="line">    <span class="keyword">IF</span> ( NOT waclass-msg_id IS INITIAL AND waclass-imessages[] IS INITIAL ).</span><br><span class="line">      PERFORM retrievemessageclass USING waclass-imessages[]</span><br><span class="line">            rnblankauthor[]</span><br><span class="line">            waclass-msg_id</span><br><span class="line">            pmlang</span><br><span class="line">            ''</span><br><span class="line">            rnblankpackage[].</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.                                                                               "findClassDetails</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* Find all interface methods used by the class</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> findinterfacemethods USING VALUE(classname)</span><br><span class="line">      ilocinterfaces LIKE dumiinterfaces[]</span><br><span class="line">      ilocmethods LIKE dumimethods[].</span><br><span class="line"></span><br><span class="line">  TYPES: BEGIN OF tintmethod,</span><br><span class="line">           interfacename LIKE vseomethod-clsname,</span><br><span class="line">           cmpname       LIKE vseomethod-cmpname,</span><br><span class="line">           exposure      LIKE vseomethod-exposure,</span><br><span class="line">         END OF tintmethod.</span><br><span class="line">  DATA: wamethod <span class="keyword">TYPE</span> tmethod.</span><br><span class="line">  DATA: wainterface LIKE <span class="keyword">LINE</span> OF ilocinterfaces.</span><br><span class="line">  DATA: iintmethod <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF tintmethod WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line"></span><br><span class="line">  LOOP AT ilocinterfaces INTO wainterface.</span><br><span class="line">    SELECT a~clsname <span class="keyword">AS</span> interfacename</span><br><span class="line">    a~cmpname</span><br><span class="line">    b~exposure</span><br><span class="line">    APPENDING <span class="keyword">TABLE</span> iintmethod</span><br><span class="line">    FROM seocompo <span class="keyword">AS</span> a</span><br><span class="line">    INNER JOIN seocompodf <span class="keyword">AS</span> b</span><br><span class="line">    <span class="keyword">ON</span> a~clsname = b~clsname</span><br><span class="line">    AND a~cmpname = b~cmpname</span><br><span class="line">    WHERE a~clsname = wainterface-interfacename.</span><br><span class="line">  ENDLOOP.</span><br><span class="line"></span><br><span class="line">  LOOP AT iintmethod.</span><br><span class="line">    CONCATENATE iintmethod-interfacename '~' iintmethod-cmpname INTO wamethod-cmpname.</span><br><span class="line">    wamethod-exposure = iintmethod-exposure.</span><br><span class="line"></span><br><span class="line">    SELECT SINGLE descript</span><br><span class="line">    FROM seocompotx</span><br><span class="line">    INTO wamethod-descript</span><br><span class="line">    WHERE clsname = iintmethod-interfacename</span><br><span class="line">    AND cmpname = iintmethod-cmpname</span><br><span class="line">    AND langu = pmlang.</span><br><span class="line"></span><br><span class="line">    PERFORM findmethodkey USING classname</span><br><span class="line">          wamethod-cmpname</span><br><span class="line">          wamethod-methodkey.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">IF</span> NOT wamethod-methodkey IS INITIAL.</span><br><span class="line">      <span class="keyword">APPEND</span> wamethod TO ilocmethods.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">CLEAR</span> wamethod.</span><br><span class="line">  ENDLOOP.</span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*   Check to see if their are any interfaces being used by this class</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> findclassinterfaces USING VALUE(classname)</span><br><span class="line">      ilocinterfaces LIKE dumiinterfaces[].</span><br><span class="line"></span><br><span class="line">  DATA: isinheritance <span class="keyword">TYPE</span> abap_bool VALUE abap_true.</span><br><span class="line">  DATA: iinterfaces <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF vseoimplem WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: walocinterface LIKE <span class="keyword">LINE</span> OF ilocinterfaces.</span><br><span class="line"></span><br><span class="line">  SELECT * FROM vseoimplem</span><br><span class="line">  INTO <span class="keyword">TABLE</span> iinterfaces</span><br><span class="line">  WHERE clsname = classname.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">WHILE</span> isinheritance = abap_true.</span><br><span class="line">    PERFORM findclassparent USING classname</span><br><span class="line">          classname.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">IF</span> classname IS INITIAL.</span><br><span class="line">      isinheritance = abap_false.</span><br><span class="line">    <span class="keyword">ELSE</span>.</span><br><span class="line">      SELECT * FROM vseoimplem</span><br><span class="line">      APPENDING <span class="keyword">TABLE</span> iinterfaces</span><br><span class="line">      WHERE clsname = classname.</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDWHILE.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> NOT iinterfaces[] IS INITIAL.</span><br><span class="line">    <span class="keyword">SORT</span> iinterfaces ASCENDING <span class="keyword">BY</span> refclsname.</span><br><span class="line">    DELETE ADJACENT <span class="keyword">DUPLICATES</span> FROM iinterfaces COMPARING refclsname.</span><br><span class="line"></span><br><span class="line">    LOOP AT iinterfaces.</span><br><span class="line">      walocinterface-interfacename = iinterfaces-refclsname.</span><br><span class="line">      <span class="keyword">APPEND</span> walocinterface TO ilocinterfaces.</span><br><span class="line">    ENDLOOP.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  Find the parent of the current class</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> findclassparent USING VALUE(classname)</span><br><span class="line">      parentclassname.</span><br><span class="line"></span><br><span class="line">  DATA: wainheritance <span class="keyword">TYPE</span> seor_inheritance_r.</span><br><span class="line">  DATA: clskey <span class="keyword">TYPE</span> seoclskey.</span><br><span class="line"></span><br><span class="line">  clskey-clsname = classname.</span><br><span class="line"></span><br><span class="line">  CALL FUNCTION 'SEO_INHERITANC_READ'</span><br><span class="line">    EXPORTING</span><br><span class="line">      clskey             = clskey</span><br><span class="line">      <span class="keyword">version</span>            = seoc_version_active</span><br><span class="line">    IMPORTING</span><br><span class="line">      inheritance        = wainheritance</span><br><span class="line"><span class="comment">*     redefinitions      = redefinitions</span></span><br><span class="line">    EXCEPTIONS</span><br><span class="line">      class_not_existing = 1.</span><br><span class="line"></span><br><span class="line">  parentclassname = wainheritance-refclsname.</span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  buildClassKeys...   Finds the title text of a class.</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> buildclasskeys USING waclass <span class="keyword">TYPE</span> tclass.</span><br><span class="line"></span><br><span class="line">  DATA: classnamelength <span class="keyword">TYPE</span> i.</span><br><span class="line">  DATA: loops <span class="keyword">TYPE</span> i.</span><br><span class="line"></span><br><span class="line">  classnamelength = <span class="literal">strlen</span>( waclass-clsname ).</span><br><span class="line"></span><br><span class="line">  cl_oo_classname_service=&gt;get_pubsec_name( EXPORTING clsname = waclass-clsname</span><br><span class="line">    RECEIVING result = waclass-publicclasskey ).</span><br><span class="line"></span><br><span class="line">  cl_oo_classname_service=&gt;get_prisec_name( EXPORTING clsname = waclass-clsname</span><br><span class="line">    RECEIVING result = waclass-privateclasskey ).</span><br><span class="line"></span><br><span class="line">  cl_oo_classname_service=&gt;get_prosec_name( EXPORTING clsname = waclass-clsname</span><br><span class="line">    RECEIVING result = waclass-protectedclasskey ).</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* Text element key - length of text element key has to be 32 characters.</span></span><br><span class="line">  loops = 30 - classnamelength.</span><br><span class="line">  waclass-textelementkey = waclass-clsname.</span><br><span class="line">  <span class="keyword">DO</span> loops TIMES.</span><br><span class="line">    CONCATENATE waclass-textelementkey '=' INTO waclass-textelementkey.</span><br><span class="line">  ENDDO.</span><br><span class="line"><span class="comment">* Save this for later.</span></span><br><span class="line">  CONCATENATE waclass-textelementkey 'CP' INTO waclass-textelementkey.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Types Class key - length of class name has to be 32 characters.</span></span><br><span class="line">  loops = 30 - classnamelength.</span><br><span class="line">  waclass-typesclasskey = waclass-clsname.</span><br><span class="line">  <span class="keyword">DO</span> loops TIMES.</span><br><span class="line">    CONCATENATE waclass-typesclasskey '=' INTO waclass-typesclasskey.</span><br><span class="line">  ENDDO.</span><br><span class="line"><span class="comment">* Save this for later</span></span><br><span class="line">  CONCATENATE waclass-typesclasskey '<span class="keyword">CT</span>' INTO waclass-typesclasskey.</span><br><span class="line">ENDFORM.                                                                                 "buildClassKeys</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  findClassDescription...   Finds the title text of a class.</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> findclassdescription USING VALUE(classname)</span><br><span class="line">      titletext.</span><br><span class="line"></span><br><span class="line">  SELECT SINGLE descript</span><br><span class="line">  FROM vseoclass</span><br><span class="line">  INTO titletext</span><br><span class="line">  WHERE clsname = classname</span><br><span class="line">  AND langu = pmlang.</span><br><span class="line">  <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line">    SELECT SINGLE descript</span><br><span class="line">    FROM vseoclass</span><br><span class="line">    INTO titletext</span><br><span class="line">    WHERE clsname = classname.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.                                                                           "findClassDescription</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  findExceptionTexts...   Fiond the texts of an exception class.</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> findexceptiontexts USING publicclasskey</span><br><span class="line">      iconcepts LIKE dumiconcepts[].</span><br><span class="line"></span><br><span class="line">  DATA: castclassname <span class="keyword">TYPE</span> <span class="keyword">program</span>.</span><br><span class="line">  DATA: itemplines <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF string WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: itokens <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF stokes WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: ikeywords <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF text20 WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: istatements <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF sstmnt WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: watokens <span class="keyword">TYPE</span> stokes.</span><br><span class="line">  DATA: wacurrenttoken <span class="keyword">TYPE</span> stokes.</span><br><span class="line">  DATA: waconcept LIKE <span class="keyword">LINE</span> OF iconcepts.</span><br><span class="line">  DATA: tokenlength <span class="keyword">TYPE</span> i.</span><br><span class="line">  DATA: myrow <span class="keyword">TYPE</span> i.</span><br><span class="line"></span><br><span class="line">  castclassname = publicclasskey.</span><br><span class="line">  <span class="keyword">READ</span> <span class="keyword">REPORT</span> castclassname INTO itemplines.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">APPEND</span> 'CONSTANTS' TO ikeywords.</span><br><span class="line">  SCAN ABAP-SOURCE itemplines TOKENS INTO itokens STATEMENTS INTO istatements KEYWORDS FROM ikeywords.</span><br><span class="line"></span><br><span class="line">  DELETE itokens WHERE str = 'CONSTANTS'.</span><br><span class="line">  DELETE itokens WHERE str = 'VALUE'.</span><br><span class="line">  DELETE itokens WHERE str = '<span class="keyword">TYPE</span>'.</span><br><span class="line"></span><br><span class="line">  LOOP AT itokens INTO watokens WHERE str = 'SOTR_CONC'.</span><br><span class="line"><span class="comment">*   The loop before holds the constant name</span></span><br><span class="line">    myrow = sy-tabix - 1.</span><br><span class="line">    <span class="keyword">READ</span> <span class="keyword">TABLE</span> itokens INDEX myrow INTO wacurrenttoken.</span><br><span class="line">    waconcept-constname = wacurrenttoken-str.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   The loop after holds the constant name</span></span><br><span class="line">    myrow = myrow + 2.</span><br><span class="line">    <span class="keyword">READ</span> <span class="keyword">TABLE</span> itokens INDEX myrow INTO wacurrenttoken.</span><br><span class="line">    tokenlength = <span class="literal">strlen</span>( wacurrenttoken-str ).</span><br><span class="line">    <span class="keyword">IF</span> tokenlength = 34.</span><br><span class="line"><span class="comment">*     Most likely an exception text.</span></span><br><span class="line">      <span class="keyword">REPLACE</span> ALL OCCURRENCES OF '''' <span class="keyword">IN</span> wacurrenttoken-str WITH ' ' .</span><br><span class="line">      waconcept-concept = wacurrenttoken-str.</span><br><span class="line">      <span class="keyword">APPEND</span> waconcept TO iconcepts.</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDLOOP.</span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  findClassMethods...   Finds the methods of a class.</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> findclassmethods USING VALUE(classname)</span><br><span class="line">      ilocmethods LIKE dumimethods[].</span><br><span class="line"></span><br><span class="line">  DATA: imethods <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF tmethod WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: iredefinedmethods <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF seoredef WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: originalclassname <span class="keyword">TYPE</span> seoclsname.</span><br><span class="line">  DATA: wamethod LIKE <span class="keyword">LINE</span> OF imethods.</span><br><span class="line"></span><br><span class="line">  SELECT cmpname descript exposure</span><br><span class="line">  FROM vseomethod</span><br><span class="line">  INTO CORRESPONDING FIELDS OF <span class="keyword">TABLE</span> imethods</span><br><span class="line">  WHERE clsname = classname</span><br><span class="line">  AND <span class="keyword">version</span> = '1'</span><br><span class="line">  AND langu = pmlang</span><br><span class="line">  AND ( state = '0' OR state = '1' ).</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line">    SELECT cmpname descript exposure</span><br><span class="line">    FROM vseomethod</span><br><span class="line">    INTO CORRESPONDING FIELDS OF <span class="keyword">TABLE</span> imethods</span><br><span class="line">    WHERE clsname = classname</span><br><span class="line">    AND <span class="keyword">version</span> = '0'</span><br><span class="line">    AND langu = pmlang</span><br><span class="line">    AND ( state = '0' OR state = '1' ).</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">  SELECT *</span><br><span class="line">  FROM seoredef</span><br><span class="line">  INTO <span class="keyword">TABLE</span> iredefinedmethods</span><br><span class="line">  WHERE clsname = classname</span><br><span class="line">  AND <span class="keyword">version</span> = '1'.</span><br><span class="line"></span><br><span class="line"><span class="comment">*  For Each method we must find the original class the method was created in</span></span><br><span class="line">  LOOP AT iredefinedmethods.</span><br><span class="line">    PERFORM findredefinitionclass USING iredefinedmethods-refclsname</span><br><span class="line">          iredefinedmethods-mtdname</span><br><span class="line">          originalclassname.</span><br><span class="line"></span><br><span class="line">    wamethod-cmpname = iredefinedmethods-mtdname.</span><br><span class="line"></span><br><span class="line">    SELECT SINGLE descript exposure</span><br><span class="line">    FROM vseomethod</span><br><span class="line">    INTO CORRESPONDING FIELDS OF  wamethod</span><br><span class="line">    WHERE clsname = originalclassname</span><br><span class="line">    AND cmpname = iredefinedmethods-mtdname</span><br><span class="line">    AND <span class="keyword">version</span> = '1'</span><br><span class="line">    AND langu = pmlang</span><br><span class="line">    AND ( state = '0' OR state = '1' ).</span><br><span class="line"></span><br><span class="line">    CONCATENATE `Redefined: ` wamethod-descript INTO wamethod-descript.</span><br><span class="line">    <span class="keyword">APPEND</span> wamethod TO imethods.</span><br><span class="line">  ENDLOOP.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Find the method key so that we can acces the source code later</span></span><br><span class="line">  LOOP AT imethods.</span><br><span class="line">    PERFORM findmethodkey USING classname</span><br><span class="line">          imethods-cmpname</span><br><span class="line">          imethods-methodkey.</span><br><span class="line">    <span class="keyword">APPEND</span> imethods TO ilocmethods.</span><br><span class="line">  ENDLOOP.</span><br><span class="line">ENDFORM.                                                                               "findClassMethods</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* findRedefinitionClass... find the original class the method was redefined from</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> findredefinitionclass USING VALUE(redefinedclassname) <span class="keyword">TYPE</span> seoclsname</span><br><span class="line">      VALUE(methodname) <span class="keyword">TYPE</span> seocpdname</span><br><span class="line">      originalclassname <span class="keyword">TYPE</span> seoclsname.</span><br><span class="line"></span><br><span class="line">  DATA: waredef <span class="keyword">TYPE</span> seoredef.</span><br><span class="line"></span><br><span class="line">  SELECT SINGLE *</span><br><span class="line">  FROM seoredef</span><br><span class="line">  INTO waredef</span><br><span class="line">  WHERE refclsname = redefinedclassname</span><br><span class="line">  AND mtdname = methodname.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line"><span class="comment">*   There is a higher class still.</span></span><br><span class="line">    originalclassname = waredef-refclsname.</span><br><span class="line">    PERFORM findredefinitionclassrecur USING waredef-refclsname</span><br><span class="line">          waredef-mtdname</span><br><span class="line">          originalclassname.</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line"><span class="comment">*   We are at the higher class.</span></span><br><span class="line">    originalclassname = waredef-refclsname.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* findRedefinitionClassRecur... Recursively find the original class the method was redefined from</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> findredefinitionclassrecur USING VALUE(redefinedclassname) <span class="keyword">TYPE</span> seoclsname</span><br><span class="line">      VALUE(methodname) <span class="keyword">TYPE</span> seocpdname</span><br><span class="line">      originalclassname <span class="keyword">TYPE</span> seoclsname.</span><br><span class="line"></span><br><span class="line">  DATA: waredef <span class="keyword">TYPE</span> seoredef.</span><br><span class="line"></span><br><span class="line">  SELECT SINGLE *</span><br><span class="line">  FROM seoredef</span><br><span class="line">  INTO waredef</span><br><span class="line">  WHERE clsname = redefinedclassname</span><br><span class="line">  AND mtdname = methodname.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line"><span class="comment">*   There is a higher class still.</span></span><br><span class="line">    originalclassname = waredef-refclsname.</span><br><span class="line">    PERFORM findredefinitionclassrecur USING waredef-refclsname</span><br><span class="line">          waredef-mtdname</span><br><span class="line">          originalclassname.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* findMethodKey... find the unique key which identifes this method</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> findmethodkey USING VALUE(classname)</span><br><span class="line">      VALUE(methodname)</span><br><span class="line">      methodkey.</span><br><span class="line"></span><br><span class="line">  DATA: methodid <span class="keyword">TYPE</span> seocpdkey.</span><br><span class="line">  DATA: locmethodkey <span class="keyword">TYPE</span> <span class="keyword">program</span>.</span><br><span class="line"></span><br><span class="line">  methodid-clsname = classname.</span><br><span class="line">  methodid-cpdname = methodname.</span><br><span class="line"></span><br><span class="line">  cl_oo_classname_service=&gt;get_method_include( EXPORTING mtdkey = methodid</span><br><span class="line">    RECEIVING result = locmethodkey</span><br><span class="line">  EXCEPTIONS class_not_existing = 1</span><br><span class="line">    method_not_existing = 2 ).</span><br><span class="line"></span><br><span class="line">  methodkey = locmethodkey.</span><br><span class="line">ENDFORM.                                                                                  "findMethodKey</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* scanForMessages... Search each program for messages</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> scanformessages USING VALUE(programname)</span><br><span class="line">      VALUE(mainmessageclass)</span><br><span class="line">      ilocmessages LIKE imessages[].</span><br><span class="line"></span><br><span class="line">  DATA: iincludelines <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF string WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: itokens <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF stokes WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: istatements <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF sstmnt WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: ikeywords <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF text20 WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: wamessage <span class="keyword">TYPE</span> tmessage.</span><br><span class="line">  DATA: wamessagecomparison <span class="keyword">TYPE</span> tmessage.</span><br><span class="line">  DATA: watokens <span class="keyword">TYPE</span> stokes.</span><br><span class="line">  DATA: nextline <span class="keyword">TYPE</span> i.</span><br><span class="line">  DATA: stringlength <span class="keyword">TYPE</span> i VALUE 0.</span><br><span class="line">  DATA: workingonmessage <span class="keyword">TYPE</span> abap_bool VALUE false.</span><br><span class="line">  DATA: castprogramname <span class="keyword">TYPE</span> <span class="keyword">program</span>.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Read the program code from the textpool.</span></span><br><span class="line">  castprogramname = programname.</span><br><span class="line">  <span class="keyword">READ</span> <span class="keyword">REPORT</span> castprogramname INTO iincludelines.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">APPEND</span> message TO ikeywords.</span><br><span class="line">  SCAN ABAP-SOURCE iincludelines TOKENS INTO itokens WITH INCLUDES STATEMENTS INTO istatements KEYWORDS FROM ikeywords.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">CLEAR</span> iincludelines[].</span><br><span class="line"></span><br><span class="line">  LOOP AT itokens.</span><br><span class="line">    <span class="keyword">IF</span> itokens-str = message.</span><br><span class="line">      workingonmessage = true.</span><br><span class="line">      <span class="keyword">CONTINUE</span>.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">IF</span> workingonmessage = true.</span><br><span class="line">      stringlength = <span class="literal">strlen</span>( itokens-str ).</span><br><span class="line"></span><br><span class="line"><span class="comment">*     Message declaration 1</span></span><br><span class="line">      <span class="keyword">IF</span> stringlength = 4 AND itokens-str+0(1) <span class="keyword">CA</span> sy-abcde.</span><br><span class="line">        wamessage-msgnr = itokens-str+1(3).</span><br><span class="line">        wamessage-arbgb = mainmessageclass.</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line">        <span class="keyword">IF</span> itokens-str <span class="keyword">CS</span> '''' OR itokens-str <span class="keyword">CS</span> '`'.</span><br><span class="line"><span class="comment">*         Message declaration 2</span></span><br><span class="line">          <span class="keyword">TRANSLATE</span> itokens-str USING ''' '.</span><br><span class="line">          <span class="keyword">TRANSLATE</span> itokens-str USING '` '.</span><br><span class="line">          CONDENSE itokens-str.</span><br><span class="line">          SHIFT itokens-str LEFT DELETING LEADING space.</span><br><span class="line">          wamessage-text = itokens-str.</span><br><span class="line">          wamessage-arbgb = 'Hard coded'.</span><br><span class="line">        <span class="keyword">ELSE</span>.</span><br><span class="line">          <span class="keyword">IF</span> itokens-str = 'ID'.</span><br><span class="line"><span class="comment">*           Message declaration 3</span></span><br><span class="line">            nextline = sy-tabix + 1.</span><br><span class="line">            <span class="keyword">READ</span> <span class="keyword">TABLE</span> itokens INDEX nextline INTO watokens.</span><br><span class="line">            <span class="keyword">TRANSLATE</span> watokens-str USING ''' '.</span><br><span class="line">            CONDENSE itokens-str.</span><br><span class="line">            SHIFT watokens-str LEFT DELETING LEADING space.</span><br><span class="line">            <span class="keyword">IF</span> NOT watokens-str = 'SY-MSGID'.</span><br><span class="line">              wamessage-arbgb = watokens-str.</span><br><span class="line"></span><br><span class="line">              nextline = nextline + 4.</span><br><span class="line">              <span class="keyword">READ</span> <span class="keyword">TABLE</span> itokens INDEX nextline INTO watokens.</span><br><span class="line">              <span class="keyword">TRANSLATE</span> watokens-str USING ''' '.</span><br><span class="line">              CONDENSE watokens-str.</span><br><span class="line">              SHIFT watokens-str LEFT DELETING LEADING space.</span><br><span class="line">              wamessage-msgnr = watokens-str.</span><br><span class="line">            <span class="keyword">ELSE</span>.</span><br><span class="line">              workingonmessage = false.</span><br><span class="line">            ENDIF.</span><br><span class="line">          <span class="keyword">ELSE</span>.</span><br><span class="line">            <span class="keyword">IF</span> stringlength &gt;= 5 AND itokens-str+4(1) = '('.</span><br><span class="line"><span class="comment">*              Message declaration 4</span></span><br><span class="line">              wamessage-msgnr = itokens-str+1(3).</span><br><span class="line">              SHIFT itokens-str LEFT UP TO '('.</span><br><span class="line">              <span class="keyword">REPLACE</span> '(' INTO itokens-str WITH space.</span><br><span class="line">              <span class="keyword">REPLACE</span> ')' INTO itokens-str WITH space.</span><br><span class="line">              CONDENSE itokens-str.</span><br><span class="line">              wamessage-arbgb = itokens-str.</span><br><span class="line">            ENDIF.</span><br><span class="line">          ENDIF.</span><br><span class="line">        ENDIF.</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*      find the message text</span></span><br><span class="line">      <span class="keyword">IF</span> NOT wamessage-arbgb IS INITIAL AND NOT wamessage-msgnr IS INITIAL AND wamessage-text IS INITIAL.</span><br><span class="line">        SELECT SINGLE text</span><br><span class="line">        FROM t100</span><br><span class="line">        INTO wamessage-text</span><br><span class="line">        WHERE sprsl = pmlang</span><br><span class="line">        AND arbgb = wamessage-arbgb</span><br><span class="line">        AND msgnr = wamessage-msgnr.</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*      Append the message</span></span><br><span class="line">      <span class="keyword">IF</span> NOT wamessage IS INITIAL.</span><br><span class="line">        <span class="keyword">IF</span> NOT wamessage-text IS INITIAL.</span><br><span class="line"><span class="comment">*          Don't append the message if we already have it listed</span></span><br><span class="line">          <span class="keyword">READ</span> <span class="keyword">TABLE</span> ilocmessages WITH KEY arbgb = wamessage-arbgb</span><br><span class="line">          msgnr = wamessage-msgnr</span><br><span class="line">          INTO wamessagecomparison.</span><br><span class="line">          <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line">            <span class="keyword">APPEND</span> wamessage TO ilocmessages.</span><br><span class="line">          ENDIF.</span><br><span class="line">        ENDIF.</span><br><span class="line">        <span class="keyword">CLEAR</span> wamessage.</span><br><span class="line">        workingonmessage = false.</span><br><span class="line">      ENDIF.</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDLOOP.</span><br><span class="line">ENDFORM.                                                                                 "scanForMessages</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* scanForTables... Search each program for dictionary tables</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> scanfortables USING VALUE(programname)</span><br><span class="line">      VALUE(customeronly)</span><br><span class="line">      VALUE(customernamerange)</span><br><span class="line">      ilocdictionary LIKE idictionary[].</span><br><span class="line"></span><br><span class="line">  DATA: iincludelines <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF string WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: itokens <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF stokes WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: istatements <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF sstmnt WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: ikeywords <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF text20 WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: wadictionary <span class="keyword">TYPE</span> tdicttable.</span><br><span class="line">  DATA: wadictionarycomparison <span class="keyword">TYPE</span> tdicttable.</span><br><span class="line">  DATA: castprogramname <span class="keyword">TYPE</span> <span class="keyword">program</span>.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Read the program code from the textpool.</span></span><br><span class="line">  castprogramname = programname.</span><br><span class="line">  <span class="keyword">READ</span> <span class="keyword">REPORT</span> castprogramname INTO iincludelines.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">APPEND</span> tables TO ikeywords.</span><br><span class="line"></span><br><span class="line">  SCAN ABAP-SOURCE iincludelines TOKENS INTO itokens WITH INCLUDES STATEMENTS INTO istatements KEYWORDS FROM ikeywords.</span><br><span class="line">  <span class="keyword">CLEAR</span> iincludelines[].</span><br><span class="line"></span><br><span class="line">  <span class="keyword">SORT</span> itokens ASCENDING <span class="keyword">BY</span> str.</span><br><span class="line">  DELETE itokens WHERE str = tables.</span><br><span class="line"></span><br><span class="line">  LOOP AT itokens.</span><br><span class="line">    <span class="keyword">IF</span> NOT customeronly IS INITIAL.</span><br><span class="line">      TRY.</span><br><span class="line">          CASE itokens-str+0(1).</span><br><span class="line">            WHEN 'Y' OR 'Z' OR customernamerange.</span><br><span class="line">            WHEN OTHERS.</span><br><span class="line">              <span class="keyword">CONTINUE</span>.</span><br><span class="line">          ENDCASE.</span><br><span class="line"><span class="comment">*        if ( iTokens-str+0(1) &lt;&gt; 'Y' or iTokens-str+0(1) &lt;&gt; 'Z' or iTokens-str ns customerNameRange ).</span></span><br><span class="line"><span class="comment">*          continue.</span></span><br><span class="line"><span class="comment">*        endif.</span></span><br><span class="line">        CATCH cx_sy_range_out_of_bounds INTO objruntimeerror.</span><br><span class="line">      ENDTRY.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line">    wadictionary-tablename = itokens-str.</span><br><span class="line"><span class="comment">*   Don't append the object if we already have it listed</span></span><br><span class="line">    <span class="keyword">READ</span> <span class="keyword">TABLE</span> ilocdictionary INTO wadictionarycomparison WITH KEY tablename = wadictionary-tablename.</span><br><span class="line">    <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line">      PERFORM findtabledescription USING wadictionary-tablename</span><br><span class="line">            wadictionary-tabletitle.</span><br><span class="line"></span><br><span class="line">      PERFORM findtabledefinition USING wadictionary-tablename</span><br><span class="line">            wadictionary-istructure[].</span><br><span class="line"></span><br><span class="line">      <span class="keyword">APPEND</span> wadictionary TO ilocdictionary.</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDLOOP.</span><br><span class="line">ENDFORM.                                                                                 "scanForTables</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  findProgramScreenFlow...</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> findprogramscreenflow USING waprogram <span class="keyword">TYPE</span> tprogram.</span><br><span class="line"></span><br><span class="line">  DATA: iflow <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF tscreenflow WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line"></span><br><span class="line">  CALL FUNCTION 'DYNPRO_PROCESSINGLOGIC'</span><br><span class="line">    EXPORTING</span><br><span class="line">      rep_name  = waprogram-progname</span><br><span class="line">    TABLES</span><br><span class="line">      scr_logic = iflow.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">SORT</span> iflow ASCENDING <span class="keyword">BY</span> screen.</span><br><span class="line">  DELETE ADJACENT <span class="keyword">DUPLICATES</span> FROM iflow COMPARING screen.</span><br><span class="line">  <span class="keyword">IF</span> waprogram-subc &lt;&gt; '<span class="keyword">M</span>'.</span><br><span class="line">    DELETE iflow WHERE screen &gt;= '1000' AND screen &lt;= '1099'.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">  LOOP AT iflow.</span><br><span class="line">    <span class="keyword">APPEND</span> iflow TO waprogram-iscreenflow.</span><br><span class="line">  ENDLOOP.</span><br><span class="line">ENDFORM.                                                                          "findProgramScreenFlow</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  findMainFunctionInclude...  Find the main include that contains the source code</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> findmainfunctioninclude USING VALUE(programname)</span><br><span class="line">      VALUE(functiongroup)</span><br><span class="line">      VALUE(functionincludeno)</span><br><span class="line">      functionincludename.</span><br><span class="line"></span><br><span class="line">  DATA: namespace        <span class="keyword">TYPE</span> string,</span><br><span class="line">        iresults         <span class="keyword">TYPE</span> match_result_tab,</span><br><span class="line">        waresult         <span class="keyword">TYPE</span> match_result,</span><br><span class="line">        startingposition <span class="keyword">TYPE</span> i.</span><br><span class="line"></span><br><span class="line">  FIND ALL OCCURRENCES OF '/' <span class="keyword">IN</span> functiongroup RESULTS iresults.</span><br><span class="line">  <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line">    <span class="keyword">READ</span> <span class="keyword">TABLE</span> iresults INDEX sy-tfill INTO waresult.</span><br><span class="line">    startingposition = waresult-offset + 1.</span><br><span class="line">    namespace = functiongroup+0(startingposition).</span><br><span class="line">    functiongroup = functiongroup+startingposition.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">  CONCATENATE namespace '<span class="keyword">L</span>' functiongroup '<span class="keyword">U</span>' functionincludeno INTO functionincludename.</span><br><span class="line">ENDFORM.                                                                                       "findMainFunctionInclude</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  findFunctionTopInclude...  Find the top include for the function group</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> findfunctiontopinclude USING VALUE(programname)</span><br><span class="line">      VALUE(functiongroup)</span><br><span class="line">      topincludename.</span><br><span class="line"></span><br><span class="line">  DATA: namespace        <span class="keyword">TYPE</span> string,</span><br><span class="line">        iresults         <span class="keyword">TYPE</span> match_result_tab,</span><br><span class="line">        waresult         <span class="keyword">TYPE</span> match_result,</span><br><span class="line">        startingposition <span class="keyword">TYPE</span> i.</span><br><span class="line"></span><br><span class="line">  FIND ALL OCCURRENCES OF '/' <span class="keyword">IN</span> functiongroup RESULTS iresults.</span><br><span class="line">  <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line">    <span class="keyword">READ</span> <span class="keyword">TABLE</span> iresults INDEX sy-tfill INTO waresult.</span><br><span class="line">    startingposition = waresult-offset + 1.</span><br><span class="line">    namespace = functiongroup+0(startingposition).</span><br><span class="line">    functiongroup = functiongroup+startingposition.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">  CONCATENATE namespace '<span class="keyword">L</span>' functiongroup 'TOP' INTO topincludename.</span><br><span class="line">ENDFORM.                                                                                        "findFunctionTopInclude</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  findFunctionScreenFlow...</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> findfunctionscreenflow USING wafunction <span class="keyword">TYPE</span> tfunction.</span><br><span class="line"></span><br><span class="line">  DATA: iflow <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF tscreenflow WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line"></span><br><span class="line">  CALL FUNCTION 'DYNPRO_PROCESSINGLOGIC'</span><br><span class="line">    EXPORTING</span><br><span class="line">      rep_name  = wafunction-progname</span><br><span class="line">    TABLES</span><br><span class="line">      scr_logic = iflow.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">SORT</span> iflow ASCENDING <span class="keyword">BY</span> screen.</span><br><span class="line">  DELETE ADJACENT <span class="keyword">DUPLICATES</span> FROM iflow COMPARING screen.</span><br><span class="line"></span><br><span class="line">  LOOP AT iflow.</span><br><span class="line">    <span class="keyword">APPEND</span> iflow TO wafunction-iscreenflow.</span><br><span class="line">  ENDLOOP.</span><br><span class="line">ENDFORM.                                                                          "findFunctionScreenFlow</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* scanForLikeOrType... Look for any dictionary objects referenced by a like or type statement</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> scanforlikeortype USING VALUE(programname)</span><br><span class="line">      VALUE(customeronly)</span><br><span class="line">      VALUE(customernamerange)</span><br><span class="line">      ilocdictionary LIKE idictionary[]</span><br><span class="line">      iloctabletypes LIKE itabletypes[].</span><br><span class="line"></span><br><span class="line">  DATA ilines <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF string WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: head <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: tail <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: junk <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: linetype <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: linelength <span class="keyword">TYPE</span> i VALUE 0.</span><br><span class="line">  DATA: endofline <span class="keyword">TYPE</span> abap_bool VALUE true.</span><br><span class="line">  DATA: wadictionary <span class="keyword">TYPE</span> tdicttable.</span><br><span class="line">  DATA: wadictionarycomparison <span class="keyword">TYPE</span> tdicttable.</span><br><span class="line">  DATA: waline <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: castprogramname <span class="keyword">TYPE</span> <span class="keyword">program</span>.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">* Read the program code from the textpool.</span></span><br><span class="line">  castprogramname = programname.</span><br><span class="line">  <span class="keyword">READ</span> <span class="keyword">REPORT</span> castprogramname INTO ilines.</span><br><span class="line"></span><br><span class="line">  LOOP AT ilines INTO waline.</span><br><span class="line"><span class="comment">*   Find custom tables.</span></span><br><span class="line">    linelength = <span class="literal">strlen</span>( waline ).</span><br><span class="line">    <span class="keyword">IF</span> linelength &gt; 0.</span><br><span class="line">      <span class="keyword">IF</span> waline(1) = asterix.</span><br><span class="line">        <span class="keyword">CONTINUE</span>.</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">TRANSLATE</span> waline TO UPPER CASE.</span><br><span class="line"></span><br><span class="line"><span class="comment">*     Determine the lineType.</span></span><br><span class="line">      <span class="keyword">IF</span> endofline = true.</span><br><span class="line">        SHIFT waline UP TO like.</span><br><span class="line">        <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line">          linetype = like.</span><br><span class="line">        <span class="keyword">ELSE</span>.</span><br><span class="line">          SHIFT waline UP TO <span class="keyword">type</span>.</span><br><span class="line">          <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line">            FIND 'BEGIN OF' <span class="keyword">IN</span> waline.</span><br><span class="line">            <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line">              FIND 'END OF' <span class="keyword">IN</span> waline.</span><br><span class="line">              <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line">                FIND 'VALUE' <span class="keyword">IN</span> waline.</span><br><span class="line">                <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line">                  linetype = <span class="keyword">type</span>.</span><br><span class="line">                ENDIF.</span><br><span class="line">              ENDIF.</span><br><span class="line">            ENDIF.</span><br><span class="line">          <span class="keyword">ELSE</span>.</span><br><span class="line">            SHIFT waline UP TO <span class="keyword">include</span>.</span><br><span class="line">            <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line">              <span class="keyword">SPLIT</span> waline AT space INTO junk ilines.</span><br><span class="line">            ENDIF.</span><br><span class="line"></span><br><span class="line">            SHIFT waline UP TO structure.</span><br><span class="line">            <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line">              linetype = structure.</span><br><span class="line">            <span class="keyword">ELSE</span>.</span><br><span class="line">              <span class="keyword">CONTINUE</span>.</span><br><span class="line">            ENDIF.</span><br><span class="line">          ENDIF.</span><br><span class="line">        ENDIF.</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line">        linetype = comma.</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line">      CASE linetype.</span><br><span class="line">        WHEN like OR <span class="keyword">type</span> OR structure.</span><br><span class="line"><span class="comment">*         Work on the appropriate lineType</span></span><br><span class="line">          SHIFT waline UP TO space.</span><br><span class="line">          SHIFT waline LEFT DELETING LEADING space.</span><br><span class="line">          <span class="keyword">IF</span> waline <span class="keyword">CS</span> <span class="keyword">table</span>.</span><br><span class="line">            <span class="keyword">SPLIT</span> waline AT <span class="keyword">table</span> INTO head tail.</span><br><span class="line">            <span class="keyword">SPLIT</span> tail AT 'OF' INTO head tail.</span><br><span class="line">            waline = tail.</span><br><span class="line">            SHIFT waline LEFT DELETING LEADING space.</span><br><span class="line">            <span class="keyword">REPLACE</span> ALL OCCURRENCES OF 'WITH HEADER <span class="keyword">LINE</span>' <span class="keyword">IN</span> waline WITH ''.</span><br><span class="line">          ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*         Are we only to download SAP dictionary structures.</span></span><br><span class="line">          <span class="keyword">IF</span> NOT customeronly IS INITIAL.</span><br><span class="line">            TRY.</span><br><span class="line">                <span class="keyword">IF</span> waline+0(1) = 'Y' OR waline+0(1) = 'Z' OR waline <span class="keyword">CS</span> customernamerange.</span><br><span class="line">                <span class="keyword">ELSE</span>.</span><br><span class="line">                  linetype = ''.</span><br><span class="line">                  <span class="keyword">CONTINUE</span>.</span><br><span class="line">                ENDIF.</span><br><span class="line">              CATCH cx_sy_range_out_of_bounds INTO objruntimeerror.</span><br><span class="line">            ENDTRY.</span><br><span class="line">          ENDIF.</span><br><span class="line"></span><br><span class="line">          <span class="keyword">IF</span> waline <span class="keyword">CS</span> comma.</span><br><span class="line">            <span class="keyword">SPLIT</span> waline AT comma INTO head tail.</span><br><span class="line">            <span class="keyword">IF</span> waline <span class="keyword">CS</span> dash.</span><br><span class="line">              <span class="keyword">SPLIT</span> head AT dash INTO head tail.</span><br><span class="line">            ENDIF.</span><br><span class="line">            <span class="keyword">IF</span> waline <span class="keyword">CS</span> occurs.</span><br><span class="line">              <span class="keyword">SPLIT</span> waline AT space INTO head tail.</span><br><span class="line">            ENDIF.</span><br><span class="line">          <span class="keyword">ELSE</span>.</span><br><span class="line">            <span class="keyword">IF</span> waline <span class="keyword">CS</span> period.</span><br><span class="line">              <span class="keyword">SPLIT</span> waline AT period INTO head tail.</span><br><span class="line">              <span class="keyword">IF</span> waline <span class="keyword">CS</span> dash.</span><br><span class="line">                <span class="keyword">SPLIT</span> head AT dash INTO head tail.</span><br><span class="line">              ENDIF.</span><br><span class="line">              <span class="keyword">IF</span> waline <span class="keyword">CS</span> occurs.</span><br><span class="line">                <span class="keyword">SPLIT</span> waline AT space INTO head tail.</span><br><span class="line">              ENDIF.</span><br><span class="line">            <span class="keyword">ELSE</span>.</span><br><span class="line">              <span class="keyword">SPLIT</span> waline AT space INTO head tail.</span><br><span class="line">              <span class="keyword">IF</span> waline <span class="keyword">CS</span> dash.</span><br><span class="line">                <span class="keyword">SPLIT</span> head AT dash INTO head tail.</span><br><span class="line">              ENDIF.</span><br><span class="line">            ENDIF.</span><br><span class="line">          ENDIF.</span><br><span class="line"></span><br><span class="line">          <span class="keyword">IF</span> NOT head IS INITIAL.</span><br><span class="line">            wadictionary-tablename = head.</span><br><span class="line"><span class="comment">*           Don't append the object if we already have it listed</span></span><br><span class="line">            <span class="keyword">READ</span> <span class="keyword">TABLE</span> ilocdictionary INTO wadictionarycomparison</span><br><span class="line">            WITH KEY tablename = wadictionary-tablename.</span><br><span class="line">            <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line">              PERFORM findtabledescription USING wadictionary-tablename</span><br><span class="line">                    wadictionary-tabletitle.</span><br><span class="line"></span><br><span class="line">              PERFORM findtabledefinition USING wadictionary-tablename</span><br><span class="line">                    wadictionary-istructure[].</span><br><span class="line"></span><br><span class="line"><span class="comment">*             Only append if the item is a table and not a structure or data element</span></span><br><span class="line">              <span class="keyword">IF</span> wadictionary-istructure[] IS INITIAL.</span><br><span class="line"><span class="comment">*               Not a table, but is it a table type?</span></span><br><span class="line">                PERFORM checkandaddtabletype USING wadictionary-tablename</span><br><span class="line">                      iloctabletypes[].</span><br><span class="line">              <span class="keyword">ELSE</span>.</span><br><span class="line"><span class="comment">*               It is a table</span></span><br><span class="line">                <span class="keyword">APPEND</span> wadictionary TO ilocdictionary.</span><br><span class="line">              ENDIF.</span><br><span class="line">            ENDIF.</span><br><span class="line">            <span class="keyword">CLEAR</span> wadictionary.</span><br><span class="line">          ENDIF.</span><br><span class="line"></span><br><span class="line">          linetype = ''.</span><br><span class="line">      ENDCASE.</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDLOOP.</span><br><span class="line">ENDFORM.                                                                              "scanForLikeOrType</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  displayStatus...</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> displaystatus USING VALUE(message)</span><br><span class="line">      VALUE(delay).</span><br><span class="line"></span><br><span class="line">  CALL FUNCTION 'SAPGUI_PROGRESS_INDICATOR'</span><br><span class="line">    EXPORTING</span><br><span class="line">      percentage = 0</span><br><span class="line">      text       = message</span><br><span class="line">    EXCEPTIONS</span><br><span class="line">      OTHERS     = 1.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> delay &gt; 0.</span><br><span class="line">    WAIT UP TO delay SECONDS.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.                                                                                  "displayStatus</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  removeLeadingZeros...</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> removeleadingzeros CHANGING myvalue.</span><br><span class="line"></span><br><span class="line">  CALL FUNCTION 'CONVERSION_EXIT_ALPHA_OUTPUT'</span><br><span class="line">    EXPORTING</span><br><span class="line">      <span class="keyword">input</span>  = myvalue</span><br><span class="line">    IMPORTING</span><br><span class="line">      output = myvalue</span><br><span class="line">    EXCEPTIONS</span><br><span class="line">      OTHERS = 1.</span><br><span class="line">ENDFORM.                                                                             "removeLeadingZeros</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* determineFrontendOPSystem.... Determine the frontend operating system type.</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> determinefrontendopsystem USING separator</span><br><span class="line">      operatingsystem.</span><br><span class="line"></span><br><span class="line">  DATA: platformid <span class="keyword">TYPE</span> i VALUE 0.</span><br><span class="line"></span><br><span class="line">  CREATE OBJECT objfile.</span><br><span class="line"></span><br><span class="line">  CALL METHOD objfile-&gt;get_platform</span><br><span class="line">    RECEIVING</span><br><span class="line">      platform             = platformid</span><br><span class="line">    EXCEPTIONS</span><br><span class="line">      cntl_error           = 1</span><br><span class="line">      error_no_gui         = 2</span><br><span class="line">      not_supported_by_gui = 3.</span><br><span class="line">  CASE platformid.</span><br><span class="line">    WHEN objfile-&gt;platform_windows95</span><br><span class="line">      OR objfile-&gt;platform_windows98</span><br><span class="line">      OR objfile-&gt;platform_nt351</span><br><span class="line">      OR objfile-&gt;platform_nt40</span><br><span class="line">      OR objfile-&gt;platform_nt50</span><br><span class="line">      OR objfile-&gt;platform_mac</span><br><span class="line">      OR objfile-&gt;platform_os2</span><br><span class="line">      OR 14.      "XP</span><br><span class="line">      separator = '\'.</span><br><span class="line">      operatingsystem = non_unix.</span><br><span class="line">    WHEN OTHERS.</span><br><span class="line">      separator = '/'.</span><br><span class="line">      operatingsystem = unix.</span><br><span class="line">  ENDCASE.</span><br><span class="line">ENDFORM.                                                                      "determineFrontendOpSystem</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* determineServerOPSystem.... Determine the server operating system type.</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> determineserveropsystem USING separator</span><br><span class="line">      serverfilesystem</span><br><span class="line">      serveropsystem.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Find the file system</span></span><br><span class="line">  SELECT SINGLE filesys</span><br><span class="line">  FROM opsystem</span><br><span class="line">  INTO serverfilesystem</span><br><span class="line">  WHERE opsys = sy-opsys.</span><br><span class="line"></span><br><span class="line">  FIND 'WINDOWS' <span class="keyword">IN</span> serverfilesystem IGNORING CASE.</span><br><span class="line">  <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line">    separator = '\'.</span><br><span class="line">    serveropsystem = non_unix.</span><br><span class="line">    serverfilesystem = 'Windows NT'.</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line">    FIND 'DOS' <span class="keyword">IN</span> serverfilesystem IGNORING CASE.</span><br><span class="line">    <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line">      separator = '\'.</span><br><span class="line">      serveropsystem = non_unix.</span><br><span class="line">    <span class="keyword">ELSE</span>.</span><br><span class="line">      separator = '/'.</span><br><span class="line">      serveropsystem = unix.</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.                                                                        "determineServerOpSystem</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* findExternalCommand.... Determine if the external command exists.  If it doesn't then disable the</span></span><br><span class="line"><span class="comment">*                         server input field</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> findexternalcommand USING VALUE(locserverfilesystem).</span><br><span class="line"></span><br><span class="line">  DATA: castserveropsys <span class="keyword">TYPE</span> syopsys.</span><br><span class="line"></span><br><span class="line">  castserveropsys = locserverfilesystem.</span><br><span class="line"></span><br><span class="line">  CALL FUNCTION 'SXPG_COMMAND_CHECK'</span><br><span class="line">    EXPORTING</span><br><span class="line">      commandname       = 'ZDTX_MKDIR'</span><br><span class="line">      operatingsystem   = castserveropsys</span><br><span class="line">    EXCEPTIONS</span><br><span class="line">      command_not_found = 1</span><br><span class="line">      OTHERS            = 0.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line">    LOOP AT SCREEN.</span><br><span class="line">      <span class="keyword">IF</span> screen-name = 'PLOGICAL'.</span><br><span class="line">        screen-<span class="keyword">input</span> = 0.</span><br><span class="line">        MODIFY SCREEN.</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">IF</span> screen-name = 'PSERV'.</span><br><span class="line">        screen-<span class="keyword">input</span> = 0.</span><br><span class="line">        MODIFY SCREEN.</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">IF</span> screen-name = 'PPC'.</span><br><span class="line">        screen-<span class="keyword">input</span> = 0.</span><br><span class="line">        MODIFY SCREEN.</span><br><span class="line">      ENDIF.</span><br><span class="line">    ENDLOOP.</span><br><span class="line"></span><br><span class="line">    MESSAGE s000(oo) WITH 'Download to server disabled,' 'external command ZDTX_MKDIR not defined.'.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"><span class="comment">********************************************************************************************************</span></span><br><span class="line"><span class="comment">*****************************************DOWNLOAD ROUTINES**********************************************</span></span><br><span class="line"><span class="comment">********************************************************************************************************</span></span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* downloadDDStructures... download database objects to file</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> downloadddstructures USING ilocdictionary LIKE idictionary[]</span><br><span class="line">      ilocdictionaryfilename LIKE idictfilename[]</span><br><span class="line">      VALUE(pathname)</span><br><span class="line">      VALUE(htmlfileextension)</span><br><span class="line">      VALUE(subdir)</span><br><span class="line">      VALUE(sorttablesasc)</span><br><span class="line">      VALUE(slashseparator)</span><br><span class="line">      VALUE(savetoserver)</span><br><span class="line">      VALUE(displayprogressmessage)</span><br><span class="line">      VALUE(locserverfilesystem)</span><br><span class="line">      VALUE(addbackground) <span class="keyword">TYPE</span> abap_bool.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  FIELD-SYMBOLS: &lt;wadictionary&gt; <span class="keyword">TYPE</span> tdicttable.</span><br><span class="line">  DATA: tablefilename <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: tablefilenamewithpath <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: ihtmltable <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF string WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: newsubdirectory <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: completesavepath <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: wadictfilename LIKE <span class="keyword">LINE</span> OF ilocdictionaryfilename.</span><br><span class="line"></span><br><span class="line">  LOOP AT ilocdictionary ASSIGNING &lt;wadictionary&gt;.</span><br><span class="line">    PERFORM buildfilename USING pathname</span><br><span class="line">          subdir</span><br><span class="line">          &lt;wadictionary&gt;-tablename</span><br><span class="line">          space</span><br><span class="line">          space</span><br><span class="line">          htmlfileextension</span><br><span class="line">          is_table</span><br><span class="line">          savetoserver</span><br><span class="line">          slashseparator</span><br><span class="line">          tablefilenamewithpath</span><br><span class="line">          tablefilename</span><br><span class="line">          newsubdirectory</span><br><span class="line">          completesavepath.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">READ</span> <span class="keyword">TABLE</span> ilocdictionaryfilename INTO wadictfilename WITH KEY tablename = &lt;wadictionary&gt;-tablename</span><br><span class="line">    filename = completesavepath.</span><br><span class="line">    <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line"><span class="comment">*     Try and import a converted table to memory as it will be much quicker than converting it again</span></span><br><span class="line">      IMPORT ihtmltable FROM <span class="keyword">MEMORY</span> ID &lt;wadictionary&gt;-tablename.</span><br><span class="line">      <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line">        <span class="keyword">IF</span> displayprogressmessage = abap_true.</span><br><span class="line">          CONCATENATE 'Converting <span class="keyword">table</span>' &lt;wadictionary&gt;-tablename 'to html' INTO statusbarmessage SEPARATED <span class="keyword">BY</span> space.</span><br><span class="line">          PERFORM displaystatus USING statusbarmessage 0.</span><br><span class="line">        ENDIF.</span><br><span class="line"></span><br><span class="line">        PERFORM convertddtohtml USING &lt;wadictionary&gt;-istructure[]</span><br><span class="line">              ihtmltable[]</span><br><span class="line">              &lt;wadictionary&gt;-tablename</span><br><span class="line">              &lt;wadictionary&gt;-tabletitle</span><br><span class="line">              sorttablesasc</span><br><span class="line">              addbackground.</span><br><span class="line"></span><br><span class="line">        EXPORT ihtmltable TO <span class="keyword">MEMORY</span> ID &lt;wadictionary&gt;-tablename.</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">IF</span> savetoserver IS INITIAL.</span><br><span class="line">        PERFORM savefiletopc USING ihtmltable[]</span><br><span class="line">              tablefilenamewithpath</span><br><span class="line">              tablefilename</span><br><span class="line">              space</span><br><span class="line">              space</span><br><span class="line">              displayprogressmessage.</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line">        PERFORM savefiletoserver USING ihtmltable[]</span><br><span class="line">              tablefilenamewithpath</span><br><span class="line">              tablefilename</span><br><span class="line">              completesavepath</span><br><span class="line">              displayprogressmessage</span><br><span class="line">              locserverfilesystem.</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line">      wadictfilename-tablename = &lt;wadictionary&gt;-tablename.</span><br><span class="line">      wadictfilename-filename = completesavepath.</span><br><span class="line">      <span class="keyword">APPEND</span> wadictfilename TO ilocdictionaryfilename.</span><br><span class="line">      <span class="keyword">CLEAR</span> wadictfilename.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">CLEAR</span> ihtmltable[].</span><br><span class="line">  ENDLOOP.</span><br><span class="line">ENDFORM.                                                                           "downloadDDStructures</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  downloadDDTableTypes</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> downloadddtabletypes USING iloctabletypes LIKE itabletypes[]</span><br><span class="line">      iloctabletypefilename LIKE idictfilename[]</span><br><span class="line">      VALUE(pathname)</span><br><span class="line">      VALUE(htmlfileextension)</span><br><span class="line">      VALUE(subdir)</span><br><span class="line">      VALUE(sorttablesasc)</span><br><span class="line">      VALUE(slashseparator)</span><br><span class="line">      VALUE(savetoserver)</span><br><span class="line">      VALUE(displayprogressmessage)</span><br><span class="line">      VALUE(locserverfilesystem)</span><br><span class="line">      VALUE(addbackground) <span class="keyword">TYPE</span> abap_bool.</span><br><span class="line"></span><br><span class="line">  FIELD-SYMBOLS: &lt;watabletypes&gt; LIKE <span class="keyword">LINE</span> OF iloctabletypes.</span><br><span class="line">  FIELD-SYMBOLS &lt;wattfilename&gt; LIKE <span class="keyword">LINE</span> OF iloctabletypefilename[].</span><br><span class="line">  DATA: tablefilename <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: tablefilenamewithpath <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: ihtmltable <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF string WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: newsubdirectory <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: completesavepath <span class="keyword">TYPE</span> string.</span><br><span class="line"></span><br><span class="line">  LOOP AT iloctabletypes ASSIGNING &lt;watabletypes&gt;.</span><br><span class="line">    PERFORM buildfilename USING pathname</span><br><span class="line">          subdir</span><br><span class="line">          &lt;watabletypes&gt;-typename</span><br><span class="line">          space</span><br><span class="line">          space</span><br><span class="line">          htmlfileextension</span><br><span class="line">          is_table</span><br><span class="line">          savetoserver</span><br><span class="line">          slashseparator</span><br><span class="line">          tablefilenamewithpath</span><br><span class="line">          tablefilename</span><br><span class="line">          newsubdirectory</span><br><span class="line">          completesavepath.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">READ</span> <span class="keyword">TABLE</span> iloctabletypefilename INTO &lt;wattfilename&gt; WITH KEY tablename = &lt;watabletypes&gt;-typename</span><br><span class="line">    filename = completesavepath.</span><br><span class="line">    <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line"><span class="comment">*     Try and import a converted table to memory as it will be much quicker than converting it again</span></span><br><span class="line">      IMPORT ihtmltable FROM <span class="keyword">MEMORY</span> ID &lt;watabletypes&gt;-typename.</span><br><span class="line">      <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line">        <span class="keyword">IF</span> displayprogressmessage = abap_true.</span><br><span class="line">          CONCATENATE 'Converting <span class="keyword">table</span> <span class="keyword">type</span>' &lt;watabletypes&gt;-typename 'to html' INTO statusbarmessage SEPARATED <span class="keyword">BY</span> space.</span><br><span class="line">          PERFORM displaystatus USING statusbarmessage 0.</span><br><span class="line">        ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*    --     Need a specific routine for table types.  All data is in the table</span></span><br><span class="line">        PERFORM converttabletypetohtml USING iloctabletypes[]</span><br><span class="line">              ihtmltable[]</span><br><span class="line">              &lt;watabletypes&gt;-typename</span><br><span class="line">              &lt;watabletypes&gt;-ddtext</span><br><span class="line">              sorttablesasc</span><br><span class="line">              addbackground.</span><br><span class="line"></span><br><span class="line">        <span class="keyword">IF</span> savetoserver IS INITIAL.</span><br><span class="line">          PERFORM savefiletopc USING ihtmltable[]</span><br><span class="line">                tablefilenamewithpath</span><br><span class="line">                tablefilename</span><br><span class="line">                space</span><br><span class="line">                space</span><br><span class="line">                displayprogressmessage.</span><br><span class="line">        <span class="keyword">ELSE</span>.</span><br><span class="line">          PERFORM savefiletoserver USING ihtmltable[]</span><br><span class="line">                tablefilenamewithpath</span><br><span class="line">                tablefilename</span><br><span class="line">                completesavepath</span><br><span class="line">                displayprogressmessage</span><br><span class="line">                locserverfilesystem.</span><br><span class="line">        ENDIF.</span><br><span class="line">      ENDIF.</span><br><span class="line">    ENDIF.</span><br><span class="line">    <span class="keyword">CLEAR</span> ihtmltable[].</span><br><span class="line">  ENDLOOP.</span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* downloadMessageClass...</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> downloadmessageclass USING ilocmessages LIKE imessages[]</span><br><span class="line">      VALUE(messageclassname)</span><br><span class="line">      VALUE(userfilepath)</span><br><span class="line">      VALUE(fileextension)</span><br><span class="line">      VALUE(htmlfileflag)</span><br><span class="line">      subdir</span><br><span class="line">      VALUE(customernamerange)</span><br><span class="line">      VALUE(getincludes)</span><br><span class="line">      VALUE(getdictstructures)</span><br><span class="line">      VALUE(userhasselectedmessageclasses)</span><br><span class="line">      VALUE(slashseparator)</span><br><span class="line">      VALUE(savetoserver)</span><br><span class="line">      VALUE(displayprogressmessage)</span><br><span class="line">      VALUE(locserverfilesystem)</span><br><span class="line">      VALUE(addbackground) <span class="keyword">TYPE</span> abap_bool.</span><br><span class="line"></span><br><span class="line">  DATA: htmlpagename <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: newfilenameonly <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: newfilenamewithpath <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: ihtmltable <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF string WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: newsubdirectory <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: completesavepath <span class="keyword">TYPE</span> string.</span><br><span class="line"></span><br><span class="line">  PERFORM appendmessagestofile USING ilocmessages[]</span><br><span class="line">        ihtmltable[]</span><br><span class="line">        userhasselectedmessageclasses.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  CONCATENATE `message <span class="keyword">class</span> ` messageclassname INTO htmlpagename.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> htmlfileflag IS INITIAL.</span><br><span class="line">    <span class="keyword">APPEND</span> '' TO ihtmltable.</span><br><span class="line">    <span class="keyword">APPEND</span>  '----------------------------------------------------------------------------------' TO ihtmltable.</span><br><span class="line"></span><br><span class="line">    PERFORM buildfootermessage USING ihtmltable.</span><br><span class="line">    <span class="keyword">APPEND</span> ihtmltable.</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line">    PERFORM convertcodetohtml USING ihtmltable[]</span><br><span class="line">          htmlpagename</span><br><span class="line">          space</span><br><span class="line">          is_messageclass</span><br><span class="line">          ''</span><br><span class="line">          false</span><br><span class="line">          fileextension</span><br><span class="line">          customernamerange</span><br><span class="line">          getincludes</span><br><span class="line">          getdictstructures</span><br><span class="line">          addbackground.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">  PERFORM buildfilename USING userfilepath</span><br><span class="line">        subdir</span><br><span class="line">        messageclassname</span><br><span class="line">        space</span><br><span class="line">        space</span><br><span class="line">        fileextension</span><br><span class="line">        is_messageclass</span><br><span class="line">        savetoserver</span><br><span class="line">        slashseparator</span><br><span class="line">        newfilenamewithpath</span><br><span class="line">        newfilenameonly</span><br><span class="line">        newsubdirectory</span><br><span class="line">        completesavepath.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> savetoserver IS INITIAL.</span><br><span class="line">    PERFORM savefiletopc USING ihtmltable[]</span><br><span class="line">          newfilenamewithpath</span><br><span class="line">          newfilenameonly</span><br><span class="line">          space</span><br><span class="line">          space</span><br><span class="line">          displayprogressmessage.</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line"><span class="comment">*     Save the file to the SAP server</span></span><br><span class="line">    PERFORM savefiletoserver USING ihtmltable[]</span><br><span class="line">          newfilenamewithpath</span><br><span class="line">          newfilenameonly</span><br><span class="line">          completesavepath</span><br><span class="line">          displayprogressmessage</span><br><span class="line">          locserverfilesystem.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.                                                                          "downloadMessageClass</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  appendMessagesToFile</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> appendmessagestofile USING ilocmessages LIKE imessages[]</span><br><span class="line">      ilochtml LIKE dumihtml[]</span><br><span class="line">      VALUE(userhasselectedmessageclasses).</span><br><span class="line"></span><br><span class="line">  DATA: previousmessageid LIKE imessages-arbgb.</span><br><span class="line">  FIELD-SYMBOLS: &lt;wamessage&gt; <span class="keyword">TYPE</span> tmessage.</span><br><span class="line">  DATA: wahtml <span class="keyword">TYPE</span> string.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">SORT</span> ilocmessages ASCENDING <span class="keyword">BY</span> arbgb msgnr.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> NOT ilocmessages[] IS INITIAL.</span><br><span class="line">    <span class="keyword">IF</span> userhasselectedmessageclasses IS INITIAL.</span><br><span class="line"><span class="comment">*     Only add these extra lines if we are actually appending them to the end of some program code</span></span><br><span class="line">      <span class="keyword">APPEND</span> wahtml TO ilochtml.</span><br><span class="line">      <span class="keyword">APPEND</span> wahtml TO ilochtml.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">APPEND</span> '*Messages' TO ilochtml.</span><br><span class="line">      <span class="keyword">APPEND</span> '*----------------------------------------------------------' TO ilochtml.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line">    LOOP AT ilocmessages ASSIGNING &lt;wamessage&gt;.</span><br><span class="line">      <span class="keyword">IF</span> ( &lt;wamessage&gt;-arbgb &lt;&gt; previousmessageid ).</span><br><span class="line"></span><br><span class="line">        <span class="keyword">IF</span> userhasselectedmessageclasses IS INITIAL.</span><br><span class="line"><span class="comment">*         Only add this extra lines if we are actually appending them to the end of some program code</span></span><br><span class="line">          <span class="keyword">APPEND</span> '*' TO ilochtml.</span><br><span class="line">          CONCATENATE `* Message <span class="keyword">class</span>: ` &lt;wamessage&gt;-arbgb INTO wahtml.</span><br><span class="line">          <span class="keyword">APPEND</span> wahtml TO ilochtml.</span><br><span class="line">        ENDIF.</span><br><span class="line"></span><br><span class="line">        previousmessageid = &lt;wamessage&gt;-arbgb.</span><br><span class="line">        <span class="keyword">CLEAR</span> wahtml.</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">IF</span> userhasselectedmessageclasses IS INITIAL.</span><br><span class="line"><span class="comment">*       Only add this extra lines if we are actually appending them to the end of some program code</span></span><br><span class="line">        CONCATENATE '*' &lt;wamessage&gt;-msgnr `   ` &lt;wamessage&gt;-text INTO wahtml.</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line">        CONCATENATE &lt;wamessage&gt;-msgnr `   ` &lt;wamessage&gt;-text INTO wahtml.</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">APPEND</span> wahtml TO ilochtml.</span><br><span class="line">    ENDLOOP.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.                                                                           "appendMessagesToFile</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  downloadFunctions...       Download function modules to file.</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> downloadfunctions USING ilocfunctions LIKE ifunctions[]</span><br><span class="line">      ilocdictionaryfilename LIKE idictfilename[]</span><br><span class="line">      iloctabletypefilename LIKE itabletypefilename[]</span><br><span class="line">      VALUE(userfilepath)</span><br><span class="line">      VALUE(fileextension)</span><br><span class="line">      VALUE(subdir)</span><br><span class="line">      VALUE(downloaddocumentation)</span><br><span class="line">      VALUE(converttohtml)</span><br><span class="line">      VALUE(customernamerange)</span><br><span class="line">      VALUE(getincludes)</span><br><span class="line">      VALUE(getdictstruct)</span><br><span class="line">      VALUE(textfileextension)</span><br><span class="line">      VALUE(htmlfileextension)</span><br><span class="line">      VALUE(sorttablesasc)</span><br><span class="line">      VALUE(slashseparator)</span><br><span class="line">      VALUE(savetoserver)</span><br><span class="line">      VALUE(displayprogressmessage)</span><br><span class="line">      VALUE(locserverfilesystem)</span><br><span class="line">      VALUE(addbackground) <span class="keyword">TYPE</span> abap_bool.</span><br><span class="line"></span><br><span class="line">  DATA: mainsubdir <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: incsubdir <span class="keyword">TYPE</span> string.</span><br><span class="line">  FIELD-SYMBOLS: &lt;wafunction&gt; <span class="keyword">TYPE</span> tfunction.</span><br><span class="line">  FIELD-SYMBOLS: &lt;wainclude&gt; <span class="keyword">TYPE</span> tinclude.</span><br><span class="line">  DATA: iemptytextelements <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF ttexttable.</span><br><span class="line">  DATA: iemptyselectiontexts <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF ttexttable.</span><br><span class="line">  DATA: iemptymessages <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF tmessage.</span><br><span class="line">  DATA: iemptyguititles <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF tguititle.</span><br><span class="line">  DATA: functiondocumentationexists <span class="keyword">TYPE</span> abap_bool VALUE false.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  LOOP AT ilocfunctions ASSIGNING &lt;wafunction&gt;.</span><br><span class="line">    <span class="keyword">IF</span> subdir IS INITIAL.</span><br><span class="line">      incsubdir = &lt;wafunction&gt;-functionname.</span><br><span class="line">      mainsubdir = ''.</span><br><span class="line">    <span class="keyword">ELSE</span>.</span><br><span class="line">      CONCATENATE subdir &lt;wafunction&gt;-functionname INTO incsubdir SEPARATED <span class="keyword">BY</span> slashseparator.</span><br><span class="line">      mainsubdir = subdir.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">IF</span> NOT downloaddocumentation IS INITIAL.</span><br><span class="line">      PERFORM downloadfunctiondocs USING &lt;wafunction&gt;-functionname</span><br><span class="line">            &lt;wafunction&gt;-functiontitle</span><br><span class="line">            userfilepath</span><br><span class="line">            fileextension</span><br><span class="line">            converttohtml</span><br><span class="line">            slashseparator</span><br><span class="line">            savetoserver</span><br><span class="line">            displayprogressmessage</span><br><span class="line">            mainsubdir</span><br><span class="line">            functiondocumentationexists</span><br><span class="line">            locserverfilesystem</span><br><span class="line">            addbackground.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Download main source code</span></span><br><span class="line">    PERFORM readfunctionanddownload USING &lt;wafunction&gt;-itextelements[]</span><br><span class="line">          &lt;wafunction&gt;-iselectiontexts[]</span><br><span class="line">          &lt;wafunction&gt;-imessages[]</span><br><span class="line">          &lt;wafunction&gt;-functionname</span><br><span class="line">          &lt;wafunction&gt;-functionmaininclude</span><br><span class="line">          &lt;wafunction&gt;-functiontitle</span><br><span class="line">          userfilepath</span><br><span class="line">          fileextension</span><br><span class="line">          mainsubdir</span><br><span class="line">          converttohtml</span><br><span class="line">          functiondocumentationexists</span><br><span class="line">          customernamerange</span><br><span class="line">          getincludes</span><br><span class="line">          getdictstruct</span><br><span class="line">          slashseparator</span><br><span class="line">          savetoserver</span><br><span class="line">          displayprogressmessage</span><br><span class="line">          locserverfilesystem</span><br><span class="line">          addbackground.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Download top include</span></span><br><span class="line">    PERFORM readincludeanddownload USING iemptytextelements[]</span><br><span class="line">          iemptyselectiontexts[]</span><br><span class="line">          iemptymessages[]</span><br><span class="line">          iemptyguititles[]</span><br><span class="line">          &lt;wafunction&gt;-topincludename</span><br><span class="line">          &lt;wafunction&gt;-functionname</span><br><span class="line">          &lt;wafunction&gt;-functiontitle</span><br><span class="line">          is_function</span><br><span class="line">          userfilepath</span><br><span class="line">          fileextension</span><br><span class="line">          mainsubdir</span><br><span class="line">          converttohtml</span><br><span class="line">          customernamerange</span><br><span class="line">          getincludes</span><br><span class="line">          getdictstruct</span><br><span class="line">          slashseparator</span><br><span class="line">          savetoserver</span><br><span class="line">          displayprogressmessage</span><br><span class="line">          locserverfilesystem</span><br><span class="line">          addbackground.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Download screens.</span></span><br><span class="line">    <span class="keyword">IF</span> NOT &lt;wafunction&gt;-iscreenflow[] IS INITIAL.</span><br><span class="line">      PERFORM downloadscreens USING &lt;wafunction&gt;-iscreenflow[]</span><br><span class="line">            &lt;wafunction&gt;-progname</span><br><span class="line">            userfilepath</span><br><span class="line">            textfileextension</span><br><span class="line">            mainsubdir</span><br><span class="line">            slashseparator</span><br><span class="line">            savetoserver</span><br><span class="line">            displayprogressmessage</span><br><span class="line">            locserverfilesystem.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Download GUI titles</span></span><br><span class="line">    <span class="keyword">IF</span> NOT &lt;wafunction&gt;-iguititle[] IS INITIAL.</span><br><span class="line">      PERFORM downloadguititles USING &lt;wafunction&gt;-iguititle</span><br><span class="line">            userfilepath</span><br><span class="line">            textfileextension</span><br><span class="line">            mainsubdir</span><br><span class="line">            slashseparator</span><br><span class="line">            savetoserver</span><br><span class="line">            displayprogressmessage</span><br><span class="line">            locserverfilesystem.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Download all other includes</span></span><br><span class="line">    LOOP AT &lt;wafunction&gt;-iincludes ASSIGNING &lt;wainclude&gt;.</span><br><span class="line">      PERFORM readincludeanddownload USING iemptytextelements[]</span><br><span class="line">            iemptyselectiontexts[]</span><br><span class="line">            iemptymessages[]</span><br><span class="line">            iemptyguititles[]</span><br><span class="line">            &lt;wainclude&gt;-includename</span><br><span class="line">            space</span><br><span class="line">            &lt;wainclude&gt;-includetitle</span><br><span class="line">            is_program</span><br><span class="line">            userfilepath</span><br><span class="line">            fileextension</span><br><span class="line">            incsubdir</span><br><span class="line">            converttohtml</span><br><span class="line">            customernamerange</span><br><span class="line">            getincludes</span><br><span class="line">            getdictstruct</span><br><span class="line">            slashseparator</span><br><span class="line">            savetoserver</span><br><span class="line">            displayprogressmessage</span><br><span class="line">            locserverfilesystem</span><br><span class="line">            addbackground.</span><br><span class="line"></span><br><span class="line">    ENDLOOP.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Download all dictionary structures</span></span><br><span class="line">    <span class="keyword">IF</span> NOT &lt;wafunction&gt;-idictstruct[] IS INITIAL.</span><br><span class="line">      PERFORM downloadddstructures USING &lt;wafunction&gt;-idictstruct[]</span><br><span class="line">            ilocdictionaryfilename[]</span><br><span class="line">            userfilepath</span><br><span class="line">            htmlfileextension</span><br><span class="line">            mainsubdir</span><br><span class="line">            sorttablesasc</span><br><span class="line">            slashseparator</span><br><span class="line">            savetoserver</span><br><span class="line">            displayprogressmessage</span><br><span class="line">            locserverfilesystem</span><br><span class="line">            addbackground.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Download all Table Types</span></span><br><span class="line">    <span class="keyword">IF</span> NOT &lt;wafunction&gt;-itabletypes[] IS INITIAL.</span><br><span class="line">      PERFORM downloadddtabletypes USING &lt;wafunction&gt;-itabletypes[]</span><br><span class="line">            iloctabletypefilename[]</span><br><span class="line">            userfilepath</span><br><span class="line">            htmlfileextension</span><br><span class="line">            mainsubdir</span><br><span class="line">            sorttablesasc</span><br><span class="line">            slashseparator</span><br><span class="line">            savetoserver</span><br><span class="line">            displayprogressmessage</span><br><span class="line">            locserverfilesystem</span><br><span class="line">            addbackground.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Download Transformations</span></span><br><span class="line">    <span class="keyword">IF</span> NOT &lt;wafunction&gt;-itransformations[] IS INITIAL.</span><br><span class="line">      PERFORM downloadxslt USING &lt;wafunction&gt;-itransformations[]</span><br><span class="line">            userfilepath</span><br><span class="line">            fileextension</span><br><span class="line">            htmlfileextension</span><br><span class="line">            textfileextension</span><br><span class="line">            converttohtml</span><br><span class="line">            customernamespace</span><br><span class="line">            slashseparatortouse</span><br><span class="line">            savetoserver</span><br><span class="line">            subdir</span><br><span class="line">            displayprogressmessage</span><br><span class="line">            serverfilesystem</span><br><span class="line">            addbackground.</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDLOOP.</span><br><span class="line">ENDFORM.                                                                              "downloadFunctions</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*   readIcludeAndDownload...</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> readincludeanddownload USING iloctextelements LIKE dumitexttab[]</span><br><span class="line">      ilocselectiontexts LIKE dumitexttab[]</span><br><span class="line">      ilocmessages LIKE imessages[]</span><br><span class="line">      ilocguititles LIKE dumiguititle[]</span><br><span class="line">      VALUE(programname)</span><br><span class="line">      VALUE(functionname)</span><br><span class="line">      VALUE(programdescription)</span><br><span class="line">      VALUE(overideprogtype)</span><br><span class="line">      VALUE(userfilepath)</span><br><span class="line">      VALUE(fileextension)</span><br><span class="line">      VALUE(additionalsubdir)</span><br><span class="line">      VALUE(converttohtml)</span><br><span class="line">      VALUE(customernamerange)</span><br><span class="line">      VALUE(getincludes)</span><br><span class="line">      VALUE(getdictstructures)</span><br><span class="line">      VALUE(slashseparator)</span><br><span class="line">      VALUE(savetoserver)</span><br><span class="line">      VALUE(displayprogressmessage)</span><br><span class="line">      VALUE(locserverfilesystem)</span><br><span class="line">      VALUE(addbackground) <span class="keyword">TYPE</span> abap_bool.</span><br><span class="line"></span><br><span class="line">  DATA: ilines <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF string WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: localfilenamewithpath <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: localfilenameonly <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: newsubdirectory <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: objectname <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: completesavepath <span class="keyword">TYPE</span> string.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">READ</span> <span class="keyword">REPORT</span> programname INTO ilines.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Download GUI titles for main program</span></span><br><span class="line">  <span class="keyword">IF</span> NOT ilocguititles[] IS INITIAL.</span><br><span class="line">    PERFORM appendguititles USING ilocguititles[]</span><br><span class="line">          ilines[].</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Download text elements for main program</span></span><br><span class="line">  <span class="keyword">IF</span> NOT iloctextelements[] IS INITIAL.</span><br><span class="line">    PERFORM appendtextelements USING iloctextelements[]</span><br><span class="line">          ilines[].</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Download selection texts for main program</span></span><br><span class="line">  <span class="keyword">IF</span> NOT ilocselectiontexts[] IS INITIAL.</span><br><span class="line">    PERFORM appendselectiontexts USING ilocselectiontexts[]</span><br><span class="line">          ilines[].</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Download messages classes for main program.</span></span><br><span class="line">  <span class="keyword">IF</span> NOT ilocmessages[] IS INITIAL.</span><br><span class="line">    PERFORM appendmessagestofile USING ilocmessages[]</span><br><span class="line">          ilines[]</span><br><span class="line">          space.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> converttohtml IS INITIAL.</span><br><span class="line">    <span class="keyword">APPEND</span> '' TO ilines.</span><br><span class="line">    <span class="keyword">APPEND</span> '----------------------------------------------------------------------------------' TO ilines.</span><br><span class="line">    PERFORM buildfootermessage USING ilines.</span><br><span class="line">    <span class="keyword">APPEND</span> ilines.</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line">    PERFORM convertcodetohtml USING ilines[]</span><br><span class="line">          programname</span><br><span class="line">          programdescription</span><br><span class="line">          overideprogtype</span><br><span class="line">          space</span><br><span class="line">          space</span><br><span class="line">          fileextension</span><br><span class="line">          customernamerange</span><br><span class="line">          getincludes</span><br><span class="line">          getdictstructures</span><br><span class="line">          addbackground.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> functionname IS INITIAL.</span><br><span class="line">    objectname = programname.</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line">    objectname = functionname.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">  PERFORM buildfilename USING userfilepath</span><br><span class="line">        additionalsubdir</span><br><span class="line">        objectname</span><br><span class="line">        space</span><br><span class="line">        programname</span><br><span class="line">        fileextension</span><br><span class="line">        overideprogtype</span><br><span class="line">        savetoserver</span><br><span class="line">        slashseparator</span><br><span class="line">        localfilenamewithpath</span><br><span class="line">        localfilenameonly</span><br><span class="line">        newsubdirectory</span><br><span class="line">        completesavepath.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> savetoserver IS INITIAL.</span><br><span class="line">    PERFORM savefiletopc USING ilines[]</span><br><span class="line">          localfilenamewithpath</span><br><span class="line">          localfilenameonly</span><br><span class="line">          space</span><br><span class="line">          space</span><br><span class="line">          displayprogressmessage.</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line">    PERFORM savefiletoserver USING ilines[]</span><br><span class="line">          localfilenamewithpath</span><br><span class="line">          localfilenameonly</span><br><span class="line">          completesavepath</span><br><span class="line">          displayprogressmessage</span><br><span class="line">          locserverfilesystem.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.                                                                         "readIncludeAndDownload</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*   readClassAndDownload...</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> readclassanddownload USING walocclass <span class="keyword">TYPE</span> tclass</span><br><span class="line">      VALUE(classname)</span><br><span class="line">      VALUE(functionname)</span><br><span class="line">      VALUE(overideprogtype)</span><br><span class="line">      VALUE(userfilepath)</span><br><span class="line">      VALUE(fileextension)</span><br><span class="line">      VALUE(additionalsubdir)</span><br><span class="line">      VALUE(converttohtml)</span><br><span class="line">      VALUE(customernamerange)</span><br><span class="line">      VALUE(getincludes)</span><br><span class="line">      VALUE(getdictstructures)</span><br><span class="line">      VALUE(slashseparator)</span><br><span class="line">      VALUE(savetoserver)</span><br><span class="line">      VALUE(displayprogressmessage)</span><br><span class="line">      VALUE(locserverfilesystem)</span><br><span class="line">      VALUE(addbackground) <span class="keyword">TYPE</span> abap_bool.</span><br><span class="line"></span><br><span class="line">  DATA: itemplines <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF string WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: ilines <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF string WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: localfilenamewithpath <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: localfilenameonly <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: newsubdirectory <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: objectname <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: castclassname <span class="keyword">TYPE</span> <span class="keyword">program</span>.</span><br><span class="line">  DATA: completesavepath <span class="keyword">TYPE</span> string.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Build up attribute comments</span></span><br><span class="line">  <span class="keyword">APPEND</span> '**************************************************************************' TO ilines.</span><br><span class="line">  <span class="keyword">APPEND</span> '*   <span class="keyword">Class</span> attributes.                                                    *' TO ilines.</span><br><span class="line">  <span class="keyword">APPEND</span> '**************************************************************************' TO ilines.</span><br><span class="line">  CASE walocclass-exposure.</span><br><span class="line">    WHEN 0.</span><br><span class="line">      <span class="keyword">APPEND</span> `Instantiation: Private` TO ilines.</span><br><span class="line">    WHEN 1.</span><br><span class="line">      <span class="keyword">APPEND</span> `Instantiation: Protected` TO ilines.</span><br><span class="line">    WHEN 2.</span><br><span class="line">      <span class="keyword">APPEND</span> `Instantiation: Public` TO ilines.</span><br><span class="line">  ENDCASE.</span><br><span class="line">  CONCATENATE `Message <span class="keyword">class</span>: ` walocclass-msg_id INTO ilines.</span><br><span class="line">  <span class="keyword">APPEND</span> ilines.</span><br><span class="line">  CASE walocclass-state.</span><br><span class="line">    WHEN 0.</span><br><span class="line">      <span class="keyword">APPEND</span> `State: Only Modelled` TO ilines.</span><br><span class="line">    WHEN 1.</span><br><span class="line">      <span class="keyword">APPEND</span> `State: Implemented` TO ilines.</span><br><span class="line">  ENDCASE.</span><br><span class="line">  CONCATENATE `Final Indicator: ` walocclass-clsfinal INTO ilines.</span><br><span class="line">  <span class="keyword">APPEND</span> ilines.</span><br><span class="line">  CONCATENATE `R/3 Release: ` walocclass-r3release INTO ilines.</span><br><span class="line">  <span class="keyword">APPEND</span> ilines.</span><br><span class="line">  <span class="keyword">CLEAR</span> ilines.</span><br><span class="line">  <span class="keyword">APPEND</span> ilines.</span><br><span class="line"></span><br><span class="line">  castclassname = walocclass-publicclasskey.</span><br><span class="line">  <span class="keyword">READ</span> <span class="keyword">REPORT</span> castclassname INTO itemplines.</span><br><span class="line">  <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line">    PERFORM reformatclasscode USING itemplines[].</span><br><span class="line"></span><br><span class="line">    <span class="keyword">APPEND</span> '**************************************************************************' TO ilines.</span><br><span class="line">    <span class="keyword">APPEND</span> '*   Public section of <span class="keyword">class</span>.                                             *' TO ilines.</span><br><span class="line">    <span class="keyword">APPEND</span> '**************************************************************************' TO ilines.</span><br><span class="line">    LOOP AT itemplines.</span><br><span class="line">      <span class="keyword">APPEND</span> itemplines TO ilines.</span><br><span class="line">    ENDLOOP.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">  castclassname = walocclass-privateclasskey.</span><br><span class="line">  <span class="keyword">READ</span> <span class="keyword">REPORT</span> castclassname INTO itemplines.</span><br><span class="line">  <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line">    PERFORM reformatclasscode USING itemplines[].</span><br><span class="line"></span><br><span class="line">    <span class="keyword">APPEND</span> ilines.</span><br><span class="line">    <span class="keyword">APPEND</span> '**************************************************************************' TO ilines.</span><br><span class="line">    <span class="keyword">APPEND</span> '*   Private section of <span class="keyword">class</span>.                                            *' TO ilines.</span><br><span class="line">    <span class="keyword">APPEND</span> '**************************************************************************' TO ilines.</span><br><span class="line">    LOOP AT itemplines.</span><br><span class="line">      <span class="keyword">APPEND</span> itemplines TO ilines.</span><br><span class="line">    ENDLOOP.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">  castclassname = walocclass-protectedclasskey.</span><br><span class="line">  <span class="keyword">READ</span> <span class="keyword">REPORT</span> castclassname INTO itemplines.</span><br><span class="line">  <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line">    PERFORM reformatclasscode USING itemplines[].</span><br><span class="line"></span><br><span class="line">    <span class="keyword">APPEND</span> ilines.</span><br><span class="line">    <span class="keyword">APPEND</span> '**************************************************************************' TO ilines.</span><br><span class="line">    <span class="keyword">APPEND</span> '*   Protected section of <span class="keyword">class</span>.                                          *' TO ilines.</span><br><span class="line">    <span class="keyword">APPEND</span> '**************************************************************************' TO ilines.</span><br><span class="line">    LOOP AT itemplines.</span><br><span class="line">      <span class="keyword">APPEND</span> itemplines TO ilines.</span><br><span class="line">    ENDLOOP.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">  castclassname = walocclass-typesclasskey.</span><br><span class="line">  <span class="keyword">READ</span> <span class="keyword">REPORT</span> castclassname INTO itemplines.</span><br><span class="line">  <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line">    <span class="keyword">APPEND</span> ilines.</span><br><span class="line">    <span class="keyword">APPEND</span> '**************************************************************************' TO ilines.</span><br><span class="line">    <span class="keyword">APPEND</span> '*   Types section of <span class="keyword">class</span>.                                              *' TO ilines.</span><br><span class="line">    <span class="keyword">APPEND</span> '**************************************************************************' TO ilines.</span><br><span class="line">    LOOP AT itemplines.</span><br><span class="line">      <span class="keyword">APPEND</span> itemplines TO ilines.</span><br><span class="line">    ENDLOOP.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Download text elements for this class</span></span><br><span class="line">  <span class="keyword">IF</span> NOT walocclass-itextelements[] IS INITIAL.</span><br><span class="line">    PERFORM appendtextelements USING walocclass-itextelements[]</span><br><span class="line">          ilines[].</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Download messages classes for this class.</span></span><br><span class="line">  <span class="keyword">IF</span> NOT walocclass-imessages[] IS INITIAL.</span><br><span class="line">    PERFORM appendmessagestofile USING walocclass-imessages[]</span><br><span class="line">          ilines[]</span><br><span class="line">          space.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Download exception texts for this class</span></span><br><span class="line">  <span class="keyword">IF</span> NOT walocclass-iconcepts[] IS INITIAL.</span><br><span class="line">    PERFORM appendexceptiontexts USING walocclass-iconcepts[]</span><br><span class="line">          ilines[].</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> converttohtml IS INITIAL.</span><br><span class="line">    <span class="keyword">APPEND</span> '' TO ilines.</span><br><span class="line">    <span class="keyword">APPEND</span> '----------------------------------------------------------------------------------' TO ilines.</span><br><span class="line">    PERFORM buildfootermessage USING ilines.</span><br><span class="line">    <span class="keyword">APPEND</span> ilines.</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line">    PERFORM convertclasstohtml USING ilines[]</span><br><span class="line">          classname</span><br><span class="line">          walocclass-descript</span><br><span class="line">          overideprogtype</span><br><span class="line">          fileextension</span><br><span class="line">          customernamerange</span><br><span class="line">          getdictstructures</span><br><span class="line">          addbackground.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> functionname IS INITIAL.</span><br><span class="line">    objectname = classname.</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line">    objectname = functionname.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">  PERFORM buildfilename USING userfilepath</span><br><span class="line">        additionalsubdir</span><br><span class="line">        objectname</span><br><span class="line">        space</span><br><span class="line">        classname</span><br><span class="line">        fileextension</span><br><span class="line">        overideprogtype</span><br><span class="line">        savetoserver</span><br><span class="line">        slashseparator</span><br><span class="line">        localfilenamewithpath</span><br><span class="line">        localfilenameonly</span><br><span class="line">        newsubdirectory</span><br><span class="line">        completesavepath.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> savetoserver IS INITIAL.</span><br><span class="line">    PERFORM savefiletopc USING ilines[]</span><br><span class="line">          localfilenamewithpath</span><br><span class="line">          localfilenameonly</span><br><span class="line">          space</span><br><span class="line">          space</span><br><span class="line">          displayprogressmessage.</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line">    PERFORM savefiletoserver USING ilines[]</span><br><span class="line">          localfilenamewithpath</span><br><span class="line">          localfilenameonly</span><br><span class="line">          completesavepath</span><br><span class="line">          displayprogressmessage</span><br><span class="line">          locserverfilesystem.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.                                                                           "readClassAndDownload</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*   readMethodAndDownload...</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> readmethodanddownload USING walocmethod <span class="keyword">TYPE</span> tmethod</span><br><span class="line">      VALUE(methodname)</span><br><span class="line">      VALUE(methodkey)</span><br><span class="line">      VALUE(functionname)</span><br><span class="line">      VALUE(overideprogtype)</span><br><span class="line">      VALUE(userfilepath)</span><br><span class="line">      VALUE(fileextension)</span><br><span class="line">      VALUE(additionalsubdir)</span><br><span class="line">      VALUE(converttohtml)</span><br><span class="line">      VALUE(customernamerange)</span><br><span class="line">      VALUE(getincludes)</span><br><span class="line">      VALUE(getdictstructures)</span><br><span class="line">      VALUE(slashseparator)</span><br><span class="line">      VALUE(savetoserver)</span><br><span class="line">      VALUE(displayprogressmessage)</span><br><span class="line">      VALUE(locserverfilesystem)</span><br><span class="line">      VALUE(addbackground) <span class="keyword">TYPE</span> abap_bool.</span><br><span class="line"></span><br><span class="line">  DATA: ilines <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF string WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: itemplines <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF string WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: localfilenamewithpath <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: localfilenameonly <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: newsubdirectory <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: objectname <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: castmethodkey <span class="keyword">TYPE</span> <span class="keyword">program</span>.</span><br><span class="line">  DATA: completesavepath <span class="keyword">TYPE</span> string.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Add the method scope to the downloaded file</span></span><br><span class="line">  <span class="keyword">APPEND</span> '**************************************************************************' TO ilines.</span><br><span class="line">  <span class="keyword">APPEND</span> '*   Method attributes.                                                   *' TO ilines.</span><br><span class="line">  <span class="keyword">APPEND</span> '**************************************************************************' TO ilines.</span><br><span class="line">  CASE walocmethod-exposure.</span><br><span class="line">    WHEN 0.</span><br><span class="line">      <span class="keyword">APPEND</span> `Instantiation: Private` TO ilines.</span><br><span class="line">    WHEN 1.</span><br><span class="line">      <span class="keyword">APPEND</span> `Instantiation: Protected` TO ilines.</span><br><span class="line">    WHEN 2.</span><br><span class="line">      <span class="keyword">APPEND</span> `Instantiation: Public` TO ilines.</span><br><span class="line">  ENDCASE.</span><br><span class="line">  <span class="keyword">APPEND</span> '**************************************************************************' TO ilines.</span><br><span class="line">  <span class="keyword">APPEND</span> '' TO ilines.</span><br><span class="line"></span><br><span class="line">  castmethodkey = walocmethod-methodkey.</span><br><span class="line">  <span class="keyword">READ</span> <span class="keyword">REPORT</span> castmethodkey INTO itemplines.</span><br><span class="line">  LOOP AT itemplines.</span><br><span class="line">    <span class="keyword">APPEND</span> itemplines TO ilines.</span><br><span class="line">  ENDLOOP.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> converttohtml IS INITIAL.</span><br><span class="line">    <span class="keyword">APPEND</span> '' TO ilines.</span><br><span class="line">    <span class="keyword">APPEND</span> '----------------------------------------------------------------------------------' TO ilines.</span><br><span class="line">    PERFORM buildfootermessage USING ilines.</span><br><span class="line">    <span class="keyword">APPEND</span> ilines.</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line">    PERFORM convertcodetohtml USING ilines[]</span><br><span class="line">          methodname</span><br><span class="line">          walocmethod-descript</span><br><span class="line">          overideprogtype</span><br><span class="line">          space</span><br><span class="line">          space</span><br><span class="line">          fileextension</span><br><span class="line">          customernamerange</span><br><span class="line">          getincludes</span><br><span class="line">          getdictstructures</span><br><span class="line">          addbackground.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> functionname IS INITIAL.</span><br><span class="line">    objectname = methodname.</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line">    objectname = functionname.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">  CASE walocmethod-exposure.</span><br><span class="line">    WHEN 0.</span><br><span class="line"><span class="comment">*     Private</span></span><br><span class="line">      CONCATENATE additionalsubdir slashseparator 'private_methods' INTO additionalsubdir.</span><br><span class="line">    WHEN 1.</span><br><span class="line"><span class="comment">*     Protected</span></span><br><span class="line">      CONCATENATE additionalsubdir slashseparator 'protected_methods' INTO additionalsubdir.</span><br><span class="line">    WHEN 2.</span><br><span class="line"><span class="comment">*     Public</span></span><br><span class="line">      CONCATENATE additionalsubdir slashseparator 'public_methods' INTO additionalsubdir.</span><br><span class="line">  ENDCASE.</span><br><span class="line"></span><br><span class="line">  PERFORM buildfilename USING userfilepath</span><br><span class="line">        additionalsubdir</span><br><span class="line">        objectname</span><br><span class="line">        space</span><br><span class="line">        methodname</span><br><span class="line">        fileextension</span><br><span class="line">        overideprogtype</span><br><span class="line">        savetoserver</span><br><span class="line">        slashseparator</span><br><span class="line">        localfilenamewithpath</span><br><span class="line">        localfilenameonly</span><br><span class="line">        newsubdirectory</span><br><span class="line">        completesavepath.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> savetoserver IS INITIAL.</span><br><span class="line">    PERFORM savefiletopc USING ilines[]</span><br><span class="line">          localfilenamewithpath</span><br><span class="line">          localfilenameonly</span><br><span class="line">          space</span><br><span class="line">          space</span><br><span class="line">          displayprogressmessage.</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line">    PERFORM savefiletoserver USING ilines[]</span><br><span class="line">          localfilenamewithpath</span><br><span class="line">          localfilenameonly</span><br><span class="line">          completesavepath</span><br><span class="line">          displayprogressmessage</span><br><span class="line">          locserverfilesystem.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.                                                                          "readMethodAndDownload</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*   readXsltAndDownload...</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> readxsltanddownload USING VALUE(xsltname)</span><br><span class="line">      xsltdescription</span><br><span class="line">      VALUE(userfilepath)</span><br><span class="line">      VALUE(fileextension)</span><br><span class="line">      VALUE(converttohtml)</span><br><span class="line">      VALUE(customernamerange)</span><br><span class="line">      VALUE(slashseparator)</span><br><span class="line">      VALUE(savetoserver)</span><br><span class="line">      VALUE(subdir)</span><br><span class="line">      VALUE(displayprogressmessage)</span><br><span class="line">      VALUE(locserverfilesystem)</span><br><span class="line">      VALUE(addbackground) <span class="keyword">TYPE</span> abap_bool.</span><br><span class="line"></span><br><span class="line">  DATA: ilines <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF string WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: ilocxsltsource <span class="keyword">TYPE</span> o2pageline_table.</span><br><span class="line">  DATA: waxsltattributes <span class="keyword">TYPE</span> o2xsltattr.</span><br><span class="line">  DATA: localfilenamewithpath <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: localfilenameonly <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: newsubdirectory <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: objectname <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: completesavepath <span class="keyword">TYPE</span> string.</span><br><span class="line"></span><br><span class="line">  cl_o2_api_xsltdesc=&gt;load( EXPORTING p_xslt_desc = xsltname</span><br><span class="line">  IMPORTING p_source = ilocxsltsource</span><br><span class="line">    p_attributes = waxsltattributes</span><br><span class="line">  EXCEPTIONS not_existing = 1</span><br><span class="line">    permission_failure = 2</span><br><span class="line">    error_occured = 3</span><br><span class="line">    version_not_found = 4 ).</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line">    xsltdescription = waxsltattributes-descript.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">APPEND</span> LINES OF ilocxsltsource TO ilines.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">IF</span> converttohtml IS INITIAL.</span><br><span class="line">      <span class="keyword">APPEND</span> '' TO ilines.</span><br><span class="line">      <span class="keyword">APPEND</span> '----------------------------------------------------------------------------------' TO ilines.</span><br><span class="line">      PERFORM buildfootermessage USING ilines.</span><br><span class="line">      <span class="keyword">APPEND</span> ilines.</span><br><span class="line">    <span class="keyword">ELSE</span>.</span><br><span class="line">      PERFORM convertcodetohtml USING ilines[]</span><br><span class="line">            xsltname</span><br><span class="line">            waxsltattributes-descript</span><br><span class="line">            space</span><br><span class="line">            space</span><br><span class="line">            space</span><br><span class="line">            fileextension</span><br><span class="line">            customernamerange</span><br><span class="line">            space</span><br><span class="line">            space</span><br><span class="line">            addbackground.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line">    PERFORM buildfilename USING userfilepath</span><br><span class="line">          subdir</span><br><span class="line">          xsltname</span><br><span class="line">          space</span><br><span class="line">          xsltname</span><br><span class="line">          fileextension</span><br><span class="line">          is_transformation</span><br><span class="line">          savetoserver</span><br><span class="line">          slashseparator</span><br><span class="line">          localfilenamewithpath</span><br><span class="line">          localfilenameonly</span><br><span class="line">          newsubdirectory</span><br><span class="line">          completesavepath.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">IF</span> savetoserver IS INITIAL.</span><br><span class="line">      PERFORM savefiletopc USING ilines[]</span><br><span class="line">            localfilenamewithpath</span><br><span class="line">            localfilenameonly</span><br><span class="line">            space</span><br><span class="line">            space</span><br><span class="line">            displayprogressmessage.</span><br><span class="line">    <span class="keyword">ELSE</span>.</span><br><span class="line">      PERFORM savefiletoserver USING ilines[]</span><br><span class="line">            localfilenamewithpath</span><br><span class="line">            localfilenameonly</span><br><span class="line">            completesavepath</span><br><span class="line">            displayprogressmessage</span><br><span class="line">            locserverfilesystem.</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.                                                                         "readXSLTAndDownload</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*   readFunctionAndDownload...</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> readfunctionanddownload USING iloctextelements LIKE dumitexttab[]</span><br><span class="line">      ilocselectiontexts LIKE dumitexttab[]</span><br><span class="line">      ilocmessages LIKE imessages[]</span><br><span class="line">      VALUE(functionname)</span><br><span class="line">      VALUE(functioninternalname)</span><br><span class="line">      VALUE(shorttext)</span><br><span class="line">      VALUE(userfilepath)</span><br><span class="line">      VALUE(fileextension)</span><br><span class="line">      VALUE(subdir)</span><br><span class="line">      VALUE(converttohtml)</span><br><span class="line">      VALUE(functiondocumentationexists)</span><br><span class="line">      VALUE(customernamerange)</span><br><span class="line">      VALUE(getincludes)</span><br><span class="line">      VALUE(getdictstructures)</span><br><span class="line">      VALUE(slashseparator)</span><br><span class="line">      VALUE(savetoserver)</span><br><span class="line">      VALUE(displayprogressmessage)</span><br><span class="line">      VALUE(locserverfilesystem)</span><br><span class="line">      VALUE(addbackground) <span class="keyword">TYPE</span> abap_bool.</span><br><span class="line"></span><br><span class="line">  DATA: ilines <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF string WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: localfilenamewithpath <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: localfilenameonly <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: newsubdirectory <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: completesavepath <span class="keyword">TYPE</span> string.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">READ</span> <span class="keyword">REPORT</span> functioninternalname INTO ilines.</span><br><span class="line"></span><br><span class="line"><span class="comment">* If we found any text elements for this function then we ought to append them to the main include.</span></span><br><span class="line">  <span class="keyword">IF</span> NOT iloctextelements[] IS INITIAL.</span><br><span class="line">    PERFORM appendtextelements USING iloctextelements[]</span><br><span class="line">          ilines[].</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">* If we found any message classes for this function then we ought to append them to the main include.</span></span><br><span class="line">  <span class="keyword">IF</span> NOT ilocmessages[] IS INITIAL.</span><br><span class="line">    PERFORM appendmessagestofile USING ilocmessages[]</span><br><span class="line">          ilines[]</span><br><span class="line">          space.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> converttohtml IS INITIAL.</span><br><span class="line">    <span class="keyword">APPEND</span> '' TO ilines.</span><br><span class="line">    <span class="keyword">APPEND</span> '----------------------------------------------------------------------------------' TO ilines.</span><br><span class="line">    PERFORM buildfootermessage USING ilines.</span><br><span class="line">    <span class="keyword">APPEND</span> ilines.</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line">    PERFORM convertfunctiontohtml USING ilines[]</span><br><span class="line">          functionname</span><br><span class="line">          shorttext</span><br><span class="line">          is_function</span><br><span class="line">          functiondocumentationexists</span><br><span class="line">          true</span><br><span class="line">          fileextension</span><br><span class="line">          customernamerange</span><br><span class="line">          getincludes</span><br><span class="line">          getdictstructures</span><br><span class="line">          addbackground.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">  PERFORM buildfilename USING userfilepath</span><br><span class="line">        subdir</span><br><span class="line">        functionname</span><br><span class="line">        space</span><br><span class="line">        space</span><br><span class="line">        fileextension</span><br><span class="line">        is_function</span><br><span class="line">        savetoserver</span><br><span class="line">        slashseparator</span><br><span class="line">        localfilenamewithpath</span><br><span class="line">        localfilenameonly</span><br><span class="line">        newsubdirectory</span><br><span class="line">        completesavepath.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> savetoserver IS INITIAL.</span><br><span class="line">    PERFORM savefiletopc USING ilines[]</span><br><span class="line">          localfilenamewithpath</span><br><span class="line">          localfilenameonly</span><br><span class="line">          space</span><br><span class="line">          space</span><br><span class="line">          displayprogressmessage.</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line">    PERFORM savefiletoserver USING ilines[]</span><br><span class="line">          localfilenamewithpath</span><br><span class="line">          localfilenameonly</span><br><span class="line">          completesavepath</span><br><span class="line">          displayprogressmessage</span><br><span class="line">          locserverfilesystem.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.                                                                        "readFunctionAndDownload</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  buildFilename...</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> buildfilename USING VALUE(userpath)</span><br><span class="line">      VALUE(additionalsubdirectory)</span><br><span class="line">      VALUE(objectname)</span><br><span class="line">      VALUE(mainfunctionno)</span><br><span class="line">      VALUE(includename)</span><br><span class="line">      VALUE(fileextension)</span><br><span class="line">      VALUE(downloadtype)</span><br><span class="line">      VALUE(downloadtoserver)</span><br><span class="line">      VALUE(slashseparator)</span><br><span class="line">      newfilenamewithpath</span><br><span class="line">      newfilenameonly</span><br><span class="line">      newsubdirectory</span><br><span class="line">      completepath.</span><br><span class="line"></span><br><span class="line"><span class="comment">* If we are running on a non UNIX environment we will need to remove forward slashes from the additional path.</span></span><br><span class="line">  <span class="keyword">IF</span> downloadtoserver IS INITIAL.</span><br><span class="line">    <span class="keyword">IF</span> frontendopsystem = non_unix.</span><br><span class="line">      <span class="keyword">IF</span> NOT additionalsubdirectory IS INITIAL.</span><br><span class="line">        <span class="keyword">TRANSLATE</span> additionalsubdirectory USING '/_'.</span><br><span class="line">        <span class="keyword">IF</span> additionalsubdirectory+0(1) = '_'.</span><br><span class="line">          SHIFT additionalsubdirectory LEFT <span class="keyword">BY</span> 1 PLACES.</span><br><span class="line">        ENDIF.</span><br><span class="line">      ENDIF.</span><br><span class="line">    ENDIF.</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line">    <span class="keyword">IF</span> serveropsystem = non_unix.</span><br><span class="line">      <span class="keyword">IF</span> NOT additionalsubdirectory IS INITIAL.</span><br><span class="line">        <span class="keyword">TRANSLATE</span> additionalsubdirectory USING '/_'.</span><br><span class="line">        <span class="keyword">IF</span> additionalsubdirectory+0(1) = '_'.</span><br><span class="line">          SHIFT additionalsubdirectory LEFT <span class="keyword">BY</span> 1 PLACES.</span><br><span class="line">        ENDIF.</span><br><span class="line">      ENDIF.</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">  CASE downloadtype.</span><br><span class="line"><span class="comment">*   Programs</span></span><br><span class="line">    WHEN is_program.</span><br><span class="line">      <span class="keyword">IF</span> additionalsubdirectory IS INITIAL.</span><br><span class="line">        CONCATENATE userpath slashseparator objectname period fileextension INTO newfilenamewithpath.</span><br><span class="line">        CONCATENATE userpath slashseparator INTO completepath.</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line">        CONCATENATE userpath slashseparator additionalsubdirectory</span><br><span class="line">        slashseparator objectname period fileextension INTO newfilenamewithpath.</span><br><span class="line">        CONCATENATE userpath slashseparator additionalsubdirectory INTO completepath.</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Function Modules</span></span><br><span class="line">    WHEN is_function.</span><br><span class="line">      <span class="keyword">IF</span> additionalsubdirectory IS INITIAL.</span><br><span class="line">        FIND 'top' <span class="keyword">IN</span> includename IGNORING CASE.</span><br><span class="line">        <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line">          CONCATENATE userpath slashseparator objectname</span><br><span class="line">          slashseparator '<span class="keyword">Global</span>-' objectname</span><br><span class="line">          period fileextension</span><br><span class="line">          INTO newfilenamewithpath.</span><br><span class="line">        <span class="keyword">ELSE</span>.</span><br><span class="line">          <span class="keyword">IF</span> includename <span class="keyword">CS</span> mainfunctionno AND NOT mainfunctionno IS INITIAL.</span><br><span class="line">            CONCATENATE userpath slashseparator objectname</span><br><span class="line">            slashseparator objectname</span><br><span class="line">            period fileextension</span><br><span class="line">            INTO newfilenamewithpath.</span><br><span class="line">          <span class="keyword">ELSE</span>.</span><br><span class="line">            CONCATENATE userpath slashseparator objectname</span><br><span class="line">            slashseparator objectname</span><br><span class="line">            period fileextension</span><br><span class="line">            INTO newfilenamewithpath.</span><br><span class="line">          ENDIF.</span><br><span class="line">        ENDIF.</span><br><span class="line">        newsubdirectory = objectname.</span><br><span class="line">        CONCATENATE userpath</span><br><span class="line">        slashseparator</span><br><span class="line">        newsubdirectory</span><br><span class="line">        slashseparator INTO completepath.</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line">        FIND 'top' <span class="keyword">IN</span> includename IGNORING CASE.</span><br><span class="line">        <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line">          CONCATENATE userpath slashseparator additionalsubdirectory</span><br><span class="line">          slashseparator objectname</span><br><span class="line">          slashseparator '<span class="keyword">Global</span>-' objectname</span><br><span class="line">          period fileextension</span><br><span class="line">          INTO newfilenamewithpath.</span><br><span class="line">        <span class="keyword">ELSE</span>.</span><br><span class="line">          <span class="keyword">IF</span> includename <span class="keyword">CS</span> mainfunctionno AND NOT mainfunctionno IS INITIAL.</span><br><span class="line">            CONCATENATE userpath slashseparator additionalsubdirectory</span><br><span class="line">            slashseparator objectname</span><br><span class="line">            slashseparator objectname</span><br><span class="line">            period fileextension</span><br><span class="line">            INTO newfilenamewithpath.</span><br><span class="line">          <span class="keyword">ELSE</span>.</span><br><span class="line">            CONCATENATE userpath slashseparator additionalsubdirectory</span><br><span class="line">            slashseparator objectname</span><br><span class="line">            slashseparator objectname</span><br><span class="line">            period fileextension</span><br><span class="line">            INTO newfilenamewithpath.</span><br><span class="line">          ENDIF.</span><br><span class="line">        ENDIF.</span><br><span class="line">        CONCATENATE additionalsubdirectory slashseparator objectname INTO newsubdirectory.</span><br><span class="line">        CONCATENATE userpath slashseparator additionalsubdirectory slashseparator objectname INTO completepath.</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Table definition</span></span><br><span class="line">    WHEN is_table.</span><br><span class="line">      <span class="keyword">IF</span> additionalsubdirectory IS INITIAL.</span><br><span class="line">        CONCATENATE userpath slashseparator 'dictionary'   " slashSeparator objectName</span><br><span class="line">        slashseparator</span><br><span class="line">        objectname period fileextension</span><br><span class="line">        INTO newfilenamewithpath.</span><br><span class="line"></span><br><span class="line">        CONCATENATE userpath slashseparator 'dictionary' INTO newsubdirectory.</span><br><span class="line">        CONCATENATE userpath slashseparator 'dictionary' INTO completepath.</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line">        CONCATENATE userpath slashseparator additionalsubdirectory</span><br><span class="line">        slashseparator 'dictionary'   " slashSeparator objectName</span><br><span class="line">        slashseparator</span><br><span class="line">        objectname period fileextension</span><br><span class="line">        INTO newfilenamewithpath.</span><br><span class="line"></span><br><span class="line">        CONCATENATE userpath slashseparator additionalsubdirectory slashseparator 'dictionary' INTO newsubdirectory.</span><br><span class="line">        CONCATENATE userpath slashseparator additionalsubdirectory slashseparator 'dictionary' INTO completepath.</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Table definition</span></span><br><span class="line">    WHEN is_transformation.</span><br><span class="line">      <span class="keyword">IF</span> additionalsubdirectory IS INITIAL.</span><br><span class="line">        CONCATENATE userpath slashseparator 'Transformations'   " slashSeparator objectName</span><br><span class="line">        slashseparator</span><br><span class="line">        objectname period fileextension</span><br><span class="line">        INTO newfilenamewithpath.</span><br><span class="line"></span><br><span class="line">        CONCATENATE userpath slashseparator 'Transformations' INTO newsubdirectory.</span><br><span class="line">        CONCATENATE userpath slashseparator 'Transformations' INTO completepath.</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line">        CONCATENATE userpath slashseparator additionalsubdirectory</span><br><span class="line">        slashseparator 'Transformations'   " slashSeparator objectName</span><br><span class="line">        slashseparator</span><br><span class="line">        objectname period fileextension</span><br><span class="line">        INTO newfilenamewithpath.</span><br><span class="line"></span><br><span class="line">        CONCATENATE userpath slashseparator additionalsubdirectory slashseparator 'Transformations' INTO newsubdirectory.</span><br><span class="line">        CONCATENATE userpath slashseparator additionalsubdirectory slashseparator 'Transformations' INTO completepath.</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Program &amp; Function documentation</span></span><br><span class="line">    WHEN is_documentation.</span><br><span class="line">      <span class="keyword">IF</span> additionalsubdirectory IS INITIAL.</span><br><span class="line">        CONCATENATE userpath slashseparator objectname</span><br><span class="line">        slashseparator 'Docs-'</span><br><span class="line">        objectname period</span><br><span class="line">        fileextension</span><br><span class="line">        INTO newfilenamewithpath.</span><br><span class="line"></span><br><span class="line">        CONCATENATE userpath slashseparator objectname INTO newsubdirectory.</span><br><span class="line">        CONCATENATE userpath slashseparator objectname INTO completepath.</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line">        CONCATENATE userpath slashseparator additionalsubdirectory</span><br><span class="line">        slashseparator objectname</span><br><span class="line">        slashseparator 'Docs-'</span><br><span class="line">        objectname period fileextension</span><br><span class="line">        INTO newfilenamewithpath.</span><br><span class="line"></span><br><span class="line">        CONCATENATE userpath slashseparator additionalsubdirectory slashseparator objectname INTO newsubdirectory.</span><br><span class="line">        CONCATENATE userpath slashseparator additionalsubdirectory slashseparator objectname INTO completepath.</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Screens</span></span><br><span class="line">    WHEN is_screen.</span><br><span class="line">      <span class="keyword">IF</span> additionalsubdirectory IS INITIAL.</span><br><span class="line">        CONCATENATE userpath slashseparator 'Screens'</span><br><span class="line">        slashseparator 'screen_'</span><br><span class="line">        objectname period</span><br><span class="line">        fileextension INTO newfilenamewithpath.</span><br><span class="line"></span><br><span class="line">        CONCATENATE userpath slashseparator 'screens' INTO newsubdirectory.</span><br><span class="line">        CONCATENATE userpath slashseparator 'screens' INTO completepath.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line">        CONCATENATE userpath slashseparator additionalsubdirectory</span><br><span class="line">        slashseparator 'Screens'</span><br><span class="line">        slashseparator 'screen_'</span><br><span class="line">        objectname period</span><br><span class="line">        fileextension INTO newfilenamewithpath.</span><br><span class="line"></span><br><span class="line">        CONCATENATE userpath slashseparator additionalsubdirectory slashseparator 'screens' INTO newsubdirectory.</span><br><span class="line">        CONCATENATE userpath slashseparator additionalsubdirectory slashseparator 'screens' INTO completepath.</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   GUI title</span></span><br><span class="line">    WHEN is_guititle.</span><br><span class="line">      <span class="keyword">IF</span> additionalsubdirectory IS INITIAL.</span><br><span class="line">        CONCATENATE userpath slashseparator 'Screens'</span><br><span class="line">        slashseparator 'gui_title_'</span><br><span class="line">        objectname period</span><br><span class="line">        fileextension INTO newfilenamewithpath.</span><br><span class="line"></span><br><span class="line">        CONCATENATE userpath slashseparator 'screens' INTO newsubdirectory.</span><br><span class="line">        CONCATENATE userpath slashseparator 'screens' INTO completepath.</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line">        CONCATENATE userpath slashseparator additionalsubdirectory</span><br><span class="line">        slashseparator 'Screens'</span><br><span class="line">        slashseparator 'gui_title_'</span><br><span class="line">        objectname period</span><br><span class="line">        fileextension INTO newfilenamewithpath.</span><br><span class="line"></span><br><span class="line">        CONCATENATE userpath slashseparator additionalsubdirectory slashseparator 'Screens' INTO newsubdirectory.</span><br><span class="line">        CONCATENATE userpath slashseparator additionalsubdirectory slashseparator 'Screens' INTO completepath.</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Message Class</span></span><br><span class="line">    WHEN is_messageclass.</span><br><span class="line">      <span class="keyword">IF</span> additionalsubdirectory IS INITIAL.</span><br><span class="line">        CONCATENATE userpath slashseparator objectname</span><br><span class="line">        slashseparator 'Message <span class="keyword">class</span>-'</span><br><span class="line">        objectname period</span><br><span class="line">        fileextension</span><br><span class="line">        INTO newfilenamewithpath.</span><br><span class="line"></span><br><span class="line">        CONCATENATE userpath slashseparator objectname INTO newsubdirectory.</span><br><span class="line">        CONCATENATE userpath slashseparator objectname INTO completepath.</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line">        CONCATENATE userpath slashseparator additionalsubdirectory</span><br><span class="line">        slashseparator objectname</span><br><span class="line">        slashseparator 'Message <span class="keyword">class</span>-'</span><br><span class="line">        objectname period fileextension</span><br><span class="line">        INTO newfilenamewithpath.</span><br><span class="line"></span><br><span class="line">        CONCATENATE userpath slashseparator additionalsubdirectory slashseparator objectname INTO newsubdirectory.</span><br><span class="line">        CONCATENATE userpath slashseparator additionalsubdirectory slashseparator objectname INTO completepath.</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Class definition</span></span><br><span class="line">    WHEN is_class.</span><br><span class="line">      <span class="keyword">IF</span> additionalsubdirectory IS INITIAL.</span><br><span class="line">        CONCATENATE userpath slashseparator objectname</span><br><span class="line">        slashseparator '<span class="keyword">Class</span>-'</span><br><span class="line">        objectname period fileextension</span><br><span class="line">        INTO newfilenamewithpath.</span><br><span class="line"></span><br><span class="line">        CONCATENATE userpath slashseparator objectname INTO newsubdirectory.</span><br><span class="line">        CONCATENATE userpath slashseparator objectname INTO completepath.</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line">        CONCATENATE userpath slashseparator additionalsubdirectory</span><br><span class="line">        slashseparator objectname</span><br><span class="line">        slashseparator '<span class="keyword">Class</span>-'</span><br><span class="line">        objectname period fileextension</span><br><span class="line">        INTO newfilenamewithpath.</span><br><span class="line"></span><br><span class="line">        CONCATENATE userpath slashseparator additionalsubdirectory slashseparator objectname INTO newsubdirectory.</span><br><span class="line">        CONCATENATE userpath slashseparator additionalsubdirectory slashseparator objectname INTO completepath.</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Class definition</span></span><br><span class="line">    WHEN is_method.</span><br><span class="line">      <span class="keyword">IF</span> additionalsubdirectory IS INITIAL.</span><br><span class="line">        CONCATENATE userpath slashseparator</span><br><span class="line">        objectname period fileextension</span><br><span class="line">        INTO newfilenamewithpath.</span><br><span class="line"></span><br><span class="line">        CONCATENATE userpath slashseparator objectname INTO newsubdirectory.</span><br><span class="line">        CONCATENATE userpath slashseparator objectname INTO completepath.</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line">        CONCATENATE userpath slashseparator additionalsubdirectory</span><br><span class="line">        slashseparator</span><br><span class="line">        objectname period fileextension</span><br><span class="line">        INTO newfilenamewithpath.</span><br><span class="line"></span><br><span class="line"><span class="comment">*        concatenate userPath slashSeparator additionalSubDirectory slashSeparator objectName into newSubDirectory.</span></span><br><span class="line">        CONCATENATE userpath slashseparator additionalsubdirectory INTO completepath.</span><br><span class="line">      ENDIF.</span><br><span class="line">  ENDCASE.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">TRANSLATE</span> completepath TO LOWER CASE.</span><br><span class="line">  CONCATENATE objectname period fileextension INTO newfilenameonly.</span><br><span class="line">  <span class="keyword">TRANSLATE</span> newfilenameonly TO LOWER CASE.</span><br><span class="line">  <span class="keyword">TRANSLATE</span> newfilenamewithpath TO LOWER CASE.</span><br><span class="line">  <span class="keyword">TRANSLATE</span> newsubdirectory TO LOWER CASE.</span><br><span class="line"></span><br><span class="line"><span class="comment">* If we are running on a non UNIX environment we will need to remove incorrect characters from the filename.</span></span><br><span class="line">  <span class="keyword">IF</span> downloadtoserver IS INITIAL.</span><br><span class="line">    <span class="keyword">IF</span> frontendopsystem = non_unix.</span><br><span class="line">      <span class="keyword">TRANSLATE</span> newfilenameonly USING '/_'.</span><br><span class="line">      <span class="keyword">TRANSLATE</span> newfilenamewithpath USING '/_'.</span><br><span class="line">      <span class="keyword">TRANSLATE</span> newfilenameonly USING '&lt; '.</span><br><span class="line">      <span class="keyword">TRANSLATE</span> newfilenamewithpath USING '&lt; '.</span><br><span class="line">      <span class="keyword">TRANSLATE</span> newfilenameonly USING '&gt; '.</span><br><span class="line">      <span class="keyword">TRANSLATE</span> newfilenamewithpath USING '&gt; '.</span><br><span class="line">      <span class="keyword">TRANSLATE</span> newfilenameonly USING '? '.</span><br><span class="line">      <span class="keyword">TRANSLATE</span> newfilenamewithpath USING '? '.</span><br><span class="line">      <span class="keyword">TRANSLATE</span> newfilenameonly USING '| '.</span><br><span class="line">      <span class="keyword">TRANSLATE</span> newfilenamewithpath USING '| '.</span><br><span class="line">      CONDENSE newfilenameonly <span class="keyword">NO</span>-GAPS.</span><br><span class="line">      CONDENSE newfilenamewithpath <span class="keyword">NO</span>-GAPS.</span><br><span class="line">    ENDIF.</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line">    <span class="keyword">IF</span> serveropsystem = non_unix.</span><br><span class="line">      <span class="keyword">TRANSLATE</span> newfilenameonly USING '/_'.</span><br><span class="line">      <span class="keyword">TRANSLATE</span> newfilenamewithpath USING '/_'.</span><br><span class="line">      <span class="keyword">TRANSLATE</span> newfilenameonly USING '&lt; '.</span><br><span class="line">      <span class="keyword">TRANSLATE</span> newfilenamewithpath USING '&lt; '.</span><br><span class="line">      <span class="keyword">TRANSLATE</span> newfilenameonly USING '&gt; '.</span><br><span class="line">      <span class="keyword">TRANSLATE</span> newfilenamewithpath USING '&gt; '.</span><br><span class="line">      <span class="keyword">TRANSLATE</span> newfilenameonly USING '? '.</span><br><span class="line">      <span class="keyword">TRANSLATE</span> newfilenamewithpath USING '? '.</span><br><span class="line">      <span class="keyword">TRANSLATE</span> newfilenameonly USING '| '.</span><br><span class="line">      <span class="keyword">TRANSLATE</span> newfilenamewithpath USING '| '.</span><br><span class="line">      CONDENSE newfilenameonly <span class="keyword">NO</span>-GAPS.</span><br><span class="line">      CONDENSE newfilenamewithpath <span class="keyword">NO</span>-GAPS.</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.                                                                                 "buildFilename</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  saveFileToPc...    write an internal table to a file on the local PC</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> savefiletopc USING idownload <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span></span><br><span class="line">      VALUE(filenamewithpath)</span><br><span class="line">      VALUE(filename)</span><br><span class="line">      VALUE(writefieldseparator)</span><br><span class="line">      VALUE(truncatetrailingblanks)</span><br><span class="line">      VALUE(displayprogressmessage).</span><br><span class="line"></span><br><span class="line">  DATA: statusmessage <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: objfile <span class="keyword">TYPE</span> REF TO cl_gui_frontend_services.</span><br><span class="line">  DATA: strsubrc <span class="keyword">TYPE</span> string.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> NOT displayprogressmessage IS INITIAL.</span><br><span class="line">    CONCATENATE `Downloading: ` filename INTO statusmessage.</span><br><span class="line">    PERFORM displaystatus USING statusmessage 0.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">  CREATE OBJECT objfile.</span><br><span class="line">  objfile-&gt;gui_download( EXPORTING filename = filenamewithpath</span><br><span class="line">    filetype = 'ASC'</span><br><span class="line">    write_field_separator = writefieldseparator</span><br><span class="line">    trunc_trailing_blanks = truncatetrailingblanks</span><br><span class="line">  CHANGING data_tab = idownload[]</span><br><span class="line">  EXCEPTIONS file_write_error        = 1</span><br><span class="line">    no_batch                = 2</span><br><span class="line">    gui_refuse_filetransfer = 3</span><br><span class="line">    invalid_type            = 4</span><br><span class="line">    no_authority            = 5</span><br><span class="line">    unknown_error           = 6</span><br><span class="line">    header_not_allowed      = 7</span><br><span class="line">    separator_not_allowed   = 8</span><br><span class="line">    filesize_not_allowed    = 9</span><br><span class="line">    header_too_long         = 10</span><br><span class="line">    dp_error_create         = 11</span><br><span class="line">    dp_error_send           = 12</span><br><span class="line">    dp_error_write          = 13</span><br><span class="line">    unknown_dp_error        = 14</span><br><span class="line">    access_denied           = 15</span><br><span class="line">    dp_out_of_memory        = 16</span><br><span class="line">    disk_full               = 17</span><br><span class="line">    dp_timeout              = 18</span><br><span class="line">    file_not_found          = 19</span><br><span class="line">    dataprovider_exception  = 20</span><br><span class="line">    control_flush_error     = 21</span><br><span class="line">    not_supported_by_gui    = 22</span><br><span class="line">    error_no_gui            = 23 ).</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line">    strsubrc = sy-subrc.</span><br><span class="line">    CONCATENATE `<span class="keyword">File</span> <span class="keyword">save</span> <span class="keyword">error</span>: ` filename ` sy-subrc: ` strsubrc INTO statusmessage.</span><br><span class="line">    PERFORM displaystatus USING statusmessage 3.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.                                                                                                  "saveFileToPc</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  saveFileToServer...    write an internal table to a file on the SAP server</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> savefiletoserver USING idownload <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span></span><br><span class="line">      VALUE(filenamewithpath)</span><br><span class="line">      VALUE(filename)</span><br><span class="line">      VALUE(path)</span><br><span class="line">      VALUE(displayprogressmessage)</span><br><span class="line">      VALUE(locserverfilesystem).</span><br><span class="line"></span><br><span class="line">  DATA: wadownload <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: statusmessage <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: pathexists <span class="keyword">TYPE</span> flag.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> NOT displayprogressmessage IS INITIAL.</span><br><span class="line">    CONCATENATE `Downloading: ` filename INTO statusmessage.</span><br><span class="line">    PERFORM displaystatus USING statusmessage 0.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">READ</span> <span class="keyword">TABLE</span> iserverpaths WITH KEY table_line = path.</span><br><span class="line">  <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line">    PERFORM checkpathexists USING path</span><br><span class="line">          pathexists.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">IF</span> pathexists = ''.</span><br><span class="line">      PERFORM createserverdirectory USING path locserverfilesystem.</span><br><span class="line">    ENDIF.</span><br><span class="line"><span class="comment">*   Add the paths we know exist as there is no point wasting time checking them again.</span></span><br><span class="line">    <span class="keyword">APPEND</span> path TO iserverpaths.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">OPEN</span> DATASET filenamewithpath <span class="keyword">FOR</span> OUTPUT <span class="keyword">IN</span> TEXT MODE ENCODING DEFAULT.</span><br><span class="line">  <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line">    LOOP AT idownload INTO wadownload.</span><br><span class="line">      TRANSFER wadownload TO filenamewithpath.</span><br><span class="line">      <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line">        MESSAGE e000(oo) WITH '<span class="keyword">Error</span> transferring data to <span class="keyword">file</span>'.</span><br><span class="line">      ENDIF.</span><br><span class="line">    ENDLOOP.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">CLOSE</span> DATASET filenamewithpath.</span><br><span class="line">    <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line">      MESSAGE e000(oo) WITH '<span class="keyword">Error</span> closing <span class="keyword">file</span>'.</span><br><span class="line">    ENDIF.</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line"><span class="comment">*   Unable to create a file</span></span><br><span class="line">    MESSAGE e000(oo) WITH '<span class="keyword">Error</span> creating <span class="keyword">file</span> <span class="keyword">on</span> SAP server' 'check permissions'.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.                                                                                              "saveFileToServer</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* checkPathExists...  Check a filepath exists on the application server.</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> checkpathexists USING VALUE(path)</span><br><span class="line">      pathexists <span class="keyword">TYPE</span> flag.</span><br><span class="line"></span><br><span class="line">  DATA: castdirectory <span class="keyword">TYPE</span> btctext80.</span><br><span class="line"></span><br><span class="line">  castdirectory = path.</span><br><span class="line"></span><br><span class="line">  CALL FUNCTION 'PFL_CHECK_DIRECTORY'</span><br><span class="line">    EXPORTING</span><br><span class="line">      directory                   = castdirectory</span><br><span class="line"><span class="comment">*     WRITE_CHECK                 = ' '</span></span><br><span class="line">    EXCEPTIONS</span><br><span class="line">      pfl_dir_not_exist           = 1</span><br><span class="line">      pfl_permission_denied       = 2</span><br><span class="line">      pfl_cant_build_dataset_name = 3</span><br><span class="line">      pfl_file_not_exist          = 4</span><br><span class="line">      OTHERS                      = 5.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line">    pathexists = 'X'.</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line">    pathexists = ''.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* createServerDirectory...</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> createserverdirectory USING VALUE(path)</span><br><span class="line">      VALUE(locserverfilesystem).</span><br><span class="line"></span><br><span class="line">  DATA: castserveropsys <span class="keyword">TYPE</span> syopsys.</span><br><span class="line"></span><br><span class="line">  castserveropsys = locserverfilesystem.</span><br><span class="line"></span><br><span class="line"><span class="comment">*  Parameters for remove command.</span></span><br><span class="line">  DATA: param1 <span class="keyword">TYPE</span> sxpgcolist-parameters.</span><br><span class="line"><span class="comment">*  Return status</span></span><br><span class="line">  DATA: funcstatus <span class="keyword">TYPE</span> extcmdexex-status.</span><br><span class="line"><span class="comment">*  Command line listing returned by the function</span></span><br><span class="line">  DATA: iserveroutput <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF btcxpm.</span><br><span class="line">  DATA: waserveroutput <span class="keyword">TYPE</span> btcxpm.</span><br><span class="line"><span class="comment">*  Targetsystem type conversion variable.</span></span><br><span class="line">  DATA: target <span class="keyword">TYPE</span> rfcdisplay-rfchost.</span><br><span class="line"><span class="comment">* Operating system</span></span><br><span class="line">  DATA: operatingsystem <span class="keyword">TYPE</span> sxpgcolist-opsystem.</span><br><span class="line"><span class="comment">*  Head for split command.</span></span><br><span class="line">  DATA: head <span class="keyword">TYPE</span> string..</span><br><span class="line">  DATA: tail <span class="keyword">TYPE</span> string.</span><br><span class="line"></span><br><span class="line">  param1 = path.</span><br><span class="line">  target = sy-host.</span><br><span class="line">  operatingsystem = locserverfilesystem.</span><br><span class="line"></span><br><span class="line">  CALL FUNCTION 'SXPG_COMMAND_EXECUTE'</span><br><span class="line">    EXPORTING</span><br><span class="line">      commandname                   = 'ZDTX_MKDIR'</span><br><span class="line">      additional_parameters         = param1</span><br><span class="line">      operatingsystem               = castserveropsys</span><br><span class="line">      targetsystem                  = target</span><br><span class="line">      stdout                        = 'X'</span><br><span class="line">      stderr                        = 'X'</span><br><span class="line">      terminationwait               = 'X'</span><br><span class="line">    IMPORTING</span><br><span class="line">      status                        = funcstatus</span><br><span class="line">    TABLES</span><br><span class="line">      exec_protocol                 = iserveroutput[]</span><br><span class="line">    EXCEPTIONS</span><br><span class="line">      no_permission                 = 1</span><br><span class="line">      command_not_found             = 2</span><br><span class="line">      parameters_too_long           = 3</span><br><span class="line">      security_risk                 = 4</span><br><span class="line">      wrong_check_call_interface    = 5</span><br><span class="line">      program_start_error           = 6</span><br><span class="line">      program_termination_error     = 7</span><br><span class="line">      x_error                       = 8</span><br><span class="line">      parameter_expected            = 9</span><br><span class="line">      too_many_parameters           = 10</span><br><span class="line">      illegal_command               = 11</span><br><span class="line">      wrong_asynchronous_parameters = 12</span><br><span class="line">      cant_enq_tbtco_entry          = 13</span><br><span class="line">      jobcount_generation_error     = 14</span><br><span class="line">      OTHERS                        = 15.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line"><span class="comment">*   Although the function succeded did the external command actually work</span></span><br><span class="line">    <span class="keyword">IF</span> funcstatus = '<span class="keyword">E</span>'.</span><br><span class="line"><span class="comment">*     External command returned with an error</span></span><br><span class="line"><span class="comment">*     An error occurred creating the directory on the server</span></span><br><span class="line">      MESSAGE e000(oo) WITH '<span class="keyword">An</span> <span class="keyword">error</span> occurred creating a directory'.</span><br><span class="line">    ENDIF.</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line">    CASE sy-subrc.</span><br><span class="line">      WHEN 1.</span><br><span class="line"><span class="comment">*       No permissions to run the command</span></span><br><span class="line">        MESSAGE e000(oo) WITH '<span class="keyword">No</span> permissions to <span class="keyword">run</span> external command ZDTX_MKDIR'.</span><br><span class="line">      WHEN 2.</span><br><span class="line"><span class="comment">*       External command not found</span></span><br><span class="line">        MESSAGE e000(oo) WITH 'External comand ZDTX_MKDIR not found'.</span><br><span class="line"></span><br><span class="line">      WHEN OTHERS.</span><br><span class="line"><span class="comment">*       Unable to create the directory</span></span><br><span class="line">        MESSAGE e000(oo) WITH '<span class="keyword">An</span> <span class="keyword">error</span> occurred creating a directory'</span><br><span class="line">        ', subrc:'</span><br><span class="line">        sy-subrc.</span><br><span class="line">    ENDCASE.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.                                                                                         "createServerDirectory</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* appendTextElements...</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> appendtextelements USING iloctextelements LIKE dumitexttab[]</span><br><span class="line">      iloclines LIKE dumihtml[].</span><br><span class="line"></span><br><span class="line">  FIELD-SYMBOLS: &lt;watextelement&gt; <span class="keyword">TYPE</span> ttexttable.</span><br><span class="line">  DATA: waline <span class="keyword">TYPE</span> string.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> lines( iloctextelements ) &gt; 0.</span><br><span class="line">    <span class="keyword">APPEND</span> '' TO iloclines.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">APPEND</span> '*Text elements' TO iloclines.</span><br><span class="line">    <span class="keyword">APPEND</span> '*----------------------------------------------------------' TO  iloclines.</span><br><span class="line">    LOOP AT iloctextelements ASSIGNING &lt;watextelement&gt;.</span><br><span class="line">      CONCATENATE '*  ' &lt;watextelement&gt;-key &lt;watextelement&gt;-entry INTO waline SEPARATED <span class="keyword">BY</span> space.</span><br><span class="line">      <span class="keyword">APPEND</span> waline TO iloclines.</span><br><span class="line">    ENDLOOP.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.                                                                                            "appendTextElements</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* appendGUITitles...</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> appendguititles USING ilocguititles LIKE dumiguititle[]</span><br><span class="line">      iloclines LIKE dumihtml[].</span><br><span class="line"></span><br><span class="line">  FIELD-SYMBOLS: &lt;waguititle&gt; <span class="keyword">TYPE</span> tguititle.</span><br><span class="line">  DATA: waline <span class="keyword">TYPE</span> string.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> lines( ilocguititles ) &gt; 0.</span><br><span class="line">    <span class="keyword">APPEND</span> '' TO iloclines.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">APPEND</span> '*GUI Texts' TO iloclines.</span><br><span class="line">    <span class="keyword">APPEND</span> '*----------------------------------------------------------' TO  iloclines.</span><br><span class="line">    LOOP AT ilocguititles ASSIGNING &lt;waguititle&gt;.</span><br><span class="line">      CONCATENATE '*  ' &lt;waguititle&gt;-obj_code '--&gt;' &lt;waguititle&gt;-text INTO waline SEPARATED <span class="keyword">BY</span> space.</span><br><span class="line">      <span class="keyword">APPEND</span> waline TO iloclines.</span><br><span class="line">    ENDLOOP.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.                                                                                               "appendGUITitles</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* appendSelectionTexts...</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> appendselectiontexts USING ilocselectiontexts LIKE dumitexttab[]</span><br><span class="line">      iloclines LIKE dumihtml[].</span><br><span class="line"></span><br><span class="line">  FIELD-SYMBOLS: &lt;waselectiontext&gt; <span class="keyword">TYPE</span> ttexttable.</span><br><span class="line">  DATA: waline <span class="keyword">TYPE</span> string.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> lines( ilocselectiontexts ) &gt; 0.</span><br><span class="line">    <span class="keyword">APPEND</span> '' TO iloclines.</span><br><span class="line">    <span class="keyword">APPEND</span> '' TO iloclines.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">APPEND</span> '*Selection texts' TO iloclines.</span><br><span class="line">    <span class="keyword">APPEND</span> '*----------------------------------------------------------' TO  iloclines.</span><br><span class="line">    LOOP AT ilocselectiontexts ASSIGNING &lt;waselectiontext&gt;.</span><br><span class="line">      CONCATENATE '*  ' &lt;waselectiontext&gt;-key &lt;waselectiontext&gt;-entry INTO waline SEPARATED <span class="keyword">BY</span> space.</span><br><span class="line">      <span class="keyword">APPEND</span> waline TO iloclines.</span><br><span class="line">    ENDLOOP.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.                                                                                          "appendSelectionTexts</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* appendExceptionTexts...</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> appendexceptiontexts USING iconcepts LIKE dumiconcepts[]</span><br><span class="line">      iloclines LIKE dumihtml[].</span><br><span class="line"></span><br><span class="line">  FIELD-SYMBOLS: &lt;waconcept&gt; <span class="keyword">TYPE</span> tconcept.</span><br><span class="line">  DATA: waline <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: concepttext <span class="keyword">TYPE</span> sotr_txt.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> lines( iconcepts ) &gt; 0.</span><br><span class="line">    <span class="keyword">APPEND</span> '' TO iloclines.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">APPEND</span> '*Exception texts' TO iloclines.</span><br><span class="line">    <span class="keyword">APPEND</span> '*----------------------------------------------------------' TO  iloclines.</span><br><span class="line">    LOOP AT iconcepts ASSIGNING &lt;waconcept&gt;.</span><br><span class="line"><span class="comment">*     Find the text for this concept</span></span><br><span class="line">      CALL FUNCTION 'SOTR_GET_TEXT_KEY'</span><br><span class="line">        EXPORTING</span><br><span class="line">          concept                = &lt;waconcept&gt;-concept</span><br><span class="line">          langu                  = pmlang</span><br><span class="line">          search_in_second_langu = 'X'</span><br><span class="line"><span class="comment">*         second_langu           = 'DE'</span></span><br><span class="line">        IMPORTING</span><br><span class="line">          e_text                 = concepttext</span><br><span class="line">        EXCEPTIONS</span><br><span class="line">          no_entry_found         = 1</span><br><span class="line">          parameter_error        = 2</span><br><span class="line">          OTHERS                 = 3.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line">        CONCATENATE '*  ' &lt;waconcept&gt;-constname '-' concepttext  INTO waline SEPARATED <span class="keyword">BY</span> space.</span><br><span class="line">        <span class="keyword">APPEND</span> waline TO iloclines.</span><br><span class="line">      ENDIF.</span><br><span class="line">    ENDLOOP.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.                                                                                          "appendExceptionTexts</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* downloadFunctionDocs...</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> downloadfunctiondocs USING VALUE(functionname)</span><br><span class="line">      VALUE(functiondescription)</span><br><span class="line">      VALUE(userfilepath)</span><br><span class="line">      VALUE(fileextension)</span><br><span class="line">      VALUE(converttohtml)</span><br><span class="line">      VALUE(slashseparator)</span><br><span class="line">      VALUE(savetoserver)</span><br><span class="line">      VALUE(displayprogressmessage)</span><br><span class="line">      subdir</span><br><span class="line">      documentationdownloaded</span><br><span class="line">      VALUE(locserverfilesystem)</span><br><span class="line">      VALUE(addbackground) <span class="keyword">TYPE</span> abap_bool.</span><br><span class="line"></span><br><span class="line">  DATA: ilines <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF string WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: idocumentation <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF funct WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: iexceptions <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF rsexc WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: iexport <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF rsexp WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: iparameter <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF rsimp WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: itables <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF rstbl WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: iscriptlines <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF tline WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: htmlpagename <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: newfilenamewithpath <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: newfilenameonly <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: object LIKE dokhl-object.</span><br><span class="line">  DATA: stringlength <span class="keyword">TYPE</span> i VALUE 0.</span><br><span class="line">  DATA: newsubdirectory <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: waline(255).</span><br><span class="line">  DATA: completesavepath <span class="keyword">TYPE</span> string.</span><br><span class="line"></span><br><span class="line">  documentationdownloaded = false.</span><br><span class="line">  object = functionname.</span><br><span class="line"></span><br><span class="line">  CALL FUNCTION 'FUNCTION_IMPORT_DOKU'</span><br><span class="line">    EXPORTING</span><br><span class="line">      funcname           = functionname</span><br><span class="line">    TABLES</span><br><span class="line">      dokumentation      = idocumentation</span><br><span class="line">      exception_list     = iexceptions</span><br><span class="line">      export_parameter   = iexport</span><br><span class="line">      import_parameter   = iparameter</span><br><span class="line">      tables_parameter   = itables</span><br><span class="line">    EXCEPTIONS</span><br><span class="line">      error_message      = 1</span><br><span class="line">      function_not_found = 2</span><br><span class="line">      invalid_name       = 3</span><br><span class="line">      OTHERS             = 4.</span><br><span class="line"></span><br><span class="line">  CALL FUNCTION 'DOCU_GET'</span><br><span class="line">    EXPORTING</span><br><span class="line">      id                     = 'FU'</span><br><span class="line">      langu                  = pmlang</span><br><span class="line">      object                 = object</span><br><span class="line">      <span class="keyword">typ</span>                    = 'T'</span><br><span class="line">      version_active_or_last = '<span class="keyword">L</span>'</span><br><span class="line">    TABLES</span><br><span class="line">      <span class="keyword">line</span>                   = iscriptlines</span><br><span class="line">    EXCEPTIONS</span><br><span class="line">      no_docu_on_screen      = 1</span><br><span class="line">      no_docu_self_def       = 2</span><br><span class="line">      no_docu_temp           = 3</span><br><span class="line">      ret_code               = 4</span><br><span class="line">      OTHERS                 = 5.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> sy-subrc = 0 AND NOT ( iscriptlines[] IS INITIAL ).</span><br><span class="line">    <span class="keyword">APPEND</span> 'SHORT TEXT' TO ilines.</span><br><span class="line">    CONCATENATE space functiondescription INTO functiondescription SEPARATED <span class="keyword">BY</span> space.</span><br><span class="line">    <span class="keyword">APPEND</span> functiondescription TO ilines.</span><br><span class="line">    <span class="keyword">APPEND</span> space TO ilines.</span><br><span class="line">    LOOP AT iscriptlines.</span><br><span class="line">      <span class="keyword">MOVE</span> iscriptlines-tdline TO ilines.</span><br><span class="line">      CONCATENATE space ilines INTO ilines SEPARATED <span class="keyword">BY</span> space.</span><br><span class="line">      <span class="keyword">WHILE</span> ilines CP '&amp;*' OR ilines CP '*&amp;'.</span><br><span class="line">        <span class="keyword">REPLACE</span> '&amp;' INTO ilines WITH space.</span><br><span class="line">        SHIFT ilines LEFT DELETING LEADING space.</span><br><span class="line">      ENDWHILE.</span><br><span class="line">      <span class="keyword">APPEND</span> ilines.</span><br><span class="line">    ENDLOOP.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">CLEAR</span> ilines.</span><br><span class="line">    <span class="keyword">IF</span> NOT ( idocumentation[] IS INITIAL ).</span><br><span class="line">      <span class="keyword">APPEND</span> ilines.</span><br><span class="line">      <span class="keyword">APPEND</span> 'PARAMETER DOCUMENTATION' TO ilines.</span><br><span class="line">      <span class="keyword">APPEND</span> '-----------------------' TO ilines.</span><br><span class="line">      <span class="keyword">APPEND</span> ilines.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">DESCRIBE</span> FIELD idocumentation-parameter LENGTH stringlength <span class="keyword">IN</span> CHARACTER MODE.</span><br><span class="line">      stringlength = stringlength + 3.</span><br><span class="line">      LOOP AT idocumentation.</span><br><span class="line">        <span class="keyword">MOVE</span> idocumentation-parameter TO waline.</span><br><span class="line">        <span class="keyword">MOVE</span> idocumentation-stext TO waline+stringlength.</span><br><span class="line">        <span class="keyword">APPEND</span> waline TO ilines.</span><br><span class="line">      ENDLOOP.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line">    CONCATENATE `Documentation - ` functionname INTO htmlpagename.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">IF</span> converttohtml IS INITIAL.</span><br><span class="line">      <span class="keyword">APPEND</span> ilines.</span><br><span class="line">      <span class="keyword">APPEND</span>  '----------------------------------------------------------------------------------' TO ilines.</span><br><span class="line">      <span class="keyword">APPEND</span> ilines.</span><br><span class="line">      PERFORM buildfootermessage USING ilines.</span><br><span class="line">      <span class="keyword">APPEND</span> ilines.</span><br><span class="line">    <span class="keyword">ELSE</span>.</span><br><span class="line">      PERFORM convertcodetohtml USING ilines[]</span><br><span class="line">            htmlpagename</span><br><span class="line">            space</span><br><span class="line">            is_documentation</span><br><span class="line">            true</span><br><span class="line">            space</span><br><span class="line">            space</span><br><span class="line">            space</span><br><span class="line">            space</span><br><span class="line">            space</span><br><span class="line">            addbackground.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line">    PERFORM buildfilename USING userfilepath</span><br><span class="line">          subdir</span><br><span class="line">          functionname</span><br><span class="line">          space</span><br><span class="line">          space</span><br><span class="line">          fileextension</span><br><span class="line">          is_documentation</span><br><span class="line">          savetoserver</span><br><span class="line">          slashseparator</span><br><span class="line">          newfilenamewithpath</span><br><span class="line">          newfilenameonly</span><br><span class="line">          newsubdirectory</span><br><span class="line">          completesavepath.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">IF</span> savetoserver IS INITIAL.</span><br><span class="line">      PERFORM savefiletopc USING ilines[]</span><br><span class="line">            newfilenamewithpath</span><br><span class="line">            newfilenameonly</span><br><span class="line">            space</span><br><span class="line">            space</span><br><span class="line">            displayprogressmessage.</span><br><span class="line">    <span class="keyword">ELSE</span>.</span><br><span class="line">      PERFORM savefiletoserver USING ilines[]</span><br><span class="line">            newfilenamewithpath</span><br><span class="line">            newfilenameonly</span><br><span class="line">            completesavepath</span><br><span class="line">            displayprogressmessage</span><br><span class="line">            locserverfilesystem.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line">    documentationdownloaded = true.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* downloadClassDocs...</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> downloadclassdocs USING VALUE(classname) <span class="keyword">TYPE</span> seoclsname</span><br><span class="line">      VALUE(userfilepath)</span><br><span class="line">      VALUE(fileextension)</span><br><span class="line">      VALUE(converttohtml)</span><br><span class="line">      VALUE(slashseparator)</span><br><span class="line">      VALUE(savetoserver)</span><br><span class="line">      VALUE(displayprogressmessage)</span><br><span class="line">      subdir</span><br><span class="line">      documentationdownloaded</span><br><span class="line">      VALUE(locserverfilesystem)</span><br><span class="line">      VALUE(addbackground) <span class="keyword">TYPE</span> abap_bool.</span><br><span class="line"></span><br><span class="line">  DATA: ilines <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF string WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: idocumentation <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF funct WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: iexceptions <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF rsexc WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: iexport <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF rsexp WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: iparameter <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF rsimp WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: itables <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF rstbl WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: iscriptlines <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF tline WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: htmlpagename <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: newfilenamewithpath <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: newfilenameonly <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: object LIKE dokhl-object.</span><br><span class="line">  DATA: stringlength <span class="keyword">TYPE</span> i VALUE 0.</span><br><span class="line">  DATA: newsubdirectory <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: waline(255).</span><br><span class="line">  DATA: completesavepath <span class="keyword">TYPE</span> string.</span><br><span class="line"></span><br><span class="line">  documentationdownloaded = false.</span><br><span class="line">  object = classname.</span><br><span class="line"></span><br><span class="line">  CALL FUNCTION 'DOC_OBJECT_GET'</span><br><span class="line">    EXPORTING</span><br><span class="line">      <span class="keyword">class</span>            = '<span class="keyword">CL</span>'</span><br><span class="line">      name             = object</span><br><span class="line">      language         = pmlang</span><br><span class="line"><span class="comment">*     short_text       = ' '</span></span><br><span class="line"><span class="comment">*     appendix         = ' '</span></span><br><span class="line"><span class="comment">*   importing</span></span><br><span class="line"><span class="comment">*     header           = header</span></span><br><span class="line">    TABLES</span><br><span class="line">      itf_lines        = iscriptlines[]</span><br><span class="line">    EXCEPTIONS</span><br><span class="line">      object_not_found = 1.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> sy-subrc = 0 AND NOT ( iscriptlines[] IS INITIAL ).</span><br><span class="line">    LOOP AT iscriptlines.</span><br><span class="line">      <span class="keyword">MOVE</span> iscriptlines-tdline TO ilines.</span><br><span class="line">      CONCATENATE space ilines INTO ilines SEPARATED <span class="keyword">BY</span> space.</span><br><span class="line">      <span class="keyword">WHILE</span> ilines CP '&amp;*' OR ilines CP '*&amp;'.</span><br><span class="line">        <span class="keyword">REPLACE</span> '&amp;' INTO ilines WITH space.</span><br><span class="line">        SHIFT ilines LEFT DELETING LEADING space.</span><br><span class="line">      ENDWHILE.</span><br><span class="line">      <span class="keyword">APPEND</span> ilines.</span><br><span class="line">    ENDLOOP.</span><br><span class="line"></span><br><span class="line">    CONCATENATE `Documentation - ` classname INTO htmlpagename.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">IF</span> converttohtml IS INITIAL.</span><br><span class="line">      <span class="keyword">APPEND</span> ilines.</span><br><span class="line">      <span class="keyword">APPEND</span>  '----------------------------------------------------------------------------------' TO ilines.</span><br><span class="line">      <span class="keyword">APPEND</span> ilines.</span><br><span class="line">      PERFORM buildfootermessage USING ilines.</span><br><span class="line">      <span class="keyword">APPEND</span> ilines.</span><br><span class="line">    <span class="keyword">ELSE</span>.</span><br><span class="line">      PERFORM convertcodetohtml USING ilines[]</span><br><span class="line">            htmlpagename</span><br><span class="line">            space</span><br><span class="line">            is_documentation</span><br><span class="line">            true</span><br><span class="line">            space</span><br><span class="line">            space</span><br><span class="line">            space</span><br><span class="line">            space</span><br><span class="line">            space</span><br><span class="line">            addbackground.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line">    PERFORM buildfilename USING userfilepath</span><br><span class="line">          subdir</span><br><span class="line">          classname</span><br><span class="line">          space</span><br><span class="line">          space</span><br><span class="line">          fileextension</span><br><span class="line">          is_documentation</span><br><span class="line">          savetoserver</span><br><span class="line">          slashseparator</span><br><span class="line">          newfilenamewithpath</span><br><span class="line">          newfilenameonly</span><br><span class="line">          newsubdirectory</span><br><span class="line">          completesavepath.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">IF</span> savetoserver IS INITIAL.</span><br><span class="line">      PERFORM savefiletopc USING ilines[]</span><br><span class="line">            newfilenamewithpath</span><br><span class="line">            newfilenameonly</span><br><span class="line">            space</span><br><span class="line">            space</span><br><span class="line">            displayprogressmessage.</span><br><span class="line">    <span class="keyword">ELSE</span>.</span><br><span class="line">      PERFORM savefiletoserver USING ilines[]</span><br><span class="line">            newfilenamewithpath</span><br><span class="line">            newfilenameonly</span><br><span class="line">            completesavepath</span><br><span class="line">            displayprogressmessage</span><br><span class="line">            locserverfilesystem.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line">    documentationdownloaded = true.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.</span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  downloadScreens...</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> downloadscreens USING ilocscreenflow LIKE dumiscreen[]</span><br><span class="line">      VALUE(programname)</span><br><span class="line">      VALUE(userfilepath)</span><br><span class="line">      VALUE(textfileextension)</span><br><span class="line">      VALUE(subdir)</span><br><span class="line">      VALUE(slashseparator)</span><br><span class="line">      VALUE(savetoserver)</span><br><span class="line">      VALUE(displayprogressmessage)</span><br><span class="line">      VALUE(locserverfilesystem).</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  TABLES: d020t.</span><br><span class="line">  DATA: header LIKE d020s.</span><br><span class="line">  DATA: ifields <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF d021s WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: iflowlogic <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF d022s WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  FIELD-SYMBOLS &lt;wascreen&gt; <span class="keyword">TYPE</span> tscreenflow.</span><br><span class="line">  DATA: wacharheader <span class="keyword">TYPE</span> scr_chhead.</span><br><span class="line">  DATA: iscreenchar <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF scr_chfld WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: ifieldschar <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF scr_chfld WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: stars <span class="keyword">TYPE</span> string VALUE '****************************************************************'.</span><br><span class="line">  DATA: comment1 <span class="keyword">TYPE</span> string VALUE '*   This <span class="keyword">file</span> was generated <span class="keyword">by</span> Direct Download Enterprise.     *'.</span><br><span class="line">  DATA: comment2 <span class="keyword">TYPE</span> string VALUE '*   Please <span class="keyword">do</span> not change it manually.                          *'.</span><br><span class="line">  DATA: dynprotext <span class="keyword">TYPE</span> string VALUE '%_DYNPRO'.</span><br><span class="line">  DATA: headertext <span class="keyword">TYPE</span> string VALUE '%_HEADER'.</span><br><span class="line">  DATA: paramstext <span class="keyword">TYPE</span> string VALUE '%_PARAMS'.</span><br><span class="line">  DATA: descriptiontext <span class="keyword">TYPE</span> string VALUE '%_DESCRIPTION'.</span><br><span class="line">  DATA: fieldstext <span class="keyword">TYPE</span> string VALUE '%_FIELDS'.</span><br><span class="line">  DATA: flowlogictext <span class="keyword">TYPE</span> string VALUE '%_FLOWLOGIC'.</span><br><span class="line">  DATA: programlength <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: newsubdirectory <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: newfilenamewithpath <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: newfilenameonly <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: completesavepath <span class="keyword">TYPE</span> string.</span><br><span class="line"></span><br><span class="line">  LOOP AT ilocscreenflow ASSIGNING &lt;wascreen&gt;.</span><br><span class="line">    CALL FUNCTION 'RS_IMPORT_DYNPRO'</span><br><span class="line">      EXPORTING</span><br><span class="line">        dylang = pmlang</span><br><span class="line">        dyname = programname</span><br><span class="line">        dynumb = &lt;wascreen&gt;-screen</span><br><span class="line">      IMPORTING</span><br><span class="line">        header = header</span><br><span class="line">      TABLES</span><br><span class="line">        ftab   = ifields</span><br><span class="line">        pltab  = iflowlogic.</span><br><span class="line"></span><br><span class="line">    CALL FUNCTION 'RS_SCRP_HEADER_RAW_TO_CHAR'</span><br><span class="line">      EXPORTING</span><br><span class="line">        header_int  = header</span><br><span class="line">      IMPORTING</span><br><span class="line">        header_char = wacharheader</span><br><span class="line">      EXCEPTIONS</span><br><span class="line">        OTHERS      = 1.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Add in the top comments for the file</span></span><br><span class="line">    <span class="keyword">APPEND</span> stars TO iscreenchar .</span><br><span class="line">    <span class="keyword">APPEND</span> comment1 TO iscreenchar.</span><br><span class="line">    <span class="keyword">APPEND</span> comment2 TO iscreenchar.</span><br><span class="line">    <span class="keyword">APPEND</span> stars TO iscreenchar.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Screen identification</span></span><br><span class="line">    <span class="keyword">APPEND</span> dynprotext TO iscreenchar.</span><br><span class="line">    <span class="keyword">APPEND</span> wacharheader-<span class="keyword">prog</span> TO iscreenchar.</span><br><span class="line">    <span class="keyword">APPEND</span> wacharheader-dnum TO iscreenchar.</span><br><span class="line">    <span class="keyword">APPEND</span> sy-saprl TO iscreenchar.</span><br><span class="line">    <span class="keyword">DESCRIBE</span> FIELD d020t-<span class="keyword">prog</span> LENGTH programlength <span class="keyword">IN</span> CHARACTER MODE.</span><br><span class="line">    CONCATENATE `                ` programlength INTO iscreenchar.</span><br><span class="line">    <span class="keyword">APPEND</span> iscreenchar.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Header</span></span><br><span class="line">    <span class="keyword">APPEND</span> headertext TO iscreenchar.</span><br><span class="line">    <span class="keyword">APPEND</span> wacharheader TO iscreenchar.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Description text</span></span><br><span class="line">    <span class="keyword">APPEND</span> descriptiontext TO iscreenchar.</span><br><span class="line">    SELECT SINGLE dtxt FROM d020t INTO iscreenchar</span><br><span class="line">    WHERE <span class="keyword">prog</span> = programname</span><br><span class="line">    AND dynr = &lt;wascreen&gt;-screen</span><br><span class="line">    AND lang = pmlang.</span><br><span class="line">    <span class="keyword">APPEND</span> iscreenchar.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Fieldlist text</span></span><br><span class="line">    <span class="keyword">APPEND</span> fieldstext TO iscreenchar.</span><br><span class="line"></span><br><span class="line">    CALL FUNCTION 'RS_SCRP_FIELDS_RAW_TO_CHAR'</span><br><span class="line">      TABLES</span><br><span class="line">        fields_int  = ifields[]</span><br><span class="line">        fields_char = ifieldschar[]</span><br><span class="line">      EXCEPTIONS</span><br><span class="line">        OTHERS      = 1.</span><br><span class="line"></span><br><span class="line">    LOOP AT ifieldschar.</span><br><span class="line">      <span class="keyword">MOVE</span>-CORRESPONDING ifieldschar TO iscreenchar.</span><br><span class="line">      <span class="keyword">APPEND</span> iscreenchar.</span><br><span class="line">    ENDLOOP.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Flowlogic text</span></span><br><span class="line">    <span class="keyword">APPEND</span> flowlogictext TO iscreenchar.</span><br><span class="line"><span class="comment">*   Flow logic.</span></span><br><span class="line">    LOOP AT iflowlogic.</span><br><span class="line">      <span class="keyword">APPEND</span> iflowlogic TO iscreenchar.</span><br><span class="line">    ENDLOOP.</span><br><span class="line"></span><br><span class="line">    PERFORM buildfilename USING userfilepath</span><br><span class="line">          subdir</span><br><span class="line">          wacharheader-dnum</span><br><span class="line">          space</span><br><span class="line">          space</span><br><span class="line">          textfileextension</span><br><span class="line">          is_screen</span><br><span class="line">          savetoserver</span><br><span class="line">          slashseparator</span><br><span class="line">          newfilenamewithpath</span><br><span class="line">          newfilenameonly</span><br><span class="line">          newsubdirectory</span><br><span class="line">          completesavepath.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">IF</span> savetoserver IS INITIAL.</span><br><span class="line"><span class="comment">*     Save the screen to the local computer</span></span><br><span class="line">      PERFORM savefiletopc USING iscreenchar[]</span><br><span class="line">            newfilenamewithpath</span><br><span class="line">            newfilenameonly</span><br><span class="line">            'X'</span><br><span class="line">            'X'</span><br><span class="line">            displayprogressmessage.</span><br><span class="line">    <span class="keyword">ELSE</span>.</span><br><span class="line"><span class="comment">*     Save the screen to the SAP server</span></span><br><span class="line">      PERFORM savefiletoserver USING iscreenchar[]</span><br><span class="line">            newfilenamewithpath</span><br><span class="line">            newfilenameonly</span><br><span class="line">            completesavepath</span><br><span class="line">            displayprogressmessage</span><br><span class="line">            locserverfilesystem.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">CLEAR</span> header. <span class="keyword">CLEAR</span> wacharheader.</span><br><span class="line">    <span class="keyword">CLEAR</span> iscreenchar[].</span><br><span class="line">    <span class="keyword">CLEAR</span> ifieldschar[].</span><br><span class="line">    <span class="keyword">CLEAR</span> ifields[].</span><br><span class="line">    <span class="keyword">CLEAR</span> iflowlogic[].</span><br><span class="line">  ENDLOOP.</span><br><span class="line">ENDFORM.                                                                                               "downloadScreens</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  downloadGUITitles..</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> downloadguititles USING ilocguititles LIKE dumiguititle[]</span><br><span class="line">      VALUE(userfilepath)</span><br><span class="line">      VALUE(textfileextension)</span><br><span class="line">      VALUE(subdir)</span><br><span class="line">      VALUE(slashseparator)</span><br><span class="line">      VALUE(savetoserver)</span><br><span class="line">      VALUE(displayprogressmessage)</span><br><span class="line">      VALUE(locserverfilesystem).</span><br><span class="line"></span><br><span class="line">  DATA: ilines <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF string WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  FIELD-SYMBOLS: &lt;waguititle&gt; <span class="keyword">TYPE</span> tguititle.</span><br><span class="line">  DATA: newsubdirectory <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: newfilenamewithpath <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: newfilenameonly <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: completesavepath <span class="keyword">TYPE</span> string.</span><br><span class="line"></span><br><span class="line">  LOOP AT ilocguititles ASSIGNING &lt;waguititle&gt;.</span><br><span class="line">    <span class="keyword">APPEND</span> &lt;waguititle&gt;-text TO ilines.</span><br><span class="line"></span><br><span class="line">    PERFORM buildfilename USING userfilepath</span><br><span class="line">          subdir</span><br><span class="line">          &lt;waguititle&gt;-obj_code</span><br><span class="line">          space</span><br><span class="line">          space</span><br><span class="line">          textfileextension</span><br><span class="line">          is_guititle</span><br><span class="line">          savetoserver</span><br><span class="line">          slashseparator</span><br><span class="line">          newfilenamewithpath</span><br><span class="line">          newfilenameonly</span><br><span class="line">          newsubdirectory</span><br><span class="line">          completesavepath.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">IF</span> savetoserver IS INITIAL.</span><br><span class="line">      PERFORM savefiletopc USING ilines[]</span><br><span class="line">            newfilenamewithpath</span><br><span class="line">            newfilenameonly</span><br><span class="line">            space</span><br><span class="line">            space</span><br><span class="line">            displayprogressmessage.</span><br><span class="line">    <span class="keyword">ELSE</span>.</span><br><span class="line">      PERFORM savefiletoserver USING ilines[]</span><br><span class="line">            newfilenamewithpath</span><br><span class="line">            newfilenameonly</span><br><span class="line">            completesavepath</span><br><span class="line">            displayprogressmessage</span><br><span class="line">            locserverfilesystem.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">CLEAR</span> ilines[].</span><br><span class="line">  ENDLOOP.</span><br><span class="line">ENDFORM.                                                                                             "downloadGUITitles</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  downloadPrograms..</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> downloadprograms USING ilocprogram LIKE iprograms[]</span><br><span class="line">      ilocfunctions LIKE ifunctions[]</span><br><span class="line">      ilocdictionaryfilename LIKE idictfilename[]</span><br><span class="line">      iloctabletypefilename LIKE itabletypefilename[]</span><br><span class="line">      VALUE(userfilepath)</span><br><span class="line">      VALUE(fileextension)</span><br><span class="line">      VALUE(htmlfileextension)</span><br><span class="line">      VALUE(textfileextension)</span><br><span class="line">      VALUE(converttohtml)</span><br><span class="line">      VALUE(customernamerange)</span><br><span class="line">      VALUE(getincludes)</span><br><span class="line">      VALUE(getdictstruct)</span><br><span class="line">      VALUE(downloaddocumentation)</span><br><span class="line">      VALUE(sorttablesasc)</span><br><span class="line">      VALUE(slashseparator)</span><br><span class="line">      VALUE(savetoserver)</span><br><span class="line">      VALUE(displayprogressmessage)</span><br><span class="line">      VALUE(locserverfilesystem)</span><br><span class="line">      VALUE(addbackground) <span class="keyword">TYPE</span> abap_bool.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  DATA: iprogfunctions <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF tfunction WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  FIELD-SYMBOLS: &lt;waprogram&gt; <span class="keyword">TYPE</span> tprogram.</span><br><span class="line">  FIELD-SYMBOLS: &lt;wainclude&gt; <span class="keyword">TYPE</span> tinclude.</span><br><span class="line">  DATA: iemptytextelements <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF ttexttable.</span><br><span class="line">  DATA: iemptyselectiontexts <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF ttexttable.</span><br><span class="line">  DATA: iemptymessages <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF tmessage.</span><br><span class="line">  DATA: iemptyguititles <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF tguititle.</span><br><span class="line">  DATA: locconverttohtml(1).</span><br><span class="line">  DATA: locfileextension <span class="keyword">TYPE</span> string.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">SORT</span> ilocprogram ASCENDING <span class="keyword">BY</span> progname.</span><br><span class="line"></span><br><span class="line">  LOOP AT ilocprogram ASSIGNING &lt;waprogram&gt;.</span><br><span class="line"><span class="comment">*   if the program to download is this program then always download as text otherwise you will get a rubbish file</span></span><br><span class="line">    <span class="keyword">IF</span> &lt;waprogram&gt;-progname = sy-cprog.</span><br><span class="line">      locconverttohtml = ''.</span><br><span class="line">      locfileextension = textextension.</span><br><span class="line">    <span class="keyword">ELSE</span>.</span><br><span class="line">      locconverttohtml = converttohtml.</span><br><span class="line">      locfileextension = fileextension.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Download the main program</span></span><br><span class="line">    PERFORM readincludeanddownload USING &lt;waprogram&gt;-itextelements[]</span><br><span class="line">          &lt;waprogram&gt;-iselectiontexts[]</span><br><span class="line">          &lt;waprogram&gt;-imessages[]</span><br><span class="line">          &lt;waprogram&gt;-iguititle[]</span><br><span class="line">          &lt;waprogram&gt;-progname</span><br><span class="line">          space</span><br><span class="line">          &lt;waprogram&gt;-programtitle</span><br><span class="line">          is_program</span><br><span class="line">          userfilepath</span><br><span class="line">          locfileextension</span><br><span class="line">          &lt;waprogram&gt;-progname</span><br><span class="line">          locconverttohtml</span><br><span class="line">          customernamerange</span><br><span class="line">          getincludes</span><br><span class="line">          getdictstruct</span><br><span class="line">          slashseparator</span><br><span class="line">          savetoserver</span><br><span class="line">          displayprogressmessage</span><br><span class="line">          locserverfilesystem</span><br><span class="line">          addbackground.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Download screens.</span></span><br><span class="line">    <span class="keyword">IF</span> NOT &lt;waprogram&gt;-iscreenflow[] IS INITIAL.</span><br><span class="line">      PERFORM downloadscreens USING &lt;waprogram&gt;-iscreenflow[]</span><br><span class="line">            &lt;waprogram&gt;-progname</span><br><span class="line">            userfilepath</span><br><span class="line">            textfileextension</span><br><span class="line">            &lt;waprogram&gt;-progname</span><br><span class="line">            slashseparator</span><br><span class="line">            savetoserver</span><br><span class="line">            displayprogressmessage</span><br><span class="line">            locserverfilesystem.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Download GUI titles</span></span><br><span class="line">    <span class="keyword">IF</span> NOT &lt;waprogram&gt;-iguititle[] IS INITIAL.</span><br><span class="line">      PERFORM downloadguititles USING &lt;waprogram&gt;-iguititle</span><br><span class="line">            userfilepath</span><br><span class="line">            textfileextension</span><br><span class="line">            &lt;waprogram&gt;-progname</span><br><span class="line">            slashseparator</span><br><span class="line">            savetoserver</span><br><span class="line">            displayprogressmessage</span><br><span class="line">            locserverfilesystem.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Download all other includes</span></span><br><span class="line">    LOOP AT &lt;waprogram&gt;-iincludes ASSIGNING &lt;wainclude&gt;.</span><br><span class="line">      PERFORM readincludeanddownload USING iemptytextelements[]</span><br><span class="line">            iemptyselectiontexts[]</span><br><span class="line">            iemptymessages[]</span><br><span class="line">            iemptyguititles[]</span><br><span class="line">            &lt;wainclude&gt;-includename</span><br><span class="line">            space</span><br><span class="line">            &lt;wainclude&gt;-includetitle</span><br><span class="line">            is_program</span><br><span class="line">            userfilepath</span><br><span class="line">            fileextension</span><br><span class="line">            &lt;waprogram&gt;-progname</span><br><span class="line">            converttohtml</span><br><span class="line">            customernamerange</span><br><span class="line">            getincludes</span><br><span class="line">            getdictstruct</span><br><span class="line">            slashseparator</span><br><span class="line">            savetoserver</span><br><span class="line">            displayprogressmessage</span><br><span class="line">            locserverfilesystem</span><br><span class="line">            addbackground.</span><br><span class="line"></span><br><span class="line">    ENDLOOP.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Download all dictionary structures</span></span><br><span class="line">    <span class="keyword">IF</span> NOT &lt;waprogram&gt;-idictstruct[] IS INITIAL.</span><br><span class="line">      PERFORM downloadddstructures USING &lt;waprogram&gt;-idictstruct[]</span><br><span class="line">            ilocdictionaryfilename[]</span><br><span class="line">            userfilepath</span><br><span class="line">            htmlfileextension</span><br><span class="line">            &lt;waprogram&gt;-progname</span><br><span class="line">            sorttablesasc</span><br><span class="line">            slashseparator</span><br><span class="line">            savetoserver</span><br><span class="line">            displayprogressmessage</span><br><span class="line">            locserverfilesystem</span><br><span class="line">            addbackground.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Download all Table Types</span></span><br><span class="line">    <span class="keyword">IF</span> NOT &lt;waprogram&gt;-itabletypes[] IS INITIAL.</span><br><span class="line">      PERFORM downloadddtabletypes USING &lt;waprogram&gt;-itabletypes[]</span><br><span class="line">            iloctabletypefilename[]</span><br><span class="line">            userfilepath</span><br><span class="line">            htmlfileextension</span><br><span class="line">            &lt;waprogram&gt;-progname</span><br><span class="line">            sorttablesasc</span><br><span class="line">            slashseparator</span><br><span class="line">            savetoserver</span><br><span class="line">            displayprogressmessage</span><br><span class="line">            locserverfilesystem</span><br><span class="line">            addbackground.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Download Transformations</span></span><br><span class="line">    <span class="keyword">IF</span> NOT &lt;waprogram&gt;-itransformations[] IS INITIAL.</span><br><span class="line">      PERFORM downloadxslt USING &lt;waprogram&gt;-itransformations[]</span><br><span class="line">            userfilepath</span><br><span class="line">            fileextension</span><br><span class="line">            htmlfileextension</span><br><span class="line">            textfileextension</span><br><span class="line">            converttohtml</span><br><span class="line">            customernamespace</span><br><span class="line">            slashseparatortouse</span><br><span class="line">            savetoserver</span><br><span class="line">            &lt;waprogram&gt;-progname</span><br><span class="line">            displayprogressmessage</span><br><span class="line">            serverfilesystem</span><br><span class="line">            addbackground.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Download any functions used by these programs</span></span><br><span class="line">    LOOP AT ilocfunctions INTO iprogfunctions WHERE programlinkname = &lt;waprogram&gt;-progname.</span><br><span class="line">      <span class="keyword">APPEND</span> iprogfunctions.</span><br><span class="line">    ENDLOOP.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">IF</span> NOT iprogfunctions[] IS INITIAL.</span><br><span class="line">      PERFORM downloadfunctions USING iprogfunctions[]</span><br><span class="line">            ilocdictionaryfilename[]</span><br><span class="line">            itabletypefilename[]</span><br><span class="line">            userfilepath</span><br><span class="line">            fileextension</span><br><span class="line">            &lt;waprogram&gt;-progname</span><br><span class="line">            downloaddocumentation</span><br><span class="line">            converttohtml</span><br><span class="line">            customernamerange</span><br><span class="line">            getincludes</span><br><span class="line">            getdictstruct</span><br><span class="line">            textfileextension</span><br><span class="line">            htmlfileextension</span><br><span class="line">            sorttablesasc</span><br><span class="line">            slashseparator</span><br><span class="line">            savetoserver</span><br><span class="line">            displayprogressmessage</span><br><span class="line">            locserverfilesystem</span><br><span class="line">            addbackground.</span><br><span class="line">      <span class="keyword">CLEAR</span> iprogfunctions[].</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDLOOP.</span><br><span class="line">ENDFORM.                                                                                              "downloadPrograms</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  downloadClasses..</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> downloadclasses USING ilocclasses LIKE iclasses[]</span><br><span class="line">      ilocfunctions LIKE ifunctions[]</span><br><span class="line">      ilocdictionaryfilename LIKE idictfilename[]</span><br><span class="line">      iloctabletypefilename LIKE itabletypefilename[]</span><br><span class="line">      VALUE(userfilepath)</span><br><span class="line">      VALUE(fileextension)</span><br><span class="line">      VALUE(htmlfileextension)</span><br><span class="line">      VALUE(textfileextension)</span><br><span class="line">      VALUE(converttohtml)</span><br><span class="line">      VALUE(customernamerange)</span><br><span class="line">      VALUE(getincludes)</span><br><span class="line">      VALUE(getdictstruct)</span><br><span class="line">      VALUE(downloaddocumentation)</span><br><span class="line">      VALUE(sorttablesasc)</span><br><span class="line">      VALUE(slashseparator)</span><br><span class="line">      VALUE(savetoserver)</span><br><span class="line">      VALUE(displayprogressmessage)</span><br><span class="line">      VALUE(locserverfilesystem)</span><br><span class="line">      VALUE(addbackground) <span class="keyword">TYPE</span> abap_bool.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  DATA: iclassfunctions <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF tfunction WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  FIELD-SYMBOLS: &lt;waclass&gt; <span class="keyword">TYPE</span> tclass.</span><br><span class="line">  FIELD-SYMBOLS: &lt;wamethod&gt; <span class="keyword">TYPE</span> tmethod.</span><br><span class="line">  DATA: additionalsubdirectory <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: classdocumentationexists <span class="keyword">TYPE</span> abap_bool VALUE false.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">SORT</span> ilocclasses ASCENDING <span class="keyword">BY</span> clsname.</span><br><span class="line"></span><br><span class="line">  LOOP AT ilocclasses ASSIGNING &lt;waclass&gt;.</span><br><span class="line"><span class="comment">*   Download the class</span></span><br><span class="line">    PERFORM readclassanddownload USING &lt;waclass&gt;</span><br><span class="line">          &lt;waclass&gt;-clsname</span><br><span class="line">          space</span><br><span class="line">          is_class</span><br><span class="line">          userfilepath</span><br><span class="line">          fileextension</span><br><span class="line">          space</span><br><span class="line">          converttohtml</span><br><span class="line">          customernamerange</span><br><span class="line">          getincludes</span><br><span class="line">          getdictstruct</span><br><span class="line">          slashseparator</span><br><span class="line">          savetoserver</span><br><span class="line">          displayprogressmessage</span><br><span class="line">          locserverfilesystem</span><br><span class="line">          addbackground.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*   Download all of the methods</span></span><br><span class="line">    LOOP AT &lt;waclass&gt;-imethods ASSIGNING &lt;wamethod&gt;.</span><br><span class="line">      additionalsubdirectory = &lt;waclass&gt;-clsname.</span><br><span class="line">      PERFORM readmethodanddownload USING &lt;wamethod&gt;</span><br><span class="line">            &lt;wamethod&gt;-cmpname</span><br><span class="line">            &lt;wamethod&gt;-methodkey</span><br><span class="line">            space</span><br><span class="line">            is_method</span><br><span class="line">            userfilepath</span><br><span class="line">            fileextension</span><br><span class="line">            additionalsubdirectory</span><br><span class="line">            converttohtml</span><br><span class="line">            customernamerange</span><br><span class="line">            getincludes</span><br><span class="line">            getdictstruct</span><br><span class="line">            slashseparator</span><br><span class="line">            savetoserver</span><br><span class="line">            displayprogressmessage</span><br><span class="line">            locserverfilesystem</span><br><span class="line">            addbackground.</span><br><span class="line"></span><br><span class="line">    ENDLOOP.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Download all dictionary structures</span></span><br><span class="line">    <span class="keyword">IF</span> NOT &lt;waclass&gt;-idictstruct[] IS INITIAL.</span><br><span class="line">      PERFORM downloadddstructures USING &lt;waclass&gt;-idictstruct[]</span><br><span class="line">            ilocdictionaryfilename[]</span><br><span class="line">            userfilepath</span><br><span class="line">            htmlfileextension</span><br><span class="line">            &lt;waclass&gt;-clsname</span><br><span class="line">            sorttablesasc</span><br><span class="line">            slashseparator</span><br><span class="line">            savetoserver</span><br><span class="line">            displayprogressmessage</span><br><span class="line">            locserverfilesystem</span><br><span class="line">            addbackground.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Download all Table Types</span></span><br><span class="line">    <span class="keyword">IF</span> NOT &lt;waclass&gt;-itabletypes[] IS INITIAL.</span><br><span class="line">      PERFORM downloadddtabletypes USING &lt;waclass&gt;-itabletypes[]</span><br><span class="line">            iloctabletypefilename[]</span><br><span class="line">            userfilepath</span><br><span class="line">            htmlfileextension</span><br><span class="line">            &lt;waclass&gt;-clsname</span><br><span class="line">            sorttablesasc</span><br><span class="line">            slashseparator</span><br><span class="line">            savetoserver</span><br><span class="line">            displayprogressmessage</span><br><span class="line">            locserverfilesystem</span><br><span class="line">            addbackground.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Download Transformations</span></span><br><span class="line">    <span class="keyword">IF</span> NOT &lt;waclass&gt;-itransformations[] IS INITIAL.</span><br><span class="line">      PERFORM downloadxslt USING &lt;waclass&gt;-itransformations[]</span><br><span class="line">            userfilepath</span><br><span class="line">            fileextension</span><br><span class="line">            htmlfileextension</span><br><span class="line">            textfileextension</span><br><span class="line">            converttohtml</span><br><span class="line">            customernamespace</span><br><span class="line">            slashseparatortouse</span><br><span class="line">            savetoserver</span><br><span class="line">            &lt;waclass&gt;-clsname</span><br><span class="line">            displayprogressmessage</span><br><span class="line">            serverfilesystem</span><br><span class="line">            addbackground.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Download any functions used by these programs</span></span><br><span class="line">    LOOP AT ilocfunctions INTO iclassfunctions WHERE programlinkname = &lt;waclass&gt;-clsname.</span><br><span class="line">      <span class="keyword">APPEND</span> iclassfunctions.</span><br><span class="line">    ENDLOOP.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">IF</span> NOT iclassfunctions[] IS INITIAL.</span><br><span class="line">      PERFORM downloadfunctions USING iclassfunctions[]</span><br><span class="line">            ilocdictionaryfilename[]</span><br><span class="line">            iloctabletypefilename[]</span><br><span class="line">            userfilepath</span><br><span class="line">            fileextension</span><br><span class="line">            &lt;waclass&gt;-clsname</span><br><span class="line">            downloaddocumentation</span><br><span class="line">            converttohtml</span><br><span class="line">            customernamerange</span><br><span class="line">            getincludes</span><br><span class="line">            getdictstruct</span><br><span class="line">            textfileextension</span><br><span class="line">            htmlfileextension</span><br><span class="line">            sorttablesasc</span><br><span class="line">            slashseparator</span><br><span class="line">            savetoserver</span><br><span class="line">            displayprogressmessage</span><br><span class="line">            locserverfilesystem</span><br><span class="line">            addbackground.</span><br><span class="line">      <span class="keyword">CLEAR</span> iclassfunctions[].</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">IF</span> downloaddocumentation = true.</span><br><span class="line">      PERFORM downloadclassdocs USING &lt;waclass&gt;-clsname</span><br><span class="line">            userfilepath</span><br><span class="line">            fileextension</span><br><span class="line">            converttohtml</span><br><span class="line">            slashseparator</span><br><span class="line">            savetoserver</span><br><span class="line">            displayprogressmessage</span><br><span class="line">            '' "subdirectory</span><br><span class="line">            classdocumentationexists</span><br><span class="line">            locserverfilesystem</span><br><span class="line">            addbackground.</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDLOOP.</span><br><span class="line">ENDFORM.                                                                                               "downloadClasses</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*   downloadXslt...</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> downloadxslt USING iloctransformation LIKE itransformations[]</span><br><span class="line">      VALUE(userfilepath)</span><br><span class="line">      VALUE(fileextension)</span><br><span class="line">      VALUE(htmlfileextension)</span><br><span class="line">      VALUE(textfileextension)</span><br><span class="line">      VALUE(converttohtml)</span><br><span class="line">      VALUE(customernamerange)</span><br><span class="line">      VALUE(slashseparator)</span><br><span class="line">      VALUE(savetoserver)</span><br><span class="line">      VALUE(subdir)</span><br><span class="line">      VALUE(displayprogressmessage)</span><br><span class="line">      VALUE(locserverfilesystem)</span><br><span class="line">      VALUE(addbackground) <span class="keyword">TYPE</span> abap_bool.</span><br><span class="line"></span><br><span class="line">  FIELD-SYMBOLS: &lt;watransformation&gt; <span class="keyword">TYPE</span> ttransformation.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">SORT</span> iloctransformation ASCENDING.</span><br><span class="line"></span><br><span class="line">  LOOP AT iloctransformation ASSIGNING &lt;watransformation&gt;.</span><br><span class="line"><span class="comment">*   Download the main program</span></span><br><span class="line">    PERFORM readxsltanddownload USING &lt;watransformation&gt;-xsltname</span><br><span class="line">          &lt;watransformation&gt;-xsltdesc</span><br><span class="line">          userfilepath</span><br><span class="line">          fileextension</span><br><span class="line">          converttohtml</span><br><span class="line">          customernamerange</span><br><span class="line">          slashseparator</span><br><span class="line">          savetoserver</span><br><span class="line">          subdir</span><br><span class="line">          displayprogressmessage</span><br><span class="line">          locserverfilesystem</span><br><span class="line">          addbackground.</span><br><span class="line">  ENDLOOP.</span><br><span class="line">ENDFORM.                                                                                              "downloadXSLT</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  reFormatClassCode...   Expand a classes public, private and protected section from the 72 characters that the class</span></span><br><span class="line"><span class="comment">*                         builder sets it to back to the wide editor mode</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> reformatclasscode USING itemplines LIKE dumihtml[].</span><br><span class="line"></span><br><span class="line">  FIELD-SYMBOLS: &lt;waline&gt; <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: newline <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: inewtable <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF string.</span><br><span class="line">  DATA: foundone <span class="keyword">TYPE</span> abap_bool VALUE false.</span><br><span class="line"></span><br><span class="line">  LOOP AT itemplines ASSIGNING &lt;waline&gt;.</span><br><span class="line">    <span class="keyword">IF</span> NOT &lt;waline&gt; IS INITIAL.</span><br><span class="line">      <span class="keyword">IF</span> foundone = false.</span><br><span class="line">        FIND 'data' <span class="keyword">IN</span> &lt;waline&gt; RESPECTING CASE.</span><br><span class="line">        <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line">          foundone = true.</span><br><span class="line">        ENDIF.</span><br><span class="line"></span><br><span class="line">        FIND 'constants' <span class="keyword">IN</span> &lt;waline&gt; RESPECTING CASE.</span><br><span class="line">        <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line">          foundone = true.</span><br><span class="line">        ENDIF.</span><br><span class="line"></span><br><span class="line">        <span class="keyword">IF</span> foundone = true.</span><br><span class="line">          newline = &lt;waline&gt;.</span><br><span class="line"></span><br><span class="line">          <span class="keyword">IF</span> ( newline <span class="keyword">CS</span> '.' OR newline <span class="keyword">CS</span> '*' ).</span><br><span class="line">            <span class="keyword">REPLACE</span> '!' <span class="keyword">IN</span> &lt;waline&gt; WITH ''.</span><br><span class="line">            <span class="keyword">APPEND</span> newline TO inewtable.</span><br><span class="line">            <span class="keyword">CLEAR</span> newline.</span><br><span class="line">            foundone = false.</span><br><span class="line">          ENDIF.</span><br><span class="line">        <span class="keyword">ELSE</span>.</span><br><span class="line">          <span class="keyword">REPLACE</span> '!' <span class="keyword">IN</span> &lt;waline&gt; WITH ''.</span><br><span class="line">          <span class="keyword">APPEND</span> &lt;waline&gt; TO inewtable.</span><br><span class="line">        ENDIF.</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line">        CONCATENATE newline &lt;waline&gt; INTO newline SEPARATED <span class="keyword">BY</span> space.</span><br><span class="line">        <span class="keyword">IF</span> ( newline <span class="keyword">CS</span> '.' OR newline <span class="keyword">CS</span> '*' ).</span><br><span class="line">          <span class="keyword">APPEND</span> newline TO inewtable.</span><br><span class="line">          <span class="keyword">CLEAR</span> newline.</span><br><span class="line">          foundone = false.</span><br><span class="line">        ENDIF.</span><br><span class="line">      ENDIF.</span><br><span class="line">    <span class="keyword">ELSE</span>.</span><br><span class="line">      <span class="keyword">REPLACE</span> '!' <span class="keyword">IN</span> &lt;waline&gt; WITH ''.</span><br><span class="line">      <span class="keyword">APPEND</span> &lt;waline&gt; TO inewtable[].</span><br><span class="line">    ENDIF.</span><br><span class="line">  ENDLOOP.</span><br><span class="line"></span><br><span class="line">  itemplines[] = inewtable[].</span><br><span class="line">ENDFORM.                                                                             "reFormatClassCode</span><br><span class="line"></span><br><span class="line"><span class="comment">***********************************************************************************************************************</span></span><br><span class="line"><span class="comment">**********************************************HTML ROUTINES************************************************************</span></span><br><span class="line"><span class="comment">***********************************************************************************************************************</span></span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  convertDDToHTML...   Convert text description to HTML</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> convertddtohtml USING ilocdictstructure LIKE dumidictstructure[]</span><br><span class="line">      ilochtml LIKE dumihtml[]</span><br><span class="line">      VALUE(tablename)</span><br><span class="line">      VALUE(tabletitle)</span><br><span class="line">      VALUE(sorttablesasc)</span><br><span class="line">      VALUE(addbackground) <span class="keyword">TYPE</span> abap_bool..</span><br><span class="line"></span><br><span class="line">  DATA: icolumncaptions <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF string WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: wadictionary <span class="keyword">TYPE</span> tdicttablestructure.</span><br><span class="line">  DATA: wahtml <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: title <span class="keyword">TYPE</span> string.</span><br><span class="line">  FIELD-SYMBOLS: &lt;ilocdictstructure&gt; <span class="keyword">TYPE</span> tdicttablestructure.</span><br><span class="line"><span class="comment">* Holds one cell from the internal table</span></span><br><span class="line">  FIELD-SYMBOLS: &lt;fsfield&gt;.</span><br><span class="line"><span class="comment">* The value of one cell form the internal table</span></span><br><span class="line">  DATA: wtextcell <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: rowcounter(3).</span><br><span class="line"><span class="comment">* The base type of the field we are reading</span></span><br><span class="line">  DATA: wfieldbasetype.</span><br><span class="line"></span><br><span class="line">  PERFORM buildddcolumnheaders USING icolumncaptions[].</span><br><span class="line"></span><br><span class="line"><span class="comment">* Add a html header to the table</span></span><br><span class="line">  CONCATENATE 'Dictionary object-' tablename INTO title SEPARATED <span class="keyword">BY</span> space.</span><br><span class="line">  PERFORM addhtmlheader USING ilochtml[]</span><br><span class="line">        title</span><br><span class="line">        addbackground</span><br><span class="line">        ss_table.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">APPEND</span> `&lt;body&gt;` TO ilochtml.</span><br><span class="line">  <span class="keyword">APPEND</span> `  &lt;<span class="keyword">table</span> <span class="keyword">class</span>=<span class="string">"outerTable"</span>&gt;` TO ilochtml.</span><br><span class="line">  <span class="keyword">APPEND</span> `    &lt;tr&gt;` TO ilochtml.</span><br><span class="line">  CONCATENATE `      &lt;td&gt;&lt;h2&gt;<span class="keyword">Table</span>: ` tablename '&lt;/h2&gt;' INTO wahtml.</span><br><span class="line">  <span class="keyword">APPEND</span> wahtml TO ilochtml.</span><br><span class="line">  CONCATENATE `  &lt;h3&gt;Description: ` tabletitle '&lt;/h3&gt;&lt;/td&gt;' INTO wahtml.</span><br><span class="line">  <span class="keyword">APPEND</span> wahtml TO ilochtml.</span><br><span class="line">  <span class="keyword">APPEND</span> `    &lt;/tr&gt;` TO ilochtml.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">APPEND</span> `    &lt;tr&gt;` TO ilochtml.</span><br><span class="line">  <span class="keyword">APPEND</span> `      &lt;td&gt;&lt;!--This is where our main <span class="keyword">table</span> begins  --&gt;` TO ilochtml.</span><br><span class="line">  <span class="keyword">APPEND</span> `&lt;<span class="keyword">table</span> <span class="keyword">class</span>=<span class="string">"innerTable"</span>&gt;` TO ilochtml.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Do we need to sort the fields into alphabetical order</span></span><br><span class="line">  <span class="keyword">IF</span> NOT sorttablesasc IS INITIAL.</span><br><span class="line">    <span class="keyword">SORT</span> ilocdictstructure ASCENDING <span class="keyword">BY</span> fieldname.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">* This is where the header fields are defined</span></span><br><span class="line">  <span class="keyword">APPEND</span> `&lt;tr&gt;` TO ilochtml.</span><br><span class="line">  LOOP AT icolumncaptions.</span><br><span class="line">    CONCATENATE `  &lt;th&gt;` icolumncaptions `&lt;/th&gt;` INTO wahtml.</span><br><span class="line">    <span class="keyword">APPEND</span> wahtml TO ilochtml.</span><br><span class="line">  ENDLOOP.</span><br><span class="line">  <span class="keyword">APPEND</span> `&lt;/tr&gt;` TO ilochtml.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Add the table cells here</span></span><br><span class="line">  LOOP AT ilocdictstructure ASSIGNING &lt;ilocdictstructure&gt;.</span><br><span class="line">    <span class="keyword">APPEND</span> `&lt;tr <span class="keyword">class</span>=<span class="string">"cell"</span>&gt;` TO ilochtml.</span><br><span class="line">    rowcounter = rowcounter + 1.</span><br><span class="line">    CONCATENATE `  &lt;td&gt;` rowcounter `&lt;/td&gt;` INTO wahtml.</span><br><span class="line">    <span class="keyword">APPEND</span> wahtml TO ilochtml.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">DO</span>.</span><br><span class="line"><span class="comment">*     Assign each field in the table to the field symbol</span></span><br><span class="line">      ASSIGN COMPONENT sy-index OF STRUCTURE &lt;ilocdictstructure&gt; TO &lt;fsfield&gt;.</span><br><span class="line">      <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line">        <span class="keyword">DESCRIBE</span> FIELD &lt;fsfield&gt; <span class="keyword">TYPE</span> wfieldbasetype.</span><br><span class="line">        <span class="keyword">IF</span> wfieldbasetype &lt;&gt; '<span class="keyword">h</span>'.</span><br><span class="line">          <span class="keyword">MOVE</span> &lt;fsfield&gt; TO wtextcell.</span><br><span class="line">          wahtml = `  &lt;td&gt;`.</span><br><span class="line"></span><br><span class="line"><span class="comment">*         Add the caption name</span></span><br><span class="line">          <span class="keyword">IF</span> wtextcell IS INITIAL.</span><br><span class="line">            CONCATENATE wahtml '&amp;nbsp;' '&lt;/td&gt;' INTO wahtml.</span><br><span class="line">          <span class="keyword">ELSE</span>.</span><br><span class="line">            CONCATENATE wahtml wtextcell '&lt;/td&gt;' INTO wahtml.</span><br><span class="line">          ENDIF.</span><br><span class="line"></span><br><span class="line">          <span class="keyword">APPEND</span> wahtml TO ilochtml.</span><br><span class="line">          <span class="keyword">CLEAR</span> wahtml.</span><br><span class="line">        ENDIF.</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line">        <span class="keyword">EXIT</span>.</span><br><span class="line">      ENDIF.</span><br><span class="line">    ENDDO.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">APPEND</span> `&lt;/tr&gt;` TO ilochtml.</span><br><span class="line">  ENDLOOP.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">APPEND</span> `      &lt;/<span class="keyword">table</span>&gt;` TO ilochtml.</span><br><span class="line">  <span class="keyword">APPEND</span> `     &lt;/td&gt;` TO ilochtml.</span><br><span class="line">  <span class="keyword">APPEND</span> `   &lt;/tr&gt;` TO ilochtml.</span><br><span class="line">  <span class="keyword">APPEND</span> '&lt;<span class="keyword">br</span>/&gt;' TO ilochtml.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Add in any domain entries</span></span><br><span class="line">  PERFORM adddomaintohtml USING ilocdictstructure[]</span><br><span class="line">        ilochtml[].</span><br><span class="line"></span><br><span class="line"><span class="comment">* Add a html footer to the table</span></span><br><span class="line">  PERFORM addhtmlfooter USING ilochtml[].</span><br><span class="line">ENDFORM.                                                                                               "convertDDToHTML</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  addDomaintoHTML...   Add domain vlaues into the HTML</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> adddomaintohtml USING ilocdictstructure LIKE dumidictstructure[]</span><br><span class="line">      ilochtml LIKE dumihtml[].</span><br><span class="line"></span><br><span class="line">  DATA: icolumncaptions <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF string WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: wadictionary <span class="keyword">TYPE</span> tdicttablestructure.</span><br><span class="line">  DATA: wahtml <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: title <span class="keyword">TYPE</span> string.</span><br><span class="line">  FIELD-SYMBOLS: &lt;ilocdictstructure&gt; <span class="keyword">TYPE</span> tdicttablestructure.</span><br><span class="line">  DATA: idomstructure <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF tdomainstructure WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line"><span class="comment">* Holds one cell from the internal table</span></span><br><span class="line">  FIELD-SYMBOLS: &lt;fsfield&gt;.</span><br><span class="line"><span class="comment">* The value of one cell form the internal table</span></span><br><span class="line">  DATA: wtextcell <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: rowcounter(3).</span><br><span class="line"><span class="comment">* The base type of the field we are reading</span></span><br><span class="line">  DATA: wfieldbasetype.</span><br><span class="line">  DATA: addedheader <span class="keyword">TYPE</span> flag VALUE ''.</span><br><span class="line"></span><br><span class="line">  PERFORM builddomcolumnheaders USING icolumncaptions[].</span><br><span class="line"></span><br><span class="line"><span class="comment">* Add the table cells here</span></span><br><span class="line">  LOOP AT ilocdictstructure ASSIGNING &lt;ilocdictstructure&gt;.</span><br><span class="line">    LOOP AT &lt;ilocdictstructure&gt;-idomains INTO idomstructure.</span><br><span class="line"><span class="comment">*     OK, lets add the header since we know we have some domain texrt to add.</span></span><br><span class="line">      <span class="keyword">IF</span> addedheader = ''.</span><br><span class="line">        <span class="keyword">APPEND</span> `  &lt;<span class="keyword">table</span> <span class="keyword">class</span>=<span class="string">"outerTable"</span>&gt;` TO ilochtml.</span><br><span class="line">        <span class="keyword">APPEND</span> `    &lt;tr&gt;` TO ilochtml.</span><br><span class="line">        CONCATENATE `      &lt;td&gt;&lt;h2&gt;Fixed Domain Values ` '&lt;/h2&gt;' INTO wahtml.</span><br><span class="line">        <span class="keyword">APPEND</span> wahtml TO ilochtml.</span><br><span class="line">        <span class="keyword">APPEND</span> `    &lt;/tr&gt;` TO ilochtml.</span><br><span class="line"></span><br><span class="line">        <span class="keyword">APPEND</span> `    &lt;tr&gt;` TO ilochtml.</span><br><span class="line">        <span class="keyword">APPEND</span> `      &lt;td&gt;&lt;!--This is where our main <span class="keyword">table</span> begins  --&gt;` TO ilochtml.</span><br><span class="line">        <span class="keyword">APPEND</span> `&lt;<span class="keyword">table</span> <span class="keyword">class</span>=<span class="string">"innerTable"</span>&gt;` TO ilochtml.</span><br><span class="line"></span><br><span class="line"><span class="comment">*       This is where the header fields are defined</span></span><br><span class="line">        <span class="keyword">APPEND</span> `&lt;tr&gt;` TO ilochtml.</span><br><span class="line">        LOOP AT icolumncaptions.</span><br><span class="line">          CONCATENATE `  &lt;th&gt;` icolumncaptions `&lt;/th&gt;` INTO wahtml.</span><br><span class="line">          <span class="keyword">APPEND</span> wahtml TO ilochtml.</span><br><span class="line">        ENDLOOP.</span><br><span class="line">        <span class="keyword">APPEND</span> `&lt;/tr&gt;` TO ilochtml.</span><br><span class="line">        addedheader = 'X'.</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">APPEND</span> `&lt;tr <span class="keyword">class</span>=<span class="string">"cell"</span>&gt;` TO ilochtml.</span><br><span class="line">      <span class="keyword">DO</span>.</span><br><span class="line"><span class="comment">*       Assign each field in the table to the field symbol</span></span><br><span class="line">        ASSIGN COMPONENT sy-index OF STRUCTURE idomstructure TO &lt;fsfield&gt;.</span><br><span class="line">        <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line">          <span class="keyword">DESCRIBE</span> FIELD &lt;fsfield&gt; <span class="keyword">TYPE</span> wfieldbasetype.</span><br><span class="line">          <span class="keyword">IF</span> wfieldbasetype &lt;&gt; '<span class="keyword">h</span>'.</span><br><span class="line">            <span class="keyword">MOVE</span> &lt;fsfield&gt; TO wtextcell.</span><br><span class="line">            wahtml = `  &lt;td&gt;`.</span><br><span class="line"></span><br><span class="line"><span class="comment">*           Add the caption name</span></span><br><span class="line">            <span class="keyword">IF</span> wtextcell IS INITIAL.</span><br><span class="line">              CONCATENATE wahtml '&amp;nbsp;' '&lt;/td&gt;' INTO wahtml.</span><br><span class="line">            <span class="keyword">ELSE</span>.</span><br><span class="line">              CONCATENATE wahtml wtextcell '&lt;/td&gt;' INTO wahtml.</span><br><span class="line">            ENDIF.</span><br><span class="line"></span><br><span class="line">            <span class="keyword">APPEND</span> wahtml TO ilochtml.</span><br><span class="line">            <span class="keyword">CLEAR</span> wahtml.</span><br><span class="line">          ENDIF.</span><br><span class="line">        <span class="keyword">ELSE</span>.</span><br><span class="line">          <span class="keyword">EXIT</span>.</span><br><span class="line">        ENDIF.</span><br><span class="line">      ENDDO.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">APPEND</span> `&lt;/tr&gt;` TO ilochtml.</span><br><span class="line">    ENDLOOP.</span><br><span class="line">  ENDLOOP.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> addedheader = 'X'.</span><br><span class="line">    <span class="keyword">APPEND</span> `      &lt;/<span class="keyword">table</span>&gt;` TO ilochtml.</span><br><span class="line">    <span class="keyword">APPEND</span> `     &lt;/td&gt;` TO ilochtml.</span><br><span class="line">    <span class="keyword">APPEND</span> `   &lt;/tr&gt;` TO ilochtml.</span><br><span class="line">  ENDIF.</span><br><span class="line">ENDFORM.</span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  convertTableTypeToHtml</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> converttabletypetohtml USING iloctabletypes LIKE itabletypes[]</span><br><span class="line">      ilochtml LIKE dumihtml[]</span><br><span class="line">      VALUE(tablename)</span><br><span class="line">      VALUE(tabletitle)</span><br><span class="line">      VALUE(sorttablesasc)</span><br><span class="line">      VALUE(addbackground) <span class="keyword">TYPE</span> abap_bool.</span><br><span class="line"></span><br><span class="line">  DATA: icolumncaptions <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF string WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: wadictionary <span class="keyword">TYPE</span> tdicttablestructure.</span><br><span class="line">  DATA: wahtml <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: title <span class="keyword">TYPE</span> string.</span><br><span class="line">  FIELD-SYMBOLS: &lt;iloctabletype&gt; LIKE <span class="keyword">LINE</span> OF iloctabletypes.</span><br><span class="line"><span class="comment">* Holds one cell from the internal table</span></span><br><span class="line">  FIELD-SYMBOLS: &lt;fsfield&gt;.</span><br><span class="line"><span class="comment">* The value of one cell form the internal table</span></span><br><span class="line">  DATA: wtextcell <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: rowcounter(3).</span><br><span class="line"></span><br><span class="line">  PERFORM buildcolumnheaderstabletypes USING icolumncaptions[].</span><br><span class="line"></span><br><span class="line"><span class="comment">* Add a html header to the table</span></span><br><span class="line">  CONCATENATE 'Dictionary object (<span class="keyword">Table</span> <span class="keyword">Type</span>)-' tablename INTO title SEPARATED <span class="keyword">BY</span> space.</span><br><span class="line">  PERFORM addhtmlheader USING ilochtml[]</span><br><span class="line">        title</span><br><span class="line">        addbackground</span><br><span class="line">        ss_table.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">APPEND</span> '&lt;body&gt;' TO ilochtml.</span><br><span class="line">  <span class="keyword">APPEND</span> '  &lt;<span class="keyword">table</span> <span class="keyword">class</span>=<span class="string">"outerTable"</span>&gt;' TO ilochtml.</span><br><span class="line">  <span class="keyword">APPEND</span> '    &lt;tr&gt;' TO ilochtml.</span><br><span class="line">  CONCATENATE '      &lt;td&gt;&lt;h2&gt;<span class="keyword">Table</span>: ' tablename '&lt;/h2&gt;' INTO wahtml.</span><br><span class="line">  <span class="keyword">APPEND</span> wahtml TO ilochtml.</span><br><span class="line">  CONCATENATE '  &lt;h3&gt;Description: ' tabletitle '&lt;/h3&gt;&lt;/td&gt;' INTO wahtml.</span><br><span class="line">  <span class="keyword">APPEND</span> wahtml TO ilochtml.</span><br><span class="line">  <span class="keyword">APPEND</span> '    &lt;/tr&gt;' TO ilochtml.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">APPEND</span> '    &lt;tr&gt;' TO ilochtml.</span><br><span class="line">  <span class="keyword">APPEND</span> '      &lt;td&gt;&lt;!--This is where our main <span class="keyword">table</span> begins  --&gt;' TO ilochtml.</span><br><span class="line">  <span class="keyword">APPEND</span> '&lt;<span class="keyword">table</span> <span class="keyword">class</span>=<span class="string">"innerTable"</span>&gt;' TO ilochtml.</span><br><span class="line"></span><br><span class="line"><span class="comment">* This is where the header fields are defined</span></span><br><span class="line">  <span class="keyword">APPEND</span> '&lt;tr&gt;' TO ilochtml.</span><br><span class="line">  LOOP AT icolumncaptions.</span><br><span class="line">    CONCATENATE '  &lt;th&gt;' icolumncaptions '&lt;/th&gt;' INTO wahtml.</span><br><span class="line">    <span class="keyword">APPEND</span> wahtml TO ilochtml.</span><br><span class="line">  ENDLOOP.</span><br><span class="line">  <span class="keyword">APPEND</span> '&lt;/tr&gt;' TO ilochtml.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Add the table cells here</span></span><br><span class="line">  LOOP AT iloctabletypes ASSIGNING &lt;iloctabletype&gt;.</span><br><span class="line">    <span class="keyword">APPEND</span> '&lt;tr <span class="keyword">class</span>=<span class="string">"cell"</span>&gt;' TO ilochtml.</span><br><span class="line">    rowcounter = rowcounter + 1.</span><br><span class="line">    CONCATENATE '  &lt;td&gt;' rowcounter '&lt;/td&gt;' INTO wahtml.</span><br><span class="line">    <span class="keyword">APPEND</span> wahtml TO ilochtml.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">DO</span>.</span><br><span class="line"><span class="comment">*     Assign each field in the table to the field symbol</span></span><br><span class="line">      ASSIGN COMPONENT sy-index OF STRUCTURE &lt;iloctabletype&gt; TO &lt;fsfield&gt;.</span><br><span class="line">      <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line">        <span class="keyword">MOVE</span> &lt;fsfield&gt; TO wtextcell.</span><br><span class="line">        wahtml = '  &lt;td&gt;'.</span><br><span class="line"></span><br><span class="line"><span class="comment">*       Add the caption name</span></span><br><span class="line">        <span class="keyword">IF</span> wtextcell IS INITIAL.</span><br><span class="line">          CONCATENATE wahtml '&amp;nbsp;' '&lt;/td&gt;' INTO wahtml.</span><br><span class="line">        <span class="keyword">ELSE</span>.</span><br><span class="line">          CONCATENATE wahtml wtextcell '&lt;/td&gt;' INTO wahtml.</span><br><span class="line">        ENDIF.</span><br><span class="line"></span><br><span class="line">        <span class="keyword">APPEND</span> wahtml TO ilochtml.</span><br><span class="line">        <span class="keyword">CLEAR</span> wahtml.</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line">        <span class="keyword">EXIT</span>.</span><br><span class="line">      ENDIF.</span><br><span class="line">    ENDDO.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">APPEND</span> '&lt;/tr&gt;' TO ilochtml.</span><br><span class="line">  ENDLOOP.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">APPEND</span> '      &lt;/<span class="keyword">table</span>&gt;' TO ilochtml.</span><br><span class="line">  <span class="keyword">APPEND</span> '     &lt;/td&gt;' TO ilochtml.</span><br><span class="line">  <span class="keyword">APPEND</span> '   &lt;/tr&gt;' TO ilochtml.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Add a html footer to the table</span></span><br><span class="line">  PERFORM addhtmlfooter USING ilochtml[].</span><br><span class="line">ENDFORM.                                                                                  "convertTableTypeToHTML</span><br><span class="line">"convertITABtoHtml</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  convertCodeToHtml... Builds an HTML table based upon a text table.</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> convertcodetohtml USING icontents LIKE dumihtml[]</span><br><span class="line">      VALUE(programname)</span><br><span class="line">      VALUE(shortdescription)</span><br><span class="line">      VALUE(sourcecodetype)</span><br><span class="line">      VALUE(functiondocumentationexists)</span><br><span class="line">      VALUE(ismainfunctioninclude)</span><br><span class="line">      VALUE(htmlextension)</span><br><span class="line">      VALUE(customernamerange)</span><br><span class="line">      VALUE(getincludes)</span><br><span class="line">      VALUE(getdictstructures)</span><br><span class="line">      VALUE(addbackground) <span class="keyword">TYPE</span> abap_bool.</span><br><span class="line"></span><br><span class="line">  DATA: htmltable <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF string WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: head(255).</span><br><span class="line">  DATA: tail(255).</span><br><span class="line">  DATA: mytabix <span class="keyword">TYPE</span> sytabix.</span><br><span class="line">  DATA: nextline <span class="keyword">TYPE</span> sytabix.</span><br><span class="line">  DATA: hyperlinkname <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: copyofcurrentline <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: currentlinelength <span class="keyword">TYPE</span> i VALUE 0.</span><br><span class="line">  DATA: copylinelength <span class="keyword">TYPE</span> i VALUE 0.</span><br><span class="line">  DATA: ignorefuturelines <span class="keyword">TYPE</span> abap_bool VALUE false.</span><br><span class="line">  DATA: foundasterix <span class="keyword">TYPE</span> abap_bool VALUE false.</span><br><span class="line">  DATA: lowercaselink <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: wanextline <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: wacontent <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: incommentmode <span class="keyword">TYPE</span> abap_bool VALUE 'X'.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Add a html header to the table</span></span><br><span class="line">  PERFORM addhtmlheader USING htmltable[]</span><br><span class="line">        programname</span><br><span class="line">        addbackground</span><br><span class="line">        ss_code.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">APPEND</span> '&lt;body&gt;' TO htmltable.</span><br><span class="line"><span class="comment">* Prgroamname and description</span></span><br><span class="line">  <span class="keyword">APPEND</span> '&lt;<span class="keyword">table</span> <span class="keyword">class</span>=<span class="string">"outerTable"</span>&gt;' TO htmltable.</span><br><span class="line">  <span class="keyword">APPEND</span> `  &lt;tr <span class="keyword">class</span>=<span class="string">"normalBoldLarge"</span>&gt;` TO htmltable.</span><br><span class="line"></span><br><span class="line">  CONCATENATE `     &lt;td&gt;&lt;h2&gt;Code listing <span class="keyword">for</span>: ` programname `&lt;/h2&gt;` INTO htmltable.</span><br><span class="line">  <span class="keyword">APPEND</span> htmltable.</span><br><span class="line"></span><br><span class="line">  CONCATENATE `&lt;h3&gt; Description: ` shortdescription `&lt;/h3&gt;&lt;/td&gt;` INTO htmltable.</span><br><span class="line">  <span class="keyword">APPEND</span> htmltable.</span><br><span class="line">  <span class="keyword">APPEND</span> `   &lt;/tr&gt;` TO htmltable.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Code</span></span><br><span class="line">  <span class="keyword">APPEND</span> `  &lt;tr&gt;` TO htmltable.</span><br><span class="line">  <span class="keyword">APPEND</span> `     &lt;td&gt;` TO htmltable.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Table containing code</span></span><br><span class="line">  <span class="keyword">APPEND</span> `     &lt;<span class="keyword">table</span> <span class="keyword">class</span>=<span class="string">"innerTable"</span>&gt;` TO htmltable.</span><br><span class="line">  <span class="keyword">APPEND</span> `       &lt;tr&gt;` TO htmltable.</span><br><span class="line">  <span class="keyword">APPEND</span> `          &lt;td&gt;` TO htmltable.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  LOOP AT icontents INTO wacontent.</span><br><span class="line">    mytabix = sy-tabix.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">IF</span> NOT ( wacontent IS INITIAL ).</span><br><span class="line">      <span class="keyword">WHILE</span> ( wacontent <span class="keyword">CS</span> '&lt;' OR wacontent <span class="keyword">CS</span> '&gt;' ).</span><br><span class="line">        <span class="keyword">REPLACE</span> '&lt;' <span class="keyword">IN</span> wacontent WITH lt.</span><br><span class="line">        <span class="keyword">REPLACE</span> '&gt;' <span class="keyword">IN</span> wacontent WITH gt.</span><br><span class="line">      ENDWHILE.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">IF</span> wacontent+0(1) &lt;&gt; asterix.</span><br><span class="line">        <span class="keyword">IF</span> mytabix = 1.</span><br><span class="line">          <span class="keyword">APPEND</span> `   &lt;div <span class="keyword">class</span>=<span class="string">"code"</span>&gt;` TO htmltable.</span><br><span class="line">          incommentmode = false.</span><br><span class="line">        <span class="keyword">ELSE</span>.</span><br><span class="line">          <span class="keyword">IF</span> incommentmode = true.</span><br><span class="line">            <span class="keyword">APPEND</span> `   &lt;/div&gt;` TO htmltable.</span><br><span class="line">            incommentmode = false.</span><br><span class="line">            <span class="keyword">APPEND</span> `   &lt;div <span class="keyword">class</span>=<span class="string">"code"</span>&gt;` TO htmltable.</span><br><span class="line">          ENDIF.</span><br><span class="line">        ENDIF.</span><br><span class="line"></span><br><span class="line">        currentlinelength = <span class="literal">strlen</span>( wacontent ).</span><br><span class="line">        copyofcurrentline = wacontent.</span><br><span class="line"></span><br><span class="line"><span class="comment">*       Don't hyperlink anything for files of type documentation</span></span><br><span class="line">        <span class="keyword">IF</span> sourcecodetype &lt;&gt; is_documentation.</span><br><span class="line"><span class="comment">*         Check for any functions to highlight</span></span><br><span class="line">          <span class="keyword">IF</span> ( wacontent <span class="keyword">CS</span> callfunction ) AND ( wacontent &lt;&gt; 'DESTINATION' ).</span><br><span class="line">            nextline = mytabix + 1.</span><br><span class="line">            <span class="keyword">READ</span> <span class="keyword">TABLE</span> icontents INTO wanextline INDEX nextline.</span><br><span class="line">            <span class="keyword">TRANSLATE</span> wanextline TO UPPER CASE.</span><br><span class="line">            <span class="keyword">IF</span> wanextline NS 'DESTINATION'.</span><br><span class="line">              SHIFT copyofcurrentline LEFT DELETING LEADING space.</span><br><span class="line"></span><br><span class="line">              copylinelength = <span class="literal">strlen</span>( copyofcurrentline ).</span><br><span class="line"></span><br><span class="line">              <span class="keyword">SPLIT</span> copyofcurrentline AT space INTO head tail.</span><br><span class="line">              <span class="keyword">SPLIT</span> tail AT space INTO head tail.</span><br><span class="line">              <span class="keyword">SPLIT</span> tail AT space INTO head tail.</span><br><span class="line"><span class="comment">*             Function name is now in head</span></span><br><span class="line">              <span class="keyword">TRANSLATE</span> head USING ''' '.</span><br><span class="line">              SHIFT head LEFT DELETING LEADING space.</span><br><span class="line"></span><br><span class="line">              TRY.</span><br><span class="line">                  <span class="keyword">IF</span> head+0(1) = 'Y' OR head+0(1) = 'Z' OR head+0(1) = 'y' OR head+0(1) = 'z' OR head <span class="keyword">CS</span> customernamerange.</span><br><span class="line"><span class="comment">*                 Definately a customer function module</span></span><br><span class="line">                    hyperlinkname = head.</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">IF</span> sourcecodetype = is_function.</span><br><span class="line">                      copyofcurrentline = 'call function &lt;a href ="../'.</span><br><span class="line">                    <span class="keyword">ELSE</span>.</span><br><span class="line">                      copyofcurrentline = 'call function &lt;a href ="'.</span><br><span class="line">                    ENDIF.</span><br><span class="line"></span><br><span class="line">                    lowercaselink = hyperlinkname.</span><br><span class="line">                    <span class="keyword">TRANSLATE</span> lowercaselink TO LOWER CASE.</span><br><span class="line"><span class="comment">*                 If we are running on a non UNIX environment we will need to remove forward slashes</span></span><br><span class="line">                    <span class="keyword">IF</span> frontendopsystem = non_unix.</span><br><span class="line">                      <span class="keyword">TRANSLATE</span> lowercaselink USING '/_'.</span><br><span class="line">                    ENDIF.</span><br><span class="line"></span><br><span class="line">                    CONCATENATE copyofcurrentline</span><br><span class="line">                    lowercaselink     "hyperlinkName</span><br><span class="line">                    '/'</span><br><span class="line">                    lowercaselink     "hyperlinkName</span><br><span class="line">                    period htmlextension '"&gt;'</span><br><span class="line">                    ''''</span><br><span class="line">                    hyperlinkname</span><br><span class="line">                    ''''</span><br><span class="line">                    '&lt;/a&gt;'</span><br><span class="line">                    tail INTO copyofcurrentline.</span><br><span class="line"></span><br><span class="line"><span class="comment">*                 Pad the string back out with spaces</span></span><br><span class="line">                    <span class="keyword">WHILE</span> copylinelength &lt; currentlinelength.</span><br><span class="line">                      SHIFT copyofcurrentline RIGHT <span class="keyword">BY</span> 1 PLACES.</span><br><span class="line">                      copylinelength = copylinelength + 1.</span><br><span class="line">                    ENDWHILE.</span><br><span class="line"></span><br><span class="line">                    wacontent = copyofcurrentline.</span><br><span class="line">                  ENDIF.</span><br><span class="line">                CATCH cx_sy_range_out_of_bounds INTO objruntimeerror.</span><br><span class="line">              ENDTRY.</span><br><span class="line">            ENDIF.</span><br><span class="line">          ENDIF.</span><br><span class="line">        ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*       Check for any customer includes to hyperlink</span></span><br><span class="line">        <span class="keyword">IF</span> wacontent <span class="keyword">CS</span> <span class="keyword">include</span> OR wacontent <span class="keyword">CS</span> lowinclude.</span><br><span class="line">          SHIFT copyofcurrentline LEFT DELETING LEADING space.</span><br><span class="line">          copylinelength = <span class="literal">strlen</span>( copyofcurrentline ).</span><br><span class="line"></span><br><span class="line">          <span class="keyword">SPLIT</span> copyofcurrentline AT space INTO head tail.</span><br><span class="line">          SHIFT tail LEFT DELETING LEADING space.</span><br><span class="line"></span><br><span class="line">          TRY.</span><br><span class="line">              <span class="keyword">IF</span> ( tail+0(1) = 'Y' OR tail+0(1) = 'Z' OR tail+0(1) = 'y' OR tail+0(1) = 'z' OR tail <span class="keyword">CS</span> customernamerange OR tail+0(2) = 'mz' OR tail+0(2) = 'MZ' )</span><br><span class="line">              AND NOT getincludes IS INITIAL AND  tail NS structure AND tail NS lowstructure.</span><br><span class="line"></span><br><span class="line"><span class="comment">*             Hyperlink for program includes</span></span><br><span class="line">                <span class="keyword">CLEAR</span> wacontent.</span><br><span class="line">                SHIFT tail LEFT DELETING LEADING space.</span><br><span class="line">                <span class="keyword">SPLIT</span> tail AT period INTO hyperlinkname tail.</span><br><span class="line">                copyofcurrentline = '<span class="keyword">include</span> &lt;a href ="'.</span><br><span class="line"></span><br><span class="line">                lowercaselink = hyperlinkname.</span><br><span class="line">                <span class="keyword">TRANSLATE</span> lowercaselink TO LOWER CASE.</span><br><span class="line"></span><br><span class="line"><span class="comment">*             If we are running on a non UNIX environment we will need to remove forward slashes</span></span><br><span class="line">                <span class="keyword">IF</span> frontendopsystem = non_unix.</span><br><span class="line">                  <span class="keyword">TRANSLATE</span> lowercaselink USING '/_'.</span><br><span class="line">                ENDIF.</span><br><span class="line"></span><br><span class="line">                CONCATENATE copyofcurrentline</span><br><span class="line">                lowercaselink       "hyperlinkName</span><br><span class="line">                period htmlextension '"&gt;'</span><br><span class="line">                hyperlinkname</span><br><span class="line">                '&lt;/a&gt;'</span><br><span class="line">                period tail INTO copyofcurrentline.</span><br><span class="line"></span><br><span class="line"><span class="comment">*             Pad the string back out with spaces</span></span><br><span class="line">                <span class="keyword">WHILE</span> copylinelength &lt; currentlinelength.</span><br><span class="line">                  SHIFT copyofcurrentline RIGHT <span class="keyword">BY</span> 1 PLACES.</span><br><span class="line">                  copylinelength = copylinelength + 1.</span><br><span class="line">                ENDWHILE.</span><br><span class="line">                wacontent = copyofcurrentline.</span><br><span class="line">              <span class="keyword">ELSE</span>.</span><br><span class="line">                <span class="keyword">IF</span> NOT getdictstructures IS INITIAL.</span><br><span class="line"><span class="comment">*              Hyperlink for structure include e.g. "include structure zfred."</span></span><br><span class="line">                  copylinelength = <span class="literal">strlen</span>( copyofcurrentline ).</span><br><span class="line">                  <span class="keyword">SPLIT</span> copyofcurrentline AT space INTO head tail.</span><br><span class="line">                  SHIFT tail LEFT DELETING LEADING space.</span><br><span class="line">                  <span class="keyword">SPLIT</span> tail AT space INTO head tail.</span><br><span class="line"></span><br><span class="line">                  TRY.</span><br><span class="line">                      <span class="keyword">IF</span> tail+0(1) = 'Y' OR tail+0(1) = 'Z' OR tail+0(1) = 'y' OR tail+0(1) = 'z' OR tail <span class="keyword">CS</span> customernamerange.</span><br><span class="line">                        <span class="keyword">CLEAR</span> wacontent.</span><br><span class="line">                        SHIFT tail LEFT DELETING LEADING space.</span><br><span class="line">                        <span class="keyword">SPLIT</span> tail AT period INTO hyperlinkname tail.</span><br><span class="line">                        copyofcurrentline = '<span class="keyword">include</span> structure &lt;a href ='.</span><br><span class="line"></span><br><span class="line">                        lowercaselink = hyperlinkname.</span><br><span class="line">                        <span class="keyword">TRANSLATE</span> lowercaselink TO LOWER CASE.</span><br><span class="line"><span class="comment">*                  If we are running on a non UNIX environment we will need to remove forward slashes</span></span><br><span class="line">                        <span class="keyword">IF</span> frontendopsystem = non_unix.</span><br><span class="line">                          <span class="keyword">TRANSLATE</span> lowercaselink USING '/_'.</span><br><span class="line">                        ENDIF.</span><br><span class="line"></span><br><span class="line">                        CONCATENATE copyofcurrentline</span><br><span class="line">                        '"'</span><br><span class="line">                        lowercaselink    "hyperlinkName</span><br><span class="line">                        '/'</span><br><span class="line">                        'dictionary-'</span><br><span class="line">                        lowercaselink    "hyperlinkName</span><br><span class="line">                        period htmlextension</span><br><span class="line">                        '"&gt;'</span><br><span class="line">                        hyperlinkname</span><br><span class="line">                        '&lt;/a&gt;'</span><br><span class="line">                        period tail INTO copyofcurrentline.</span><br><span class="line"></span><br><span class="line"><span class="comment">*                  Pad the string back out with spaces</span></span><br><span class="line">                        <span class="keyword">WHILE</span> copylinelength &lt; currentlinelength.</span><br><span class="line">                          SHIFT copyofcurrentline RIGHT <span class="keyword">BY</span> 1 PLACES.</span><br><span class="line">                          copylinelength = copylinelength + 1.</span><br><span class="line">                        ENDWHILE.</span><br><span class="line">                        wacontent = copyofcurrentline.</span><br><span class="line">                      ENDIF.</span><br><span class="line">                    CATCH cx_sy_range_out_of_bounds INTO objruntimeerror.</span><br><span class="line">                  ENDTRY.</span><br><span class="line">                ENDIF.</span><br><span class="line">              ENDIF.</span><br><span class="line">            CATCH cx_sy_range_out_of_bounds INTO objruntimeerror.</span><br><span class="line">          ENDTRY.</span><br><span class="line">        ENDIF.</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line">        <span class="keyword">IF</span>  wacontent+0(1) = asterix.</span><br><span class="line">          <span class="keyword">IF</span> mytabix = 1.</span><br><span class="line">            <span class="keyword">APPEND</span> `   &lt;div <span class="keyword">class</span>=<span class="string">"codeComment"</span>&gt;` TO htmltable.</span><br><span class="line">            incommentmode = true.</span><br><span class="line">          <span class="keyword">ELSE</span>.</span><br><span class="line">            <span class="keyword">IF</span> incommentmode = false.</span><br><span class="line">              <span class="keyword">APPEND</span> `   &lt;/div&gt;` TO htmltable.</span><br><span class="line">              <span class="keyword">APPEND</span> `   &lt;div <span class="keyword">class</span>=<span class="string">"codeComment"</span>&gt;` TO htmltable.</span><br><span class="line">              incommentmode = true.</span><br><span class="line">            ENDIF.</span><br><span class="line">          ENDIF.</span><br><span class="line">        ENDIF.</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      <span class="keyword">IF</span> incommentmode = true.</span><br><span class="line">        <span class="keyword">WHILE</span> wacontent <span class="keyword">CS</span> ' '.</span><br><span class="line">          <span class="keyword">REPLACE</span> space WITH '&amp;nbsp;' INTO wacontent.</span><br><span class="line">          <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line">            <span class="keyword">EXIT</span>.</span><br><span class="line">          ENDIF.</span><br><span class="line">        ENDWHILE.</span><br><span class="line">      ENDIF.</span><br><span class="line">      htmltable =  wacontent.</span><br><span class="line"></span><br><span class="line">      TRY.</span><br><span class="line">          <span class="keyword">IF</span> htmltable+0(1) = ` `.</span><br><span class="line">            <span class="keyword">WHILE</span> htmltable <span class="keyword">CS</span> ` `.</span><br><span class="line">              <span class="keyword">REPLACE</span> ` ` WITH '&amp;nbsp;' INTO htmltable.</span><br><span class="line">              <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line">                <span class="keyword">EXIT</span>.</span><br><span class="line">              ENDIF.</span><br><span class="line">            ENDWHILE.</span><br><span class="line">          ENDIF.</span><br><span class="line">        CATCH cx_sy_range_out_of_bounds INTO objruntimeerror.</span><br><span class="line">      ENDTRY.</span><br><span class="line">    <span class="keyword">ELSE</span>.</span><br><span class="line">      htmltable = ''.</span><br><span class="line">    ENDIF.</span><br><span class="line">    CONCATENATE htmltable `&lt;<span class="keyword">br</span> /&gt;` INTO htmltable.</span><br><span class="line">    <span class="keyword">APPEND</span> htmltable.</span><br><span class="line">  ENDLOOP.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">APPEND</span> `            &lt;/div&gt;` TO htmltable.</span><br><span class="line">  <span class="keyword">APPEND</span> `          &lt;/td&gt;`  TO htmltable.</span><br><span class="line">  <span class="keyword">APPEND</span> `        &lt;/tr&gt;` TO htmltable.</span><br><span class="line">  <span class="keyword">APPEND</span> `      &lt;/<span class="keyword">table</span>&gt;` TO htmltable.</span><br><span class="line">  <span class="keyword">APPEND</span> `      &lt;/td&gt;` TO htmltable.</span><br><span class="line">  <span class="keyword">APPEND</span> `      &lt;/tr&gt;` TO htmltable.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Add a html footer to the table</span></span><br><span class="line">  PERFORM addhtmlfooter USING htmltable[].</span><br><span class="line"></span><br><span class="line">  icontents[] = htmltable[].</span><br><span class="line">ENDFORM.                                                                                             "convertCodeToHtml</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  convertClassToHtml... Builds an HTML table based upon a text table.</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> convertclasstohtml USING icontents LIKE dumihtml[]</span><br><span class="line">      VALUE(classname)</span><br><span class="line">      VALUE(shortdescription)</span><br><span class="line">      VALUE(sourcecodetype)</span><br><span class="line">      VALUE(htmlextension)</span><br><span class="line">      VALUE(customernamerange)</span><br><span class="line">      VALUE(getdictstructures)</span><br><span class="line">      VALUE(addbackground) <span class="keyword">TYPE</span> abap_bool.</span><br><span class="line"></span><br><span class="line">  DATA: htmltable <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF string WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: mytabix <span class="keyword">TYPE</span> sytabix.</span><br><span class="line">  DATA: wacontent <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: head <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: tail <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: hyperlinkname <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: lowercaselink <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: copyofcurrentline <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: currentlinelength <span class="keyword">TYPE</span> i VALUE 0.</span><br><span class="line">  DATA: copylinelength <span class="keyword">TYPE</span> i VALUE 0.</span><br><span class="line">  DATA: incommentmode <span class="keyword">TYPE</span> abap_bool VALUE 'X'.</span><br><span class="line">  DATA: methoddirectory <span class="keyword">TYPE</span> string.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Add a html header to the table</span></span><br><span class="line">  PERFORM addhtmlheader USING htmltable[]</span><br><span class="line">        classname</span><br><span class="line">        addbackground</span><br><span class="line">        ss_code.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">APPEND</span> '&lt;body&gt;' TO htmltable.</span><br><span class="line"><span class="comment">* Class name and description</span></span><br><span class="line">  <span class="keyword">APPEND</span> '&lt;<span class="keyword">table</span> <span class="keyword">class</span>=<span class="string">"outerTable"</span>&gt;' TO htmltable.</span><br><span class="line">  <span class="keyword">APPEND</span> `  &lt;tr <span class="keyword">class</span>=<span class="string">"normalBoldLarge"</span>&gt;` TO htmltable.</span><br><span class="line"></span><br><span class="line">  CONCATENATE `     &lt;td&gt;&lt;h2&gt;Code listing <span class="keyword">for</span> <span class="keyword">class</span>: ` classname `&lt;/h2&gt;` INTO htmltable.</span><br><span class="line">  <span class="keyword">APPEND</span> htmltable.</span><br><span class="line"></span><br><span class="line">  CONCATENATE `&lt;h3&gt; Description: ` shortdescription `&lt;/h3&gt;&lt;/td&gt;` INTO htmltable.</span><br><span class="line">  <span class="keyword">APPEND</span> htmltable.</span><br><span class="line">  <span class="keyword">APPEND</span> `   &lt;/tr&gt;` TO htmltable.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Code</span></span><br><span class="line">  <span class="keyword">APPEND</span> `  &lt;tr&gt;` TO htmltable.</span><br><span class="line">  <span class="keyword">APPEND</span> `     &lt;td&gt;` TO htmltable.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Table containing code</span></span><br><span class="line">  <span class="keyword">APPEND</span> `     &lt;<span class="keyword">table</span> <span class="keyword">class</span>=<span class="string">"innerTable"</span>&gt;` TO htmltable.</span><br><span class="line">  <span class="keyword">APPEND</span> `       &lt;tr&gt;` TO htmltable.</span><br><span class="line">  <span class="keyword">APPEND</span> `          &lt;td&gt;` TO htmltable.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  LOOP AT icontents INTO wacontent.</span><br><span class="line">    mytabix = sy-tabix.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Comments</span></span><br><span class="line">    <span class="keyword">IF</span> NOT ( wacontent IS INITIAL ).</span><br><span class="line">      <span class="keyword">IF</span> wacontent+0(1) = asterix.</span><br><span class="line">        htmltable = wacontent.</span><br><span class="line">        <span class="keyword">IF</span> mytabix = 1.</span><br><span class="line">          <span class="keyword">APPEND</span> `   &lt;div <span class="keyword">class</span>=<span class="string">"codeComment"</span>&gt;` TO htmltable.</span><br><span class="line">          incommentmode = true.</span><br><span class="line">        <span class="keyword">ELSE</span>.</span><br><span class="line">          <span class="keyword">IF</span> incommentmode = false.</span><br><span class="line">            <span class="keyword">APPEND</span> `   &lt;/div&gt;` TO htmltable.</span><br><span class="line">            <span class="keyword">APPEND</span> `   &lt;div <span class="keyword">class</span>=<span class="string">"codeComment"</span>&gt;` TO htmltable.</span><br><span class="line">            incommentmode = true.</span><br><span class="line">          ENDIF.</span><br><span class="line">        ENDIF.</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line">        <span class="keyword">IF</span> mytabix = 1.</span><br><span class="line">          <span class="keyword">APPEND</span> `   &lt;div <span class="keyword">class</span>=<span class="string">"code"</span>&gt;` TO htmltable.</span><br><span class="line">          incommentmode = false.</span><br><span class="line">        <span class="keyword">ELSE</span>.</span><br><span class="line">          <span class="keyword">IF</span> incommentmode = true.</span><br><span class="line">            <span class="keyword">APPEND</span> `   &lt;/div&gt;` TO htmltable.</span><br><span class="line">            incommentmode = false.</span><br><span class="line">            <span class="keyword">APPEND</span> `   &lt;div <span class="keyword">class</span>=<span class="string">"code"</span>&gt;` TO htmltable.</span><br><span class="line">          ENDIF.</span><br><span class="line">        ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*        Smaller than, greater than signs</span></span><br><span class="line">        <span class="keyword">IF</span> NOT ( wacontent IS INITIAL ).</span><br><span class="line">          <span class="keyword">WHILE</span> ( wacontent <span class="keyword">CS</span> '&lt;' OR wacontent <span class="keyword">CS</span> '&gt;' ).</span><br><span class="line">            <span class="keyword">REPLACE</span> '&lt;' <span class="keyword">IN</span> wacontent WITH lt.</span><br><span class="line">            <span class="keyword">REPLACE</span> '&gt;' <span class="keyword">IN</span> wacontent WITH gt.</span><br><span class="line">          ENDWHILE.</span><br><span class="line"></span><br><span class="line"><span class="comment">*--        Hyperlink methods in the class</span></span><br><span class="line"><span class="comment">*--        Setup sudirectory where method will be saved</span></span><br><span class="line">          <span class="keyword">IF</span> wacontent <span class="keyword">CS</span> 'public section.'.</span><br><span class="line">            methoddirectory = 'public_methods'.</span><br><span class="line">          ELSEIF wacontent <span class="keyword">CS</span> 'private section.'.</span><br><span class="line">            methoddirectory = 'private_methods'.</span><br><span class="line">          ELSEIF wacontent <span class="keyword">CS</span> 'protected section.'.</span><br><span class="line">            methoddirectory = 'protected_methods'.</span><br><span class="line">          ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*--        When it is a method, make a link</span></span><br><span class="line">          FIND REGEX '([:space:]*methods[:space:]*)(.*)' <span class="keyword">IN</span> wacontent</span><br><span class="line">          IGNORING CASE</span><br><span class="line">          SUBMATCHES head hyperlinkname.</span><br><span class="line"></span><br><span class="line">          <span class="keyword">IF</span> sy-subrc = 0.</span><br><span class="line">            SHIFT hyperlinkname LEFT DELETING LEADING space.</span><br><span class="line">            CONCATENATE methoddirectory</span><br><span class="line">            '/'</span><br><span class="line">            hyperlinkname</span><br><span class="line">            '.html'</span><br><span class="line">            INTO lowercaselink.</span><br><span class="line"></span><br><span class="line">            <span class="keyword">TRANSLATE</span> lowercaselink TO LOWER CASE.</span><br><span class="line">            CONCATENATE head</span><br><span class="line">            ' &lt;a href="'</span><br><span class="line">            lowercaselink</span><br><span class="line">            '"&gt;'</span><br><span class="line">            hyperlinkname</span><br><span class="line">            '&lt;/a&gt;'</span><br><span class="line">            INTO wacontent.</span><br><span class="line">            SHIFT wacontent RIGHT <span class="keyword">BY</span> 2 PLACES.</span><br><span class="line">          ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*          Dictionary structures</span></span><br><span class="line">          <span class="keyword">IF</span> NOT getdictstructures IS INITIAL.</span><br><span class="line">            FIND '<span class="keyword">class</span>' <span class="keyword">IN</span> wacontent IGNORING CASE.</span><br><span class="line">            <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line"><span class="comment">*              Hyperlink for dictionary/structure include</span></span><br><span class="line">              copylinelength = <span class="literal">strlen</span>( wacontent ).</span><br><span class="line">              copyofcurrentline = wacontent.</span><br><span class="line">              <span class="keyword">SPLIT</span> copyofcurrentline AT space INTO head tail.</span><br><span class="line">              SHIFT tail LEFT DELETING LEADING space.</span><br><span class="line">              <span class="keyword">SPLIT</span> tail AT space INTO head tail.</span><br><span class="line"></span><br><span class="line">              TRY.</span><br><span class="line">                  <span class="keyword">IF</span> tail+0(1) = 'Y' OR tail+0(1) = 'Z' OR tail+0(1) = 'y' OR tail+0(1) = 'z' OR tail <span class="keyword">CS</span> customernamerange.</span><br><span class="line">                    <span class="keyword">CLEAR</span> wacontent.</span><br><span class="line">                    SHIFT tail LEFT DELETING LEADING space.</span><br><span class="line">                    <span class="keyword">SPLIT</span> tail AT period INTO hyperlinkname tail.</span><br><span class="line">                    copyofcurrentline = '<span class="keyword">include</span> structure &lt;a href ='.</span><br><span class="line"></span><br><span class="line">                    lowercaselink = hyperlinkname.</span><br><span class="line">                    <span class="keyword">TRANSLATE</span> lowercaselink TO LOWER CASE.</span><br><span class="line"><span class="comment">*                  If we are running on a non UNIX environment we will need to remove forward slashes</span></span><br><span class="line">                    <span class="keyword">IF</span> frontendopsystem = non_unix.</span><br><span class="line">                      <span class="keyword">TRANSLATE</span> lowercaselink USING '/_'.</span><br><span class="line">                    ENDIF.</span><br><span class="line"></span><br><span class="line">                    CONCATENATE copyofcurrentline</span><br><span class="line">                    '"'</span><br><span class="line">                    lowercaselink    "hyperlinkName</span><br><span class="line">                    '/'</span><br><span class="line">                    'dictionary-'</span><br><span class="line">                    lowercaselink    "hyperlinkName</span><br><span class="line">                    period htmlextension</span><br><span class="line">                    '"&gt;'</span><br><span class="line">                    hyperlinkname</span><br><span class="line">                    '&lt;/a&gt;'</span><br><span class="line">                    period tail INTO copyofcurrentline.</span><br><span class="line"></span><br><span class="line"><span class="comment">*                  Pad the string back out with spaces</span></span><br><span class="line">                    <span class="keyword">WHILE</span> copylinelength &lt; currentlinelength.</span><br><span class="line">                      SHIFT copyofcurrentline RIGHT <span class="keyword">BY</span> 1 PLACES.</span><br><span class="line">                      copylinelength = copylinelength + 1.</span><br><span class="line">                    ENDWHILE.</span><br><span class="line">                    wacontent = copyofcurrentline.</span><br><span class="line">                  ENDIF.</span><br><span class="line">                CATCH cx_sy_range_out_of_bounds INTO objruntimeerror.</span><br><span class="line">              ENDTRY.</span><br><span class="line">            ENDIF.</span><br><span class="line">          ENDIF.</span><br><span class="line"></span><br><span class="line">          htmltable = wacontent.</span><br><span class="line"></span><br><span class="line">          TRY.</span><br><span class="line">              <span class="keyword">IF</span> htmltable+0(1) = ` `.</span><br><span class="line">                <span class="keyword">WHILE</span> htmltable <span class="keyword">CS</span> ` `.</span><br><span class="line">                  <span class="keyword">REPLACE</span> ` ` WITH '&amp;nbsp;' INTO htmltable.</span><br><span class="line">                  <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line">                    <span class="keyword">EXIT</span>.</span><br><span class="line">                  ENDIF.</span><br><span class="line">                ENDWHILE.</span><br><span class="line">              ENDIF.</span><br><span class="line">            CATCH cx_sy_range_out_of_bounds INTO objruntimeerror.</span><br><span class="line">          ENDTRY.</span><br><span class="line">        <span class="keyword">ELSE</span>.</span><br><span class="line">          htmltable = ''.</span><br><span class="line">        ENDIF.</span><br><span class="line">      ENDIF.</span><br><span class="line">    <span class="keyword">ELSE</span>.</span><br><span class="line">      htmltable = ''.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line">    CONCATENATE htmltable '&lt;<span class="keyword">br</span> /&gt;' INTO htmltable.</span><br><span class="line">    <span class="keyword">APPEND</span> htmltable.</span><br><span class="line">  ENDLOOP.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">APPEND</span> `            &lt;/div&gt;` TO htmltable.</span><br><span class="line">  <span class="keyword">APPEND</span> `          &lt;/td&gt;`  TO htmltable.</span><br><span class="line">  <span class="keyword">APPEND</span> `        &lt;/tr&gt;` TO htmltable.</span><br><span class="line">  <span class="keyword">APPEND</span> `      &lt;/<span class="keyword">table</span>&gt;` TO htmltable.</span><br><span class="line">  <span class="keyword">APPEND</span> `      &lt;/td&gt;` TO htmltable.</span><br><span class="line">  <span class="keyword">APPEND</span> `      &lt;/tr&gt;` TO htmltable.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Add a html footer to the table</span></span><br><span class="line">  PERFORM addhtmlfooter USING htmltable[].</span><br><span class="line"></span><br><span class="line">  icontents[] = htmltable[].</span><br><span class="line">ENDFORM.                                                                                            "convertClassToHtml</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  convertFunctionToHtml... Builds an HTML table based upon a text table.</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> convertfunctiontohtml USING icontents LIKE dumihtml[]</span><br><span class="line">      VALUE(functionname)</span><br><span class="line">      VALUE(shortdescription)</span><br><span class="line">      VALUE(sourcecodetype)</span><br><span class="line">      VALUE(functiondocumentationexists)</span><br><span class="line">      VALUE(ismainfunctioninclude)</span><br><span class="line">      VALUE(htmlextension)</span><br><span class="line">      VALUE(customernamerange)</span><br><span class="line">      VALUE(getincludes)</span><br><span class="line">      VALUE(getdictstructures)</span><br><span class="line">      VALUE(addbackground) <span class="keyword">TYPE</span> abap_bool.</span><br><span class="line"></span><br><span class="line">  DATA: htmltable <span class="keyword">TYPE</span> STANDARD <span class="keyword">TABLE</span> OF string WITH HEADER <span class="keyword">LINE</span>.</span><br><span class="line">  DATA: head(255).</span><br><span class="line">  DATA: tail(255).</span><br><span class="line">  DATA: mytabix <span class="keyword">TYPE</span> sytabix.</span><br><span class="line">  DATA: nextline <span class="keyword">TYPE</span> sytabix.</span><br><span class="line">  DATA: hyperlinkname <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: copyofcurrentline <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: currentlinelength <span class="keyword">TYPE</span> i VALUE 0.</span><br><span class="line">  DATA: copylinelength <span class="keyword">TYPE</span> i VALUE 0.</span><br><span class="line">  DATA: ignorefuturelines <span class="keyword">TYPE</span> abap_bool VALUE false.</span><br><span class="line">  DATA: foundasterix <span class="keyword">TYPE</span> abap_bool VALUE false.</span><br><span class="line">  DATA: lowercaselink <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: wanextline <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: wacontent <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: incommentmode <span class="keyword">TYPE</span> abap_bool VALUE 'X'.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Add a html header to the table</span></span><br><span class="line">  PERFORM addhtmlheader USING htmltable[]</span><br><span class="line">        functionname</span><br><span class="line">        addbackground</span><br><span class="line">        ss_code.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">APPEND</span> '&lt;body&gt;' TO htmltable.</span><br><span class="line"><span class="comment">* Class name and description</span></span><br><span class="line">  <span class="keyword">APPEND</span> '&lt;<span class="keyword">table</span> <span class="keyword">class</span>=<span class="string">"outerTable"</span>&gt;' TO htmltable.</span><br><span class="line">  <span class="keyword">APPEND</span> `  &lt;tr <span class="keyword">class</span>=<span class="string">"normalBoldLarge"</span>&gt;` TO htmltable.</span><br><span class="line"></span><br><span class="line">  CONCATENATE `     &lt;td&gt;&lt;h2&gt;Code listing <span class="keyword">for</span> function ` functionname `&lt;/h2&gt;` INTO htmltable.</span><br><span class="line">  <span class="keyword">APPEND</span> htmltable.</span><br><span class="line"></span><br><span class="line">  CONCATENATE `&lt;h3&gt; Description: ` shortdescription `&lt;/h3&gt;&lt;/td&gt;` INTO htmltable.</span><br><span class="line">  <span class="keyword">APPEND</span> htmltable.</span><br><span class="line">  <span class="keyword">APPEND</span> `   &lt;/tr&gt;` TO htmltable.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Code</span></span><br><span class="line">  <span class="keyword">APPEND</span> `  &lt;tr&gt;` TO htmltable.</span><br><span class="line">  <span class="keyword">APPEND</span> `     &lt;td&gt;` TO htmltable.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Table containing code</span></span><br><span class="line">  <span class="keyword">APPEND</span> `     &lt;<span class="keyword">table</span> <span class="keyword">class</span>=<span class="string">"innerTable"</span>&gt;` TO htmltable.</span><br><span class="line">  <span class="keyword">APPEND</span> `       &lt;tr&gt;` TO htmltable.</span><br><span class="line">  <span class="keyword">APPEND</span> `          &lt;td&gt;` TO htmltable.</span><br><span class="line"></span><br><span class="line">  LOOP AT icontents INTO wacontent.</span><br><span class="line">    mytabix = sy-tabix.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Extra code for adding global and doc hyperlinks to functions</span></span><br><span class="line">    <span class="keyword">IF</span> sourcecodetype = is_function AND ismainfunctioninclude = true.</span><br><span class="line">      <span class="keyword">IF</span> NOT ( wacontent IS INITIAL ).</span><br><span class="line">        <span class="keyword">IF</span> sy-tabix &gt; 1.</span><br><span class="line">          <span class="keyword">IF</span> wacontent+0(1) = asterix AND ignorefuturelines = false.</span><br><span class="line">            foundasterix = true.</span><br><span class="line">          <span class="keyword">ELSE</span>.</span><br><span class="line">            <span class="keyword">IF</span> foundasterix = true.</span><br><span class="line"><span class="comment">*             Lets add our extra HTML lines in here</span></span><br><span class="line">              <span class="keyword">APPEND</span> '' TO htmltable.</span><br><span class="line"></span><br><span class="line"><span class="comment">*             Global data hyperlink</span></span><br><span class="line">              copyofcurrentline = '&lt;div <span class="keyword">class</span>=<span class="string">"codeComment"</span>&gt;*       &lt;a href ="' .</span><br><span class="line">              lowercaselink = functionname.</span><br><span class="line">              <span class="keyword">TRANSLATE</span> lowercaselink TO LOWER CASE.</span><br><span class="line"><span class="comment">*             If we are running on a non UNIX environment we will need to remove forward slashes</span></span><br><span class="line">              <span class="keyword">IF</span> frontendopsystem = non_unix.</span><br><span class="line">                <span class="keyword">TRANSLATE</span> lowercaselink USING '/_'.</span><br><span class="line">              ENDIF.</span><br><span class="line"></span><br><span class="line">              CONCATENATE copyofcurrentline '<span class="keyword">global</span>-' lowercaselink  "functionName</span><br><span class="line">              period htmlextension '"&gt;' '<span class="keyword">Global</span> data declarations' '&lt;/a&gt;' INTO copyofcurrentline.</span><br><span class="line"></span><br><span class="line">              CONCATENATE copyofcurrentline '&lt;/div&gt;&lt;<span class="keyword">br</span> /&gt;' INTO copyofcurrentline.</span><br><span class="line"></span><br><span class="line">              <span class="keyword">APPEND</span> copyofcurrentline TO htmltable.</span><br><span class="line"></span><br><span class="line"><span class="comment">*             Documentation hyperlink.</span></span><br><span class="line">              <span class="keyword">IF</span> functiondocumentationexists = true.</span><br><span class="line">                copyofcurrentline = '&lt;div <span class="keyword">class</span>=<span class="string">"codeComment"</span>&gt;*       &lt;a href ="'.</span><br><span class="line"></span><br><span class="line">                lowercaselink = functionname.</span><br><span class="line">                <span class="keyword">TRANSLATE</span> lowercaselink TO LOWER CASE.</span><br><span class="line"><span class="comment">*               If we are running on a non UNIX environment we will need to remove forward slashes</span></span><br><span class="line">                <span class="keyword">IF</span> frontendopsystem = non_unix.</span><br><span class="line">                  <span class="keyword">TRANSLATE</span> lowercaselink USING '/_'.</span><br><span class="line">                ENDIF.</span><br><span class="line"></span><br><span class="line">                CONCATENATE copyofcurrentline</span><br><span class="line">                'docs-'</span><br><span class="line">                lowercaselink  "functionName</span><br><span class="line">                period htmlextension '"&gt;'</span><br><span class="line">                'Function module documentation'</span><br><span class="line">                '&lt;/a&gt;'</span><br><span class="line">                INTO copyofcurrentline.</span><br><span class="line"></span><br><span class="line">                CONCATENATE copyofcurrentline '&lt;/div&gt;&lt;<span class="keyword">br</span> /&gt;' INTO copyofcurrentline.</span><br><span class="line">                <span class="keyword">APPEND</span> copyofcurrentline TO htmltable.</span><br><span class="line">              ENDIF.</span><br><span class="line"></span><br><span class="line">              foundasterix = false.</span><br><span class="line">              ignorefuturelines = true.</span><br><span class="line">            ENDIF.</span><br><span class="line">          ENDIF.</span><br><span class="line">        ENDIF.</span><br><span class="line">      ENDIF.</span><br><span class="line">    ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Carry on as normal</span></span><br><span class="line">    <span class="keyword">IF</span> NOT ( wacontent IS INITIAL ).</span><br><span class="line">      <span class="keyword">WHILE</span> ( wacontent <span class="keyword">CS</span> '&lt;' OR wacontent <span class="keyword">CS</span> '&gt;' ).</span><br><span class="line">        <span class="keyword">REPLACE</span> '&lt;' <span class="keyword">IN</span> wacontent WITH lt.</span><br><span class="line">        <span class="keyword">REPLACE</span> '&gt;' <span class="keyword">IN</span> wacontent WITH gt.</span><br><span class="line">      ENDWHILE.</span><br><span class="line"></span><br><span class="line">      <span class="keyword">IF</span> wacontent+0(1) &lt;&gt; asterix.</span><br><span class="line">        <span class="keyword">IF</span> mytabix = 1.</span><br><span class="line">          <span class="keyword">APPEND</span> `   &lt;div <span class="keyword">class</span>=<span class="string">"code"</span>&gt;` TO htmltable.</span><br><span class="line">          incommentmode = false.</span><br><span class="line">        <span class="keyword">ELSE</span>.</span><br><span class="line">          <span class="keyword">IF</span> incommentmode = true.</span><br><span class="line">            <span class="keyword">APPEND</span> `   &lt;/div&gt;` TO htmltable.</span><br><span class="line">            incommentmode = false.</span><br><span class="line">            <span class="keyword">APPEND</span> `   &lt;div <span class="keyword">class</span>=<span class="string">"code"</span>&gt;` TO htmltable.</span><br><span class="line">          ENDIF.</span><br><span class="line">        ENDIF.</span><br><span class="line"></span><br><span class="line">        currentlinelength = <span class="literal">strlen</span>( wacontent ).</span><br><span class="line"></span><br><span class="line"><span class="comment">*       Don't hyperlink anything for files of type documentation</span></span><br><span class="line">        <span class="keyword">IF</span> sourcecodetype &lt;&gt; is_documentation.</span><br><span class="line"><span class="comment">*       Check for any functions to highlight</span></span><br><span class="line">          <span class="keyword">IF</span> ( wacontent <span class="keyword">CS</span> callfunction ) AND ( wacontent &lt;&gt; 'DESTINATION' ).</span><br><span class="line">            nextline = mytabix + 1.</span><br><span class="line">            <span class="keyword">READ</span> <span class="keyword">TABLE</span> icontents INTO wanextline INDEX nextline.</span><br><span class="line">            <span class="keyword">TRANSLATE</span> wanextline TO UPPER CASE.</span><br><span class="line">            <span class="keyword">IF</span> wanextline NS 'DESTINATION'.</span><br><span class="line">              copyofcurrentline = wacontent.</span><br><span class="line">              SHIFT copyofcurrentline LEFT DELETING LEADING space.</span><br><span class="line"></span><br><span class="line">              copylinelength = <span class="literal">strlen</span>( copyofcurrentline ).</span><br><span class="line"></span><br><span class="line">              <span class="keyword">SPLIT</span> copyofcurrentline AT space INTO head tail.</span><br><span class="line">              <span class="keyword">SPLIT</span> tail AT space INTO head tail.</span><br><span class="line">              <span class="keyword">SPLIT</span> tail AT space INTO head tail.</span><br><span class="line"><span class="comment">*             Function name is now in head</span></span><br><span class="line">              <span class="keyword">TRANSLATE</span> head USING ''' '.</span><br><span class="line">              SHIFT head LEFT DELETING LEADING space.</span><br><span class="line"></span><br><span class="line">              TRY.</span><br><span class="line">                  <span class="keyword">IF</span> head+0(1) = 'Y' OR head+0(1) = 'Z' OR head+0(1) = 'y' OR head+0(1) = 'z' OR head <span class="keyword">CS</span> customernamerange.</span><br><span class="line"></span><br><span class="line"><span class="comment">*                 Definately a customer function module</span></span><br><span class="line">                    hyperlinkname = head.</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">IF</span> sourcecodetype = is_function.</span><br><span class="line">                      copyofcurrentline = 'call function &lt;a href ="../'.</span><br><span class="line">                    <span class="keyword">ELSE</span>.</span><br><span class="line">                      copyofcurrentline = 'call function &lt;a href ="'.</span><br><span class="line">                    ENDIF.</span><br><span class="line"></span><br><span class="line">                    lowercaselink = hyperlinkname.</span><br><span class="line">                    <span class="keyword">TRANSLATE</span> lowercaselink TO LOWER CASE.</span><br><span class="line"><span class="comment">*                 If we are running on a non UNIX environment we will need to remove forward slashes</span></span><br><span class="line">                    <span class="keyword">IF</span> frontendopsystem = non_unix.</span><br><span class="line">                      <span class="keyword">TRANSLATE</span> lowercaselink USING '/_'.</span><br><span class="line">                    ENDIF.</span><br><span class="line"></span><br><span class="line">                    CONCATENATE copyofcurrentline</span><br><span class="line">                    lowercaselink     "hyperlinkName</span><br><span class="line">                    '/'</span><br><span class="line">                    lowercaselink     "hyperlinkName</span><br><span class="line">                    period htmlextension '"&gt;'</span><br><span class="line">                    ''''</span><br><span class="line">                    hyperlinkname</span><br><span class="line">                    ''''</span><br><span class="line">                    '&lt;/a&gt;'</span><br><span class="line">                    tail INTO copyofcurrentline.</span><br><span class="line"></span><br><span class="line"><span class="comment">*                 Pad the string back out with spaces</span></span><br><span class="line">                    <span class="keyword">WHILE</span> copylinelength &lt; currentlinelength.</span><br><span class="line">                      SHIFT copyofcurrentline RIGHT <span class="keyword">BY</span> 1 PLACES.</span><br><span class="line">                      copylinelength = copylinelength + 1.</span><br><span class="line">                    ENDWHILE.</span><br><span class="line"></span><br><span class="line">                    wacontent = copyofcurrentline.</span><br><span class="line">                  ENDIF.</span><br><span class="line">                CATCH cx_sy_range_out_of_bounds INTO objruntimeerror.</span><br><span class="line">              ENDTRY.</span><br><span class="line">            ENDIF.</span><br><span class="line">          ENDIF.</span><br><span class="line">        ENDIF.</span><br><span class="line"></span><br><span class="line"><span class="comment">*       Check for any customer includes to hyperlink</span></span><br><span class="line">        <span class="keyword">IF</span> wacontent <span class="keyword">CS</span> <span class="keyword">include</span> OR wacontent <span class="keyword">CS</span> lowinclude.</span><br><span class="line">          copyofcurrentline = wacontent.</span><br><span class="line"></span><br><span class="line">          SHIFT copyofcurrentline LEFT DELETING LEADING space.</span><br><span class="line">          copylinelength = <span class="literal">strlen</span>( copyofcurrentline ).</span><br><span class="line"></span><br><span class="line">          <span class="keyword">SPLIT</span> copyofcurrentline AT space INTO head tail.</span><br><span class="line">          SHIFT tail LEFT DELETING LEADING space.</span><br><span class="line"></span><br><span class="line">          TRY.</span><br><span class="line">              <span class="keyword">IF</span> ( tail+0(1) = 'Y' OR tail+0(1) = 'Z' OR tail+0(1) = 'y' OR tail+0(1) = 'z'</span><br><span class="line">              OR tail <span class="keyword">CS</span> customernamerange OR tail+0(2) = 'mz' OR tail+0(2) = 'MZ' ) AND NOT getincludes IS INITIAL.</span><br><span class="line"></span><br><span class="line"><span class="comment">*             Hyperlink for program includes</span></span><br><span class="line">                <span class="keyword">CLEAR</span> wacontent.</span><br><span class="line">                SHIFT tail LEFT DELETING LEADING space.</span><br><span class="line">                <span class="keyword">SPLIT</span> tail AT period INTO hyperlinkname tail.</span><br><span class="line">                copyofcurrentline = '<span class="keyword">include</span> &lt;a href ="'.</span><br><span class="line"></span><br><span class="line">                lowercaselink = hyperlinkname.</span><br><span class="line">                <span class="keyword">TRANSLATE</span> lowercaselink TO LOWER CASE.</span><br><span class="line"><span class="comment">*             If we are running on a non UNIX environment we will need to remove forward slashes</span></span><br><span class="line">                <span class="keyword">IF</span> frontendopsystem = non_unix.</span><br><span class="line">                  <span class="keyword">TRANSLATE</span> lowercaselink USING '/_'.</span><br><span class="line">                ENDIF.</span><br><span class="line"></span><br><span class="line">                CONCATENATE copyofcurrentline</span><br><span class="line">                lowercaselink       "hyperlinkName</span><br><span class="line">                period htmlextension '"&gt;'</span><br><span class="line">                hyperlinkname</span><br><span class="line">                '&lt;/a&gt;'</span><br><span class="line">                period tail INTO copyofcurrentline.</span><br><span class="line"></span><br><span class="line"><span class="comment">*             Pad the string back out with spaces</span></span><br><span class="line">                <span class="keyword">WHILE</span> copylinelength &lt; currentlinelength.</span><br><span class="line">                  SHIFT copyofcurrentline RIGHT <span class="keyword">BY</span> 1 PLACES.</span><br><span class="line">                  copylinelength = copylinelength + 1.</span><br><span class="line">                ENDWHILE.</span><br><span class="line">                wacontent = copyofcurrentline.</span><br><span class="line">              <span class="keyword">ELSE</span>.</span><br><span class="line">                <span class="keyword">IF</span> NOT getdictstructures IS INITIAL.</span><br><span class="line"><span class="comment">*               Hyperlink for structure include</span></span><br><span class="line">                  copylinelength = <span class="literal">strlen</span>( copyofcurrentline ).</span><br><span class="line">                  <span class="keyword">SPLIT</span> copyofcurrentline AT space INTO head tail.</span><br><span class="line">                  SHIFT tail LEFT DELETING LEADING space.</span><br><span class="line">                  <span class="keyword">SPLIT</span> tail AT space INTO head tail.</span><br><span class="line"></span><br><span class="line">                  TRY.</span><br><span class="line">                      <span class="keyword">IF</span> tail+0(1) = 'Y' OR tail+0(1) = 'Z' OR tail+0(1) = 'y' OR tail+0(1) = 'z' OR tail <span class="keyword">CS</span> customernamerange.</span><br><span class="line">                        <span class="keyword">CLEAR</span> wacontent.</span><br><span class="line">                        SHIFT tail LEFT DELETING LEADING space.</span><br><span class="line">                        <span class="keyword">SPLIT</span> tail AT period INTO hyperlinkname tail.</span><br><span class="line">                        copyofcurrentline = '<span class="keyword">include</span> structure &lt;a href ='.</span><br><span class="line"></span><br><span class="line">                        lowercaselink = hyperlinkname.</span><br><span class="line">                        <span class="keyword">TRANSLATE</span> lowercaselink TO LOWER CASE.</span><br><span class="line"><span class="comment">*                   If we are running on a non UNIX environment we will need to remove forward slashes</span></span><br><span class="line">                        <span class="keyword">IF</span> frontendopsystem = non_unix.</span><br><span class="line">                          <span class="keyword">TRANSLATE</span> lowercaselink USING '/_'.</span><br><span class="line">                        ENDIF.</span><br><span class="line"></span><br><span class="line">                        CONCATENATE copyofcurrentline</span><br><span class="line">                        '"'</span><br><span class="line">                        lowercaselink    "hyperlinkName</span><br><span class="line">                        '/'</span><br><span class="line">                        'dictionary-'</span><br><span class="line">                        lowercaselink    "hyperlinkName</span><br><span class="line">                        period htmlextension</span><br><span class="line">                        '"&gt;'</span><br><span class="line">                        hyperlinkname</span><br><span class="line">                        '&lt;/a&gt;'</span><br><span class="line">                        period tail INTO copyofcurrentline.</span><br><span class="line"></span><br><span class="line"><span class="comment">*                   Pad the string back out with spaces</span></span><br><span class="line">                        <span class="keyword">WHILE</span> copylinelength &lt; currentlinelength.</span><br><span class="line">                          SHIFT copyofcurrentline RIGHT <span class="keyword">BY</span> 1 PLACES.</span><br><span class="line">                          copylinelength = copylinelength + 1.</span><br><span class="line">                        ENDWHILE.</span><br><span class="line">                        wacontent = copyofcurrentline.</span><br><span class="line">                      ENDIF.</span><br><span class="line">                    CATCH cx_sy_range_out_of_bounds INTO objruntimeerror.</span><br><span class="line">                  ENDTRY.</span><br><span class="line">                ENDIF.</span><br><span class="line">              ENDIF.</span><br><span class="line">            CATCH cx_sy_range_out_of_bounds INTO objruntimeerror.</span><br><span class="line">          ENDTRY.</span><br><span class="line">        ENDIF.</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line">        <span class="keyword">IF</span> wacontent+0(1) = asterix.</span><br><span class="line">          <span class="keyword">IF</span> mytabix = 1.</span><br><span class="line">            <span class="keyword">APPEND</span> `   &lt;div <span class="keyword">class</span>=<span class="string">"codeComment"</span>&gt;` TO htmltable.</span><br><span class="line">            incommentmode = true.</span><br><span class="line">          <span class="keyword">ELSE</span>.</span><br><span class="line">            <span class="keyword">IF</span> incommentmode = false.</span><br><span class="line">              <span class="keyword">APPEND</span> `   &lt;/div&gt;` TO htmltable.</span><br><span class="line">              <span class="keyword">APPEND</span> `   &lt;div <span class="keyword">class</span>=<span class="string">"codeComment"</span>&gt;` TO htmltable.</span><br><span class="line">              incommentmode = true.</span><br><span class="line">            ENDIF.</span><br><span class="line">          ENDIF.</span><br><span class="line">        ENDIF.</span><br><span class="line">      ENDIF.</span><br><span class="line"></span><br><span class="line">      htmltable = wacontent.</span><br><span class="line"></span><br><span class="line">      TRY.</span><br><span class="line">          <span class="keyword">IF</span> htmltable+0(1) = ` `.</span><br><span class="line">            <span class="keyword">WHILE</span> htmltable <span class="keyword">CS</span> ` `.</span><br><span class="line">              <span class="keyword">REPLACE</span> ` ` WITH '&amp;nbsp;' INTO htmltable.</span><br><span class="line">              <span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line">                <span class="keyword">EXIT</span>.</span><br><span class="line">              ENDIF.</span><br><span class="line">            ENDWHILE.</span><br><span class="line">          ENDIF.</span><br><span class="line">        CATCH cx_sy_range_out_of_bounds INTO objruntimeerror.</span><br><span class="line">      ENDTRY.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">ELSE</span>.</span><br><span class="line">      htmltable = ''.</span><br><span class="line">    ENDIF.</span><br><span class="line">    CONCATENATE htmltable '&lt;<span class="keyword">br</span> /&gt;' INTO htmltable.</span><br><span class="line">    <span class="keyword">APPEND</span> htmltable.</span><br><span class="line">  ENDLOOP.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">APPEND</span> `            &lt;/div&gt;` TO htmltable.</span><br><span class="line">  <span class="keyword">APPEND</span> `          &lt;/td&gt;`  TO htmltable.</span><br><span class="line">  <span class="keyword">APPEND</span> `        &lt;/tr&gt;` TO htmltable.</span><br><span class="line">  <span class="keyword">APPEND</span> `      &lt;/<span class="keyword">table</span>&gt;` TO htmltable.</span><br><span class="line">  <span class="keyword">APPEND</span> `      &lt;/td&gt;` TO htmltable.</span><br><span class="line">  <span class="keyword">APPEND</span> `      &lt;/tr&gt;` TO htmltable.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Add a html footer to the table</span></span><br><span class="line">  PERFORM addhtmlfooter USING htmltable[].</span><br><span class="line"></span><br><span class="line">  icontents[] = htmltable[].</span><br><span class="line">ENDFORM.                                                                                         "convertFunctionToHtml</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  buildColumnHeaders... build table column names</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> buildddcolumnheaders USING iloccolumncaptions LIKE dumihtml[].</span><br><span class="line"></span><br><span class="line">  <span class="keyword">APPEND</span> 'Row' TO iloccolumncaptions.</span><br><span class="line">  <span class="keyword">APPEND</span> 'Field name' TO iloccolumncaptions.</span><br><span class="line">  <span class="keyword">APPEND</span> 'Position' TO iloccolumncaptions.</span><br><span class="line">  <span class="keyword">APPEND</span> 'Key' TO iloccolumncaptions.</span><br><span class="line">  <span class="keyword">APPEND</span> 'Data element' TO iloccolumncaptions.</span><br><span class="line">  <span class="keyword">APPEND</span> 'Domain' TO iloccolumncaptions.</span><br><span class="line">  <span class="keyword">APPEND</span> 'Datatype' TO iloccolumncaptions.</span><br><span class="line">  <span class="keyword">APPEND</span> 'Length' TO iloccolumncaptions.</span><br><span class="line">  <span class="keyword">APPEND</span> 'Lowercase' TO iloccolumncaptions.</span><br><span class="line">  <span class="keyword">APPEND</span> 'Domain text' TO iloccolumncaptions.</span><br><span class="line">ENDFORM.                                                                                            "buildColumnHeaders</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  buildDomColumnHeaders... build table column names</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> builddomcolumnheaders USING iloccolumncaptions LIKE dumihtml[].</span><br><span class="line"></span><br><span class="line">  <span class="keyword">APPEND</span> 'Domain Name' TO iloccolumncaptions.</span><br><span class="line">  <span class="keyword">APPEND</span> 'Value Low' TO iloccolumncaptions.</span><br><span class="line">  <span class="keyword">APPEND</span> 'Value High' TO iloccolumncaptions.</span><br><span class="line">  <span class="keyword">APPEND</span> 'Text' TO iloccolumncaptions.</span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  buildColumnHeadersTableTypes</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> buildcolumnheaderstabletypes  USING iloccolumncaptions LIKE dumihtml[].</span><br><span class="line"></span><br><span class="line">  <span class="keyword">APPEND</span> 'Row' TO iloccolumncaptions.</span><br><span class="line">  <span class="keyword">APPEND</span> 'Name of <span class="keyword">table</span> <span class="keyword">type</span>' TO iloccolumncaptions.</span><br><span class="line">  <span class="keyword">APPEND</span> 'Name of row <span class="keyword">type</span> <span class="keyword">for</span> <span class="keyword">table</span> types' TO iloccolumncaptions.</span><br><span class="line">  <span class="keyword">APPEND</span> 'Category of <span class="keyword">table</span> <span class="keyword">type</span> (<span class="keyword">range</span> or general <span class="keyword">table</span> <span class="keyword">type</span>)' TO iloccolumncaptions.</span><br><span class="line">  <span class="keyword">APPEND</span> 'Elem. <span class="keyword">type</span> of LOW and HIGH components of a Ranges <span class="keyword">type</span>' TO iloccolumncaptions.</span><br><span class="line">  <span class="keyword">APPEND</span> '<span class="keyword">Type</span> of Object Referenced' TO iloccolumncaptions.</span><br><span class="line">  <span class="keyword">APPEND</span> 'Initial <span class="keyword">Line</span> Number <span class="keyword">for</span> <span class="keyword">Table</span> Types' TO iloccolumncaptions.</span><br><span class="line">  <span class="keyword">APPEND</span> 'Description' TO iloccolumncaptions.</span><br><span class="line">ENDFORM.                                                                                 " BUILDCOLUMNHEADERSTABLETYPES</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* addHTMLHeader...  add a html formatted header to our output table</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> addhtmlheader USING ilocheader LIKE dumihtml[]</span><br><span class="line">      VALUE(title)</span><br><span class="line">      VALUE(addbackground) <span class="keyword">TYPE</span> abap_bool</span><br><span class="line">      VALUE(stylesheettype) <span class="keyword">TYPE</span> char1.</span><br><span class="line"></span><br><span class="line">  DATA: waheader <span class="keyword">TYPE</span> string.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">APPEND</span> '&lt;!DOCTYPE html PUBLIC <span class="string">"-//W3C//DTD XHTML 1.1//EN"</span> <span class="string">"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"</span>&gt;' TO ilocheader.</span><br><span class="line">  <span class="keyword">APPEND</span> '&lt;html xmlns=<span class="string">"http://www.w3.org/1999/xhtml"</span>&gt;' TO ilocheader.</span><br><span class="line">  <span class="keyword">APPEND</span> '&lt;head&gt;' TO ilocheader.</span><br><span class="line"><span class="comment">*     append '&lt;meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" /&gt;' to iLocHeader.</span></span><br><span class="line">  <span class="keyword">APPEND</span> '&lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"application/xhtml+xml; charset=ISO-8859-1"</span> /&gt;' TO ilocheader.</span><br><span class="line"></span><br><span class="line">  CONCATENATE '&lt;title&gt;' title '&lt;/title&gt;' INTO waheader.</span><br><span class="line">  <span class="keyword">APPEND</span> waheader TO ilocheader.</span><br><span class="line"></span><br><span class="line">  CASE stylesheettype.</span><br><span class="line">    WHEN ss_code.</span><br><span class="line">      PERFORM addcodestyles USING ilocheader</span><br><span class="line">            addbackground.</span><br><span class="line">    WHEN ss_table.</span><br><span class="line">      PERFORM addtablestyles USING ilocheader</span><br><span class="line">            addbackground.</span><br><span class="line">  ENDCASE.</span><br><span class="line"></span><br><span class="line">  PERFORM addgenericstyles USING ilocheader</span><br><span class="line">        addbackground.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">APPEND</span> '&lt;/head&gt;' TO ilocheader.</span><br><span class="line">ENDFORM.                                                                                                 "addHTMLHeader</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* addCodeStyles... Add the stylesheets needed for HTML output</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> addcodestyles USING ilocheader LIKE dumihtml[]</span><br><span class="line">      VALUE(addbackground) <span class="keyword">TYPE</span> abap_bool.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">APPEND</span> '&lt;style <span class="keyword">type</span>=<span class="string">"text/css"</span>&gt;' TO ilocheader.</span><br><span class="line">  <span class="keyword">APPEND</span> `.code&#123; font-family:<span class="string">"Courier New"</span>, Courier, monospace; color:#000; font-size:14px; background-color:#F2F4F7 &#125;` TO ilocheader.</span><br><span class="line">  <span class="keyword">APPEND</span> `  .codeComment &#123;font-family:<span class="string">"Courier New"</span>, Courier, monospace; color:#0000F0; font-size:14px; background-color:#F2F4F7 &#125;` TO ilocheader.</span><br><span class="line">  <span class="keyword">APPEND</span> `  .normalBold&#123; font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; font-weight:800 &#125;` TO ilocheader.</span><br><span class="line">  <span class="keyword">APPEND</span> `  .normalBoldLarge&#123; font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 &#125;` TO ilocheader.</span><br><span class="line">  <span class="keyword">APPEND</span> '&lt;/style&gt;' TO ilocheader.</span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* addTableStyles... Add the stylesheets needed for HTML output</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> addtablestyles USING ilocheader LIKE dumihtml[]</span><br><span class="line">      VALUE(addbackground) <span class="keyword">TYPE</span> abap_bool.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">APPEND</span> '&lt;style <span class="keyword">type</span>=<span class="string">"text/css"</span>&gt;' TO ilocheader.</span><br><span class="line">  <span class="keyword">APPEND</span> `  th&#123;text-align:left&#125;` TO ilocheader.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">APPEND</span> `  .cell&#123;` TO ilocheader.</span><br><span class="line">  <span class="keyword">APPEND</span> `     font-family:<span class="string">"Courier New"</span>, Courier, monospace;` TO ilocheader.</span><br><span class="line">  <span class="keyword">APPEND</span> `     color:#000;` TO ilocheader.</span><br><span class="line">  <span class="keyword">APPEND</span> `     font-size:12px;` TO ilocheader.</span><br><span class="line">  <span class="keyword">APPEND</span> `     background-color:#F2F4F7;` TO ilocheader.</span><br><span class="line">  <span class="keyword">APPEND</span> `  &#125;` TO ilocheader.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">APPEND</span> `  .cell td &#123; border: thin solid #ccc; &#125;` TO ilocheader.</span><br><span class="line">  <span class="keyword">APPEND</span> `&lt;/style&gt;` TO ilocheader.</span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* addTableStyles... Add the stylesheets needed for HTML output</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> addgenericstyles USING ilocheader LIKE dumihtml[]</span><br><span class="line">      VALUE(addbackground) <span class="keyword">TYPE</span> abap_bool.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">APPEND</span> '&lt;style <span class="keyword">type</span>=<span class="string">"text/css"</span>&gt;' TO ilocheader.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">APPEND</span> `  .normal&#123; font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px &#125;` TO ilocheader.</span><br><span class="line">  <span class="keyword">APPEND</span> `  .footer&#123; font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; text-align: center &#125;` TO ilocheader.</span><br><span class="line">  <span class="keyword">APPEND</span> `  h2&#123; font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 &#125;` TO ilocheader.</span><br><span class="line">  <span class="keyword">APPEND</span> `  h3&#123; font-family:Arial, Helvetica, sans-serif; color:#000; font-size:14px; font-weight:800 &#125;` TO ilocheader.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">APPEND</span> `  .outerTable&#123;` TO ilocheader.</span><br><span class="line">  <span class="keyword">IF</span> NOT addbackground IS INITIAL.</span><br><span class="line">    <span class="keyword">APPEND</span> `   background-color:#E0E7ED;` TO ilocheader.</span><br><span class="line">  ENDIF.</span><br><span class="line">  <span class="keyword">APPEND</span> `   width:100%;` TO ilocheader.</span><br><span class="line">  <span class="keyword">APPEND</span> `   border-top-width: thin;` TO ilocheader.</span><br><span class="line">  <span class="keyword">APPEND</span> `   border-right-width: thin;` TO ilocheader.</span><br><span class="line">  <span class="keyword">APPEND</span> `   border-right-width: thin;` TO ilocheader.</span><br><span class="line">  <span class="keyword">APPEND</span> `   border-left-width: thin;` TO ilocheader.</span><br><span class="line">  <span class="keyword">APPEND</span> `   border-top-style: solid;` TO ilocheader.</span><br><span class="line">  <span class="keyword">APPEND</span> `   border-right-style: solid;` TO ilocheader.</span><br><span class="line">  <span class="keyword">APPEND</span> `   border-bottom-style: solid;` TO ilocheader.</span><br><span class="line">  <span class="keyword">APPEND</span> `   border-left-style: solid;` TO ilocheader.</span><br><span class="line">  <span class="keyword">APPEND</span> `  &#125;` TO ilocheader.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">APPEND</span> `  .innerTable&#123;` TO ilocheader.</span><br><span class="line">  <span class="keyword">IF</span> NOT addbackground IS INITIAL.</span><br><span class="line">    <span class="keyword">APPEND</span> `   background-color:#F2F4F7;` TO ilocheader.</span><br><span class="line">  ENDIF.</span><br><span class="line">  <span class="keyword">APPEND</span> `   width:100%;` TO ilocheader.</span><br><span class="line">  <span class="keyword">APPEND</span> `   border-top-width: thin;` TO ilocheader.</span><br><span class="line">  <span class="keyword">APPEND</span> `   border-right-width: thin;` TO ilocheader.</span><br><span class="line">  <span class="keyword">APPEND</span> `   border-bottom-width: thin;` TO ilocheader.</span><br><span class="line">  <span class="keyword">APPEND</span> `   border-left-width: thin;` TO ilocheader.</span><br><span class="line">  <span class="keyword">APPEND</span> `   border-top-style: solid;` TO ilocheader.</span><br><span class="line">  <span class="keyword">APPEND</span> `   border-right-style: solid;` TO ilocheader.</span><br><span class="line">  <span class="keyword">APPEND</span> `   border-bottom-style: solid;` TO ilocheader.</span><br><span class="line">  <span class="keyword">APPEND</span> `   border-left-style: solid;` TO ilocheader.</span><br><span class="line">  <span class="keyword">APPEND</span> `  &#125;` TO ilocheader.</span><br><span class="line">  <span class="keyword">APPEND</span> '&lt;/style&gt;' TO ilocheader.</span><br><span class="line">ENDFORM.</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* addHTMLFooter...  add a html formatted footer to our output table</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> addhtmlfooter USING ilocfooter LIKE dumihtml[].</span><br><span class="line"></span><br><span class="line">  DATA: footermessage <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: wafooter <span class="keyword">TYPE</span> string.</span><br><span class="line"></span><br><span class="line">  PERFORM buildfootermessage USING footermessage.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">APPEND</span> `   &lt;tr&gt;` TO ilocfooter.</span><br><span class="line">  CONCATENATE '&lt;td <span class="keyword">class</span>=<span class="string">"footer"</span>&gt;' footermessage '&lt;/td&gt;' INTO wafooter.</span><br><span class="line">  <span class="keyword">APPEND</span> wafooter TO ilocfooter.</span><br><span class="line">  <span class="keyword">APPEND</span> `   &lt;/tr&gt;` TO ilocfooter.</span><br><span class="line">  <span class="keyword">APPEND</span> `&lt;/<span class="keyword">table</span>&gt;` TO ilocfooter.</span><br><span class="line">  <span class="keyword">APPEND</span> '&lt;/body&gt;' TO ilocfooter.</span><br><span class="line">  <span class="keyword">APPEND</span> '&lt;/html&gt;' TO ilocfooter.</span><br><span class="line">ENDFORM.                                                                                                 "addHTMLFooter</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* buildFooterMessage...Returns a footer message based on the output file type.</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> buildfootermessage USING returnmessage.</span><br><span class="line"></span><br><span class="line">  CONCATENATE `Extracted <span class="keyword">by</span> Mass Download <span class="keyword">version</span> `</span><br><span class="line">  versionno ` - <span class="keyword">E</span>.<span class="keyword">G</span>.Mellodew. 1998-`</span><br><span class="line">  sy-datum+0(4) `. Sap Release ` sy-saprl INTO returnmessage.</span><br><span class="line">ENDFORM.                                                                                            "buildFooterMessage</span><br><span class="line"></span><br><span class="line"><span class="comment">***********************************************************************************************************************</span></span><br><span class="line"><span class="comment">********************************************DISPLAY ROUTINES***********************************************************</span></span><br><span class="line"><span class="comment">***********************************************************************************************************************</span></span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  fillTreeNodeTables...</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> filltreenodetables USING ilocdictionary LIKE idictionary[]</span><br><span class="line">      iloctreedisplay LIKE itreedisplay[]</span><br><span class="line">      VALUE(runtime).</span><br><span class="line"></span><br><span class="line">  DATA: tablelines <span class="keyword">TYPE</span> i.</span><br><span class="line">  DATA: watreedisplay LIKE snodetext.</span><br><span class="line">  FIELD-SYMBOLS: &lt;wadictionary&gt; <span class="keyword">TYPE</span> tdicttable.</span><br><span class="line">  DATA: tablelinesstring <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: runtimechar(10).</span><br><span class="line">  DATA: sublevel <span class="keyword">TYPE</span> string.</span><br><span class="line"></span><br><span class="line">  tablelines = lines( ilocdictionary ).</span><br><span class="line">  tablelinesstring = tablelines.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> tablelines = 1.</span><br><span class="line">    CONCATENATE tablelinesstring '<span class="keyword">table</span> downloaded' INTO watreedisplay-text2 SEPARATED <span class="keyword">BY</span> space.</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line">    CONCATENATE tablelinesstring 'tables downloaded' INTO watreedisplay-text2 SEPARATED <span class="keyword">BY</span> space.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">  WRITE runtime TO runtimechar.</span><br><span class="line">  CONCATENATE watreedisplay-text2 '- runtime' runtimechar INTO watreedisplay-text2 SEPARATED <span class="keyword">BY</span> space.</span><br><span class="line"></span><br><span class="line"><span class="comment">* include header display record.</span></span><br><span class="line">  watreedisplay-tlevel = '1'.</span><br><span class="line">  watreedisplay-tlength2  = 60.</span><br><span class="line">  watreedisplay-tcolor2    = 1.</span><br><span class="line">  <span class="keyword">APPEND</span> watreedisplay TO iloctreedisplay.</span><br><span class="line"></span><br><span class="line">  LOOP AT ilocdictionary ASSIGNING &lt;wadictionary&gt;.</span><br><span class="line">    watreedisplay-tlevel = '2'.</span><br><span class="line">    watreedisplay-text2 = &lt;wadictionary&gt;-tablename.</span><br><span class="line">    watreedisplay-tcolor2    = 3.</span><br><span class="line">    watreedisplay-tlength3   = 80.</span><br><span class="line">    watreedisplay-tcolor3    = 3.</span><br><span class="line">    watreedisplay-tpos3      = 60.</span><br><span class="line">    CONCATENATE 'Dictionary:' &lt;wadictionary&gt;-tabletitle INTO watreedisplay-text3 SEPARATED <span class="keyword">BY</span> space.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">APPEND</span> watreedisplay TO iloctreedisplay.</span><br><span class="line">  ENDLOOP.</span><br><span class="line">ENDFORM.                                                                                            "fillTreeNodeTables</span><br><span class="line"></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*   fillTreeNodeXslt...</span></span><br><span class="line"><span class="comment">*-------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> filltreenodexslt USING iloctransformations LIKE itransformations[]</span><br><span class="line">      iloctreedisplay LIKE itreedisplay[]</span><br><span class="line">      VALUE(runtime).</span><br><span class="line"></span><br><span class="line">  DATA: tablelines <span class="keyword">TYPE</span> i.</span><br><span class="line">  DATA: watreedisplay LIKE snodetext.</span><br><span class="line">  FIELD-SYMBOLS: &lt;watransformation&gt; <span class="keyword">TYPE</span> ttransformation.</span><br><span class="line">  DATA: tablelinesstring <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: runtimechar(10).</span><br><span class="line"></span><br><span class="line">  tablelines = lines( iloctransformations ).</span><br><span class="line">  tablelinesstring = tablelines.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> tablelines = 1.</span><br><span class="line">    CONCATENATE tablelinesstring ` XSLT <span class="keyword">program</span> downloaded` INTO watreedisplay-text2.</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line">    CONCATENATE tablelinesstring ` XSLT programs downloaded` INTO watreedisplay-text2.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">  WRITE runtime TO runtimechar.</span><br><span class="line"></span><br><span class="line">  CONCATENATE watreedisplay-text2 ` - runtime ` runtimechar INTO watreedisplay-text2.</span><br><span class="line"><span class="comment">* include header display record.</span></span><br><span class="line">  watreedisplay-tlevel = '2'.</span><br><span class="line">  watreedisplay-tlength2  = 60.</span><br><span class="line">  watreedisplay-tcolor2    = 1.</span><br><span class="line">  <span class="keyword">APPEND</span> watreedisplay TO itreedisplay.</span><br><span class="line"></span><br><span class="line">  LOOP AT iloctransformations ASSIGNING &lt;watransformation&gt;.</span><br><span class="line"><span class="comment">*   Main programs.</span></span><br><span class="line">    watreedisplay-tlevel = '3'.</span><br><span class="line">    watreedisplay-text2 = &lt;watransformation&gt;-xsltname.</span><br><span class="line">    watreedisplay-tcolor2    = 1.</span><br><span class="line"><span class="comment">*   Description</span></span><br><span class="line">    watreedisplay-tlength3   = 80.</span><br><span class="line">    watreedisplay-tcolor3    = 1.</span><br><span class="line">    watreedisplay-tpos3      = 60.</span><br><span class="line">    CONCATENATE `XSLT: ` &lt;watransformation&gt;-xsltdesc INTO watreedisplay-text3.</span><br><span class="line">    <span class="keyword">APPEND</span> watreedisplay TO itreedisplay.</span><br><span class="line">  ENDLOOP.</span><br><span class="line">ENDFORM.                                                                           " FILLTREENODEXSLT</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  fillTreeNodeMessages...</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> filltreenodemessages USING ilocmessages LIKE imessages[]</span><br><span class="line">      iloctreedisplay LIKE itreedisplay[]</span><br><span class="line">      VALUE(runtime).</span><br><span class="line"></span><br><span class="line">  DATA: tablelines <span class="keyword">TYPE</span> i.</span><br><span class="line">  DATA: watreedisplay LIKE snodetext.</span><br><span class="line">  FIELD-SYMBOLS: &lt;wamessage&gt; <span class="keyword">TYPE</span> tmessage.</span><br><span class="line">  DATA: tablelinesstring <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: runtimechar(10).</span><br><span class="line"></span><br><span class="line">  <span class="keyword">SORT</span> ilocmessages ASCENDING <span class="keyword">BY</span> arbgb.</span><br><span class="line"></span><br><span class="line">  LOOP AT ilocmessages ASSIGNING &lt;wamessage&gt;.</span><br><span class="line">    AT NEW arbgb.</span><br><span class="line">      tablelines = tablelines + 1.</span><br><span class="line">    ENDAT.</span><br><span class="line">  ENDLOOP.</span><br><span class="line">  tablelinesstring = tablelines.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> tablelines = 1.</span><br><span class="line">    CONCATENATE tablelinesstring 'message <span class="keyword">class</span> downloaded' INTO watreedisplay-text2 SEPARATED <span class="keyword">BY</span> space.</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line">    CONCATENATE tablelinesstring 'message classes downloaded' INTO watreedisplay-text2 SEPARATED <span class="keyword">BY</span> space.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">  WRITE runtime TO runtimechar.</span><br><span class="line">  CONCATENATE watreedisplay-text2 '- runtime' runtimechar INTO watreedisplay-text2 SEPARATED <span class="keyword">BY</span> space.</span><br><span class="line"></span><br><span class="line"><span class="comment">* include header display record.</span></span><br><span class="line">  watreedisplay-tlevel = '1'.</span><br><span class="line">  watreedisplay-tlength2 = 60.</span><br><span class="line">  watreedisplay-tcolor2 = 1.</span><br><span class="line">  <span class="keyword">APPEND</span> watreedisplay TO iloctreedisplay.</span><br><span class="line"></span><br><span class="line">  LOOP AT ilocmessages ASSIGNING &lt;wamessage&gt;.</span><br><span class="line">    AT NEW arbgb.</span><br><span class="line">      watreedisplay-tlevel = '2'.</span><br><span class="line">      watreedisplay-text2 = &lt;wamessage&gt;-arbgb.</span><br><span class="line">      watreedisplay-tcolor2    = 5.</span><br><span class="line">      watreedisplay-tlength3   = 80.</span><br><span class="line">      watreedisplay-tcolor3    = 5.</span><br><span class="line">      watreedisplay-tpos3      = 60.</span><br><span class="line">      watreedisplay-text3 = &lt;wamessage&gt;-stext.</span><br><span class="line">      CONCATENATE 'Message <span class="keyword">class</span>:'  watreedisplay-text3 INTO watreedisplay-text3 SEPARATED <span class="keyword">BY</span> space.</span><br><span class="line">      <span class="keyword">APPEND</span> watreedisplay TO iloctreedisplay.</span><br><span class="line">    ENDAT.</span><br><span class="line">  ENDLOOP.</span><br><span class="line">ENDFORM.                                                                                          "fillTreeNodeMessages</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  fillTreeNodeTableTypes</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> filltreenodetabletypes USING iloctabletypes LIKE itabletypes[]</span><br><span class="line">      iloctreedisplay LIKE itreedisplay[]</span><br><span class="line">      VALUE(runtime).</span><br><span class="line"></span><br><span class="line">  DATA: tablelines <span class="keyword">TYPE</span> i.</span><br><span class="line">  DATA: watreedisplay LIKE snodetext.</span><br><span class="line">  FIELD-SYMBOLS: &lt;watabletype&gt; LIKE <span class="keyword">LINE</span> OF iloctabletypes.</span><br><span class="line">  DATA: tablelinesstring <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: runtimechar(10).</span><br><span class="line">  DATA: sublevel <span class="keyword">TYPE</span> string.</span><br><span class="line"></span><br><span class="line">  tablelines = lines( iloctabletypes ).</span><br><span class="line">  tablelinesstring = tablelines.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> tablelines = 1.</span><br><span class="line">    CONCATENATE tablelinesstring '<span class="keyword">table</span> <span class="keyword">type</span> downloaded' INTO watreedisplay-text2 SEPARATED <span class="keyword">BY</span> space.</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line">    CONCATENATE tablelinesstring '<span class="keyword">table</span> types downloaded' INTO watreedisplay-text2 SEPARATED <span class="keyword">BY</span> space.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">  WRITE runtime TO runtimechar.</span><br><span class="line">  CONCATENATE watreedisplay-text2 '- runtime' runtimechar INTO watreedisplay-text2 SEPARATED <span class="keyword">BY</span> space.</span><br><span class="line"></span><br><span class="line"><span class="comment">* include header display record.</span></span><br><span class="line">  watreedisplay-tlevel = '2'.</span><br><span class="line">  watreedisplay-tlength2  = 60.</span><br><span class="line">  watreedisplay-tcolor2    = 1.</span><br><span class="line">  <span class="keyword">APPEND</span> watreedisplay TO iloctreedisplay.</span><br><span class="line"></span><br><span class="line">  LOOP AT iloctabletypes ASSIGNING &lt;watabletype&gt;.</span><br><span class="line">    watreedisplay-tlevel = '3'.</span><br><span class="line">    watreedisplay-text2 = &lt;watabletype&gt;-typename.</span><br><span class="line">    watreedisplay-tcolor2    = 3.</span><br><span class="line">    watreedisplay-tlength3   = 80.</span><br><span class="line">    watreedisplay-tcolor3    = 3.</span><br><span class="line">    watreedisplay-tpos3      = 60.</span><br><span class="line">    CONCATENATE 'Dictionary:' &lt;watabletype&gt;-ddtext INTO watreedisplay-text3 SEPARATED <span class="keyword">BY</span> space.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">APPEND</span> watreedisplay TO iloctreedisplay.</span><br><span class="line">  ENDLOOP.</span><br><span class="line">ENDFORM.                                                                                        " FILLTREENODETABLETYPES</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  fillTreeNodeFunctions...</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> filltreenodefunctions USING ilocfunctions LIKE ifunctions[]</span><br><span class="line">      iloctreedisplay LIKE itreedisplay[]</span><br><span class="line">      VALUE(runtime).</span><br><span class="line"></span><br><span class="line">  DATA: tablelines <span class="keyword">TYPE</span> i.</span><br><span class="line">  DATA: watreedisplay LIKE snodetext.</span><br><span class="line">  FIELD-SYMBOLS: &lt;wafunction&gt; <span class="keyword">TYPE</span> tfunction.</span><br><span class="line">  FIELD-SYMBOLS: &lt;wascreen&gt; <span class="keyword">TYPE</span> tscreenflow.</span><br><span class="line">  FIELD-SYMBOLS: &lt;waguititle&gt; <span class="keyword">TYPE</span> tguititle.</span><br><span class="line">  FIELD-SYMBOLS: &lt;wadictionary&gt; <span class="keyword">TYPE</span> tdicttable.</span><br><span class="line">  FIELD-SYMBOLS: &lt;wainclude&gt; <span class="keyword">TYPE</span> tinclude.</span><br><span class="line">  FIELD-SYMBOLS: &lt;wamessage&gt; <span class="keyword">TYPE</span> tmessage.</span><br><span class="line">  FIELD-SYMBOLS: &lt;watabletype&gt; <span class="keyword">TYPE</span> ttabletype.</span><br><span class="line">  FIELD-SYMBOLS: &lt;watransformation&gt; <span class="keyword">TYPE</span> ttransformation.</span><br><span class="line">  DATA: tablelinesstring <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: runtimechar(10).</span><br><span class="line"></span><br><span class="line">  <span class="keyword">SORT</span> ilocfunctions ASCENDING <span class="keyword">BY</span> functionname.</span><br><span class="line"></span><br><span class="line">  tablelines = lines( ilocfunctions ).</span><br><span class="line">  tablelinesstring = tablelines.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> tablelines = 1.</span><br><span class="line">    CONCATENATE tablelinesstring ` function downloaded` INTO watreedisplay-text2.</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line">    CONCATENATE tablelinesstring ` functions downloaded` INTO watreedisplay-text2.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">  WRITE runtime TO runtimechar.</span><br><span class="line"></span><br><span class="line">  CONCATENATE watreedisplay-text2 ` - runtime ` runtimechar INTO watreedisplay-text2.</span><br><span class="line"><span class="comment">* include header display record.</span></span><br><span class="line">  watreedisplay-tlevel = '1'.</span><br><span class="line">  watreedisplay-tlength2  = 60.</span><br><span class="line">  watreedisplay-tcolor2    = 1.</span><br><span class="line">  <span class="keyword">APPEND</span> watreedisplay TO iloctreedisplay.</span><br><span class="line"></span><br><span class="line"><span class="comment">* Lets fill the detail in</span></span><br><span class="line">  LOOP AT ilocfunctions ASSIGNING &lt;wafunction&gt;.</span><br><span class="line">    watreedisplay-tlevel = 2.</span><br><span class="line">    watreedisplay-text2 = &lt;wafunction&gt;-functionname.</span><br><span class="line">    watreedisplay-tcolor2    = 7.</span><br><span class="line">    watreedisplay-tlength3   = 80.</span><br><span class="line">    watreedisplay-tcolor3    = 7.</span><br><span class="line">    watreedisplay-tpos3      = 60.</span><br><span class="line">    CONCATENATE `Function: ` &lt;wafunction&gt;-functionname INTO watreedisplay-text3.</span><br><span class="line">    <span class="keyword">APPEND</span> watreedisplay TO iloctreedisplay.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Screens.</span></span><br><span class="line">    LOOP AT &lt;wafunction&gt;-iscreenflow ASSIGNING &lt;wascreen&gt;.</span><br><span class="line">      watreedisplay-tlevel = '2'.</span><br><span class="line">      watreedisplay-text2 = &lt;wascreen&gt;-screen.</span><br><span class="line">      watreedisplay-tcolor2    = 6.</span><br><span class="line">      watreedisplay-tlength3   = 80.</span><br><span class="line">      watreedisplay-tcolor3    = 6.</span><br><span class="line">      watreedisplay-tpos3      = 60.</span><br><span class="line">      watreedisplay-text3 = 'Screen'.</span><br><span class="line">      <span class="keyword">APPEND</span> watreedisplay TO itreedisplay.</span><br><span class="line">    ENDLOOP.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   GUI Title.</span></span><br><span class="line">    LOOP AT &lt;wafunction&gt;-iguititle ASSIGNING &lt;waguititle&gt;.</span><br><span class="line">      watreedisplay-tlevel = '2'.</span><br><span class="line">      watreedisplay-text2 = &lt;waguititle&gt;-obj_code.</span><br><span class="line">      watreedisplay-tcolor2    = 6.</span><br><span class="line">      watreedisplay-tlength3   = 80.</span><br><span class="line">      watreedisplay-tcolor3    = 6.</span><br><span class="line">      watreedisplay-tpos3      = 60.</span><br><span class="line">      watreedisplay-text3 = 'GUI Title'.</span><br><span class="line">      <span class="keyword">APPEND</span> watreedisplay TO itreedisplay.</span><br><span class="line">    ENDLOOP.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Fill in the tree with include information</span></span><br><span class="line">    LOOP AT &lt;wafunction&gt;-iincludes ASSIGNING &lt;wainclude&gt;.</span><br><span class="line">      watreedisplay-tlevel = 3.</span><br><span class="line">      watreedisplay-text2 =  &lt;wainclude&gt;-includename.</span><br><span class="line">      watreedisplay-tcolor2    = 4.</span><br><span class="line">      watreedisplay-tlength3   = 80.</span><br><span class="line">      watreedisplay-tcolor3    = 4.</span><br><span class="line">      watreedisplay-tpos3      = 60.</span><br><span class="line">      CONCATENATE `<span class="keyword">Include</span>:   ` &lt;wainclude&gt;-includetitle INTO watreedisplay-text3.</span><br><span class="line">      <span class="keyword">APPEND</span> watreedisplay TO iloctreedisplay.</span><br><span class="line">    ENDLOOP.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   fill in the tree with dictionary information</span></span><br><span class="line">    LOOP AT &lt;wafunction&gt;-idictstruct ASSIGNING &lt;wadictionary&gt;.</span><br><span class="line">      watreedisplay-tlevel = 3.</span><br><span class="line">      watreedisplay-text2 =  &lt;wadictionary&gt;-tablename.</span><br><span class="line">      watreedisplay-tcolor2    = 3.</span><br><span class="line">      watreedisplay-tlength3   = 80.</span><br><span class="line">      watreedisplay-tcolor3    = 3.</span><br><span class="line">      watreedisplay-tpos3      = 60.</span><br><span class="line">      CONCATENATE `Dictionary:` &lt;wadictionary&gt;-tabletitle INTO watreedisplay-text3.</span><br><span class="line">      <span class="keyword">APPEND</span> watreedisplay TO iloctreedisplay.</span><br><span class="line">    ENDLOOP.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   fill in the tree with Table type information</span></span><br><span class="line">    LOOP AT &lt;wafunction&gt;-itabletypes ASSIGNING &lt;watabletype&gt;.</span><br><span class="line">      watreedisplay-tlevel = 3.</span><br><span class="line">      watreedisplay-text2 =  &lt;watabletype&gt;-typename.</span><br><span class="line">      watreedisplay-tcolor2    = 3.</span><br><span class="line">      watreedisplay-tlength3   = 80.</span><br><span class="line">      watreedisplay-tcolor3    = 3.</span><br><span class="line">      watreedisplay-tpos3      = 60.</span><br><span class="line">      CONCATENATE `<span class="keyword">Table</span> <span class="keyword">Type</span>:    ` &lt;watabletype&gt;-ddtext INTO watreedisplay-text3.</span><br><span class="line">      <span class="keyword">APPEND</span> watreedisplay TO iloctreedisplay.</span><br><span class="line">    ENDLOOP.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   fill in the tree with transformation information</span></span><br><span class="line">    LOOP AT &lt;wafunction&gt;-itransformations[] ASSIGNING &lt;watransformation&gt;.</span><br><span class="line">      watreedisplay-tlevel = 3.</span><br><span class="line">      watreedisplay-text2 =  &lt;watransformation&gt;-xsltname.</span><br><span class="line">      watreedisplay-tcolor2    = 3.</span><br><span class="line">      watreedisplay-tlength3   = 80.</span><br><span class="line">      watreedisplay-tcolor3    = 3.</span><br><span class="line">      watreedisplay-tpos3      = 60.</span><br><span class="line">      CONCATENATE `<span class="keyword">Table</span> <span class="keyword">Type</span>:    ` &lt;watransformation&gt;-xsltdesc INTO watreedisplay-text3.</span><br><span class="line">      <span class="keyword">APPEND</span> watreedisplay TO iloctreedisplay.</span><br><span class="line">    ENDLOOP.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   fill in the tree with message information</span></span><br><span class="line">    <span class="keyword">SORT</span> &lt;wafunction&gt;-imessages[] ASCENDING <span class="keyword">BY</span> arbgb.</span><br><span class="line">    LOOP AT &lt;wafunction&gt;-imessages ASSIGNING &lt;wamessage&gt;.</span><br><span class="line">      AT NEW arbgb.</span><br><span class="line">        watreedisplay-tlevel = 3.</span><br><span class="line">        watreedisplay-text2 = &lt;wamessage&gt;-arbgb.</span><br><span class="line">        watreedisplay-tcolor2    = 5.</span><br><span class="line">        watreedisplay-tlength3   = 80.</span><br><span class="line">        watreedisplay-tcolor3    = 5.</span><br><span class="line">        watreedisplay-tpos3      = 60.</span><br><span class="line"></span><br><span class="line"><span class="comment">*       Select the message class text if we do not have it already</span></span><br><span class="line">        <span class="keyword">IF</span> &lt;wamessage&gt;-stext IS INITIAL.</span><br><span class="line">          SELECT SINGLE stext FROM t100a</span><br><span class="line">          INTO &lt;wamessage&gt;-stext</span><br><span class="line">          WHERE arbgb = &lt;wamessage&gt;-arbgb.</span><br><span class="line">        ENDIF.</span><br><span class="line"></span><br><span class="line">        watreedisplay-text3 = &lt;wamessage&gt;-stext.</span><br><span class="line">        CONCATENATE `Message <span class="keyword">class</span>: `  watreedisplay-text3 INTO watreedisplay-text3.</span><br><span class="line">        <span class="keyword">APPEND</span> watreedisplay TO iloctreedisplay.</span><br><span class="line">      ENDAT.</span><br><span class="line">    ENDLOOP.</span><br><span class="line">  ENDLOOP.</span><br><span class="line">ENDFORM.                                                                                         "fillTreeNodeFunctions</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  fillTreeNodePrograms</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> filltreenodeprograms USING ilocprograms LIKE iprograms[]</span><br><span class="line">      ilocfunctions LIKE ifunctions[]</span><br><span class="line">      iloctreedisplay LIKE itreedisplay[]</span><br><span class="line">      VALUE(runtime).</span><br><span class="line"></span><br><span class="line">  DATA: tablelines <span class="keyword">TYPE</span> i.</span><br><span class="line">  DATA: watreedisplay LIKE snodetext.</span><br><span class="line">  FIELD-SYMBOLS: &lt;waprogram&gt; <span class="keyword">TYPE</span> tprogram.</span><br><span class="line">  FIELD-SYMBOLS: &lt;wascreen&gt; <span class="keyword">TYPE</span> tscreenflow.</span><br><span class="line">  FIELD-SYMBOLS: &lt;wafunction&gt; <span class="keyword">TYPE</span> tfunction.</span><br><span class="line">  FIELD-SYMBOLS: &lt;wadictionary&gt; <span class="keyword">TYPE</span> tdicttable.</span><br><span class="line">  FIELD-SYMBOLS: &lt;wainclude&gt; <span class="keyword">TYPE</span> tinclude.</span><br><span class="line">  FIELD-SYMBOLS: &lt;wamessage&gt; <span class="keyword">TYPE</span> tmessage.</span><br><span class="line">  FIELD-SYMBOLS: &lt;watabletype&gt; <span class="keyword">TYPE</span> ttabletype.</span><br><span class="line">  FIELD-SYMBOLS: &lt;watransformation&gt; <span class="keyword">TYPE</span> ttransformation.</span><br><span class="line">  DATA: tablelinesstring <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: runtimechar(10).</span><br><span class="line"></span><br><span class="line">  tablelines = lines( ilocprograms ).</span><br><span class="line">  tablelinesstring = tablelines.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> tablelines = 1.</span><br><span class="line">    CONCATENATE tablelinesstring ` <span class="keyword">program</span> downloaded` INTO watreedisplay-text2.</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line">    CONCATENATE tablelinesstring ` programs downloaded` INTO watreedisplay-text2.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">  WRITE runtime TO runtimechar.</span><br><span class="line"></span><br><span class="line">  CONCATENATE watreedisplay-text2 ` - runtime ` runtimechar INTO watreedisplay-text2.</span><br><span class="line"><span class="comment">* include header display record.</span></span><br><span class="line">  watreedisplay-tlevel = '1'.</span><br><span class="line">  watreedisplay-tlength2  = 60.</span><br><span class="line">  watreedisplay-tcolor2    = 1.</span><br><span class="line">  <span class="keyword">APPEND</span> watreedisplay TO itreedisplay.</span><br><span class="line"></span><br><span class="line">  LOOP AT ilocprograms ASSIGNING &lt;waprogram&gt;.</span><br><span class="line"><span class="comment">*   Main programs.</span></span><br><span class="line">    watreedisplay-tlevel = '2'.</span><br><span class="line">    watreedisplay-text2 = &lt;waprogram&gt;-progname.</span><br><span class="line">    watreedisplay-tcolor2    = 1.</span><br><span class="line"><span class="comment">*   Description</span></span><br><span class="line">    watreedisplay-tlength3   = 80.</span><br><span class="line">    watreedisplay-tcolor3    = 1.</span><br><span class="line">    watreedisplay-tpos3      = 60.</span><br><span class="line">    CONCATENATE `<span class="keyword">Program</span>: ` &lt;waprogram&gt;-programtitle INTO watreedisplay-text3.</span><br><span class="line">    <span class="keyword">APPEND</span> watreedisplay TO itreedisplay.</span><br><span class="line"><span class="comment">*   Screens.</span></span><br><span class="line">    LOOP AT &lt;waprogram&gt;-iscreenflow ASSIGNING &lt;wascreen&gt;.</span><br><span class="line">      watreedisplay-tlevel = '3'.</span><br><span class="line">      watreedisplay-text2 = &lt;wascreen&gt;-screen.</span><br><span class="line">      watreedisplay-tcolor2    = 6.</span><br><span class="line">      watreedisplay-tlength3   = 80.</span><br><span class="line">      watreedisplay-tcolor3    = 6.</span><br><span class="line">      watreedisplay-tpos3      = 60.</span><br><span class="line">      watreedisplay-text3 = 'Screen'.</span><br><span class="line">      <span class="keyword">APPEND</span> watreedisplay TO itreedisplay.</span><br><span class="line">    ENDLOOP.</span><br><span class="line"><span class="comment">*   fill in the tree with message information</span></span><br><span class="line">    <span class="keyword">SORT</span> &lt;waprogram&gt;-imessages[] ASCENDING <span class="keyword">BY</span> arbgb.</span><br><span class="line">    LOOP AT &lt;waprogram&gt;-imessages ASSIGNING &lt;wamessage&gt;.</span><br><span class="line">      AT NEW arbgb.</span><br><span class="line">        watreedisplay-tlevel = 3.</span><br><span class="line">        watreedisplay-text2 = &lt;wamessage&gt;-arbgb.</span><br><span class="line">        watreedisplay-tcolor2    = 5.</span><br><span class="line">        watreedisplay-tlength3   = 80.</span><br><span class="line">        watreedisplay-tcolor3    = 5.</span><br><span class="line">        watreedisplay-tpos3      = 60.</span><br><span class="line"></span><br><span class="line"><span class="comment">*       Select the message class text if we do not have it already</span></span><br><span class="line">        <span class="keyword">IF</span> &lt;wamessage&gt;-stext IS INITIAL.</span><br><span class="line">          SELECT SINGLE stext FROM t100a</span><br><span class="line">          INTO &lt;wamessage&gt;-stext</span><br><span class="line">          WHERE arbgb = &lt;wamessage&gt;-arbgb.</span><br><span class="line">        ENDIF.</span><br><span class="line"></span><br><span class="line">        watreedisplay-text3 = &lt;wamessage&gt;-stext.</span><br><span class="line">        CONCATENATE `Message <span class="keyword">class</span>: `  watreedisplay-text3 INTO watreedisplay-text3.</span><br><span class="line">        <span class="keyword">APPEND</span> watreedisplay TO iloctreedisplay.</span><br><span class="line">      ENDAT.</span><br><span class="line">    ENDLOOP.</span><br><span class="line"><span class="comment">*   Fill in the tree with include information</span></span><br><span class="line">    LOOP AT &lt;waprogram&gt;-iincludes ASSIGNING &lt;wainclude&gt;.</span><br><span class="line">      watreedisplay-tlevel = 3.</span><br><span class="line">      watreedisplay-text2 =  &lt;wainclude&gt;-includename.</span><br><span class="line">      watreedisplay-tcolor2    = 4.</span><br><span class="line">      watreedisplay-tlength3   = 80.</span><br><span class="line">      watreedisplay-tcolor3    = 4.</span><br><span class="line">      watreedisplay-tpos3      = 60.</span><br><span class="line">      CONCATENATE `<span class="keyword">Include</span>:   ` &lt;wainclude&gt;-includetitle INTO watreedisplay-text3.</span><br><span class="line">      <span class="keyword">APPEND</span> watreedisplay TO iloctreedisplay.</span><br><span class="line">    ENDLOOP.</span><br><span class="line"><span class="comment">*   fill in the tree with dictionary information</span></span><br><span class="line">    LOOP AT &lt;waprogram&gt;-idictstruct ASSIGNING &lt;wadictionary&gt;.</span><br><span class="line">      watreedisplay-tlevel = 3.</span><br><span class="line">      watreedisplay-text2 =  &lt;wadictionary&gt;-tablename.</span><br><span class="line">      watreedisplay-tcolor2    = 3.</span><br><span class="line">      watreedisplay-tlength3   = 80.</span><br><span class="line">      watreedisplay-tcolor3    = 3.</span><br><span class="line">      watreedisplay-tpos3      = 60.</span><br><span class="line">      CONCATENATE `Dictionary:    ` &lt;wadictionary&gt;-tabletitle INTO watreedisplay-text3.</span><br><span class="line">      <span class="keyword">APPEND</span> watreedisplay TO iloctreedisplay.</span><br><span class="line">    ENDLOOP.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   fill in the tree with Table type information</span></span><br><span class="line">    LOOP AT &lt;waprogram&gt;-itabletypes ASSIGNING &lt;watabletype&gt;.</span><br><span class="line">      watreedisplay-tlevel = 3.</span><br><span class="line">      watreedisplay-text2 =  &lt;watabletype&gt;-typename.</span><br><span class="line">      watreedisplay-tcolor2    = 3.</span><br><span class="line">      watreedisplay-tlength3   = 80.</span><br><span class="line">      watreedisplay-tcolor3    = 3.</span><br><span class="line">      watreedisplay-tpos3      = 60.</span><br><span class="line">      CONCATENATE `<span class="keyword">Table</span> <span class="keyword">Type</span>:    ` &lt;watabletype&gt;-ddtext INTO watreedisplay-text3.</span><br><span class="line">      <span class="keyword">APPEND</span> watreedisplay TO iloctreedisplay.</span><br><span class="line">    ENDLOOP.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   fill in the tree with transformation information</span></span><br><span class="line">    LOOP AT &lt;waprogram&gt;-itransformations ASSIGNING &lt;watransformation&gt;.</span><br><span class="line">      watreedisplay-tlevel = 3.</span><br><span class="line">      watreedisplay-text2 =  &lt;watransformation&gt;-xsltname.</span><br><span class="line">      watreedisplay-tcolor2    = 3.</span><br><span class="line">      watreedisplay-tlength3   = 80.</span><br><span class="line">      watreedisplay-tcolor3    = 3.</span><br><span class="line">      watreedisplay-tpos3      = 60.</span><br><span class="line">      CONCATENATE `<span class="keyword">Table</span> <span class="keyword">Type</span>:    ` &lt;watransformation&gt;-xsltdesc INTO watreedisplay-text3.</span><br><span class="line">      <span class="keyword">APPEND</span> watreedisplay TO iloctreedisplay.</span><br><span class="line">    ENDLOOP.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Function Modules</span></span><br><span class="line">    LOOP AT ilocfunctions ASSIGNING &lt;wafunction&gt; WHERE programlinkname = &lt;waprogram&gt;-progname.</span><br><span class="line">      watreedisplay-tlevel = 3.</span><br><span class="line">      watreedisplay-text2 = &lt;wafunction&gt;-functionname.</span><br><span class="line">      watreedisplay-tcolor2    = 7.</span><br><span class="line">      watreedisplay-tlength3   = 80.</span><br><span class="line">      watreedisplay-tcolor3    = 7.</span><br><span class="line">      watreedisplay-tpos3      = 60.</span><br><span class="line">      CONCATENATE `Function:      ` &lt;wafunction&gt;-functionname INTO watreedisplay-text3.</span><br><span class="line">      <span class="keyword">APPEND</span> watreedisplay TO iloctreedisplay.</span><br><span class="line"></span><br><span class="line"><span class="comment">*     Fill in the tree with include information</span></span><br><span class="line">      LOOP AT &lt;wafunction&gt;-iincludes ASSIGNING &lt;wainclude&gt;.</span><br><span class="line">        watreedisplay-tlevel = 4.</span><br><span class="line">        watreedisplay-text2 =  &lt;wainclude&gt;-includename.</span><br><span class="line">        watreedisplay-tcolor2    = 4.</span><br><span class="line">        watreedisplay-tlength3   = 80.</span><br><span class="line">        watreedisplay-tcolor3    = 4.</span><br><span class="line">        watreedisplay-tpos3      = 60.</span><br><span class="line">        CONCATENATE `<span class="keyword">Include</span>:       ` &lt;wainclude&gt;-includetitle INTO watreedisplay-text3.</span><br><span class="line">        <span class="keyword">APPEND</span> watreedisplay TO iloctreedisplay.</span><br><span class="line">      ENDLOOP.</span><br><span class="line"></span><br><span class="line"><span class="comment">*     fill in the tree with dictionary information</span></span><br><span class="line">      LOOP AT &lt;wafunction&gt;-idictstruct ASSIGNING &lt;wadictionary&gt;.</span><br><span class="line">        watreedisplay-tlevel = 4.</span><br><span class="line">        watreedisplay-text2 =  &lt;wadictionary&gt;-tablename.</span><br><span class="line">        watreedisplay-tcolor2    = 3.</span><br><span class="line">        watreedisplay-tlength3   = 80.</span><br><span class="line">        watreedisplay-tcolor3    = 3.</span><br><span class="line">        watreedisplay-tpos3      = 60.</span><br><span class="line">        CONCATENATE `Dictionary:    ` &lt;wadictionary&gt;-tabletitle INTO watreedisplay-text3.</span><br><span class="line">        <span class="keyword">APPEND</span> watreedisplay TO iloctreedisplay.</span><br><span class="line">      ENDLOOP.</span><br><span class="line"></span><br><span class="line"><span class="comment">*     fill in the tree with message information</span></span><br><span class="line">      <span class="keyword">SORT</span> &lt;wafunction&gt;-imessages[] ASCENDING <span class="keyword">BY</span> arbgb.</span><br><span class="line">      LOOP AT &lt;wafunction&gt;-imessages ASSIGNING &lt;wamessage&gt;.</span><br><span class="line">        AT NEW arbgb.</span><br><span class="line">          watreedisplay-tlevel = 4.</span><br><span class="line">          watreedisplay-text2 = &lt;wamessage&gt;-arbgb.</span><br><span class="line">          watreedisplay-tcolor2    = 5.</span><br><span class="line">          watreedisplay-tlength3   = 80.</span><br><span class="line">          watreedisplay-tcolor3    = 5.</span><br><span class="line">          watreedisplay-tpos3      = 60.</span><br><span class="line"></span><br><span class="line"><span class="comment">*         Select the message class text if we do not have it already</span></span><br><span class="line">          <span class="keyword">IF</span> &lt;wamessage&gt;-stext IS INITIAL.</span><br><span class="line">            SELECT SINGLE stext FROM t100a</span><br><span class="line">            INTO &lt;wamessage&gt;-stext</span><br><span class="line">            WHERE arbgb = &lt;wamessage&gt;-arbgb.</span><br><span class="line">          ENDIF.</span><br><span class="line"></span><br><span class="line">          watreedisplay-text3 = &lt;wamessage&gt;-stext.</span><br><span class="line">          CONCATENATE `Message <span class="keyword">class</span>:  `  watreedisplay-text3 INTO watreedisplay-text3.</span><br><span class="line">          <span class="keyword">APPEND</span> watreedisplay TO iloctreedisplay.</span><br><span class="line">        ENDAT.</span><br><span class="line">      ENDLOOP.</span><br><span class="line">    ENDLOOP.</span><br><span class="line">  ENDLOOP.</span><br><span class="line">ENDFORM.                                                                                          "fillTreeNodePrograms</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  fillTreeNodeClasses</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> filltreenodeclasses USING ilocclasses LIKE iclasses[]</span><br><span class="line">      ilocfunctions LIKE ifunctions[]</span><br><span class="line">      iloctreedisplay LIKE itreedisplay[]</span><br><span class="line">      VALUE(runtime).</span><br><span class="line"></span><br><span class="line">  DATA: tablelines <span class="keyword">TYPE</span> i.</span><br><span class="line">  DATA: watreedisplay LIKE snodetext.</span><br><span class="line">  FIELD-SYMBOLS: &lt;waclass&gt; <span class="keyword">TYPE</span> tclass.</span><br><span class="line">  FIELD-SYMBOLS: &lt;wamethod&gt; <span class="keyword">TYPE</span> tmethod.</span><br><span class="line">  FIELD-SYMBOLS: &lt;wafunction&gt; <span class="keyword">TYPE</span> tfunction.</span><br><span class="line">  FIELD-SYMBOLS: &lt;wadictionary&gt; <span class="keyword">TYPE</span> tdicttable.</span><br><span class="line">  FIELD-SYMBOLS: &lt;wainclude&gt; <span class="keyword">TYPE</span> tinclude.</span><br><span class="line">  FIELD-SYMBOLS: &lt;wamessage&gt; <span class="keyword">TYPE</span> tmessage.</span><br><span class="line">  FIELD-SYMBOLS: &lt;watabletype&gt; <span class="keyword">TYPE</span> ttabletype.</span><br><span class="line">  FIELD-SYMBOLS: &lt;watransformation&gt; <span class="keyword">TYPE</span> ttransformation.</span><br><span class="line">  DATA: tablelinesstring <span class="keyword">TYPE</span> string.</span><br><span class="line">  DATA: runtimechar(10).</span><br><span class="line"></span><br><span class="line">  tablelines = lines( ilocclasses ).</span><br><span class="line">  tablelinesstring = tablelines.</span><br><span class="line"></span><br><span class="line">  <span class="keyword">IF</span> tablelines = 1.</span><br><span class="line">    CONCATENATE tablelinesstring ` <span class="keyword">class</span> downloaded` INTO watreedisplay-text2.</span><br><span class="line">  <span class="keyword">ELSE</span>.</span><br><span class="line">    CONCATENATE tablelinesstring ` classes downloaded` INTO watreedisplay-text2.</span><br><span class="line">  ENDIF.</span><br><span class="line"></span><br><span class="line">  WRITE runtime TO runtimechar.</span><br><span class="line"></span><br><span class="line">  CONCATENATE watreedisplay-text2 ` - runtime ` runtimechar INTO watreedisplay-text2.</span><br><span class="line"><span class="comment">* include header display record.</span></span><br><span class="line">  watreedisplay-tlevel = '1'.</span><br><span class="line">  watreedisplay-tlength2  = 60.</span><br><span class="line">  watreedisplay-tcolor2    = 1.</span><br><span class="line">  <span class="keyword">APPEND</span> watreedisplay TO itreedisplay.</span><br><span class="line"></span><br><span class="line">  LOOP AT ilocclasses ASSIGNING &lt;waclass&gt;.</span><br><span class="line"><span class="comment">*   Main Class.</span></span><br><span class="line">    watreedisplay-tlevel = '2'.</span><br><span class="line">    watreedisplay-text2 = &lt;waclass&gt;-clsname.</span><br><span class="line">    watreedisplay-tcolor2    = 1.</span><br><span class="line"><span class="comment">*   Description</span></span><br><span class="line">    watreedisplay-tlength3   = 80.</span><br><span class="line">    watreedisplay-tcolor3    = 1.</span><br><span class="line">    watreedisplay-tpos3      = 60.</span><br><span class="line">    CONCATENATE `<span class="keyword">Class</span>:    ` &lt;waclass&gt;-descript INTO watreedisplay-text3.</span><br><span class="line">    <span class="keyword">APPEND</span> watreedisplay TO itreedisplay.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   fill in the tree with method information</span></span><br><span class="line">    LOOP AT &lt;waclass&gt;-imethods[] ASSIGNING &lt;wamethod&gt;.</span><br><span class="line">      watreedisplay-tlevel = 3.</span><br><span class="line">      watreedisplay-text2 =  &lt;wamethod&gt;-cmpname.</span><br><span class="line">      watreedisplay-tcolor2    = 2.</span><br><span class="line">      watreedisplay-tlength3   = 80.</span><br><span class="line">      watreedisplay-tcolor3    = 2.</span><br><span class="line">      watreedisplay-tpos3      = 60.</span><br><span class="line">      CONCATENATE `Method:   ` &lt;wamethod&gt;-descript INTO watreedisplay-text3.</span><br><span class="line">      <span class="keyword">APPEND</span> watreedisplay TO iloctreedisplay.</span><br><span class="line">    ENDLOOP.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   fill in the tree with message information</span></span><br><span class="line">    <span class="keyword">SORT</span> &lt;waclass&gt;-imessages[] ASCENDING <span class="keyword">BY</span> arbgb.</span><br><span class="line">    LOOP AT &lt;waclass&gt;-imessages ASSIGNING &lt;wamessage&gt;.</span><br><span class="line">      AT NEW arbgb.</span><br><span class="line">        watreedisplay-tlevel = 3.</span><br><span class="line">        watreedisplay-text2 = &lt;wamessage&gt;-arbgb.</span><br><span class="line">        watreedisplay-tcolor2    = 5.</span><br><span class="line">        watreedisplay-tlength3   = 80.</span><br><span class="line">        watreedisplay-tcolor3    = 5.</span><br><span class="line">        watreedisplay-tpos3      = 60.</span><br><span class="line"></span><br><span class="line"><span class="comment">*       Select the message class text if we do not have it already</span></span><br><span class="line">        <span class="keyword">IF</span> &lt;wamessage&gt;-stext IS INITIAL.</span><br><span class="line">          SELECT SINGLE stext FROM t100a</span><br><span class="line">          INTO &lt;wamessage&gt;-stext</span><br><span class="line">          WHERE arbgb = &lt;wamessage&gt;-arbgb.</span><br><span class="line">        ENDIF.</span><br><span class="line"></span><br><span class="line">        watreedisplay-text3 = &lt;wamessage&gt;-stext.</span><br><span class="line">        CONCATENATE `Message <span class="keyword">class</span>: `  watreedisplay-text3 INTO watreedisplay-text3.</span><br><span class="line">        <span class="keyword">APPEND</span> watreedisplay TO iloctreedisplay.</span><br><span class="line">      ENDAT.</span><br><span class="line">    ENDLOOP.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   fill in the tree with dictionary information</span></span><br><span class="line">    LOOP AT &lt;waclass&gt;-idictstruct ASSIGNING &lt;wadictionary&gt;.</span><br><span class="line">      watreedisplay-tlevel = 3.</span><br><span class="line">      watreedisplay-text2 =  &lt;wadictionary&gt;-tablename.</span><br><span class="line">      watreedisplay-tcolor2    = 3.</span><br><span class="line">      watreedisplay-tlength3   = 80.</span><br><span class="line">      watreedisplay-tcolor3    = 3.</span><br><span class="line">      watreedisplay-tpos3      = 60.</span><br><span class="line">      CONCATENATE `Dictionary:    ` &lt;wadictionary&gt;-tabletitle INTO watreedisplay-text3.</span><br><span class="line">      <span class="keyword">APPEND</span> watreedisplay TO iloctreedisplay.</span><br><span class="line">    ENDLOOP.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   fill in the tree with Table type information</span></span><br><span class="line">    LOOP AT &lt;waclass&gt;-itabletypes ASSIGNING &lt;watabletype&gt;.</span><br><span class="line">      watreedisplay-tlevel = 3.</span><br><span class="line">      watreedisplay-text2 =  &lt;watabletype&gt;-typename.</span><br><span class="line">      watreedisplay-tcolor2    = 3.</span><br><span class="line">      watreedisplay-tlength3   = 80.</span><br><span class="line">      watreedisplay-tcolor3    = 3.</span><br><span class="line">      watreedisplay-tpos3      = 60.</span><br><span class="line">      CONCATENATE `<span class="keyword">Table</span> <span class="keyword">Type</span>:    ` &lt;watabletype&gt;-ddtext INTO watreedisplay-text3.</span><br><span class="line">      <span class="keyword">APPEND</span> watreedisplay TO iloctreedisplay.</span><br><span class="line">    ENDLOOP.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   fill in the tree with transformation information</span></span><br><span class="line">    LOOP AT &lt;waclass&gt;-itransformations ASSIGNING &lt;watransformation&gt;.</span><br><span class="line">      watreedisplay-tlevel = 3.</span><br><span class="line">      watreedisplay-text2 =  &lt;watransformation&gt;-xsltname.</span><br><span class="line">      watreedisplay-tcolor2    = 3.</span><br><span class="line">      watreedisplay-tlength3   = 80.</span><br><span class="line">      watreedisplay-tcolor3    = 3.</span><br><span class="line">      watreedisplay-tpos3      = 60.</span><br><span class="line">      CONCATENATE `<span class="keyword">Table</span> <span class="keyword">Type</span>:    ` &lt;watransformation&gt;-xsltdesc INTO watreedisplay-text3.</span><br><span class="line">      <span class="keyword">APPEND</span> watreedisplay TO iloctreedisplay.</span><br><span class="line">    ENDLOOP.</span><br><span class="line"></span><br><span class="line"><span class="comment">*   Function Modules</span></span><br><span class="line">    LOOP AT ilocfunctions ASSIGNING &lt;wafunction&gt; WHERE programlinkname = &lt;waclass&gt;-clsname.</span><br><span class="line">      watreedisplay-tlevel = 3.</span><br><span class="line">      watreedisplay-text2 = &lt;wafunction&gt;-functionname.</span><br><span class="line">      watreedisplay-tcolor2    = 7.</span><br><span class="line">      watreedisplay-tlength3   = 80.</span><br><span class="line">      watreedisplay-tcolor3    = 7.</span><br><span class="line">      watreedisplay-tpos3      = 60.</span><br><span class="line">      CONCATENATE `Function:      ` &lt;wafunction&gt;-functionname INTO watreedisplay-text3.</span><br><span class="line">      <span class="keyword">APPEND</span> watreedisplay TO iloctreedisplay.</span><br><span class="line"></span><br><span class="line"><span class="comment">*     Fill in the tree with include information</span></span><br><span class="line">      LOOP AT &lt;wafunction&gt;-iincludes ASSIGNING &lt;wainclude&gt;.</span><br><span class="line">        watreedisplay-tlevel = 4.</span><br><span class="line">        watreedisplay-text2 =  &lt;wainclude&gt;-includename.</span><br><span class="line">        watreedisplay-tcolor2    = 4.</span><br><span class="line">        watreedisplay-tlength3   = 80.</span><br><span class="line">        watreedisplay-tcolor3    = 4.</span><br><span class="line">        watreedisplay-tpos3      = 60.</span><br><span class="line">        CONCATENATE `<span class="keyword">Include</span>:       ` &lt;wainclude&gt;-includetitle INTO watreedisplay-text3.</span><br><span class="line">        <span class="keyword">APPEND</span> watreedisplay TO iloctreedisplay.</span><br><span class="line">      ENDLOOP.</span><br><span class="line"></span><br><span class="line"><span class="comment">*     fill in the tree with dictionary information</span></span><br><span class="line">      LOOP AT &lt;wafunction&gt;-idictstruct ASSIGNING &lt;wadictionary&gt;.</span><br><span class="line">        watreedisplay-tlevel = 4.</span><br><span class="line">        watreedisplay-text2 =  &lt;wadictionary&gt;-tablename.</span><br><span class="line">        watreedisplay-tcolor2    = 3.</span><br><span class="line">        watreedisplay-tlength3   = 80.</span><br><span class="line">        watreedisplay-tcolor3    = 3.</span><br><span class="line">        watreedisplay-tpos3      = 60.</span><br><span class="line">        CONCATENATE `Dictionary:    ` &lt;wadictionary&gt;-tabletitle INTO watreedisplay-text3.</span><br><span class="line">        <span class="keyword">APPEND</span> watreedisplay TO iloctreedisplay.</span><br><span class="line">      ENDLOOP.</span><br><span class="line"></span><br><span class="line"><span class="comment">*     fill in the tree with message information</span></span><br><span class="line">      <span class="keyword">SORT</span> &lt;wafunction&gt;-imessages[] ASCENDING <span class="keyword">BY</span> arbgb.</span><br><span class="line">      LOOP AT &lt;wafunction&gt;-imessages ASSIGNING &lt;wamessage&gt;.</span><br><span class="line">        AT NEW arbgb.</span><br><span class="line">          watreedisplay-tlevel = 4.</span><br><span class="line">          watreedisplay-text2 = &lt;wamessage&gt;-arbgb.</span><br><span class="line">          watreedisplay-tcolor2    = 5.</span><br><span class="line">          watreedisplay-tlength3   = 80.</span><br><span class="line">          watreedisplay-tcolor3    = 5.</span><br><span class="line">          watreedisplay-tpos3      = 60.</span><br><span class="line"></span><br><span class="line"><span class="comment">*         Select the message class text if we do not have it already</span></span><br><span class="line">          <span class="keyword">IF</span> &lt;wamessage&gt;-stext IS INITIAL.</span><br><span class="line">            SELECT SINGLE stext FROM t100a</span><br><span class="line">            INTO &lt;wamessage&gt;-stext</span><br><span class="line">            WHERE arbgb = &lt;wamessage&gt;-arbgb.</span><br><span class="line">          ENDIF.</span><br><span class="line"></span><br><span class="line">          watreedisplay-text3 = &lt;wamessage&gt;-stext.</span><br><span class="line">          CONCATENATE `Message <span class="keyword">class</span>:  `  watreedisplay-text3 INTO watreedisplay-text3.</span><br><span class="line">          <span class="keyword">APPEND</span> watreedisplay TO iloctreedisplay.</span><br><span class="line">        ENDAT.</span><br><span class="line">      ENDLOOP.</span><br><span class="line">    ENDLOOP.</span><br><span class="line">  ENDLOOP.</span><br><span class="line">ENDFORM.                                                                                           "fillTreeNodeClasses</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">* displayTree...</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> displaytree USING iloctreedisplay LIKE itreedisplay[].</span><br><span class="line"></span><br><span class="line">  DATA: watreedisplay <span class="keyword">TYPE</span> snodetext.</span><br><span class="line"></span><br><span class="line"><span class="comment">* build up the tree from the internal table node</span></span><br><span class="line">  CALL FUNCTION 'RS_TREE_CONSTRUCT'</span><br><span class="line">    TABLES</span><br><span class="line">      nodetab            = itreedisplay</span><br><span class="line">    EXCEPTIONS</span><br><span class="line">      tree_failure       = 1</span><br><span class="line">      id_not_found       = 2</span><br><span class="line">      wrong_relationship = 3</span><br><span class="line">      OTHERS             = 4.</span><br><span class="line"></span><br><span class="line"><span class="comment">* get the first index and expand the whole tree</span></span><br><span class="line">  <span class="keyword">READ</span> <span class="keyword">TABLE</span> iloctreedisplay INTO watreedisplay INDEX 1.</span><br><span class="line">  CALL FUNCTION 'RS_TREE_EXPAND'</span><br><span class="line">    EXPORTING</span><br><span class="line">      node_id   = watreedisplay-id</span><br><span class="line">      all       = 'X'</span><br><span class="line">    EXCEPTIONS</span><br><span class="line">      not_found = 1</span><br><span class="line">      OTHERS    = 2.</span><br><span class="line"></span><br><span class="line"><span class="comment">* now display the tree</span></span><br><span class="line">  CALL FUNCTION 'RS_TREE_LIST_DISPLAY'</span><br><span class="line">    EXPORTING</span><br><span class="line">      callback_program      = sy-cprog</span><br><span class="line">      callback_user_command = 'CB_USER_COMMAND'</span><br><span class="line">      callback_text_display = 'CB_text_DISPLAY'</span><br><span class="line">      callback_top_of_page  = 'TOP_OF_PAGE'</span><br><span class="line">    EXCEPTIONS</span><br><span class="line">      OTHERS                = 1.</span><br><span class="line">ENDFORM.                                                                                                   "displayTree</span><br><span class="line"></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="comment">*  topOfPage... for tree display routines.</span></span><br><span class="line"><span class="comment">*----------------------------------------------------------------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">FORM</span> topofpage.</span><br><span class="line"></span><br><span class="line">ENDFORM.</span><br></pre></td></tr></table></figure>
<h3 id="批量创建用户">批量创建用户</h3><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">"批量创建用户</span><br><span class="line"><span class="keyword">REPORT</span>  z_user_create.</span><br><span class="line">TABLES: usrsysact.</span><br><span class="line">TYPES: BEGIN OF t_usertab,</span><br><span class="line">         bname    <span class="keyword">TYPE</span> xubname,</span><br><span class="line">         lastname <span class="keyword">TYPE</span> ad_namelas,</span><br><span class="line">         password <span class="keyword">TYPE</span> xuncode,</span><br><span class="line">       END OF t_usertab,</span><br><span class="line">       BEGIN OF t_roletab,</span><br><span class="line">         bname    <span class="keyword">TYPE</span> xubname,</span><br><span class="line">         system   <span class="keyword">TYPE</span> rfcrcvsys,</span><br><span class="line">         rolename <span class="keyword">TYPE</span> f_agr_name,</span><br><span class="line">       END OF t_roletab.</span><br><span class="line">DATA: wt_usertab        <span class="keyword">TYPE</span> <span class="keyword">TABLE</span> OF t_usertab,</span><br><span class="line">      wt_roletab        <span class="keyword">TYPE</span> <span class="keyword">TABLE</span> OF t_roletab,</span><br><span class="line">      wa_usertab        <span class="keyword">TYPE</span>          t_usertab,</span><br><span class="line">      wa_roletab        <span class="keyword">TYPE</span>          t_roletab,</span><br><span class="line">      w_index           <span class="keyword">TYPE</span>          i,</span><br><span class="line">      wa_userlines      <span class="keyword">TYPE</span>          i,</span><br><span class="line">      wa_rolelines      <span class="keyword">TYPE</span>          i,</span><br><span class="line">      wt_activitygroups <span class="keyword">TYPE</span> <span class="keyword">TABLE</span> OF bapilocagr,</span><br><span class="line">      wa_activitygroups <span class="keyword">TYPE</span>          bapilocagr,</span><br><span class="line">      wa_return         <span class="keyword">TYPE</span>          bapiret2,</span><br><span class="line">      wt_return         <span class="keyword">TYPE</span> <span class="keyword">TABLE</span> OF bapiret2,</span><br><span class="line">      wa_logondata      <span class="keyword">TYPE</span>          bapilogond,</span><br><span class="line">      wa_password       <span class="keyword">TYPE</span>          bapipwd,</span><br><span class="line">      wa_address        <span class="keyword">TYPE</span>          bapiaddr3.</span><br><span class="line">PARAMETERS: p_users <span class="keyword">TYPE</span> rlgrap-filename,</span><br><span class="line">p_roles <span class="keyword">TYPE</span> rlgrap-filename.</span><br><span class="line"></span><br><span class="line">DATA: wa_filename <span class="keyword">TYPE</span> string.</span><br><span class="line"><span class="comment">* upload files with user/role info.for simplicity, all superfluous</span></span><br><span class="line"><span class="comment">* parameters as well as exception handling is removed from the function</span></span><br><span class="line"><span class="comment">* calls below.MOVE p_users TO wa_filename.</span></span><br><span class="line">CALL FUNCTION 'gui_upload'</span><br><span class="line">  EXPORTING</span><br><span class="line">    filename            = wa_filename</span><br><span class="line">    filetype            = 'asc'</span><br><span class="line">    has_field_separator = 'x'</span><br><span class="line">  TABLES</span><br><span class="line">    data_tab            = wt_usertab.</span><br><span class="line"><span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line">  MESSAGE ID sy-msgid <span class="keyword">TYPE</span> sy-msgty NUMBER sy-msgno</span><br><span class="line">  WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.</span><br><span class="line">ENDIF.</span><br><span class="line"><span class="keyword">MOVE</span> p_roles TO wa_filename.</span><br><span class="line">CALL FUNCTION 'gui_upload'</span><br><span class="line">  EXPORTING</span><br><span class="line">    filename            = wa_filename</span><br><span class="line">    filetype            = 'asc'</span><br><span class="line">    has_field_separator = 'x'</span><br><span class="line">  TABLES</span><br><span class="line">    data_tab            = wt_roletab.</span><br><span class="line"><span class="keyword">IF</span> sy-subrc &lt;&gt; 0.</span><br><span class="line">  MESSAGE ID sy-msgid <span class="keyword">TYPE</span> sy-msgty NUMBER sy-msgno</span><br><span class="line">  WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.</span><br><span class="line">ENDIF.</span><br><span class="line"><span class="comment">* Sort the resulting tables of users / rolessort wt_usertab.</span></span><br><span class="line"><span class="keyword">SORT</span> wt_roletab.</span><br><span class="line"><span class="comment">* check contentsdescribe table wt_usertab lines wa_userlines.</span></span><br><span class="line"><span class="keyword">DESCRIBE</span> <span class="keyword">TABLE</span> wt_roletab LINES wa_rolelines.</span><br><span class="line"><span class="keyword">IF</span> wa_userlines <span class="keyword">EQ</span> 0 OR wa_rolelines <span class="keyword">EQ</span> 0.</span><br><span class="line"><span class="comment">* Write an error message here!ELSE.</span></span><br><span class="line"><span class="comment">* Do a nested loop on the two tables; create users/assign roles</span></span><br><span class="line">  w_index = 1.</span><br><span class="line">  LOOP AT wt_usertab INTO wa_usertab.</span><br><span class="line"><span class="comment">* check if the user already exists.IF NOT: create.</span></span><br><span class="line">    CALL FUNCTION 'bapi_user_existence_check'</span><br><span class="line">      EXPORTING</span><br><span class="line">        username = wa_usertab-bname</span><br><span class="line">      IMPORTING</span><br><span class="line">        <span class="keyword">return</span>   = wa_return.</span><br><span class="line">    <span class="keyword">IF</span> sy-subrc NE 0.</span><br><span class="line"><span class="comment">* User does not exist – create</span></span><br><span class="line">      <span class="keyword">MOVE</span> sy-datum TO wa_logondata-gltgv.</span><br><span class="line">      <span class="keyword">MOVE</span> '31122010' TO wa_logondata-gltgb.</span><br><span class="line">      <span class="keyword">MOVE</span> wa_usertab-lastname TO wa_address-lastname.</span><br><span class="line">      <span class="keyword">MOVE</span> wa_usertab-password TO wa_password-bapipwd.</span><br><span class="line">      CALL FUNCTION 'bapi_user_create1'</span><br><span class="line">        EXPORTING</span><br><span class="line">          username  = wa_usertab-bname</span><br><span class="line"><span class="comment">*         name_in   =</span></span><br><span class="line">          logondata = wa_logondata</span><br><span class="line">          password  = wa_password</span><br><span class="line"><span class="comment">*         defaults  =</span></span><br><span class="line">          address   = wa_address.</span><br><span class="line">    <span class="keyword">ELSE</span>.</span><br><span class="line"><span class="comment">* User already exists – read current roles &amp; merge with new</span></span><br><span class="line">      CALL FUNCTION 'BAPI_USER_LOCACTGROUPS_READ'</span><br><span class="line">        EXPORTING</span><br><span class="line">          username       = wa_usertab-bname</span><br><span class="line">        TABLES</span><br><span class="line">          activitygroups = wt_activitygroups</span><br><span class="line">          <span class="keyword">return</span>         = wt_return.</span><br><span class="line">    ENDIF.</span><br><span class="line"><span class="comment">* find role assignments for this user in our second file</span></span><br><span class="line">    LOOP AT wt_roletab INTO wa_roletab FROM w_index.</span><br><span class="line">      <span class="keyword">IF</span> wa_roletab-bname &lt;&gt; wa_usertab-bname.</span><br><span class="line">        w_index = sy-tabix.</span><br><span class="line">        <span class="keyword">SORT</span> wt_activitygroups.</span><br><span class="line">        DELETE ADJACENT <span class="keyword">DUPLICATES</span> FROM wt_activitygroups.</span><br><span class="line">        CALL FUNCTION 'bapi_user_locactgroups_assign'</span><br><span class="line">          EXPORTING</span><br><span class="line">            username       = wa_roletab-bname</span><br><span class="line"><span class="comment">*no_db_update           = ‘ ‘*</span></span><br><span class="line">            incl_hr_assign = ''</span><br><span class="line"><span class="comment">*distribute_change_only = ‘ ‘</span></span><br><span class="line">          TABLES</span><br><span class="line">            activitygroups = wt_activitygroups</span><br><span class="line">            <span class="keyword">return</span>         = wt_return.</span><br><span class="line">        <span class="keyword">CLEAR</span> wt_activitygroups.</span><br><span class="line">        REFRESH wt_activitygroups.</span><br><span class="line">        <span class="keyword">EXIT</span>.</span><br><span class="line">      ENDIF.</span><br><span class="line">      WRITE : /10 wa_roletab-bname, wa_roletab-system, wa_roletab-rolename.</span><br><span class="line"><span class="comment">* check if role exists in system (usrsysact)</span></span><br><span class="line">      SELECT SINGLE * FROM  usrsysact</span><br><span class="line">        WHERE  subsystem  = wa_roletab-system</span><br><span class="line">        AND    agr_name   = wa_roletab-rolename.</span><br><span class="line">      <span class="keyword">IF</span> sy-subrc <span class="keyword">EQ</span> 0.</span><br><span class="line"><span class="comment">* Add role assignment to temporary role assignment table</span></span><br><span class="line">        <span class="keyword">MOVE</span> wa_roletab-system TO wa_activitygroups-subsystem.</span><br><span class="line">        <span class="keyword">MOVE</span> wa_roletab-rolename TO wa_activitygroups-agr_name.</span><br><span class="line">        <span class="keyword">MOVE</span> sy-datum TO wa_activitygroups-from_dat.</span><br><span class="line"><span class="comment">* assigning roles until end of 2010; company policies may apply here…</span></span><br><span class="line">        <span class="keyword">MOVE</span> '31122010' TO wa_activitygroups-to_dat.</span><br><span class="line">        <span class="keyword">APPEND</span> wa_activitygroups TO wt_activitygroups.</span><br><span class="line">      <span class="keyword">ELSE</span>.</span><br><span class="line">        WRITE : /1 '*** this system/role combination does NOT exist: ', wa_roletab-system, wa_roletab-rolename.</span><br><span class="line">      ENDIF.</span><br><span class="line">    ENDLOOP.</span><br><span class="line">  ENDLOOP.</span><br><span class="line">ENDIF.</span><br></pre></td></tr></table></figure>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/05/16/python-intro/" itemprop="url">
                  python程序入门
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            發表於
            <time itemprop="dateCreated" datetime="2017-05-16T14:59:15+08:00" content="2017-05-16">
              2017-05-16
            </time>
          </span>

          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <h1 id="Python程序入门">Python程序入门</h1><h3 id="第一章_Python初探">第一章 Python初探</h3><h5 id="谁在用？">谁在用？</h5><ul>
<li>Google、YouTube</li>
<li>Tencent、Baidu</li>
<li>Byvin</li>
</ul>
<h5 id="在哪里用？">在哪里用？</h5><ul>
<li>命令行窗口</li>
<li>图形用户界面，包括Web</li>
<li>客户端和服务端Web</li>
<li>大型网站后端</li>
<li>云（第三方负责管理的服务器）</li>
<li>移动设备</li>
<li>嵌入式设备</li>
</ul>
<h5 id="优点">优点</h5><ul>
<li>简洁</li>
<li>跨平台</li>
<li>生态庞大</li>
</ul>
<h5 id="缺点">缺点</h5><ul>
<li>慢，对应慢的情况一般是通过C语言来加速 </li>
</ul>
<h5 id="Python_2与Python_3">Python 2与Python 3</h5><ul>
<li>已经存在的Python2项目，继续用Python2</li>
<li>新开发的程序建议用Python3，Python3的Unicode支持的更好</li>
</ul>
<h5 id="运行Python">运行Python</h5><ul>
<li>交互式运行</li>
<li>文件运行</li>
</ul>
<h6 id="交互式运行">交互式运行</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Python <span class="number">3.5</span><span class="number">.2</span> |Anaconda <span class="number">4.2</span><span class="number">.0</span> (<span class="number">64</span>-bit)| (default, Jul  <span class="number">2</span> <span class="number">2016</span>, <span class="number">17</span>:<span class="number">53</span>:<span class="number">06</span>) </span><br><span class="line">[GCC <span class="number">4.4</span><span class="number">.7</span> <span class="number">20120313</span> (Red Hat <span class="number">4.4</span><span class="number">.7</span>-<span class="number">1</span>)] on linux</span><br><span class="line">Type <span class="string">"help"</span>, <span class="string">"copyright"</span>, <span class="string">"credits"</span> <span class="keyword">or</span> <span class="string">"license"</span> <span class="keyword">for</span> more information.</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<h6 id="文件运行">文件运行</h6><p>如果你把61 放在文件中并使用Python 来执行它，确实可以，但是程序什么都不会输出。<br>在非交互式的Python 程序中，你必须调用print 函数来打印内容，如下所示：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="number">61</span>)</span><br></pre></td></tr></table></figure></p>
<p>我们来生成一个Python 程序文件并运行它。<br>(1) 打开你的文本编辑器。<br>(2) 输入代码print(61)，如上所示。<br>(3) 保存文件，命名为61.py。一定要确保存储为纯文本而不是“富文本”格式，比如RTF<br>或者Word。Python 程序文件并不是一定要以.py 结尾，但是加上它可以让你清楚这个<br>文件的作用。<br>(4) 如果你使用的是图形用户界面——基本上每个人都会用——请打开一个终端窗口2。<br>(5) 输入下面的命令来运行程序：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ python <span class="number">61</span>.py</span><br></pre></td></tr></table></figure></p>
<p>应该可以看到一行输出：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">61</span></span><br></pre></td></tr></table></figure></p>
<h5 id="Python指导哲学">Python指导哲学</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span><span class="keyword">import</span> this</span><br><span class="line">《Python之禅》 Tim Peters</span><br><span class="line">优美胜于丑陋</span><br><span class="line">明了胜于隐晦</span><br><span class="line">简洁胜于复杂</span><br><span class="line">复杂胜于混乱</span><br><span class="line">扁平胜于嵌套</span><br><span class="line">宽松胜于紧凑</span><br><span class="line">可读性很重要</span><br><span class="line">即便是特例，也不可违背这些规则</span><br><span class="line">虽然现实往往不那么完美</span><br><span class="line">但是不应该放过任何异常</span><br><span class="line">除非你确定需要如此</span><br><span class="line">如果存在多种可能，不要猜测</span><br><span class="line">肯定有一种——通常也是唯一一种——最佳的解决方案</span><br><span class="line">虽然这并不容易，因为你不是Python之父</span><br><span class="line">动手比不动手要好</span><br><span class="line">但不假思索就动手还不如不做</span><br><span class="line">如果你的方案很难懂，那肯定不是一个好方案</span><br><span class="line">如果你的方案很好懂，那肯定是一个好方案</span><br><span class="line">命名空间非常有用，我们应当多加利用</span><br></pre></td></tr></table></figure>
<h3 id="第二章_Python基本元素：数字、字符串和变量">第二章  Python基本元素：数字、字符串和变量</h3><h4 id="变量">变量</h4><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; a = 7 </span><br><span class="line">&gt;&gt;&gt; print(a)</span><br><span class="line">7</span><br><span class="line">&gt;&gt;&gt; type(a)</span><br><span class="line">&lt;class 'int'&gt;</span><br><span class="line">&gt;&gt;&gt; b = "8"</span><br><span class="line">&gt;&gt;&gt; print(b)</span><br><span class="line">8</span><br><span class="line">&gt;&gt;&gt; type(b)</span><br><span class="line">&lt;class 'str'&gt;</span><br><span class="line">&gt;&gt;&gt; c = '8'</span><br><span class="line">&gt;&gt;&gt; print(c)</span><br><span class="line">8</span><br><span class="line">&gt;&gt;&gt; type(c)</span><br><span class="line">&lt;class 'str'&gt;</span><br></pre></td></tr></table></figure>
<h4 id="关键字">关键字</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="prompt">&gt;&gt;&gt; </span><span class="keyword">import</span> keyword</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>print(keyword)</span><br><span class="line">&lt;module <span class="string">'keyword'</span> <span class="keyword">from</span> <span class="string">'/root/anaconda3/lib/python3.5/keyword.py'</span>&gt;</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>dir(keyword)</span><br><span class="line">[<span class="string">'__all__'</span>, <span class="string">'__builtins__'</span>, <span class="string">'__cached__'</span>, <span class="string">'__doc__'</span>, <span class="string">'__file__'</span>,</span><br><span class="line"> <span class="string">'__loader__'</span>, <span class="string">'__name__'</span>, <span class="string">'__package__'</span>, <span class="string">'__spec__'</span>, <span class="string">'iskeyword'</span>,</span><br><span class="line">  <span class="string">'kwlist'</span>, <span class="string">'main'</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>keyword.kwlist</span><br><span class="line">[<span class="string">'False'</span>, <span class="string">'None'</span>, <span class="string">'True'</span>, <span class="string">'and'</span>, <span class="string">'as'</span>, <span class="string">'assert'</span>, <span class="string">'break'</span>, <span class="string">'class'</span>,</span><br><span class="line"> <span class="string">'continue'</span>, <span class="string">'def'</span>, <span class="string">'del'</span>, <span class="string">'elif'</span>, <span class="string">'else'</span>, <span class="string">'except'</span>, <span class="string">'finally'</span>, </span><br><span class="line"> <span class="string">'for'</span>, <span class="string">'from'</span>, <span class="string">'global'</span>, <span class="string">'if'</span>, <span class="string">'import'</span>, <span class="string">'in'</span>, <span class="string">'is'</span>, <span class="string">'lambda'</span>, </span><br><span class="line"> <span class="string">'nonlocal'</span>, <span class="string">'not'</span>, <span class="string">'or'</span>, <span class="string">'pass'</span>, <span class="string">'raise'</span>, <span class="string">'return'</span>, <span class="string">'try'</span>, <span class="string">'while'</span>, </span><br><span class="line"> <span class="string">'with'</span>, <span class="string">'yield'</span>]</span><br></pre></td></tr></table></figure>
<h4 id="数字">数字</h4><table>
<thead>
<tr>
<th>运算符</th>
<th>描述</th>
<th>示例</th>
<th>运算结果</th>
</tr>
</thead>
<tbody>
<tr>
<td>+</td>
<td>加法</td>
<td>5 + 8</td>
<td>13</td>
</tr>
<tr>
<td>-</td>
<td>减法</td>
<td>90 - 10</td>
<td>80</td>
</tr>
<tr>
<td>*</td>
<td>乘法</td>
<td>4 * 7</td>
<td>28</td>
</tr>
<tr>
<td>/</td>
<td>浮点数除法</td>
<td>7 / 2</td>
<td>3.5</td>
</tr>
<tr>
<td>//</td>
<td>整数除法</td>
<td>7//2</td>
<td>3</td>
</tr>
<tr>
<td>%</td>
<td>模(求余)</td>
<td>7%3</td>
<td>1</td>
</tr>
<tr>
<td>**</td>
<td>幂</td>
<td>3**4</td>
<td>81</td>
</tr>
</tbody>
</table>
<h4 id="基数">基数</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="prompt">&gt;&gt;&gt; </span><span class="number">10</span></span><br><span class="line"><span class="number">10</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>bin(<span class="number">10</span>) <span class="comment">#二进制</span></span><br><span class="line"><span class="string">'0b1010'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>oct(<span class="number">10</span>) <span class="comment">#八进制</span></span><br><span class="line"><span class="string">'0o12'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>hex(<span class="number">10</span>) <span class="comment">#十六进制</span></span><br><span class="line"><span class="string">'0xa'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span><span class="string">'0b1010'</span></span><br><span class="line"><span class="string">'0b1010'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span><span class="number">0b1010</span></span><br><span class="line"><span class="number">10</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span><span class="number">0o12</span></span><br><span class="line"><span class="number">10</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span><span class="number">0xa</span></span><br><span class="line"><span class="number">10</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>int(<span class="string">'0b1010'</span>,<span class="number">2</span>) <span class="comment">#二进制转十进制</span></span><br><span class="line"><span class="number">10</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>int(<span class="string">'0o12'</span>,<span class="number">8</span>) <span class="comment">#八进制转十进制</span></span><br><span class="line"><span class="number">10</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>int(<span class="string">'0xa'</span>,<span class="number">16</span>) <span class="comment">#十六进制转十进制</span></span><br><span class="line"><span class="number">10</span></span><br></pre></td></tr></table></figure>
<h4 id="类型转换">类型转换</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="prompt">&gt;&gt;&gt; </span>int(<span class="keyword">True</span>)</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>int(<span class="keyword">False</span>)</span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>int(<span class="number">98.6</span>)</span><br><span class="line"><span class="number">98</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>int(<span class="number">1.0e4</span>)</span><br><span class="line"><span class="number">10000</span></span><br><span class="line"></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>int(<span class="string">'98.6'</span>) <span class="comment">#int() 可以接受浮点数或由数字组成的字符串，</span></span><br><span class="line">                <span class="comment">#但无法接受包含小数点或指数的字符串</span></span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">ValueError: invalid literal <span class="keyword">for</span> int() <span class="keyword">with</span> base <span class="number">10</span>: <span class="string">'98.6'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>int(<span class="string">'1.0e4'</span>)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">ValueError: invalid literal <span class="keyword">for</span> int() <span class="keyword">with</span> base <span class="number">10</span>: <span class="string">'1.0e4'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>int(<span class="number">56.3</span>) <span class="comment">#浮点数变成整数</span></span><br><span class="line"><span class="number">56</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>int(<span class="string">'-23'</span>)</span><br><span class="line">-<span class="number">23</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>int(<span class="string">'+12'</span>)</span><br><span class="line"><span class="number">12</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>int(<span class="string">'99 bottles of beer on the wall'</span>)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">ValueError: invalid literal <span class="keyword">for</span> int() <span class="keyword">with</span> base <span class="number">10</span>: <span class="string">'99 bottles of beer on the wall'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>int(<span class="string">''</span>)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">ValueError: invalid literal <span class="keyword">for</span> int() <span class="keyword">with</span> base <span class="number">10</span>: <span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>float(<span class="number">98</span>)</span><br><span class="line"><span class="number">98.0</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>float(<span class="string">'99'</span>)</span><br><span class="line"><span class="number">99.0</span></span><br></pre></td></tr></table></figure>
<h4 id="字符串">字符串</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="prompt">&gt;&gt;&gt; </span><span class="string">'Snap'</span> <span class="comment">#一对单引号或一对双引号中即可创建字符串</span></span><br><span class="line"><span class="string">'Snap'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span><span class="string">"Crackle"</span></span><br><span class="line"><span class="string">'Crackle'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>poem2 = <span class="string">'''I do not like thee, Doctor Fell. </span><br><span class="line"><span class="prompt">... </span>The reason why, I cannot tell.</span><br><span class="line"><span class="prompt">... </span>But this I know, and know full well:</span><br><span class="line"><span class="prompt">... </span>I do not like thee, Doctor Fell.</span><br><span class="line"><span class="prompt">... </span>'''</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>print(poem2) <span class="comment">#三元引号包裹的字符串,内部格式不变</span></span><br><span class="line">I do <span class="keyword">not</span> like thee, Doctor Fell.</span><br><span class="line">The reason why, I cannot tell.</span><br><span class="line">But this I know, <span class="keyword">and</span> know full well:</span><br><span class="line">I do <span class="keyword">not</span> like thee, Doctor Fell.</span><br></pre></td></tr></table></figure>
<h5 id="使用str()进行类型转换">使用str()进行类型转换</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="prompt">&gt;&gt;&gt; </span>str(<span class="number">98.6</span>)</span><br><span class="line"><span class="string">'98.6'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>str(<span class="number">1.0e4</span>)</span><br><span class="line"><span class="string">'10000.0'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>str(<span class="keyword">True</span>)</span><br><span class="line"><span class="string">'True'</span></span><br></pre></td></tr></table></figure>
<h5 id="使用+拼接">使用+拼接</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="prompt">&gt;&gt;&gt; </span><span class="string">'Release the kraken! '</span> + <span class="string">'At once!'</span></span><br><span class="line"><span class="string">'Release the kraken! At once!'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>a = <span class="string">'Duck.'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>b = a</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>c = <span class="string">'Grey Duck!'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>a + b + c</span><br><span class="line"><span class="string">'Duck.Duck.Grey Duck!'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>print(a, b, c) <span class="comment">#print() 进行打印时，Python 会在各</span></span><br><span class="line">                   <span class="comment">#个参数之间自动添加空格并在结尾添加换行符</span></span><br><span class="line">Duck. Duck. Grey Duck!</span><br></pre></td></tr></table></figure>
<h5 id="使用*复制">使用*复制</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="prompt">&gt;&gt;&gt; </span>start = <span class="string">'Na '</span> * <span class="number">4</span> + <span class="string">'\n'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>middle = <span class="string">'Hey '</span> * <span class="number">3</span> + <span class="string">'\n'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>end = <span class="string">'Goodbye.'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>print(start + start + middle + end)</span><br></pre></td></tr></table></figure>
<h5 id="使用[]提取字符">使用[]提取字符</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="prompt">&gt;&gt;&gt; </span>letters = <span class="string">'abcdefghijklmnopqrstuvwxyz'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>letters[<span class="number">0</span>]</span><br><span class="line"><span class="string">'a'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>letters[<span class="number">1</span>]</span><br><span class="line"><span class="string">'b'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>letters[-<span class="number">1</span>]</span><br><span class="line"><span class="string">'z'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>letters[-<span class="number">2</span>]</span><br><span class="line"><span class="string">'y'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>letters[<span class="number">25</span>]</span><br><span class="line"><span class="string">'z'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>letters[<span class="number">5</span>]</span><br><span class="line"><span class="string">'f'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>letters[<span class="number">100</span>]</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">IndexError: string index out of range</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>name = <span class="string">'Henny'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>naume[<span class="number">0</span>] = <span class="string">'P'</span></span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">TypeError: <span class="string">'str'</span> object does <span class="keyword">not</span> support item assignment</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>name = <span class="string">'Henny'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>name.replace(<span class="string">'H'</span>, <span class="string">'P'</span>)</span><br><span class="line"><span class="string">'Penny'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span><span class="string">'P'</span> + name[<span class="number">1</span>:]</span><br><span class="line"><span class="string">'Penny'</span></span><br></pre></td></tr></table></figure>
<h5 id="使用切片">使用切片</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="prompt">&gt;&gt;&gt; </span>letters = <span class="string">'abcdefghijklmnopqrstuvwxyz'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>letters[:]</span><br><span class="line"><span class="string">'abcdefghijklmnopqrstuvwxyz'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>letters[<span class="number">20</span>:]</span><br><span class="line"><span class="string">'uvwxyz'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>letters[<span class="number">10</span>:]</span><br><span class="line"><span class="string">'klmnopqrstuvwxyz'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>letters[<span class="number">12</span>:<span class="number">15</span>]</span><br><span class="line"><span class="string">'mno'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>letters[-<span class="number">3</span>:]</span><br><span class="line"><span class="string">'xyz'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>letters[<span class="number">18</span>:-<span class="number">3</span>]</span><br><span class="line"><span class="string">'stuvw'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>letters[-<span class="number">6</span>:-<span class="number">2</span>]</span><br><span class="line"><span class="string">'uvwx'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>letters[::<span class="number">7</span>]</span><br><span class="line"><span class="string">'ahov'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>letters[<span class="number">4</span>:<span class="number">20</span>:<span class="number">3</span>]</span><br><span class="line"><span class="string">'ehknqt'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>letters[::-<span class="number">1</span>]</span><br><span class="line"><span class="string">'zyxwvutsrqponmlkjihgfedcba'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>letters[:<span class="number">70</span>]</span><br><span class="line"><span class="string">'abcdefghijklmnopqrstuvwxyz'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>letters[<span class="number">70</span>:<span class="number">71</span>]</span><br><span class="line"><span class="string">''</span></span><br></pre></td></tr></table></figure>
<h5 id="使用len()获得长度">使用len()获得长度</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="prompt">&gt;&gt;&gt; </span>letters = <span class="string">'abcdefghijklmnopqrstuvwxyz'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>len(letters)</span><br><span class="line"><span class="number">26</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>empty = <span class="string">""</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>len(empty)</span><br><span class="line"><span class="number">0</span></span><br></pre></td></tr></table></figure>
<h5 id="split切割字符串">split切割字符串</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="prompt">&gt;&gt;&gt; </span>todos = <span class="string">'get gloves,get mask,give cat vitamins,call ambulance'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>todos.split(<span class="string">','</span>)</span><br><span class="line">[<span class="string">'get gloves'</span>, <span class="string">'get mask'</span>, <span class="string">'give cat vitamins'</span>, <span class="string">'call ambulance'</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>todos.split()  <span class="comment">#默认分隔符是空白符—换行符、空格、制表</span></span><br><span class="line">[<span class="string">'get'</span>, <span class="string">'gloves,get'</span>, <span class="string">'mask,give'</span>, <span class="string">'cat'</span>, <span class="string">'vitamins,call'</span>, <span class="string">'ambulance'</span>]</span><br></pre></td></tr></table></figure>
<h5 id="使用join()合并">使用join()合并</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="prompt">&gt;&gt;&gt; </span>crypto_list = [<span class="string">'Yeti'</span>, <span class="string">'Bigfoot'</span>, <span class="string">'Loch Ness Monster'</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>crypto_string = <span class="string">', '</span>.join(crypto_list)</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>print(<span class="string">'Found and signing book deals:'</span>, crypto_string)</span><br><span class="line">Found <span class="keyword">and</span> signing book deals: Yeti, Bigfoot, Loch Ness Monster</span><br></pre></td></tr></table></figure>
<h5 id="字符串函数">字符串函数</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>poem = <span class="string">'''All that doth flow we cannot liquid name</span><br><span class="line">Or else would fire and water be the same;</span><br><span class="line">But that is liquid which is moist and wet</span><br><span class="line">Fire that property can never get.</span><br><span class="line">Then 'tis not cold that doth the fire put out</span><br><span class="line">But 'tis the wet that makes it die, no doubt.'''</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>poem[:<span class="number">13</span>] <span class="comment"># 提取开头的13 个字符</span></span><br><span class="line"><span class="string">'All that doth'</span> </span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>len(poem) <span class="comment"># 字符串长度</span></span><br><span class="line"><span class="number">250</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>poem.startswith(<span class="string">'All'</span>) <span class="comment"># 字符串是否以All开头</span></span><br><span class="line"><span class="keyword">True</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>poem.endswith(<span class="string">'That\'s all, folks!'</span>) <span class="comment"># 否以That's all, folks!? 结尾？</span></span><br><span class="line"><span class="keyword">False</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>word = <span class="string">'the'</span>  <span class="comment"># 查找the出现的第一次的位置</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>poem.find(word)</span><br><span class="line"><span class="number">73</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>poem.rfind(word) <span class="comment"># 查找the出现的最后一次的位置</span></span><br><span class="line"><span class="number">214</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>poem.count(word) <span class="comment"># the出现的次数</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>poem.isalnum() <span class="comment"># 所有字符是否都是字母或数字</span></span><br><span class="line"><span class="keyword">False</span></span><br></pre></td></tr></table></figure>
<h4 id="字符串全部方法">字符串全部方法</h4><p><a href="https://docs.python.org/3/library/stdtypes.html#string-methods" target="_blank" rel="external">Python字符串库</a></p>
<h3 id="第三章_Python容器：列表、元组、字典与集合">第三章 Python容器：列表、元组、字典与集合</h3><h4 id="列表">列表</h4><h5 id="使用[]或list()创建列表">使用[]或list()创建列表</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>empty_list = [ ]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>weekdays = [<span class="string">'Monday'</span>, <span class="string">'Tuesday'</span>, <span class="string">'Wednesday'</span>, <span class="string">'Thursday'</span>, <span class="string">'Friday'</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>big_birds = [<span class="string">'emu'</span>, <span class="string">'ostrich'</span>, <span class="string">'cassowary'</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>first_names = [<span class="string">'Graham'</span>, <span class="string">'John'</span>, <span class="string">'Terry'</span>, <span class="string">'Terry'</span>, <span class="string">'Michael'</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>another_empty_list = list()</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>another_empty_list</span><br><span class="line">[]</span><br><span class="line"></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>list(<span class="string">'cat'</span>)</span><br><span class="line">[<span class="string">'c'</span>, <span class="string">'a'</span>, <span class="string">'t'</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>a_tuple = (<span class="string">'ready'</span>, <span class="string">'fire'</span>, <span class="string">'aim'</span>)</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>list(a_tuple)</span><br><span class="line">[<span class="string">'ready'</span>, <span class="string">'fire'</span>, <span class="string">'aim'</span>]</span><br><span class="line"></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>birthday = <span class="string">'1/6/1952'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>birthday.split(<span class="string">'/'</span>)</span><br><span class="line">[<span class="string">'1'</span>, <span class="string">'6'</span>, <span class="string">'1952'</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>splitme = <span class="string">'a/b//c/d///e'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>splitme.split(<span class="string">'/'</span>)</span><br><span class="line">[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">''</span>, <span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">''</span>, <span class="string">''</span>, <span class="string">'e'</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>splitme = <span class="string">'a/b//c/d///e'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>splitme.split(<span class="string">'//'</span>)</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">[<span class="string">'a/b'</span>, <span class="string">'c/d'</span>, <span class="string">'/e'</span>]</span><br></pre></td></tr></table></figure>
<h5 id="使用[offset]获取元素">使用[offset]获取元素</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes = [<span class="string">'Groucho'</span>, <span class="string">'Chico'</span>, <span class="string">'Harpo'</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes[<span class="number">0</span>]</span><br><span class="line"><span class="string">'Groucho'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes[<span class="number">1</span>]</span><br><span class="line"><span class="string">'Chico'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes[<span class="number">2</span>]</span><br><span class="line"><span class="string">'Harpo'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes[-<span class="number">1</span>]</span><br><span class="line"><span class="string">'Harpo'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes[-<span class="number">2</span>]</span><br><span class="line"><span class="string">'Chico'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes[-<span class="number">3</span>]</span><br><span class="line"><span class="string">'Groucho'</span></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line"></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes = [<span class="string">'Groucho'</span>, <span class="string">'Chico'</span>, <span class="string">'Harpo'</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes[<span class="number">5</span>]</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">IndexError: list index out of range</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes[-<span class="number">5</span>]</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">IndexError: list index out of range</span><br></pre></td></tr></table></figure>
<h5 id="包含列表的列表">包含列表的列表</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="prompt">&gt;&gt;&gt; </span>small_birds = [<span class="string">'hummingbird'</span>, <span class="string">'finch'</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>extinct_birds = [<span class="string">'dodo'</span>, <span class="string">'passenger pigeon'</span>, <span class="string">'Norwegian Blue'</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>carol_birds = [<span class="number">3</span>, <span class="string">'French hens'</span>, <span class="number">2</span>, <span class="string">'turtledoves'</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>all_birds = [small_birds, extinct_birds, <span class="string">'macaw'</span>, carol_birds]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>all_birds</span><br><span class="line">[[<span class="string">'hummingbird'</span>, <span class="string">'finch'</span>], </span><br><span class="line">[<span class="string">'dodo'</span>, <span class="string">'passenger pigeon'</span>, <span class="string">'Norwegian Blue'</span>], <span class="string">'macaw'</span>,</span><br><span class="line">[<span class="number">3</span>, <span class="string">'French hens'</span>, <span class="number">2</span>, <span class="string">'turtledoves'</span>]]</span><br><span class="line"></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>all_birds[<span class="number">0</span>]</span><br><span class="line">[<span class="string">'hummingbird'</span>, <span class="string">'finch'</span>]</span><br><span class="line"></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>all_birds[<span class="number">1</span>]</span><br><span class="line">[<span class="string">'dodo'</span>, <span class="string">'passenger pigeon'</span>, <span class="string">'Norwegian Blue'</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>all_birds[<span class="number">1</span>][<span class="number">0</span>]</span><br><span class="line"><span class="string">'dodo'</span></span><br></pre></td></tr></table></figure>
<h5 id="使用[offset]修改元素">使用[offset]修改元素</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes = [<span class="string">'Groucho'</span>, <span class="string">'Chico'</span>, <span class="string">'Harpo'</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes[<span class="number">2</span>] = <span class="string">'Wanda'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes</span><br><span class="line">[<span class="string">'Groucho'</span>, <span class="string">'Chico'</span>, <span class="string">'Wanda'</span>]</span><br></pre></td></tr></table></figure>
<h5 id="使用切片提取元素">使用切片提取元素</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes = [<span class="string">'Groucho'</span>, <span class="string">'Chico,'</span> <span class="string">'Harpo'</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes[<span class="number">0</span>:<span class="number">2</span>]</span><br><span class="line">[<span class="string">'Groucho'</span>, <span class="string">'Chico'</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes[::<span class="number">2</span>]</span><br><span class="line">[<span class="string">'Groucho'</span>, <span class="string">'Harpo'</span>]</span><br><span class="line"></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes[::-<span class="number">2</span>]</span><br><span class="line">[<span class="string">'Harpo'</span>, <span class="string">'Groucho'</span>]</span><br></pre></td></tr></table></figure>
<h5 id="使用append()添加元素至尾部">使用append()添加元素至尾部</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes.append(<span class="string">'Zeppo'</span>)</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes</span><br><span class="line">[<span class="string">'Groucho'</span>, <span class="string">'Chico'</span>, <span class="string">'Harpo'</span>, <span class="string">'Zeppo'</span>]</span><br><span class="line"></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes = [<span class="string">'Groucho'</span>, <span class="string">'Chico'</span>, <span class="string">'Harpo'</span>, <span class="string">'Zeppo'</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>others = [<span class="string">'Gummo'</span>, <span class="string">'Karl'</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes.append(others)</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes</span><br><span class="line">[<span class="string">'Groucho'</span>, <span class="string">'Chico'</span>, <span class="string">'Harpo'</span>, <span class="string">'Zeppo'</span>, [<span class="string">'Gummo'</span>, <span class="string">'Karl'</span>]]</span><br></pre></td></tr></table></figure>
<h5 id="使用extend()或+=合并列表">使用extend()或+=合并列表</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes = [<span class="string">'Groucho'</span>, <span class="string">'Chico'</span>, <span class="string">'Harpo'</span>, <span class="string">'Zeppo'</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>others = [<span class="string">'Gummo'</span>, <span class="string">'Karl'</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes.extend(others)</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes</span><br><span class="line">[<span class="string">'Groucho'</span>, <span class="string">'Chico'</span>, <span class="string">'Harpo'</span>, <span class="string">'Zeppo'</span>, <span class="string">'Gummo'</span>, <span class="string">'Karl'</span>]</span><br><span class="line"></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes = [<span class="string">'Groucho'</span>, <span class="string">'Chico'</span>, <span class="string">'Harpo'</span>, <span class="string">'Zeppo'</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>others = [<span class="string">'Gummo'</span>, <span class="string">'Karl'</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes += others</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes</span><br><span class="line">[<span class="string">'Groucho'</span>, <span class="string">'Chico'</span>, <span class="string">'Harpo'</span>, <span class="string">'Zeppo'</span>, <span class="string">'Gummo'</span>, <span class="string">'Karl'</span>]</span><br></pre></td></tr></table></figure>
<h5 id="insert()在指定位置插入元素">insert()在指定位置插入元素</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes.insert(<span class="number">3</span>, <span class="string">'Gummo'</span>)</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes</span><br><span class="line">[<span class="string">'Groucho'</span>, <span class="string">'Chico'</span>, <span class="string">'Harpo'</span>, <span class="string">'Gummo'</span>, <span class="string">'Zeppo'</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes.insert(<span class="number">10</span>, <span class="string">'Karl'</span>)</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes</span><br><span class="line">[<span class="string">'Groucho'</span>, <span class="string">'Chico'</span>, <span class="string">'Harpo'</span>, <span class="string">'Gummo'</span>, <span class="string">'Zeppo'</span>, <span class="string">'Karl'</span>]</span><br></pre></td></tr></table></figure>
<h5 id="使用del删除指定位置的元素">使用del删除指定位置的元素</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="prompt">&gt;&gt;&gt; </span><span class="keyword">del</span> marxes[-<span class="number">1</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes</span><br><span class="line">[<span class="string">'Groucho'</span>, <span class="string">'Chico'</span>, <span class="string">'Harpo'</span>, <span class="string">'Gummo'</span>, <span class="string">'Zeppo'</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes = [<span class="string">'Groucho'</span>, <span class="string">'Chico'</span>, <span class="string">'Harpo'</span>, <span class="string">'Gummo'</span>, <span class="string">'Zeppo'</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes[<span class="number">2</span>]</span><br><span class="line"><span class="string">'Harpo'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span><span class="keyword">del</span> marxes[<span class="number">2</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes</span><br><span class="line">[<span class="string">'Groucho'</span>, <span class="string">'Chico'</span>, <span class="string">'Gummo'</span>, <span class="string">'Zeppo'</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes[<span class="number">2</span>]</span><br><span class="line"><span class="string">'Gummo'</span></span><br></pre></td></tr></table></figure>
<h5 id="使用remove()删除具有指定值的元素">使用remove()删除具有指定值的元素</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes = [<span class="string">'Groucho'</span>, <span class="string">'Chico'</span>, <span class="string">'Harpo'</span>, <span class="string">'Gummo'</span>, <span class="string">'Zeppo'</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes.remove(<span class="string">'Gummo'</span>)</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes</span><br><span class="line">[<span class="string">'Groucho'</span>, <span class="string">'Chico'</span>, <span class="string">'Harpo'</span>, <span class="string">'Zeppo'</span>]</span><br></pre></td></tr></table></figure>
<h5 id="全部删除指定元素">全部删除指定元素</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes = [<span class="string">'t'</span>,<span class="string">'s'</span>,<span class="string">'t'</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>list(filter(<span class="keyword">lambda</span> a: a != <span class="string">'t'</span>,marxes ))</span><br><span class="line">[<span class="string">'s'</span>]</span><br></pre></td></tr></table></figure>
<h5 id="使用pop()获取并删除指定位置的元素">使用pop()获取并删除指定位置的元素</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes = [<span class="string">'Groucho'</span>, <span class="string">'Chico'</span>, <span class="string">'Harpo'</span>, <span class="string">'Zeppo'</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes.pop()</span><br><span class="line"><span class="string">'Zeppo'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes</span><br><span class="line">[<span class="string">'Groucho'</span>, <span class="string">'Chico'</span>, <span class="string">'Harpo'</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes.pop(<span class="number">1</span>)</span><br><span class="line"><span class="string">'Chico'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes</span><br><span class="line">[<span class="string">'Groucho'</span>, <span class="string">'Harpo'</span>]</span><br></pre></td></tr></table></figure>
<h5 id="使用index()查询具有特定值的元素位置">使用index()查询具有特定值的元素位置</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes = [<span class="string">'Groucho'</span>, <span class="string">'Chico'</span>, <span class="string">'Harpo'</span>, <span class="string">'Zeppo'</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes.index(<span class="string">'Chico'</span>)</span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure>
<h5 id="使用in判断值是否存在">使用in判断值是否存在</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes = [<span class="string">'Groucho'</span>, <span class="string">'Chico'</span>, <span class="string">'Harpo'</span>, <span class="string">'Zeppo'</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span><span class="string">'Groucho'</span> <span class="keyword">in</span> marxes</span><br><span class="line"><span class="keyword">True</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span><span class="string">'Bob'</span> <span class="keyword">in</span> marxes</span><br><span class="line"><span class="keyword">False</span></span><br></pre></td></tr></table></figure>
<h5 id="使用count()记录特定值出现的次数">使用count()记录特定值出现的次数</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes = [<span class="string">'Groucho'</span>, <span class="string">'Chico'</span>, <span class="string">'Harpo'</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes.count(<span class="string">'Harpo'</span>)</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes.count(<span class="string">'Bob'</span>)</span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>snl_skit = [<span class="string">'cheeseburger'</span>, <span class="string">'cheeseburger'</span>, <span class="string">'cheeseburger'</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>snl_skit.count(<span class="string">'cheeseburger'</span>)</span><br><span class="line"><span class="number">3</span></span><br></pre></td></tr></table></figure>
<h5 id="使用join()转换为字符串">使用join()转换为字符串</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes = [<span class="string">'Groucho'</span>, <span class="string">'Chico'</span>, <span class="string">'Harpo'</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span><span class="string">', '</span>.join(marxes)</span><br><span class="line"><span class="string">'Groucho, Chico, Harpo'</span></span><br><span class="line"><span class="comment">#join() 是split() 的逆过程</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>friends = [<span class="string">'Harry'</span>, <span class="string">'Hermione'</span>, <span class="string">'Ron'</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>separator = <span class="string">' * '</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>joined = separator.join(friends)</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>joined</span><br><span class="line"><span class="string">'Harry * Hermione * Ron'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>separated = joined.split(separator)</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>separated</span><br><span class="line">[<span class="string">'Harry'</span>, <span class="string">'Hermione'</span>, <span class="string">'Ron'</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>separated == friends</span><br><span class="line"><span class="keyword">True</span></span><br></pre></td></tr></table></figure>
<h5 id="使用sort()重新排列元素">使用sort()重新排列元素</h5><ul>
<li>列表方法sort() 会对原列表进行排序，改变原列表内容；</li>
<li>通用函数sorted() 则会返回排好序的列表副本，原列表内容不变。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes = [<span class="string">'Groucho'</span>, <span class="string">'Chico'</span>, <span class="string">'Harpo'</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>sorted_marxes = sorted(marxes)</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>sorted_marxes</span><br><span class="line">[<span class="string">'Chico'</span>, <span class="string">'Groucho'</span>, <span class="string">'Harpo'</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes</span><br><span class="line">[<span class="string">'Groucho'</span>, <span class="string">'Chico'</span>, <span class="string">'Harpo'</span>]</span><br><span class="line"></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes.sort()</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes</span><br><span class="line">[<span class="string">'Chico'</span>, <span class="string">'Groucho'</span>, <span class="string">'Harpo'</span>]</span><br><span class="line"></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>numbers = [<span class="number">2</span>, <span class="number">1</span>, <span class="number">4.0</span>, <span class="number">3</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>numbers.sort(reverse=<span class="keyword">True</span>) <span class="comment"># 添加参数reverse=True 可以改变为降序排列</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>numbers</span><br><span class="line">[<span class="number">4.0</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br></pre></td></tr></table></figure>
<h5 id="使用len()获取长度">使用len()获取长度</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marxes = [<span class="string">'Groucho'</span>, <span class="string">'Chico'</span>, <span class="string">'Harpo'</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>len(marxes)</span><br><span class="line"><span class="number">3</span></span><br></pre></td></tr></table></figure>
<h5 id="使用=赋值，使用copy()复制">使用=赋值，使用copy()复制</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="prompt">&gt;&gt;&gt; </span>a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>a</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>b = a</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>b</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>a[<span class="number">0</span>] = <span class="string">'surprise'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>a</span><br><span class="line">[<span class="string">'surprise'</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br></pre></td></tr></table></figure>
<p>通过下面任意一种方法，都可以将一个列表的值复制到另一个新的列表中：</p>
<ul>
<li>列表copy() 函数</li>
<li>list() 转换函数</li>
<li>列表分片[:]<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="prompt">&gt;&gt;&gt; </span>a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>b = a.copy()</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>c = list(a)</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>d = a[:]</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>在这个例子中，b、c、d 都是a 的复制：<br>它们是自身带有值的新对象，与原始<br>的a 所指向的列表对象[1, 2, 3] 没有<br>任何关联。改变a 不影响b、c 和d 的复制</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="prompt">&gt;&gt;&gt; </span>a[<span class="number">0</span>] = <span class="string">'integer lists are boring'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>a</span><br><span class="line">[<span class="string">'integer lists are boring'</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>b</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>c</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>d</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br></pre></td></tr></table></figure>
<h3 id="元组">元组</h3><h5 id="创建元组">创建元组</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="prompt">&gt;&gt;&gt; </span>empty_tuple = ()</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>empty_tuple</span><br><span class="line">()</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>one_marx = <span class="string">'Groucho'</span>,</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>one_marx</span><br><span class="line">(<span class="string">'Groucho'</span>,)</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marx_tuple = <span class="string">'Groucho'</span>, <span class="string">'Chico'</span>, <span class="string">'Harpo'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marx_tuple</span><br><span class="line">(<span class="string">'Groucho'</span>, <span class="string">'Chico'</span>, <span class="string">'Harpo'</span>)</span><br><span class="line"></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marx_tuple = (<span class="string">'Groucho'</span>, <span class="string">'Chico'</span>, <span class="string">'Harpo'</span>) <span class="comment">#元组解包</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>a, b, c = marx_tuple</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>a</span><br><span class="line"><span class="string">'Groucho'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>b</span><br><span class="line"><span class="string">'Chico'</span></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>c</span><br><span class="line"><span class="string">'Harpo'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>marx_list = [<span class="string">'Groucho'</span>, <span class="string">'Chico'</span>, <span class="string">'Harpo'</span>]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>tuple(marx_list)</span><br><span class="line">(<span class="string">'Groucho'</span>, <span class="string">'Chico'</span>, <span class="string">'Harpo'</span>)</span><br></pre></td></tr></table></figure>
<h5 id="元组与列表">元组与列表</h5><p>在许多地方都可以用元组代替列表，但元组的方法函数与列表相比要少一些——元组没有<br>append()、insert()，等等——因为一旦创建元组便无法修改。既然列表更加灵活，那为<br>什么不在所有地方都使用列表呢？原因如下所示：<br>• 元组占用的空间较小<br>• 你不会意外修改元组的值<br>• 可以将元组用作字典的键（详见3.4 节）<br>• 命名元组（详见第6 章“命名元组”小节）可以作为对象的替代<br>• 函数的参数是以元组形式传递的（详见4.7 节）</p>
<h3 id="字典">字典</h3><h5 id="使用{}创建字典">使用{}创建字典</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="prompt">&gt;&gt;&gt; </span>empty_dict = &#123;&#125;</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>empty_dict</span><br><span class="line">&#123;&#125;</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>bierce = &#123;</span><br><span class="line"><span class="prompt">... </span><span class="string">"day"</span>: <span class="string">"A period of twenty-four hours, mostly misspent"</span>,</span><br><span class="line"><span class="prompt">... </span><span class="string">"positive"</span>: <span class="string">"Mistaken at the top of one's voice"</span>,</span><br><span class="line"><span class="prompt">... </span><span class="string">"misfortune"</span>: <span class="string">"The kind of fortune that never misses"</span>,</span><br><span class="line"><span class="prompt">... </span>&#125;</span><br></pre></td></tr></table></figure>
<h5 id="使用dict()转换为字典">使用dict()转换为字典</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>lol = [ [<span class="string">'a'</span>, <span class="string">'b'</span>], [<span class="string">'c'</span>, <span class="string">'d'</span>], [<span class="string">'e'</span>, <span class="string">'f'</span>] ]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>dict(lol)</span><br><span class="line">&#123;<span class="string">'c'</span>: <span class="string">'d'</span>, <span class="string">'a'</span>: <span class="string">'b'</span>, <span class="string">'e'</span>: <span class="string">'f'</span>&#125;</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>lot = [ (<span class="string">'a'</span>, <span class="string">'b'</span>), (<span class="string">'c'</span>, <span class="string">'d'</span>), (<span class="string">'e'</span>, <span class="string">'f'</span>) ]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>dict(lot)</span><br><span class="line">&#123;<span class="string">'c'</span>: <span class="string">'d'</span>, <span class="string">'a'</span>: <span class="string">'b'</span>, <span class="string">'e'</span>: <span class="string">'f'</span>&#125;</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>tol = ( [<span class="string">'a'</span>, <span class="string">'b'</span>], [<span class="string">'c'</span>, <span class="string">'d'</span>], [<span class="string">'e'</span>, <span class="string">'f'</span>] )</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>dict(tol)</span><br><span class="line">&#123;<span class="string">'c'</span>: <span class="string">'d'</span>, <span class="string">'a'</span>: <span class="string">'b'</span>, <span class="string">'e'</span>: <span class="string">'f'</span>&#125;</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>los = [ <span class="string">'ab'</span>, <span class="string">'cd'</span>, <span class="string">'ef'</span> ]</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>dict(los)</span><br><span class="line">&#123;<span class="string">'c'</span>: <span class="string">'d'</span>, <span class="string">'a'</span>: <span class="string">'b'</span>, <span class="string">'e'</span>: <span class="string">'f'</span>&#125;</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>tos = ( <span class="string">'ab'</span>, <span class="string">'cd'</span>, <span class="string">'ef'</span> )</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>dict(tos)</span><br><span class="line">&#123;<span class="string">'c'</span>: <span class="string">'d'</span>, <span class="string">'a'</span>: <span class="string">'b'</span>, <span class="string">'e'</span>: <span class="string">'f'</span>&#125;</span><br></pre></td></tr></table></figure>
<h5 id="使用[key]添加或修改元素">使用[key]添加或修改元素</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="prompt">&gt;&gt;&gt; </span>pythons = &#123;</span><br><span class="line"><span class="prompt">... </span><span class="string">'Chapman'</span>: <span class="string">'Graham'</span>,</span><br><span class="line"><span class="prompt">... </span><span class="string">'Cleese'</span>: <span class="string">'John'</span>,</span><br><span class="line"><span class="prompt">... </span><span class="string">'Idle'</span>: <span class="string">'Eric'</span>,</span><br><span class="line"><span class="prompt">... </span><span class="string">'Jones'</span>: <span class="string">'Terry'</span>,</span><br><span class="line"><span class="prompt">... </span><span class="string">'Palin'</span>: <span class="string">'Michael'</span>,</span><br><span class="line"><span class="prompt">... </span>&#125;</span><br><span class="line"><span class="prompt">&gt;&gt;&gt; </span>pythons</span><br><span class="line">&#123;<span class="string">'Cleese'</span>: <span class="string">'John'</span>, <span class="string">'Jones'</span>: <span class="string">'Terry'</span>, <span class="string">'Palin'</span>: <span class="string">'Michael'</span>,</span><br><span class="line"><span class="string">'Chapman'</span>: <span class="string">'Graham'</span>, <span class="string">'Idle'</span>: <span class="string">'Eric'</span>&#125;</span><br></pre></td></tr></table></figure>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>#####<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/04/26/deeplearning/" itemprop="url">
                  深度学习
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            發表於
            <time itemprop="dateCreated" datetime="2017-04-26T16:06:37+08:00" content="2017-04-26">
              2017-04-26
            </time>
          </span>

          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <p>资料持续更新中</p>
<ol>
<li>单变量微积分</li>
<li>多变量微积分</li>
</ol>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/09/28/js-stack/" itemprop="url">
                  js_stack
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            發表於
            <time itemprop="dateCreated" datetime="2016-09-28T11:13:19+08:00" content="2016-09-28">
              2016-09-28
            </time>
          </span>

          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              
            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/28/DjangoGirls-Blog/" itemprop="url">
                  DjangoGirls Blog开发流程
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            發表於
            <time itemprop="dateCreated" datetime="2016-05-28T15:33:01+08:00" content="2016-05-28">
              2016-05-28
            </time>
          </span>

          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <p>hexo不支持Django模板.<br>因此将此文移动到<a href="http://www.jianshu.com/p/7adbee88662e" target="_blank" rel="external">简书</a></p>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/17/OleDB/" itemprop="url">
                  Access数据相关操作
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            發表於
            <time itemprop="dateCreated" datetime="2016-05-17T16:47:05+08:00" content="2016-05-17">
              2016-05-17
            </time>
          </span>

          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <p>Csharp 实现<br><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Data;</span><br><span class="line"><span class="keyword">using</span> System.Data.OleDb;</span><br><span class="line"><span class="keyword">using</span> System.Xml.Serialization;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">oledb</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="keyword">string</span>[] args</span>)</span><br><span class="line">        </span>&#123;</span><br><span class="line">            <span class="comment">//设置访问连接并选择字符串</span></span><br><span class="line">            <span class="comment">//如果从命令行生成此示例</span></span><br><span class="line">            <span class="comment">//则必须更改BugTypes的路径</span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">if</span> USINGPROJECTSYSTEM</span></span><br><span class="line">            <span class="keyword">string</span> strAccessConn = <span class="string">"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=..\\..\\BugTypes.MDB"</span>;</span><br><span class="line"><span class="preprocessor">#<span class="keyword">else</span></span></span><br><span class="line">            <span class="keyword">string</span> strAccessConn = <span class="string">"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=BugTypes.MDB"</span>;</span><br><span class="line"><span class="preprocessor">#<span class="keyword">endif</span></span></span><br><span class="line">            <span class="keyword">string</span> strAccessSelect = <span class="string">"SELECT * FROM Categories"</span>;</span><br><span class="line">            <span class="comment">//创建数据集并向其中添加Categories 表</span></span><br><span class="line">            DataSet myDataSet = <span class="keyword">new</span> DataSet();</span><br><span class="line">            OleDbConnection myAccessConn = <span class="keyword">null</span>;</span><br><span class="line">            <span class="comment">//打开连接</span></span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                myAccessConn = <span class="keyword">new</span> OleDbConnection(strAccessConn);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span>(Exception ex)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(<span class="string">"Error: Failed to create a database connection.\n&#123;0&#125;"</span>, ex.Message);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//提取所有数据</span></span><br><span class="line">            <span class="keyword">try</span></span><br><span class="line">            &#123;</span><br><span class="line">                OleDbCommand myAccessCommand = <span class="keyword">new</span> OleDbCommand(strAccessSelect, myAccessConn);</span><br><span class="line">                OleDbDataAdapter myDataAdapter = <span class="keyword">new</span> OleDbDataAdapter(myAccessCommand);</span><br><span class="line"></span><br><span class="line">                myAccessConn.Open();</span><br><span class="line">                myDataAdapter.Fill(myDataSet, <span class="string">"Categories"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span>(Exception ex)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(<span class="string">"Error: Failed to retrieve the required data from the DataBase.\n&#123;0&#125;"</span>, ex.Message);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">finally</span></span><br><span class="line">            &#123;</span><br><span class="line">                myAccessConn.Close();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 一个数据集可以包含多个表,因此可以将这些表名放入一个数组中</span></span><br><span class="line">            DataTableCollection dta = myDataSet.Tables;</span><br><span class="line">            <span class="keyword">foreach</span>(DataTable dt <span class="keyword">in</span> dta)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(<span class="string">"Found data table &#123;0&#125;"</span>, dt.TableName);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 下面两行显示两种不同的方法,可以获取数据集中的表数</span></span><br><span class="line">            Console.WriteLine(<span class="string">"&#123;0&#125; tables in data set"</span>, myDataSet.Tables.Count);</span><br><span class="line">            Console.WriteLine(<span class="string">"&#123;0&#125; tables in data set"</span>, dta.Count);</span><br><span class="line">            <span class="comment">// 下面几行显示如何按照名称从数据集中获取特定表的信息</span></span><br><span class="line">            Console.WriteLine(<span class="string">"&#123;0&#125; rows in Categories table"</span>, myDataSet.Tables[<span class="string">"Categories"</span>].Rows.Count);</span><br><span class="line">            <span class="comment">// 列信息自动从数据库中提取</span></span><br><span class="line">            Console.WriteLine(<span class="string">"&#123;0&#125; columns in Categories table"</span>, myDataSet.Tables[<span class="string">"Categories"</span>].Columns.Count);</span><br><span class="line">            DataColumnCollection drc = myDataSet.Tables[<span class="string">"Categories"</span>].Columns;</span><br><span class="line">            <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">foreach</span>(DataColumn dc <span class="keyword">in</span> drc)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(<span class="string">"Column name[&#123;0&#125;] is &#123;1&#125;,of type &#123;2&#125; "</span>, i++, dc.ColumnName, dc.DataType);</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">            DataRowCollection dra = myDataSet.Tables[<span class="string">"Categories"</span>].Rows;</span><br><span class="line">            <span class="keyword">foreach</span>(DataRow dr <span class="keyword">in</span> dra)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(<span class="string">"CategoryName [&#123;0&#125;] is &#123;1&#125;"</span>, dr[<span class="number">0</span>], dr[<span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            Console.ReadKey();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/04/25/dec2bin/" itemprop="url">
                  十进制转换二进制
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            發表於
            <time itemprop="dateCreated" datetime="2016-04-25T10:59:56+08:00" content="2016-04-25">
              2016-04-25
            </time>
          </span>

          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <h3 id="JavaScript实现">JavaScript实现</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Stack</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> items = [];</span><br><span class="line"></span><br><span class="line">	<span class="keyword">this</span>.push = <span class="function"><span class="keyword">function</span> (<span class="params">element</span>) </span>&#123;</span><br><span class="line">		items.push(element);</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">this</span>.pop = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> items.pop();</span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">this</span>.peek = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> items[items.length-<span class="number">1</span>];</span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">this</span>.isEmpty = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> items.length == <span class="number">0</span>;</span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">this</span>.size = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> items.length;</span><br><span class="line"></span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">this</span>.clear = functions()&#123;</span><br><span class="line">		items = [];</span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">this</span>.print = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="built_in">console</span>.log(items.toString());</span><br><span class="line">	&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">divideBy2</span>(<span class="params">decNumber</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> remStack = <span class="keyword">new</span> Stack(),</span><br><span class="line">	    rem,</span><br><span class="line">	    binaryString = <span class="string">''</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span> (decNumber &gt; <span class="number">0</span>) &#123;</span><br><span class="line">		rem = <span class="built_in">Math</span>.floor(decNumber % <span class="number">2</span>);</span><br><span class="line">		remStack.push(rem);</span><br><span class="line">		decNumber = <span class="built_in">Math</span>.floor(decNumber / <span class="number">2</span>); </span><br><span class="line">	&#125;    </span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span> (!remStack.isEmpty) &#123;</span><br><span class="line">		binaryString += remStack.pop().toString();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> binaryString;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(devideBy2(<span class="number">233</span>));<span class="comment">//输出11101001</span></span><br><span class="line"><span class="built_in">console</span>.log(devideBy2(<span class="number">10</span>));<span class="comment">//输出1010</span></span><br><span class="line"><span class="built_in">console</span>.log(devideBy2(<span class="number">1000</span>));<span class="comment">//输出1111101000</span></span><br></pre></td></tr></table></figure>
            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/03/29/sort-fsharp/" itemprop="url">
                  排序（F#实现）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            發表於
            <time itemprop="dateCreated" datetime="2016-03-29T20:50:26+08:00" content="2016-03-29">
              2016-03-29
            </time>
          </span>

          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <figure class="highlight fsharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ------ Example: define a sort function ------</span></span><br><span class="line"><span class="keyword">let</span> <span class="keyword">rec</span> sort list =</span><br><span class="line">   <span class="keyword">match</span> list <span class="keyword">with</span></span><br><span class="line">   <span class="comment">// If the list is empty</span></span><br><span class="line">   | [] -&gt;</span><br><span class="line">        []                            <span class="comment">// return an empty list</span></span><br><span class="line">   <span class="comment">// If the list is not empty</span></span><br><span class="line">   | firstElem::otherElements -&gt;      <span class="comment">// take the first element</span></span><br><span class="line">        <span class="keyword">let</span> smallerElements =         <span class="comment">// extract the smaller elements</span></span><br><span class="line">            otherElements             <span class="comment">// from the remaining ones</span></span><br><span class="line">            |&gt; List.filter (<span class="keyword">fun</span> e -&gt; e &lt; firstElem)</span><br><span class="line">            |&gt; sort                   <span class="comment">// and sort them</span></span><br><span class="line">        <span class="keyword">let</span> largerElements =          <span class="comment">// extract the larger ones</span></span><br><span class="line">            otherElements             <span class="comment">// from the remaining ones</span></span><br><span class="line">            |&gt; List.filter (<span class="keyword">fun</span> e -&gt; e &gt;= firstElem)</span><br><span class="line">            |&gt; sort                   <span class="comment">// and sort them</span></span><br><span class="line">        <span class="comment">// Combine the 3 parts into a new list and return it</span></span><br><span class="line">        List.concat [smallerElements; [firstElem]; largerElements]</span><br><span class="line"></span><br><span class="line"><span class="comment">// test</span></span><br><span class="line">sort [<span class="number">1</span>; <span class="number">5</span>; <span class="number">23</span>; <span class="number">18</span>; <span class="number">9</span>; <span class="number">1</span>; <span class="number">3</span>] |&gt; printfn <span class="string">"Sorted = %A"</span></span><br></pre></td></tr></table></figure>
            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/03/27/lang-map-load/" itemprop="url">
                  编程语言学习路线图
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            發表於
            <time itemprop="dateCreated" datetime="2016-03-27T15:52:36+08:00" content="2016-03-27">
              2016-03-27
            </time>
          </span>

          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <h3 id="CSharp">CSharp</h3><ul>
<li>Learning Hard C#</li>
<li>C# in a Netshell</li>
<li>C# in Depth</li>
<li>CLR via C#</li>
<li>C#语言规范</li>
</ul>
<h3 id="Java">Java</h3><ul>
<li>Core Java for the Impatient</li>
</ul>
<h3 id="Python">Python</h3><ul>
<li>Python介绍及应用</li>
</ul>
<h3 id="Clojure">Clojure</h3><ul>
<li>Living Clojure</li>
<li>Clojure CookBook</li>
<li>the Toy of Clojure</li>
</ul>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    

  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



        </div>

        


        

      </div>

      
        
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" src="/images/default_avatar.jpg" alt="SmallTalk" itemprop="image"/>
          <p class="site-author-name" itemprop="name">SmallTalk</p>
        </div>
        <p class="site-description motion-element" itemprop="description"></p>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">14</span>
              <span class="site-state-item-name">文章</span>
            </a>
          </div>

          <div class="site-state-item site-state-categories">
            
              <span class="site-state-item-count">0</span>
              <span class="site-state-item-name">分類</span>
              
          </div>

          <div class="site-state-item site-state-tags">
            <a href="/tags">
              <span class="site-state-item-count">1</span>
              <span class="site-state-item-name">標籤</span>
              </a>
          </div>

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        <div class="links-of-author motion-element">
          
        </div>

      </section>

      

    </div>
  </aside>


      
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="icon-next-heart fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">SmallTalk</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 強力驅動
</div>

<div class="theme-info">
  主題 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>



      </div>
    </footer>

    <div class="back-to-top"></div>
  </div>

  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  

  
    
    

  


  

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/fancy-box.js?v=0.4.5.2"></script>


  <script type="text/javascript" src="/js/helpers.js?v=0.4.5.2"></script>
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>
<script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

<script type="text/javascript" src="/js/motion.js?v=0.4.5.2" id="motion.global"></script>


  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  

  <script type="text/javascript" src="/js/bootstrap.js"></script>

  
  

  
  

</body>
</html>
